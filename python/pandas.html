<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta property="og:url" content="https://abelsun.tech/python/pandas.html"><meta property="og:site_name" content="LearnNotes"><meta property="og:title" content="Pandas"><meta property="og:description" content="Pandas Pandas 是一个强大的分析结构化数据的工具集，它的使用基础是 Numpy（提供高性能的矩阵运算），用于数据挖掘和数据分析，同时也提供数据清洗功能。 官方 官方文档 (https://pandas.pydata.org/docs/reference/index.html#api); 源代码 (https://github.com/pan..."><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-11-21T05:38:26.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:modified_time" content="2022-11-21T05:38:26.000Z"><title>Pandas | LearnNotes</title><meta name="description" content="Pandas Pandas 是一个强大的分析结构化数据的工具集，它的使用基础是 Numpy（提供高性能的矩阵运算），用于数据挖掘和数据分析，同时也提供数据清洗功能。 官方 官方文档 (https://pandas.pydata.org/docs/reference/index.html#api); 源代码 (https://github.com/pan...">
    <meta name="keywords" content="自我提升,效率提升,开源工具,学习笔记" />
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style.80000541.css" as="style" /><link rel="stylesheet" href="/assets/style.80000541.css" />
    <link rel="modulepreload" href="/assets/app.9fe353dd.js"><link rel="modulepreload" href="/assets/pandas.html.f5557d2b.js"><link rel="modulepreload" href="/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/assets/pandas.html.33865b09.js">
    <!-- 看板娘区块 -->
    <link href="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-y/font-awesome/6.0.0/css/all.min.css" type="text/css" rel="stylesheet" />
    <script src="/live2d-widget/autoload.js"></script>
    <!-- End 看板娘区块 -->
    <!-- Matomo 此区块为统计代码，请删除-->
    <script>
      var _paq = window._paq = window._paq || [];
      /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function() {
        var u="https://piwik.seoipo.com/";
        _paq.push(['setTrackerUrl', u+'matomo.php']);
        _paq.push(['setSiteId', '7']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
      })();
    </script>
    <!-- End Matomo Code 此区块为统计代码，请删除-->
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.svg" alt="LearnNotes"><!----><span class="site-name hide-in-pad">LearnNotes</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/blog.html" class="nav-link" aria-label="博客"><span class="icon iconfont icon-blog"></span>博客<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="编程就是"><span class="title"><span class="icon iconfont icon-code"></span>编程就是</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>基础/系统</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/services/NAS" class="nav-link" aria-label="/services/NAS"><!---->/services/NAS<!----></a></li><li class="dropdown-subitem"><a href="/windows/faq" class="nav-link" aria-label="/windows/faq"><!---->/windows/faq<!----></a></li></ul></li><li class="dropdown-item"><a href="/code/Markdown.html" class="nav-link" aria-label="Markdown基础语法"><span class="icon iconfont icon-markdown"></span>Markdown基础语法<!----></a></li><li class="dropdown-item"><a href="/java/java_base.html" class="nav-link" aria-label="俯瞰Java服务端开发"><span class="icon iconfont icon-note"></span>俯瞰Java服务端开发<!----></a></li><li class="dropdown-item"><a href="/python/Python.html" class="nav-link" aria-label="Python基础知识"><span class="icon iconfont icon-python"></span>Python基础知识<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="应用"><span class="title"><span class="icon iconfont icon-app"></span>应用</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/apps/Applist.html" class="nav-link" aria-label="必备应用"><span class="icon iconfont icon-list"></span>必备应用<!----></a></li><li class="dropdown-item"><a href="/apps/AppNotes.html" class="nav-link" aria-label="应用笔记"><span class="icon iconfont icon-plugin"></span>应用笔记<!----></a></li><li class="dropdown-item"><a href="/apps/Chrome.html" class="nav-link" aria-label="Chrome 扩展"><span class="icon iconfont icon-chrome"></span>Chrome 扩展<!----></a></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>服务/系统</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/services/NAS" class="nav-link" aria-label="/services/NAS"><!---->/services/NAS<!----></a></li><li class="dropdown-subitem"><a href="/windows/faq" class="nav-link" aria-label="/windows/faq"><!---->/windows/faq<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="生活"><span class="title"><span class="icon iconfont icon-emmet"></span>生活</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/family/Diet.html" class="nav-link" aria-label="健康饮食"><span class="icon iconfont icon-enum"></span>健康饮食<!----></a></li><li class="dropdown-item"><a href="/family/Coupon.html" class="nav-link" aria-label="网购攻略"><span class="icon iconfont icon-free"></span>网购攻略<!----></a></li></ul></button></div></div></nav><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><div class="nav-item"><a class="repo-link" href="https://github.com/token01/token01.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/DailyRoutine.html" class="nav-link sidebar-link sidebar-page" aria-label="每日仪式"><span class="icon iconfont icon-check"></span>每日仪式<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Read.html" class="nav-link sidebar-link sidebar-page" aria-label="读书方法"><span class="icon iconfont icon-read"></span>读书方法<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><p class="sidebar-heading"><!----><span class="title">😅 技术周刊</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/letter/001.html" class="nav-link sidebar-link sidebar-page" aria-label="001 🐣 低代码、我的信息管理"><!---->001 🐣 低代码、我的信息管理<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/002.html" class="nav-link sidebar-link sidebar-page" aria-label="002 🕷 Web 3.0、关于好品味的商业模式"><!---->002 🕷 Web 3.0、关于好品味的商业模式<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/003.html" class="nav-link sidebar-link sidebar-page" aria-label="003 🐂 新一代 kubernetes、反脆弱"><!---->003 🐂 新一代 kubernetes、反脆弱<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/004.html" class="nav-link sidebar-link sidebar-page" aria-label="004 🧛‍♂ 备受程序员喜爱的暗黑主题、程序员的英语有多重要、Newsletter 资源分享"><!---->004 🧛‍♂ 备受程序员喜爱的暗黑主题、程序员的英语有多重要、Newsletter 资源分享<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/005.html" class="nav-link sidebar-link sidebar-page" aria-label="005 ⚙️ IFTTT 和 Zapier 使用对比、最好的效率系统、投入产出比最高的 3 件事"><!---->005 ⚙️ IFTTT 和 Zapier 使用对比、最好的效率系统、投入产出比最高的 3 件事<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/006.html" class="nav-link sidebar-link sidebar-page" aria-label="006 📒 与人保持联系的系统、用低代码应用设计产品原型、万能锤"><!---->006 📒 与人保持联系的系统、用低代码应用设计产品原型、万能锤<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/007.html" class="nav-link sidebar-link sidebar-page" aria-label="007 🍀 十年后重新使用 RSS 给我带来的巨变"><!---->007 🍀 十年后重新使用 RSS 给我带来的巨变<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/008.html" class="nav-link sidebar-link sidebar-page" aria-label="008 📚 Notion vs Obsidian、程序设计 vs 软件工程"><!---->008 📚 Notion vs Obsidian、程序设计 vs 软件工程<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/009.html" class="nav-link sidebar-link sidebar-page" aria-label="009 🌈 Newsletter Of Newsletters、海绵宝宝的智慧"><!---->009 🌈 Newsletter Of Newsletters、海绵宝宝的智慧<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/010.html" class="nav-link sidebar-link sidebar-page" aria-label="010 🚀 Hacking The Mind / 拆掉思维里的墙、放飞想象、打破规则"><!---->010 🚀 Hacking The Mind / 拆掉思维里的墙、放飞想象、打破规则<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/011.html" class="nav-link sidebar-link sidebar-page" aria-label="011 🖼 Browser = OS 、文章、工具、资源、文摘、言论"><!---->011 🖼 Browser = OS 、文章、工具、资源、文摘、言论<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/012.html" class="nav-link sidebar-link sidebar-page" aria-label="012 📸 Old But Good 、UNIX 艺术、互联网历史博物馆"><!---->012 📸 Old But Good 、UNIX 艺术、互联网历史博物馆<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/013.html" class="nav-link sidebar-link sidebar-page" aria-label="013 🔭 重新掌控自己的信息"><!---->013 🔭 重新掌控自己的信息<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/014.html" class="nav-link sidebar-link sidebar-page" aria-label="014 🚮 中国互联网的三个问题"><!---->014 🚮 中国互联网的三个问题<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/015.html" class="nav-link sidebar-link sidebar-page" aria-label="015 🍻 内卷时代的软件和自媒体"><!---->015 🍻 内卷时代的软件和自媒体<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/016_growup_01.html" class="nav-link sidebar-link sidebar-page" aria-label="016 🐒 野生架构师成长之路(1)——游戏与现实、乌龟与火箭"><!---->016 🐒 野生架构师成长之路(1)——游戏与现实、乌龟与火箭<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/017.html" class="nav-link sidebar-link sidebar-page" aria-label="017 🏅 成为职场优秀程序员的 5 个建议"><!---->017 🏅 成为职场优秀程序员的 5 个建议<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/018.html" class="nav-link sidebar-link sidebar-page" aria-label="018 🙊 Less Is More"><!---->018 🙊 Less Is More<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/letter/019.html" class="nav-link sidebar-link sidebar-page" aria-label="019 ✨ 从凯文·凯利的建议中找到对自己有用的那 10%"><!---->019 ✨ 从凯文·凯利的建议中找到对自己有用的那 10%<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><!----><span class="title">🚀 基础编程</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/code/" class="nav-link sidebar-link sidebar-page" aria-label="编程汇总（更新中）"><span class="icon iconfont icon-code"></span>编程汇总（更新中）<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/code/NAS.html" class="nav-link sidebar-link sidebar-page" aria-label="NAS"><span class="icon iconfont icon-process"></span>NAS<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/code/Huginn.html" class="nav-link sidebar-link sidebar-page" aria-label="Huginn"><span class="icon iconfont icon-customize"></span>Huginn<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/code/Javascript.html" class="nav-link sidebar-link sidebar-page" aria-label="JavaScript"><span class="icon iconfont icon-javascript"></span>JavaScript<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/code/TTRSS.html" class="nav-link sidebar-link sidebar-page" aria-label="Tiny Tiny RSS"><span class="icon iconfont icon-rss"></span>Tiny Tiny RSS<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/code/AutoHotkey.html" class="nav-link sidebar-link sidebar-page" aria-label="AutoHotkey"><span class="icon iconfont icon-linter"></span>AutoHotkey<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/code/Docker.html" class="nav-link sidebar-link sidebar-page" aria-label="Docker"><span class="icon iconfont icon-any"></span>Docker<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/code/Markdown.html" class="nav-link sidebar-link sidebar-page" aria-label="Markdown基础语法"><span class="icon iconfont icon-markdown"></span>Markdown基础语法<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/code/Electron.html" class="nav-link sidebar-link sidebar-page" aria-label="Electron"><span class="icon iconfont icon-layout"></span>Electron<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><!----><span class="title">🤳 JAVA语言</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/java/liquibase.html" class="nav-link sidebar-link sidebar-page" aria-label="5分钟搞定liquibase数据库版本控制"><span class="icon iconfont icon-note"></span>5分钟搞定liquibase数据库版本控制<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/api_error_handling.html" class="nav-link sidebar-link sidebar-page" aria-label="API错误处理的最佳实践"><span class="icon iconfont icon-note"></span>API错误处理的最佳实践<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/unit_test.html" class="nav-link sidebar-link sidebar-page" aria-label="DAO层测试"><span class="icon iconfont icon-note"></span>DAO层测试<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/Spring.html" class="nav-link sidebar-link sidebar-page" aria-label="Java_Spring基础框架知识"><span class="icon iconfont icon-note"></span>Java_Spring基础框架知识<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/part_one_of_java_engineer_path.html" class="nav-link sidebar-link sidebar-page" aria-label="JAVA从业余到专业"><span class="icon iconfont icon-note"></span>JAVA从业余到专业<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/JVM.html" class="nav-link sidebar-link sidebar-page" aria-label="JVM"><span class="icon iconfont icon-note"></span>JVM<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/JAVA%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B.html" class="nav-link sidebar-link sidebar-page" aria-label="Reactive_响应式编程"><span class="icon iconfont icon-note"></span>Reactive_响应式编程<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/spring_best_practice.html" class="nav-link sidebar-link sidebar-page" aria-label="Spring项目开发最佳实践"><span class="icon iconfont icon-note"></span>Spring项目开发最佳实践<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/java_base.html" class="nav-link sidebar-link sidebar-page" aria-label="俯瞰Java服务端开发"><span class="icon iconfont icon-note"></span>俯瞰Java服务端开发<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81.html" class="nav-link sidebar-link sidebar-page" aria-label="分布式锁"><span class="icon iconfont icon-note"></span>分布式锁<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7.html" class="nav-link sidebar-link sidebar-page" aria-label="分析工具"><span class="icon iconfont icon-note"></span>分析工具<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/JAVA%E5%9F%BA%E7%A1%80.html" class="nav-link sidebar-link sidebar-page" aria-label="基础知识积累"><span class="icon iconfont icon-note"></span>基础知识积累<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/JAVA%E5%AD%97%E8%8A%82%E7%A0%81.html" class="nav-link sidebar-link sidebar-page" aria-label="字节码_Bytecode"><span class="icon iconfont icon-note"></span>字节码_Bytecode<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/java_study_way.html" class="nav-link sidebar-link sidebar-page" aria-label="学习方法"><span class="icon iconfont icon-note"></span>学习方法<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/%E5%A6%82%E4%BD%95%E9%99%90%E6%B5%81.html" class="nav-link sidebar-link sidebar-page" aria-label="限流如何做"><span class="icon iconfont icon-note"></span>限流如何做<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading active"><!----><span class="title">😂 Python语言</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/python/Python.html" class="nav-link sidebar-link sidebar-page" aria-label="Python基础知识"><span class="icon iconfont icon-python"></span>Python基础知识<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/python/JupyterNotebook.html" class="nav-link sidebar-link sidebar-page" aria-label="Jupyter Notebook"><span class="icon iconfont icon-python"></span>Jupyter Notebook<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/python/pandas.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Pandas"><span class="icon iconfont icon-python"></span>Pandas<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/python/pandas.html#pandas" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Pandas"><!---->Pandas<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/python/pandas.html#官方" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="官方"><!---->官方<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/python/pandas.html#非官方" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="非官方"><!---->非官方<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/python/pandas.html#基础" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="基础"><!---->基础<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/python/pandas.html#时间处理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="时间处理"><!---->时间处理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/python/pandas.html#表格中的直方图-sparkline-图形" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="表格中的直方图，sparkline 图形"><!---->表格中的直方图，sparkline 图形<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/python/pySpark.html" class="nav-link sidebar-link sidebar-page" aria-label="Spark in Python"><span class="icon iconfont icon-python"></span>Spark in Python<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/python/WinHidden.html" class="nav-link sidebar-link sidebar-page" aria-label="window hidden"><span class="icon iconfont icon-python"></span>window hidden<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><!----><span class="title">👹 文本文档</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/notpad/APP%E7%AD%BE%E5%90%8D.html" class="nav-link sidebar-link sidebar-page" aria-label="APP Signing"><span class="icon iconfont icon-check"></span>APP Signing<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notpad/emoji.html" class="nav-link sidebar-link sidebar-page" aria-label="Emoji list"><span class="icon iconfont icon-check"></span>Emoji list<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notpad/%E4%BA%A7%E5%93%81%E8%AE%BE%E8%AE%A1.html" class="nav-link sidebar-link sidebar-page" aria-label="产品设计"><span class="icon iconfont icon-check"></span>产品设计<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notpad/%E5%85%AC%E5%BC%8F.html" class="nav-link sidebar-link sidebar-page" aria-label="公式"><span class="icon iconfont icon-check"></span>公式<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notpad/%E5%BC%80%E6%BA%90%E5%8D%8F%E8%AE%AE.html" class="nav-link sidebar-link sidebar-page" aria-label="开源协议"><span class="icon iconfont icon-check"></span>开源协议<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notpad/%E6%95%B0%E6%8D%AE%E6%BA%90.html" class="nav-link sidebar-link sidebar-page" aria-label="数据源"><span class="icon iconfont icon-check"></span>数据源<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notpad/%E6%97%A5%E5%B8%B8%E6%9D%82%E9%A1%B9.html" class="nav-link sidebar-link sidebar-page" aria-label="日常杂项"><span class="icon iconfont icon-check"></span>日常杂项<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notpad/opensource-awesome.html" class="nav-link sidebar-link sidebar-page" aria-label="精彩的开源项目"><span class="icon iconfont icon-check"></span>精彩的开源项目<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notpad/%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E5%B8%88.html" class="nav-link sidebar-link sidebar-page" aria-label="软件架构师设计"><span class="icon iconfont icon-check"></span>软件架构师设计<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notpad/Sales.html" class="nav-link sidebar-link sidebar-page" aria-label="销售"><span class="icon iconfont icon-check"></span>销售<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><!----><span class="title">🧰 软件应用</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/apps/Applist.html" class="nav-link sidebar-link sidebar-page" aria-label="必备应用"><span class="icon iconfont icon-list"></span>必备应用<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/apps/Chrome.html" class="nav-link sidebar-link sidebar-page" aria-label="Chrome 扩展"><span class="icon iconfont icon-chrome"></span>Chrome 扩展<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/apps/AppNotes.html" class="nav-link sidebar-link sidebar-page" aria-label="应用笔记"><span class="icon iconfont icon-plugin"></span>应用笔记<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><!----><span class="title">🏗️ 网站部署</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/deploy/Static.html" class="nav-link sidebar-link sidebar-page" aria-label="静态部署"><span class="icon iconfont icon-generic"></span>静态部署<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/deploy/VPS.html" class="nav-link sidebar-link sidebar-page" aria-label="服务器 VPS"><span class="icon iconfont icon-IO"></span>服务器 VPS<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/deploy/GitHub.html" class="nav-link sidebar-link sidebar-page" aria-label="GitHub"><span class="icon iconfont icon-github"></span>GitHub<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/deploy/Cloudflare.html" class="nav-link sidebar-link sidebar-page" aria-label="Cloudflare"><span class="icon iconfont icon-proxy"></span>Cloudflare<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/deploy/DNS.html" class="nav-link sidebar-link sidebar-page" aria-label="域名 DNS 托管"><span class="icon iconfont icon-sitemap"></span>域名 DNS 托管<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><!----><span class="title">🐋 生活记录</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/family/Diet.html" class="nav-link sidebar-link sidebar-page" aria-label="健康饮食"><span class="icon iconfont icon-enum"></span>健康饮食<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/family/Coupon.html" class="nav-link sidebar-link sidebar-page" aria-label="网购攻略"><span class="icon iconfont icon-free"></span>网购攻略<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/family/HomeAutomation.html" class="nav-link sidebar-link sidebar-page" aria-label="智能家居"><span class="icon iconfont icon-home"></span>智能家居<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading clickable"><span class="icon iconfont icon-blog"></span><a href="/blog.html" class="title">博客文章</a><!----></p><ul class="sidebar-links"><li><!--[--><a href="/_posts/2022-11-03-ffmpeg_screen_recording.html" class="nav-link sidebar-link sidebar-page" aria-label="3 分钟入门 FFmpeg，抛弃又贵又难用的录屏软件"><!---->3 分钟入门 FFmpeg，抛弃又贵又难用的录屏软件<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-11-16-Introduction-to-technology.html" class="nav-link sidebar-link sidebar-page" aria-label="浅谈技术-回顾"><!---->浅谈技术-回顾<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-09-05-stable_diffusion_ai_painting.html" class="nav-link sidebar-link sidebar-page" aria-label="零基础入门 Stable Diffusion - 无需显卡把 AI 绘画引擎搬进家用电脑"><!---->零基础入门 Stable Diffusion - 无需显卡把 AI 绘画引擎搬进家用电脑<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-08-22-learndata_blog_to_knowledge_management.html" class="nav-link sidebar-link sidebar-page" aria-label="抛弃 Notion 知识管理软件的尝试：把博客变为知识库"><!---->抛弃 Notion 知识管理软件的尝试：把博客变为知识库<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-06-07-blog_md_to_wordpress.html" class="nav-link sidebar-link sidebar-page" aria-label="集自动发布、本地管理于一身：WordPress 博客管理方案分享"><!---->集自动发布、本地管理于一身：WordPress 博客管理方案分享<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-05-22-surveillance_video_for_myself.html" class="nav-link sidebar-link sidebar-page" aria-label="疫情封控两个月后，我对自己开始 24 小时的自我监控录像"><!---->疫情封控两个月后，我对自己开始 24 小时的自我监控录像<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-04-21-uivision_rpa.html" class="nav-link sidebar-link sidebar-page" aria-label="不想学 Python，零基础也能用的自动化工具-UI.Vision RPA"><!---->不想学 Python，零基础也能用的自动化工具-UI.Vision RPA<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-04-20-survivorship_bias_in_shanghai_2022.html" class="nav-link sidebar-link sidebar-page" aria-label="上海没吃的？割裂的城市，我真的生活在上海吗？"><!---->上海没吃的？割裂的城市，我真的生活在上海吗？<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-03-21-winget_the_strongest_software_manager_for_windows.html" class="nav-link sidebar-link sidebar-page" aria-label="一键安装 99 个程序，Windows 最强软件管理器"><!---->一键安装 99 个程序，Windows 最强软件管理器<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-03-17-rss_persistent_link_collection.html" class="nav-link sidebar-link sidebar-page" aria-label="RSS 汇总篇：RSS 永久链接合集，拒绝 RSS 失效"><!---->RSS 汇总篇：RSS 永久链接合集，拒绝 RSS 失效<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-03-09-lenovo_black_card_member.html" class="nav-link sidebar-link sidebar-page" aria-label="联想黑金超核会员情报分享"><!---->联想黑金超核会员情报分享<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-02-19-microsoft_store_fixed.html" class="nav-link sidebar-link sidebar-page" aria-label="Windows 应用商店 (Microsoft store) 打不开？100% 解决方法 - 兼容 Win10、Win11"><!---->Windows 应用商店 (Microsoft store) 打不开？100% 解决方法 - 兼容 Win10、Win11<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-01-23-wechat_lucky_money_cover.html" class="nav-link sidebar-link sidebar-page" aria-label="想要独一无二的微信红包，你也可以自己做"><!---->想要独一无二的微信红包，你也可以自己做<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2021-10-23-nas_with_rsshub_and_huginn.html" class="nav-link sidebar-link sidebar-page" aria-label="RSS 完结篇：节省千元服务费，RSSHub、Huginn 转移 NAS"><!---->RSS 完结篇：节省千元服务费，RSSHub、Huginn 转移 NAS<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2021-05-31-principles_criticism_and_self-criticism.html" class="nav-link sidebar-link sidebar-page" aria-label="普通人的生活原则－批评与自我批评"><!---->普通人的生活原则－批评与自我批评<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2021-03-22-live_streaming.html" class="nav-link sidebar-link sidebar-page" aria-label="直播新手攻略：从小白入门到网红达人"><!---->直播新手攻略：从小白入门到网红达人<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2021-01-27-blog_jekyll_to_wordpress.html" class="nav-link sidebar-link sidebar-page" aria-label="Jekyll 博客迁移－从 Markdown 到 WordPress"><!---->Jekyll 博客迁移－从 Markdown 到 WordPress<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2021-01-02-keepass_the_real_lastpassword.html" class="nav-link sidebar-link sidebar-page" aria-label="抛弃 Lastpass，拥抱 KeePass-免费开源的绿色密码管理软件"><!---->抛弃 Lastpass，拥抱 KeePass-免费开源的绿色密码管理软件<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2020-11-27-rime_input.html" class="nav-link sidebar-link sidebar-page" aria-label="小狼毫 3 分钟入门及进阶指南"><!---->小狼毫 3 分钟入门及进阶指南<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2020-11-01-gym_equipment_throw_away.html" class="nav-link sidebar-link sidebar-page" aria-label="这些全网卖爆的“必备”品，我劝你别买……"><!---->这些全网卖爆的“必备”品，我劝你别买……<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2020-09-22-uefi_asus_board.html" class="nav-link sidebar-link sidebar-page" aria-label="「硬盘布局不受 UEFI 固件支持」－华硕主板解决方案"><!---->「硬盘布局不受 UEFI 固件支持」－华硕主板解决方案<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2020-10-25-dpc_watchdog_violation.html" class="nav-link sidebar-link sidebar-page" aria-label="真·DPC_WATCHDOG_VIOLATION 蓝屏解决方案"><!---->真·DPC_WATCHDOG_VIOLATION 蓝屏解决方案<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2020-09-13-wifi_speed_up.html" class="nav-link sidebar-link sidebar-page" aria-label="无线路由调整，加快 WIFI 速度"><!---->无线路由调整，加快 WIFI 速度<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2020-03-25-rsshub_on_vps.html" class="nav-link sidebar-link sidebar-page" aria-label="RSS 速成篇 2：RSSHub 自部署"><!---->RSS 速成篇 2：RSSHub 自部署<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2019-10-04-fake_aka_hospital_skin_care_products.html" class="nav-link sidebar-link sidebar-page" aria-label="这些「医院护肤品」你买了吗？"><!---->这些「医院护肤品」你买了吗？<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2019-08-26-scrcpy_screen_projection.html" class="nav-link sidebar-link sidebar-page" aria-label="scrcpy - 手机无线投屏到电脑"><!---->scrcpy - 手机无线投屏到电脑<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2019-04-01-rsshub_noob.html" class="nav-link sidebar-link sidebar-page" aria-label="RSS 速成篇：RSSHub 捡现成的轮子"><!---->RSS 速成篇：RSSHub 捡现成的轮子<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2019-03-31-openvpn_back_to_home.html" class="nav-link sidebar-link sidebar-page" aria-label="OpenVPN 随时随地回家的路"><!---->OpenVPN 随时随地回家的路<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-12-28-voice_input_try.html" class="nav-link sidebar-link sidebar-page" aria-label="等了十年，PC 端能用的语音输入方案来了"><!---->等了十年，PC 端能用的语音输入方案来了<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-10-07-huginn_scraping_any_website.html" class="nav-link sidebar-link sidebar-page" aria-label="RSS 进阶篇：Huginn - 真·为任意网页定制 RSS 源（PhantomJs 抓取）"><!---->RSS 进阶篇：Huginn - 真·为任意网页定制 RSS 源（PhantomJs 抓取）<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-06-19-iptv_direckly.html" class="nav-link sidebar-link sidebar-page" aria-label="客厅、书房、卧室，任意收看 IPTV 直播！（上海电信）"><!---->客厅、书房、卧室，任意收看 IPTV 直播！（上海电信）<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-06-10-koolproxy_https.html" class="nav-link sidebar-link sidebar-page" aria-label="koolproxy 无法下载 https 证书？"><!---->koolproxy 无法下载 https 证书？<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-06-08-baizhuo_gp1700.html" class="nav-link sidebar-link sidebar-page" aria-label="光猫改造 篇三：百卓 GP1700 进阶设置 - 端口映射"><!---->光猫改造 篇三：百卓 GP1700 进阶设置 - 端口映射<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-05-24-airtable_noob.html" class="nav-link sidebar-link sidebar-page" aria-label="真· Airtable 3 分钟菜鸟入门"><!---->真· Airtable 3 分钟菜鸟入门<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-05-15-aria2_a_new_download_tool.html" class="nav-link sidebar-link sidebar-page" aria-label="抛弃迅雷，Aria2 新手入门"><!---->抛弃迅雷，Aria2 新手入门<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-05-04-audition_cut_mp3.html" class="nav-link sidebar-link sidebar-page" aria-label="怎么用 Adobe Audition 快速剪切音频？"><!---->怎么用 Adobe Audition 快速剪切音频？<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-05-03-jekyll_blog_autodeploy.html" class="nav-link sidebar-link sidebar-page" aria-label="Jekyll 篇二：自动部署服务器博客"><!---->Jekyll 篇二：自动部署服务器博客<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-05-02-jekyll_blog_on_vps.html" class="nav-link sidebar-link sidebar-page" aria-label="Jekyll 扩展篇：服务器搭建 Jekyll 博客"><!---->Jekyll 扩展篇：服务器搭建 Jekyll 博客<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-05-01-jekyll_blog_on_github_pages.html" class="nav-link sidebar-link sidebar-page" aria-label="Jekyll 篇一：3 分钟搭建 Github Pages 博客"><!---->Jekyll 篇一：3 分钟搭建 Github Pages 博客<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-04-30-baota_deploy_vps.html" class="nav-link sidebar-link sidebar-page" aria-label="新手建站神器 - 宝塔面板"><!---->新手建站神器 - 宝塔面板<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-03-06-no_more_dinner.html" class="nav-link sidebar-link sidebar-page" aria-label="提早晚餐，饿死算逑"><!---->提早晚餐，饿死算逑<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-01-31-hire_a_robot.html" class="nav-link sidebar-link sidebar-page" aria-label="雇个机器人帮你干活"><!---->雇个机器人帮你干活<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-01-19-forget_the_cdn.html" class="nav-link sidebar-link sidebar-page" aria-label="小型网站管理员，快放弃 CDN！"><!---->小型网站管理员，快放弃 CDN！<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2017-10-18-light_cat_port_forwarding.html" class="nav-link sidebar-link sidebar-page" aria-label="光猫改造 篇二：光猫 + 路由器，实现端口映射"><!---->光猫改造 篇二：光猫 + 路由器，实现端口映射<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2017-10-18-light_cat_e8-c-epon_admin.html" class="nav-link sidebar-link sidebar-page" aria-label="光猫改造 篇一：超级管理员密码破解（E8-C-EPON RG201O-CA_V1A2)"><!---->光猫改造 篇一：超级管理员密码破解（E8-C-EPON RG201O-CA_V1A2)<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2017-09-03-smb_lan_sharing.html" class="nav-link sidebar-link sidebar-page" aria-label="加速 SMB 协议，让 PC 变身小型 NAS"><!---->加速 SMB 协议，让 PC 变身小型 NAS<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2017-09-02-forced_shutdown.html" class="nav-link sidebar-link sidebar-page" aria-label="电脑关机了，第二天一看确又开着的？让系统正常关机！"><!---->电脑关机了，第二天一看确又开着的？让系统正常关机！<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2017-07-29-onenote_2016_cannot_be_logged_in.html" class="nav-link sidebar-link sidebar-page" aria-label="OneNote 2016 无法登陆问题解决"><!---->OneNote 2016 无法登陆问题解决<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2017-07-28-office_2016_installer_error.html" class="nav-link sidebar-link sidebar-page" aria-label="office 2016 安装程序报错解决办法"><!---->office 2016 安装程序报错解决办法<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2017-04-18-wechat_multi_open.html" class="nav-link sidebar-link sidebar-page" aria-label="电脑上实现微信双开，无需网页版或第三方软件"><!---->电脑上实现微信双开，无需网页版或第三方软件<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-09-07-extreme_branding_thinking_with_mate50.html" class="nav-link sidebar-link sidebar-page" aria-label="「华为没电也能打电话」「iPhone 没电也能刷公交卡」，手机品牌是被绑架还是行业底线就是低？"><!---->「华为没电也能打电话」「iPhone 没电也能刷公交卡」，手机品牌是被绑架还是行业底线就是低？<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="icon iconfont icon-python"></span>Pandas</h1><div class="page-info"><!----><!----><span class="words-info" aria-label="字数🔠" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>约 5944 字</span><meta property="wordCount" content="5944"></span><span class="reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 20 分钟</span><meta property="timeRequired" content="PT20M"></span><span class="visitor-info" aria-label="访问量🔢" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon eye-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="eye icon"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 00-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z"></path></svg><span class="waline-pageview-count" data-path="/python/pandas.html">...</span></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/python/pandas.html#pandas" class="router-link-active router-link-exact-active toc-link level2">Pandas</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/python/pandas.html#官方" class="router-link-active router-link-exact-active toc-link level3">官方</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/python/pandas.html#非官方" class="router-link-active router-link-exact-active toc-link level3">非官方</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/python/pandas.html#基础" class="router-link-active router-link-exact-active toc-link level3">基础</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/python/pandas.html#时间处理" class="router-link-active router-link-exact-active toc-link level3">时间处理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/python/pandas.html#表格中的直方图-sparkline-图形" class="router-link-active router-link-exact-active toc-link level3">表格中的直方图，sparkline 图形</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h2 id="pandas" tabindex="-1"><a class="header-anchor" href="#pandas" aria-hidden="true">#</a> Pandas</h2><blockquote><p>Pandas 是一个强大的分析结构化数据的工具集，它的使用基础是 Numpy（提供高性能的矩阵运算），用于数据挖掘和数据分析，同时也提供数据清洗功能。</p></blockquote><h3 id="官方" tabindex="-1"><a class="header-anchor" href="#官方" aria-hidden="true">#</a> 官方</h3><ul><li><a href="https://pandas.pydata.org/docs/reference/index.html#api" target="_blank" rel="noopener noreferrer">官方文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/pandas-dev/pandas" target="_blank" rel="noopener noreferrer">源代码<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h3 id="非官方" tabindex="-1"><a class="header-anchor" href="#非官方" aria-hidden="true">#</a> 非官方</h3><ul><li><a href="https://www.gairuo.com/p/pandas-tutorial" target="_blank" rel="noopener noreferrer">Pandas 教程<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.gairuo.com/p/numpy-tutorial" target="_blank" rel="noopener noreferrer">numpy 教程<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.gairuo.com/p/regular-expression" target="_blank" rel="noopener noreferrer">正则表达式语法<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h3 id="基础" tabindex="-1"><a class="header-anchor" href="#基础" aria-hidden="true">#</a> 基础</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd  <span class="token comment"># 最新为 1.0.4 版本 (2020-05-29)</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token operator">%</span>matplotlib inline

<span class="token comment">#df：任意的 Pandas DataFrame 对象</span>
<span class="token comment">#s：任意的 Pandas Series 对象</span>
<span class="token comment">#注：有些属性方法 df 和 s 都可以使用</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="导入导出数据" tabindex="-1"><a class="header-anchor" href="#导入导出数据" aria-hidden="true">#</a> 导入导出数据</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># 从 CSV 文件导入数据</span>
pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;file.csv&#39;</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;列名&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;列名2&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 从限定分隔符的文本文件导入数据</span>
pd<span class="token punctuation">.</span>read_table<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment"># Excel 导入，指定 sheet 和表头</span>
pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">&#39;file.xlsx&#39;</span><span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">&#39; 表1&#39;</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment"># 从 SQL 表/库导入数据</span>
pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span>query<span class="token punctuation">,</span> connection_object<span class="token punctuation">)</span>
<span class="token comment"># 从 JSON 格式的字符串导入数据</span>
pd<span class="token punctuation">.</span>read_json<span class="token punctuation">(</span>json_string<span class="token punctuation">)</span>
<span class="token comment"># 解析 URL、字符串或者 HTML 文件，抽取其中的 tables 表格</span>
pd<span class="token punctuation">.</span>read_html<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token comment"># 从你的粘贴板获取内容，并传给 read_table()</span>
pd<span class="token punctuation">.</span>read_clipboard<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 从字典对象导入数据，Key 是列名，Value是数据</span>
pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">)</span>
<span class="token comment"># 导入字符串</span>
<span class="token keyword">from</span> io <span class="token keyword">import</span> StringIO
pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>StringIO<span class="token punctuation">(</span>web_data<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># 导出数据到CSV文件</span>
df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">&#39;filename.csv&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 导出数据到Excel文件</span>
df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string">&#39;filename.xlsx&#39;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment"># 导出数据到 SQL 表</span>
df<span class="token punctuation">.</span>to_sql<span class="token punctuation">(</span>table_name<span class="token punctuation">,</span> connection_object<span class="token punctuation">)</span>
<span class="token comment"># 以Json格式导出数据到文本文件</span>
df<span class="token punctuation">.</span>to_json<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
<span class="token comment"># 其他</span>
df<span class="token punctuation">.</span>to_html<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 显示 HTML 代码</span>
df<span class="token punctuation">.</span>to_markdown<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 显示 markdown 代码</span>
df<span class="token punctuation">.</span>to_string<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 显示格式化字符</span>
df<span class="token punctuation">.</span>to_latex<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment"># LaTeX tabular, longtable</span>
df<span class="token punctuation">.</span>to_dict<span class="token punctuation">(</span><span class="token string">&#39;split&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 字典, 格式 list/series/records/index</span>
df<span class="token punctuation">.</span>to_clipboard<span class="token punctuation">(</span>sep<span class="token operator">=</span><span class="token string">&#39;,&#39;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment"># 存入系统剪贴板</span>

<span class="token comment"># 将两个表格输出到一个excel文件里面,导出到多个 sheet</span>
writer<span class="token operator">=</span>pd<span class="token punctuation">.</span>ExcelWriter<span class="token punctuation">(</span><span class="token string">&#39;new.xlsx&#39;</span><span class="token punctuation">)</span>
df_1<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token string">&#39;第一个&#39;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
df_2<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token string">&#39;第二个&#39;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
writer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 必须运行writer.save()，不然不能输出到本地</span>

<span class="token comment"># 写法2</span>
<span class="token keyword">with</span> pd<span class="token punctuation">.</span>ExcelWriter<span class="token punctuation">(</span><span class="token string">&#39;new.xlsx&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> writer<span class="token punctuation">:</span>
    df1<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">&#39;第一个&#39;</span><span class="token punctuation">)</span>
    df2<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">&#39;第二个&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 用 xlsxwriter 导出支持合并单元格、颜色、图表等定制功能</span>
<span class="token comment"># https://xlsxwriter.readthedocs.io/working_with_pandas.html</span>
<span class="token comment"># pd.ExcelWriter(&#39;new.xlsx&#39;,engine=&#39;xlsxwriter&#39;)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="测试数据" tabindex="-1"><a class="header-anchor" href="#测试数据" aria-hidden="true">#</a> 测试数据</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># 创建20行5列的随机数组成的 DataFrame 对象</span>
pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 从可迭代对象 my_list 创建一个 Series 对象</span>
pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>my_list<span class="token punctuation">)</span>
<span class="token comment"># 增加一个日期索引</span>
df<span class="token punctuation">.</span>index <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">&#39;1900/1/30&#39;</span><span class="token punctuation">,</span> periods<span class="token operator">=</span>df<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 创建随机数据集</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>util<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>makeDataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 创建随机日期索引数据集</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>util<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>makePeriodFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>util<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>makeTimeDataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 创建随机混合类型数据集</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>util<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>makeMixedDataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="查看、检查、统计、属性" tabindex="-1"><a class="header-anchor" href="#查看、检查、统计、属性" aria-hidden="true">#</a> 查看、检查、统计、属性</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token comment"># 查看 DataFrame 对象的前n行</span>
df<span class="token punctuation">.</span>tail<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token comment"># 查看 DataFrame 对象的最后n行</span>
df<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token comment"># 查看 n 个样本，随机</span>
df<span class="token punctuation">.</span>shape <span class="token comment"># 查看行数和列数</span>
df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 查看索引、数据类型和内存信息</span>
df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 查看数值型列的汇总统计</span>
df<span class="token punctuation">.</span>dtypes <span class="token comment"># 查看各字段类型</span>
df<span class="token punctuation">.</span>axes <span class="token comment"># 显示数据行和列名</span>
df<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 返回所有列的均值</span>
df<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 返回所有行的均值，下同</span>
df<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 返回列与列之间的相关系数</span>
df<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 返回每一列中的非空值的个数</span>
df<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 返回每一列的最大值</span>
df<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 返回每一列的最小值</span>
df<span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 返回每一列的中位数</span>
df<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 返回每一列的标准差</span>
df<span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 方差</span>
s<span class="token punctuation">.</span>mode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 众数</span>
s<span class="token punctuation">.</span>prod<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 连乘</span>
s<span class="token punctuation">.</span>cumprod<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 累积连乘,累乘</span>
df<span class="token punctuation">.</span>cumsum<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># 累积连加,累加</span>
s<span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 去重数量，不同值的量</span>
df<span class="token punctuation">.</span>idxmax<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 每列最大的值的索引名</span>
df<span class="token punctuation">.</span>idxmin<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 最小</span>
df<span class="token punctuation">.</span>columns <span class="token comment"># 显示所有列名</span>
df<span class="token punctuation">.</span>team<span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 显示列中的不重复值</span>
<span class="token comment"># 查看 Series 对象的唯一值和计数, 计数占比: normalize=True</span>
s<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span>dropna<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token comment"># 查看 DataFrame 对象中每一列的唯一值和计数</span>
df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">.</span>value_counts<span class="token punctuation">)</span>
df<span class="token punctuation">.</span>duplicated<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 重复行</span>
df<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 删除重复行</span>
<span class="token comment"># set_option、reset_option、describe_option 设置显示要求</span>
pd<span class="token punctuation">.</span>get_option<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 设置行列最大显示数量，None 为不限制(jupyter notebok)</span>
pd<span class="token punctuation">.</span>options<span class="token punctuation">.</span>display<span class="token punctuation">.</span>max_rows <span class="token operator">=</span> <span class="token boolean">None</span>
pd<span class="token punctuation">.</span>options<span class="token punctuation">.</span>display<span class="token punctuation">.</span>max_columns <span class="token operator">=</span> <span class="token boolean">None</span>
pd<span class="token punctuation">.</span>options<span class="token punctuation">.</span>display<span class="token punctuation">.</span>max_colwidth <span class="token operator">=</span> <span class="token boolean">None</span>
<span class="token comment"># 恢复默认值</span>
pd<span class="token punctuation">.</span>options<span class="token punctuation">.</span>display<span class="token punctuation">.</span>max_rows <span class="token operator">=</span> <span class="token number">60</span>
pd<span class="token punctuation">.</span>options<span class="token punctuation">.</span>display<span class="token punctuation">.</span>max_columns <span class="token operator">=</span> <span class="token number">20</span>
pd<span class="token punctuation">.</span>options<span class="token punctuation">.</span>display<span class="token punctuation">.</span>max_colwidth <span class="token operator">=</span> <span class="token number">50</span>
df<span class="token punctuation">.</span>col<span class="token punctuation">.</span>argmin<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 最大值[最小值 .argmax()] 所在位置的自动索引</span>
df<span class="token punctuation">.</span>col<span class="token punctuation">.</span>idxmin<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 最大值[最小值 .idxmax()] 所在位置的定义索引</span>
<span class="token comment"># 累计统计</span>
ds<span class="token punctuation">.</span>cumsum<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 前边所有值之和</span>
ds<span class="token punctuation">.</span>cumprod<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 前边所有值之积</span>
ds<span class="token punctuation">.</span>cummax<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 前边所有值的最大值</span>
ds<span class="token punctuation">.</span>cummin<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 前边所有值的最小值</span>
<span class="token comment"># 窗口计算(滚动计算)</span>
ds<span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#依次计算相邻x个元素的和</span>
ds<span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#依次计算相邻x个元素的算术平均</span>
ds<span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#依次计算相邻x个元素的方差</span>
ds<span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#依次计算相邻x个元素的标准差</span>
ds<span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#依次计算相邻x个元素的最小值</span>
ds<span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#依次计算相邻x个元素的最大值</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="数据清理" tabindex="-1"><a class="header-anchor" href="#数据清理" aria-hidden="true">#</a> 数据清理</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;b&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;c&#39;</span><span class="token punctuation">]</span> <span class="token comment"># 重命名列名</span>
df<span class="token punctuation">.</span>columns <span class="token operator">=</span> df<span class="token punctuation">.</span>columns<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&#39; &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;_&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 列名空格换下划线</span>
df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 批量更改列名</span>
df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;old_name&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;new_name&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># 选择性更改列名</span>
df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">&#39;column_one&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 更改索引列</span>
df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 批量重命名索引</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">.</span>AAA <span class="token operator">&gt;=</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;BBB&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;CCC&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">555</span> <span class="token comment"># 替换数据</span>
df<span class="token punctuation">[</span><span class="token string">&#39;pf&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span>site_id<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">&#39;小程序&#39;</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">:</span><span class="token string">&#39;M 站&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># 将枚举换成名称</span>
pd<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 检查DataFrame对象中的空值，并返回一个 Boolean 数组</span>
pd<span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 检查DataFrame对象中的非空值，并返回一个 Boolean 数组</span>
df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 删除列</span>
df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># 删除行</span>
df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;colname&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;不详&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;110&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment"># 删除行</span>
<span class="token keyword">del</span> df<span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">]</span> <span class="token comment"># 删除列</span>
df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 删除所有包含空值的行</span>
df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 删除所有包含空值的列</span>
df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>thresh<span class="token operator">=</span>n<span class="token punctuation">)</span> <span class="token comment"># 删除所有小于 n 个非空值的行</span>
df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment"># 用x替换DataFrame对象中所有的空值</span>
df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;prov&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;未知&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># 指定列的空值替换为指定内容</span>
s<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token comment"># 将Series中的数据类型更改为 float 类型</span>
df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">&#39;datetime64[ns]&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 转化为时间格式</span>
s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;one&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 用 ‘one’ 代替所有等于 1 的值</span>
s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&#39;one&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;three&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 用&#39;one&#39;代替 1，用 &#39;three&#39; 代替 3</span>
df<span class="token punctuation">[</span><span class="token string">&#39;是否设置提现账号&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;状态&#39;</span><span class="token punctuation">]</span> <span class="token comment"># 复制一列</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment"># 列顺序反转</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment"># 行顺序反转, 下方为重新定义索引</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment"># 修改某个cell</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;colname&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&#39;value&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;colname&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;newvalue&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="数据处理、filter、sort" tabindex="-1"><a class="header-anchor" href="#数据处理、filter、sort" aria-hidden="true">#</a> 数据处理、Filter、Sort</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># 保留小数位，四舍六入五成双</span>
df<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># 全部</span>
df<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;C&#39;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># 指定列</span>
df<span class="token punctuation">[</span><span class="token string">&#39;Name&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span>Name <span class="token comment"># 取列名的两个方法</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>index <span class="token operator">==</span> <span class="token string">&#39;Jude&#39;</span><span class="token punctuation">]</span> <span class="token comment"># 索引列的查询要用 .index</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0.5</span><span class="token punctuation">]</span> <span class="token comment"># 选择col列的值大于0.5的行</span>
<span class="token comment"># 多条件查询</span>
df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;team&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&#39;A&#39;</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>
   <span class="token punctuation">(</span> df<span class="token punctuation">[</span><span class="token string">&#39;Q1&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">80</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>
   df<span class="token punctuation">.</span>utype<span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;老客&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;老访客&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment"># 筛选为空的内容</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>order<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment"># 类似 SQL where in</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>team<span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>team<span class="token operator">==</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">.</span>Q1 <span class="token operator">==</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
df<span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;team&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&#39;A&#39;</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span> df<span class="token punctuation">[</span><span class="token string">&#39;Q1&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># 非，或</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">&#39;张&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># 包含字符</span>
df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>col1<span class="token punctuation">)</span> <span class="token comment"># 按照列col1排序数据，默认升序排列</span>
df<span class="token punctuation">.</span>col1<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 同上, -&gt; s</span>
df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>col2<span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment"># 按照列 col1 降序排列数据</span>
<span class="token comment"># 先按列col1升序排列，后按col2降序排列数据</span>
df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">[</span>col1<span class="token punctuation">,</span>col2<span class="token punctuation">]</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token punctuation">[</span><span class="token boolean">True</span><span class="token punctuation">,</span><span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>df<span class="token punctuation">,</span> prefix<span class="token operator">=</span><span class="token string">&#39;t_&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 将枚举的那些列带枚举转到列上</span>
s<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 多索引处理</span>
dd<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;utype&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;site_id&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;p_day&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
dd<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># 按索引排序</span>
dd<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">&#39;新访客&#39;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;2019-06-22&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">.</span>barh<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># loc 中按顺序指定索引内容</span>
<span class="token comment"># 前100行, 不能指定行，如：df[100]</span>
df<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span>
<span class="token comment"># 只取指定行</span>
df1 <span class="token operator">=</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;设计师ID&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;姓名&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token comment"># 将ages平分成5个区间并指定 labels</span>
ages <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">58</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">89</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>ages<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">u&quot;婴儿&quot;</span><span class="token punctuation">,</span><span class="token string">u&quot;青年&quot;</span><span class="token punctuation">,</span><span class="token string">u&quot;中年&quot;</span><span class="token punctuation">,</span><span class="token string">u&quot;壮年&quot;</span><span class="token punctuation">,</span><span class="token string">u&quot;老年&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

daily_index<span class="token punctuation">.</span>difference<span class="token punctuation">(</span>df_work_day<span class="token punctuation">.</span>index<span class="token punctuation">)</span> <span class="token comment"># 取出差别</span>
<span class="token comment"># 格式化</span>
df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>name <span class="token comment"># 索引的名称 str</span>
df<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>values<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>总人口<span class="token punctuation">.</span>values<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">)</span> <span class="token comment"># 对 DataFrame 中的每一列应用函数 np.mean</span>
data<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 对 DataFrame 中的每一行应用函数 np.max</span>
df<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;three&#39;</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> allow_duplicates<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment"># 插入列 (位置、列名、[值])</span>
df<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">&#39;class&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 删除列</span>
<span class="token comment"># 增加一行</span>
df<span class="token punctuation">.</span>append<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;one&#39;</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span>
                        <span class="token string">&#39;two&#39;</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span>
                        <span class="token string">&#39;three&#39;</span><span class="token punctuation">:</span> <span class="token number">4.4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                       index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;f&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          sort<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment"># 指定新列</span>
iris<span class="token punctuation">.</span>assign<span class="token punctuation">(</span>sepal_ratio<span class="token operator">=</span>iris<span class="token punctuation">[</span><span class="token string">&#39;SepalWidth&#39;</span><span class="token punctuation">]</span> <span class="token operator">/</span> iris<span class="token punctuation">[</span><span class="token string">&#39;SepalLength&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>assign<span class="token punctuation">(</span>rate<span class="token operator">=</span><span class="token keyword">lambda</span> df<span class="token punctuation">:</span> df<span class="token punctuation">.</span>orders<span class="token operator">/</span>df<span class="token punctuation">.</span>uv<span class="token punctuation">)</span>
<span class="token comment"># shift 函数是对数据进行平移动的操作</span>
df<span class="token punctuation">[</span><span class="token string">&#39;增幅&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;国内生产总值&#39;</span><span class="token punctuation">]</span> <span class="token operator">-</span> df<span class="token punctuation">[</span><span class="token string">&#39;国内生产总值&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>tshift<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 时间移动，按周期</span>
<span class="token comment"># 和上相同，diff 函数是用来将数据进行移动之后与原数据差</span>
<span class="token comment"># 异数据，等于 df.shift()-df</span>
df<span class="token punctuation">[</span><span class="token string">&#39;增幅&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;国内生产总值&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>diff<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># 留存数据，因为最大一般为数据池</span>
df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token operator">/</span>x<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># 取 best 列中值为列名的值写到 name 行上</span>
df<span class="token punctuation">[</span><span class="token string">&#39;value&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span>lookup<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">&#39;best&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

s<span class="token punctuation">.</span>where<span class="token punctuation">(</span>s <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment"># 满足条件下数据替换（10，空为 NaN）</span>
s<span class="token punctuation">.</span>mask<span class="token punctuation">(</span>s <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># 留下满足条件的，其他的默认为 NaN</span>
<span class="token comment"># 所有值加 1 (加减乘除等)</span>
df <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">/</span> df<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># 管道方法，链式调用函数，f(df)=df.pipe(f)</span>
<span class="token keyword">def</span> <span class="token function">gb</span><span class="token punctuation">(</span>df<span class="token punctuation">,</span> by<span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> df<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    result <span class="token operator">=</span> result<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result
<span class="token comment"># 调用</span>
df<span class="token punctuation">.</span>pipe<span class="token punctuation">(</span>gb<span class="token punctuation">,</span> by<span class="token operator">=</span><span class="token string">&#39;team&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 窗口计算 &#39;2s&#39; 为两秒</span>
df<span class="token punctuation">.</span>rolling<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 在窗口结果基础上的窗口计算</span>
df<span class="token punctuation">.</span>expanding<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 超出（大于、小于）的值替换成对应值</span>
df<span class="token punctuation">.</span>clip<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>
<span class="token comment"># AB 两列想加增加 C 列</span>
df<span class="token punctuation">[</span><span class="token string">&#39;C&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">&#39;A+B&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 和上相同效果</span>
df<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">&#39;C = A + B&#39;</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment"># 数列的变化百分比</span>
s<span class="token punctuation">.</span>pct_change<span class="token punctuation">(</span>periods<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># 分位数, 可实现时间的中间点</span>
df<span class="token punctuation">.</span>quantile<span class="token punctuation">(</span><span class="token number">.5</span><span class="token punctuation">)</span>
<span class="token comment"># 排名 average, min,max,first，dense, 默认 average</span>
s<span class="token punctuation">.</span>rank<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 数据爆炸，将本列的类列表数据和其他列的数据展开铺开</span>
df<span class="token punctuation">.</span>explode<span class="token punctuation">(</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 枚举更新</span>
status <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token string">&#39;未执行&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token string">&#39;执行中&#39;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token string">&#39;执行完毕&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span><span class="token string">&#39;执行异常&#39;</span><span class="token punctuation">}</span>
df<span class="token punctuation">[</span><span class="token string">&#39;taskStatus&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;taskStatus&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span>get<span class="token punctuation">)</span>
df<span class="token punctuation">.</span>assign<span class="token punctuation">(</span>金额<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># 新增字段</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&#39;bar&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;two&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;A&#39;</span><span class="token punctuation">]</span> <span class="token comment"># 多索引查询</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;i0 == &quot;b&quot; &amp; i1 == &quot;b&quot;&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 多索引查询方法 2</span>
<span class="token comment"># 取多索引中指定级别的所有不重复值</span>
df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>get_level_values<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 去掉为零小数，12.00 -&gt; 12</span>
df<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">&#39;str&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>applymap<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&#39;.00&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 插入数据，在第三列加入「两倍」列</span>
df<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&#39;两倍&#39;</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">&#39;值&#39;</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># 枚举转换</span>
df<span class="token punctuation">[</span><span class="token string">&#39;gender&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span>gender<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;male&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;female&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;女&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment"># 增加本行之和列</span>
df<span class="token punctuation">[</span><span class="token string">&#39;Col_sum&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># 对指定行进行加和</span>
col_list<span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment"># 取请假范围日期</span>
df<span class="token punctuation">[</span><span class="token string">&#39;总天数&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span>col_list<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 计算总请假天数</span>
<span class="token comment"># 对列求和，汇总</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">&#39;col_sum&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 按指定的列表顺序显示</span>
df<span class="token punctuation">.</span>reindex<span class="token punctuation">(</span>order_list<span class="token punctuation">)</span>
<span class="token comment"># 按指定的多列排序</span>
df<span class="token punctuation">.</span>reindex<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;col_1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;col_5&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token string">&quot;columns&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># 补齐空值</span>
a <span class="token operator">=</span> a<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">&#39;bfill&#39;</span><span class="token punctuation">)</span>
<span class="token comment">#method : {‘backfill&#39;, ‘bfill&#39;, ‘pad&#39;, ‘ffill&#39;, None}, default None</span>
<span class="token comment">#pad / ffill: 向下自动填充</span>
<span class="token comment">#backfill / bfill: 向上自动填充</span>
<span class="token comment"># 时间范围</span>
s_date <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">&#39;2021-06-29&#39;</span><span class="token punctuation">)</span><span class="token comment">#datetime.datetime.strptime(&#39;20210629&#39;, &#39;%Y%m%d&#39;).date()</span>
e_date <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">&#39;2021-07-29&#39;</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">&#39;DATA_DATE_TIME&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;DATA_DATE&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">&#39;%Y%m%d&#39;</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;DATA_DATE_TIME&#39;</span><span class="token punctuation">]</span><span class="token operator">&gt;=</span>s_date<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;DATA_DATE_TIME&#39;</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span>e_date<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># 查询具体重复的数据</span>
unique1 <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;ORDER_ID&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span>
unique2 <span class="token operator">=</span> unique1<span class="token punctuation">[</span>unique1<span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
unique3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>unique2<span class="token punctuation">,</span>df<span class="token punctuation">,</span>on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;ORDER_ID&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
unique3

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="数据选取" tabindex="-1"><a class="header-anchor" href="#数据选取" aria-hidden="true">#</a> 数据选取</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">[</span><span class="token punctuation">[</span>col1<span class="token punctuation">,</span> col2<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># 以DataFrame形式返回多列</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;team&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&#39;B&#39;</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># 按条件查询，只显示name 列</span>
s<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># 按位置选取数据</span>
s<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">&#39;index_one&#39;</span><span class="token punctuation">]</span> <span class="token comment"># 按索引选取数据</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">]</span> <span class="token comment">#  A到 B 字段的第一行</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">2018</span><span class="token punctuation">:</span><span class="token number">1990</span><span class="token punctuation">,</span> <span class="token string">&#39;第一产业增加值&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;第三产业增加值&#39;</span><span class="token punctuation">]</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># d.loc[位置切片, 字段]</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment"># 返回第一行, iloc 只能是数字</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># 返回第一列的第一个元素</span>
dc<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;site_id &gt; 8 and utype==&quot;老客&quot;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 可以 and or / &amp; |</span>
 <span class="token comment"># 迭代器及使用</span>
<span class="token keyword">for</span> idx<span class="token punctuation">,</span>row <span class="token keyword">in</span> df<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> row<span class="token punctuation">[</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">]</span>
<span class="token comment"># 迭代器对每个元素进行处理</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token string">&#39;链接&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&#39;http://www.gairuo.com/p/</span><span class="token interpolation"><span class="token punctuation">{</span>slug<span class="token punctuation">}</span></span><span class="token string">.html&#39;</span></span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> df<span class="token punctuation">.</span>Name<span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment"># 迭代一个列</span>
<span class="token comment"># 按列迭代，[列名, 列中的数据序列 S（索引名 值)]</span>
<span class="token keyword">for</span> label<span class="token punctuation">,</span> content <span class="token keyword">in</span> df<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span>label<span class="token punctuation">,</span> content<span class="token punctuation">)</span>
<span class="token comment"># 按行迭代，迭代出整行包括索引的类似列表的内容，可row[2]取</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> df<span class="token punctuation">.</span>itertuples<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
df<span class="token punctuation">.</span>at<span class="token punctuation">[</span><span class="token number">2018</span><span class="token punctuation">,</span> <span class="token string">&#39;总人口&#39;</span><span class="token punctuation">]</span> <span class="token comment"># 按行列索引名取一个指定的单个元素</span>
df<span class="token punctuation">.</span>iat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token comment"># 索引和列的编号取单个元素</span>
s<span class="token punctuation">.</span>nlargest<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>nsmallest<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># 最大和最小的前几个值</span>
df<span class="token punctuation">.</span>nlargest<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;population&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;GDP&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>take<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 指定多个行列位置的内容</span>
<span class="token comment"># 按行列截取掉部分内容，支持日期索引标签</span>
ds<span class="token punctuation">.</span>truncate<span class="token punctuation">(</span>before<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> after<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token comment"># 将 dataframe 转成 series</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">&#39;%&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 百分数转数字</span>
df<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># 取消索引</span>

df<span class="token punctuation">.</span>eq<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 等于相等 ==</span>
df<span class="token punctuation">.</span>ne<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 不等于 !=</span>
df<span class="token punctuation">.</span>le<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 小于等于 &gt;=</span>
df<span class="token punctuation">.</span>lt<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 小于 &lt;</span>
df<span class="token punctuation">.</span>ge<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 大于等于 &gt;=</span>
df<span class="token punctuation">.</span>gt<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 大于 &gt;</span>
<span class="token comment"># 都支持  axis{0 or ‘index’, 1 or ‘columns’}, default ‘columns’</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>Q1<span class="token punctuation">.</span>ne<span class="token punctuation">(</span><span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># Q1 不等于8</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">.</span>Q1<span class="token punctuation">.</span>gt<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> df<span class="token punctuation">.</span>Q2<span class="token punctuation">.</span>lt<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># and 关系 Q1&gt;90 Q2&lt;90</span>

df<span class="token punctuation">[</span><span class="token keyword">lambda</span> df<span class="token punctuation">:</span> df<span class="token punctuation">[</span><span class="token string">&#39;Q1&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">]</span> <span class="token comment"># Q1为8的</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token keyword">lambda</span> df<span class="token punctuation">:</span> df<span class="token punctuation">.</span>Q1 <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">&#39;Q1&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;Q2&#39;</span><span class="token punctuation">]</span> <span class="token comment"># Q1为8的, 显示 Q1 Q2</span>

df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;Q1 &gt; Q2 &gt; 90&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 直接写类型 sql where 语句</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;Q1 + Q2 &gt; 180&#39;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;Q1 == Q2&#39;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;(Q1&lt;50) &amp; (Q2&gt;40) and (Q3&gt;90)&#39;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;Q1 &gt; Q2 &gt; Q3 &gt; Q4&#39;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;team != &quot;C&quot;&#39;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;team not in (&quot;E&quot;,&quot;A&quot;,&quot;B&quot;)&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 对于名称中带有空格的列，可以使用反引号引起来</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;B == `team name`&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># 支持传入变量，如：大于平均分40分的</span>
a <span class="token operator">=</span> df<span class="token punctuation">.</span>Q1<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;Q1 &gt; @a+40&#39;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;Q1 &gt; `Q2`+@a&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># df.eval() 用法与 df.query 类似</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">&quot;Q1 &gt; 90 &gt; Q3 &gt; 10&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">&quot;Q1 &gt; `Q2`+@a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># 分组取前3</span>
df_ask_org<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;CLASS&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token punctuation">.</span>nlargest<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">&#39;述求量&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="数据处理、分组、透视" tabindex="-1"><a class="header-anchor" href="#数据处理、分组、透视" aria-hidden="true">#</a> 数据处理、分组、透视</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span>col1<span class="token punctuation">,</span>col2<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 返回一个按多列进行分组的Groupby对象</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>col1<span class="token punctuation">)</span><span class="token punctuation">[</span>col2<span class="token punctuation">]</span> <span class="token comment"># 返回按列col1进行分组后，列col2的均值</span>
<span class="token comment"># 创建一个按列col1进行分组，并计算col2和col3的最大值的数据透视表</span>
df<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>index<span class="token operator">=</span>col1<span class="token punctuation">,</span>
               values<span class="token operator">=</span><span class="token punctuation">[</span>col2<span class="token punctuation">,</span>col3<span class="token punctuation">]</span><span class="token punctuation">,</span>
               aggfunc<span class="token operator">=</span><span class="token builtin">max</span><span class="token punctuation">,</span>
               as_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token comment"># 同上</span>
df<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;site_id&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;utype&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;uv_all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;regist_num&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               aggfunc<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;max&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;mean&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>col1<span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">)</span> <span class="token comment"># 返回按列col1分组的所有列的均值</span>
<span class="token comment"># 按列将其他列转行</span>
pd<span class="token punctuation">.</span>melt<span class="token punctuation">(</span>df<span class="token punctuation">,</span> id_vars<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;day&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> var_name<span class="token operator">=</span><span class="token string">&#39;city&#39;</span><span class="token punctuation">,</span> value_name<span class="token operator">=</span><span class="token string">&#39;temperature&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 交叉表是用于统计分组频率的特殊透视表</span>
pd<span class="token punctuation">.</span>crosstab<span class="token punctuation">(</span>df<span class="token punctuation">.</span>Nationality<span class="token punctuation">,</span>df<span class="token punctuation">.</span>Handedness<span class="token punctuation">)</span>
<span class="token comment"># groupby 后排序，分组 agg 内的元素取固定个数</span>
<span class="token punctuation">(</span>
    df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>p_day <span class="token operator">&gt;=</span> <span class="token string">&#39;20190101&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;p_day&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;uv&#39;</span><span class="token punctuation">:</span><span class="token builtin">sum</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;p_day&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;uv&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>level<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment"># 每天取5个页面</span>
    <span class="token punctuation">.</span>unstack<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment"># 合并查询经第一个看（max, min, last, size:数量）</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;结算类型&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 合并明细并分组统计加总（&#39;max&#39;, `mean`, `median`,</span>
<span class="token comment"># `prod`, `sum`, `std`,`var`, &#39;nunique&#39;）,&#39;nunique&#39;为去重的列表</span>
df1 <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">&#39;设计师ID&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;结算金额&#39;</span><span class="token punctuation">:</span><span class="token builtin">sum</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span>df<span class="token punctuation">.</span>pf<span class="token punctuation">)</span><span class="token punctuation">.</span>ip<span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># groupby distinct, 分组+去重数</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span>df<span class="token punctuation">.</span>pf<span class="token punctuation">)</span><span class="token punctuation">.</span>ip<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># groupby 分组+去重的值及数量</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;sum&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;median&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;count&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

se_level1<span class="token punctuation">[</span><span class="token string">&#39;level_0&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x <span class="token punctuation">:</span> <span class="token string">&#39;{:0&gt;2d}&#39;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
data<span class="token punctuation">[</span><span class="token string">&#39;huanbi_01&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">&#39;mony&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> data<span class="token punctuation">[</span><span class="token string">&#39;mony&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>data<span class="token punctuation">[</span><span class="token string">&#39;mony&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&#39;.2%&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># {:.2f} 保留小数点后两位</span>
<span class="token comment"># {:+.2f} 带符号保留小数点后两位</span>
<span class="token comment"># {:+.2f} 带符号保留小数点后两位</span>
<span class="token comment"># {:.0f} 不带小数</span>
<span class="token comment"># {:0&gt;2d} 数字补零 (填充左边, 宽度为2)</span>
<span class="token comment"># {:x&lt;4d} 数字补x (填充右边, 宽度为4)</span>
<span class="token comment"># {:x&lt;4d} 数字补x (填充右边, 宽度为4)</span>
<span class="token comment"># {:,} 以逗号分隔的数字格式</span>
<span class="token comment"># {:.2%} 百分比格式</span>
<span class="token comment"># {:.2e} 指数记法</span>
<span class="token comment"># {:&gt;10d} 右对齐 (默认, 宽度为10)</span>
<span class="token comment"># {:&lt;10d} 左对齐 (宽度为10)</span>
<span class="token comment"># {:^10d} 中间对齐 (宽度为10)</span>

<span class="token comment"># 占比</span>
r15<span class="token punctuation">[</span><span class="token string">&#39;proportion&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> r15<span class="token punctuation">[</span><span class="token string">&#39;count&#39;</span><span class="token punctuation">]</span><span class="token operator">/</span>r15<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;service_provider&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;trip_type&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;count&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token string">&#39;sum&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># 合并结果为一列</span>
r1_3 <span class="token operator">=</span> df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&quot;APPLICANT_SEX_CN != &#39;未知&#39;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token string">&quot;CASE_TYPE_CN&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;APPLICANT_SEX_CN&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>
        <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> gensexrate<span class="token punctuation">(</span>x<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_frame<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#.apply(lambda x: &quot;:&quot;.join(str(a) for a in x.value_counts().values.tolist()))</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="数据合并" tabindex="-1"><a class="header-anchor" href="#数据合并" aria-hidden="true">#</a> 数据合并</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># 合并透视表和分组表</span>
table4 <span class="token operator">=</span> table1<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
table3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;一级分类&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;二级分类&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;uuid&quot;</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
table2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;一级分类&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;uuid&quot;</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
table1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>df<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;一级分类&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;二级分类&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;三级分类&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fill_value<span class="token operator">=</span><span class="token string">&quot;无&quot;</span><span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;uuid&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> aggfunc<span class="token operator">=</span><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
_merge <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>table2<span class="token punctuation">,</span> table4<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;一级分类&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
_merge<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;一级分类&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;一级分类_count&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;二级分类&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;三级分类&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;三级分类_count&#39;</span><span class="token punctuation">]</span>
merge <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>_merge<span class="token punctuation">,</span> table3<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;一级分类&#39;</span><span class="token punctuation">,</span><span class="token string">&quot;二级分类&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
merge <span class="token operator">=</span> merge<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;工单编号&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;二级分类_count&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
merge <span class="token operator">=</span> merge<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&#39;一级分类&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;一级分类_count&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;二级分类&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;二级分类_count&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;三级分类&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;三级分类_count&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
merge <span class="token operator">=</span> merge<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;一级分类_count&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;二级分类_count&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;三级分类_count&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># 合并拼接行</span>
<span class="token comment"># 将df2中的行添加到df1的尾部</span>
df1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>df2<span class="token punctuation">)</span>
<span class="token comment"># 指定列合并成一个新表新列</span>
ndf <span class="token operator">=</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;提名1&#39;</span><span class="token punctuation">]</span>
       <span class="token punctuation">.</span>append<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;提名2&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span>append<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;提名3&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ndf <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>ndf<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;姓名&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 将df2中的列添加到df1的尾部</span>
df<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># 合并文件的各行</span>
df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;111.csv&#39;</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">&#39;\t&#39;</span><span class="token punctuation">)</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;222.csv&#39;</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">&#39;\t&#39;</span><span class="token punctuation">)</span>
excel_list <span class="token operator">=</span> <span class="token punctuation">[</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">]</span>
<span class="token comment"># result = pd.concat(excel_list).fillna(&#39;&#39;)[:].astype(&#39;str&#39;)</span>
result <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span>excel_list<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
result<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string">&#39;333.xlsx&#39;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># 合并指定目录下所有的 excel (csv) 文件</span>
<span class="token keyword">import</span> glob
files <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">&quot;data/cs/*.xls&quot;</span><span class="token punctuation">)</span>
dflist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> files<span class="token punctuation">:</span>
    dflist<span class="token punctuation">.</span>append<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>i<span class="token punctuation">,</span> usecols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;ID&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;时间&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;名称&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span>dflist<span class="token punctuation">)</span>

<span class="token comment"># 合并增加列</span>
<span class="token comment"># 对df1的列和df2的列执行SQL形式的join</span>
df1<span class="token punctuation">.</span>join<span class="token punctuation">(</span>df2<span class="token punctuation">,</span>on<span class="token operator">=</span>col1<span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">&#39;inner&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 用 key 合并两个表</span>
df_all <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df_sku<span class="token punctuation">,</span> df_spu<span class="token punctuation">,</span>
                  how<span class="token operator">=</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">,</span>
                  left_on<span class="token operator">=</span>df_sku<span class="token punctuation">[</span><span class="token string">&#39;product_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  right_on<span class="token operator">=</span>df_spu<span class="token punctuation">[</span><span class="token string">&#39;p.product_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 返回多列</span>
<span class="token keyword">def</span> <span class="token function">formatrow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>
    a <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">&quot;cnt&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    b <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">&quot;cnt&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> row<span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> a<span class="token punctuation">,</span> b
df_tmp<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;fomat1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;format2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_tmp<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>formatrow<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> result_type<span class="token operator">=</span><span class="token string">&quot;expand&quot;</span><span class="token punctuation">)</span>
df_tmp<span class="token punctuation">[</span><span class="token string">&quot;fomat1-1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df_tmp<span class="token punctuation">[</span><span class="token string">&quot;format2-2&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token operator">*</span>df_tmp<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>formatrow<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">age_map</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> x<span class="token operator">+</span><span class="token number">1</span>
data<span class="token punctuation">[</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&#39;birth_year&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>age_map<span class="token punctuation">)</span>

pd<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
df<span class="token punctuation">.</span>isna<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="时间处理" tabindex="-1"><a class="header-anchor" href="#时间处理" aria-hidden="true">#</a> 时间处理</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># 时间索引</span>
df<span class="token punctuation">.</span>index <span class="token operator">=</span> pd<span class="token punctuation">.</span>DatetimeIndex<span class="token punctuation">(</span>df<span class="token punctuation">.</span>index<span class="token punctuation">)</span>
<span class="token comment"># 时间只保留日期</span>
df<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;time&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>date
<span class="token comment"># 将指定字段格式化为时间类型</span>
df<span class="token punctuation">[</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;时间&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 转化为北京时间</span>
df<span class="token punctuation">[</span><span class="token string">&#39;time&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;time&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>tz_convert<span class="token punctuation">(</span><span class="token string">&#39;Asia/Shanghai&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 转为指定格式，可能会失去秒以后的精度</span>
df<span class="token punctuation">[</span><span class="token string">&#39;time&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;time&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">&quot;%Y-%m-%d %H:%M:%S&quot;</span><span class="token punctuation">)</span>
dc<span class="token punctuation">.</span>index <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>dc<span class="token punctuation">.</span>index<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">&#39;%Y%m%d&#39;</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">&#39;ignore&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 时间，参与运算</span>
pd<span class="token punctuation">.</span>DateOffset<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># 当前时间</span>
pd<span class="token punctuation">.</span>Timestamp<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">&#39;today&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 判断时间是否当天</span>
pd<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>year <span class="token operator">==</span> df<span class="token punctuation">.</span>start_work<span class="token punctuation">.</span>dt<span class="token punctuation">.</span>year
df<span class="token punctuation">.</span>time<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">&#39;datetime64[ns]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>date <span class="token operator">==</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">&#39;today&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 定义个天数</span>
<span class="token keyword">import</span> datetime
days <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span>x<span class="token punctuation">)</span>
days<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># 同上，直接用 pd 包装的</span>
pd<span class="token punctuation">.</span>Timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># unix 时间戳</span>
pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>ted<span class="token punctuation">.</span>film_date<span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">&#39;ms&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 按月（YMDHminS）采集合计数据</span>
df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>resample<span class="token punctuation">(</span><span class="token string">&#39;M&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;quantity&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;ext price&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>resample<span class="token punctuation">(</span><span class="token string">&quot;M&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 按天汇总，index 是 datetime 时间类型</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span>df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>date<span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;uu&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;count&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment"># 按周汇总</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span>df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>weekday<span class="token punctuation">)</span><span class="token punctuation">.</span>uu<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 按月进行汇总</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">,</span> pd<span class="token punctuation">.</span>Grouper<span class="token punctuation">(</span>key<span class="token operator">=</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">&#39;M&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;ext price&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 按月进行汇总</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>Grouper<span class="token punctuation">(</span>key<span class="token operator">=</span><span class="token string">&#39;day&#39;</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">&#39;1M&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 按照年度，且截止到12月最后一天统计 ext price 的 sum 值</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">,</span> pd<span class="token punctuation">.</span>Grouper<span class="token punctuation">(</span>key<span class="token operator">=</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">&#39;A-DEC&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;ext price&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 按月的平均重新采样</span>
df<span class="token punctuation">[</span><span class="token string">&#39;Close&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>resample<span class="token punctuation">(</span><span class="token string">&#39;M&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases</span>
<span class="token comment"># 取时间范围，并取工作日</span>
rng <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span>start<span class="token operator">=</span><span class="token string">&quot;6/1/2016&quot;</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">&quot;6/30/2016&quot;</span><span class="token punctuation">,</span>freq<span class="token operator">=</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 重新定时数据频度，按一定补充方法</span>
df<span class="token punctuation">.</span>asfreq<span class="token punctuation">(</span><span class="token string">&#39;D&#39;</span><span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">&#39;pad&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 时区，df.tz_convert(&#39;Europe/Berlin&#39;)</span>
df<span class="token punctuation">.</span>time<span class="token punctuation">.</span>tz_localize<span class="token punctuation">(</span>tz<span class="token operator">=</span><span class="token string">&#39;Asia/Shanghai&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 转北京时间</span>
df<span class="token punctuation">[</span><span class="token string">&#39;Time&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;Time&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>tz_localize<span class="token punctuation">(</span><span class="token string">&#39;UTC&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>tz_convert<span class="token punctuation">(</span><span class="token string">&#39;Asia/Shanghai&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 查看所有时区</span>
<span class="token keyword">from</span> pytz <span class="token keyword">import</span> all_timezones
<span class="token keyword">print</span> <span class="token punctuation">(</span>all_timezones<span class="token punctuation">)</span>
<span class="token comment"># 时长，多久，两个时间间隔时间，时差</span>
df<span class="token punctuation">[</span><span class="token string">&#39;duration&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;end&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;begin&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">60</span><span class="token operator">/</span><span class="token number">60</span>
<span class="token comment"># 指定时间进行对比</span>
df<span class="token punctuation">.</span>Time<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">&#39;datetime64[ns]&#39;</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">&#39;2019-12-11 20:00:00&#39;</span><span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">&#39;%Y-%m-%d %H:%M:%S&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 只计算工作日</span>
<span class="token keyword">from</span> pandas<span class="token punctuation">.</span>tseries<span class="token punctuation">.</span>offsets <span class="token keyword">import</span> CustomBusinessDay
b <span class="token operator">=</span> CustomBusinessDay<span class="token punctuation">(</span>holidays<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;2022-04-03&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;2022-04-04&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;2022-04-05&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>weekmask<span class="token operator">=</span><span class="token string">&#39;Mon Tue Wed Thu Fri Sat Sun&#39;</span><span class="token punctuation">)</span>
start_time <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">&#39;2022-03-28 01:30:12&#39;</span><span class="token punctuation">)</span>
end_time <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">&#39;2022-04-11 12:55:35&#39;</span><span class="token punctuation">)</span>
len1 <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span> end_time<span class="token punctuation">,</span>freq<span class="token operator">=</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
len2 <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span> end_time<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>len1<span class="token punctuation">,</span>len2<span class="token punctuation">)</span>
duration <span class="token operator">=</span> end_time<span class="token operator">-</span>start_time
<span class="token keyword">print</span><span class="token punctuation">(</span>duration<span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span>duration<span class="token punctuation">)</span><span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>len2<span class="token operator">-</span>len1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">24</span><span class="token punctuation">)</span>
<span class="token comment"># 只计算工作日，考虑开始时间与结束时间可能是非工作日的情况</span>
holidays<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;2022-04-03&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;2022-04-04&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;2022-04-05&#39;</span><span class="token punctuation">]</span>
businessdays <span class="token operator">=</span> pd<span class="token punctuation">.</span>tseries<span class="token punctuation">.</span>offsets<span class="token punctuation">.</span>CustomBusinessDay<span class="token punctuation">(</span>holidays<span class="token operator">=</span>holidays<span class="token punctuation">,</span>weekmask<span class="token operator">=</span><span class="token string">&#39;Mon Tue Wed Thu Fri Sat Sun&#39;</span><span class="token punctuation">)</span>
df_test <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&#39;2022-03-28 01:30:12&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2022-04-11 12:55:35&#39;</span><span class="token punctuation">,</span> <span class="token string">&quot;te1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        <span class="token punctuation">[</span><span class="token string">&#39;2022-04-04 01:30:12&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2022-04-11 12:55:35&#39;</span><span class="token punctuation">,</span> <span class="token string">&quot;te2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        <span class="token punctuation">[</span><span class="token string">&#39;2022-04-04 23:30:12&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2022-04-06 12:20:35&#39;</span><span class="token punctuation">,</span> <span class="token string">&quot;te3&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        <span class="token punctuation">[</span><span class="token string">&#39;2022-04-02 20:30:12&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2022-04-03 12:00:00&#39;</span><span class="token punctuation">,</span> <span class="token string">&quot;te4&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;start_time&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;end_time&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;title&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">computeDur</span><span class="token punctuation">(</span>start_time<span class="token punctuation">,</span> end_time<span class="token punctuation">)</span><span class="token punctuation">:</span>
   start_time <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>start_time<span class="token punctuation">)</span>
   end_time <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>end_time<span class="token punctuation">)</span>
   len1 <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span>start_time<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end_time<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> freq<span class="token operator">=</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
   len2 <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span>start_time<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end_time<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token keyword">if</span> len1 <span class="token operator">==</span><span class="token number">0</span> <span class="token punctuation">:</span>
       <span class="token keyword">return</span> <span class="token number">0</span>
   sub_s <span class="token operator">=</span> <span class="token number">0</span>
   sub_e <span class="token operator">=</span> <span class="token number">0</span>
   <span class="token keyword">if</span> <span class="token builtin">str</span><span class="token punctuation">(</span>start_time<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">in</span> holidays<span class="token punctuation">:</span>
       sub_s <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>start_time<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39; 23:59:59&#39;</span><span class="token punctuation">)</span> <span class="token operator">-</span> start_time
       sub_s <span class="token operator">=</span> <span class="token number">24</span> <span class="token operator">-</span> sub_s<span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">/</span> <span class="token number">60</span>
   <span class="token keyword">if</span> <span class="token builtin">str</span><span class="token punctuation">(</span>end_time<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">in</span> holidays<span class="token punctuation">:</span>
       sub_e <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>end_time<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39; 23:59:59&#39;</span><span class="token punctuation">)</span> <span class="token operator">-</span> end_time
       sub_e <span class="token operator">=</span> sub_e<span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">/</span> <span class="token number">60</span>
   <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>end_time <span class="token operator">-</span> start_time<span class="token punctuation">)</span><span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>len2 <span class="token operator">-</span> len1<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">+</span> sub_s <span class="token operator">+</span> sub_e

df_test<span class="token punctuation">[</span><span class="token string">&#39;duration&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_test<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> computeDur<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token string">&#39;start_time&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token string">&#39;end_time&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="其他" tabindex="-1"><a class="header-anchor" href="#其他" aria-hidden="true">#</a> 其他</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># 解决科学计数法问题</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;111.csv&#39;</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">&#39;\t&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">&#39;str&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 和订单量相关性最大到小显示</span>
dd<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>total_order_num<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># 解析列表、json 字符串</span>
<span class="token keyword">import</span> ast
ast<span class="token punctuation">.</span>literal_eval<span class="token punctuation">(</span><span class="token string">&quot;[{&#39;id&#39;: 7, &#39;name&#39;: &#39;Funny&#39;}]&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># Series apply method applies a function to</span>
<span class="token comment"># every element in a Series and returns a Series</span>
ted<span class="token punctuation">.</span>ratings<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>str_to_list<span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># lambda is a shorter alternative</span>
ted<span class="token punctuation">.</span>ratings<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> ast<span class="token punctuation">.</span>literal_eval<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># an even shorter alternative is to apply the</span>
<span class="token comment"># function directly (without lambda)</span>
ted<span class="token punctuation">.</span>ratings<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>ast<span class="token punctuation">.</span>literal_eval<span class="token punctuation">)</span>
<span class="token comment"># 索引 index 使用 apply()</span>
df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>to_series<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="样式显示" tabindex="-1"><a class="header-anchor" href="#样式显示" aria-hidden="true">#</a> 样式显示</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># https://pbpython.com/styling-pandas.html</span>
df<span class="token punctuation">[</span><span class="token string">&#39;per_cost&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;per_cost&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token string">&#39;{:,.2f}%&#39;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">)</span>  <span class="token comment"># 显示%比形式</span>
<span class="token comment"># 指定列表（值大于0）加背景色</span>
df<span class="token punctuation">.</span>style<span class="token punctuation">.</span>applymap<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token string">&#39;background-color: grey&#39;</span> <span class="token keyword">if</span> x<span class="token operator">&gt;</span><span class="token number">0</span> <span class="token keyword">else</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
                  subset<span class="token operator">=</span>pd<span class="token punctuation">.</span>IndexSlice<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;C&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 最大值最小值加背景色</span>
df<span class="token punctuation">.</span>style<span class="token punctuation">.</span>highlight_max<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">&#39;lightgreen&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>highlight_min<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">&#39;#cd4f39&#39;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">&#39;{:.2%}&#39;</span><span class="token punctuation">,</span> subset<span class="token operator">=</span>pd<span class="token punctuation">.</span>IndexSlice<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 显示百分号</span>

<span class="token comment"># 指定各列的样式</span>
format_dict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&#39;sum&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;${0:,.0f}&#39;</span><span class="token punctuation">,</span>
                       <span class="token string">&#39;date&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;{:%Y-%m}&#39;</span><span class="token punctuation">,</span>
                       <span class="token string">&#39;pct_of_total&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;{:.2%}&#39;</span>
                       <span class="token string">&#39;c&#39;</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">.</span>upper<span class="token punctuation">}</span>

<span class="token comment"># 一次性样式设置</span>
<span class="token punctuation">(</span>df<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>format_dict<span class="token punctuation">)</span> <span class="token comment"># 多种样式形式</span>
    <span class="token punctuation">.</span>hide_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 指定列按颜色深度表示值大小, cmap 为 matplotlib colormap</span>
    <span class="token punctuation">.</span>background_gradient<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;sum_num&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">&#39;BuGn&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># 表格内作横向 bar 代表值大小</span>
    <span class="token punctuation">.</span>bar<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">&#39;#FFA07A&#39;</span><span class="token punctuation">,</span> vmin<span class="token operator">=</span><span class="token number">100_000</span><span class="token punctuation">,</span> subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;sum&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> align<span class="token operator">=</span><span class="token string">&#39;zero&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># 表格内作横向 bar 代表值大小</span>
    <span class="token punctuation">.</span>bar<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">&#39;lightgreen&#39;</span><span class="token punctuation">,</span> vmin<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;pct_of_total&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> align<span class="token operator">=</span><span class="token string">&#39;zero&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># 下降（小于0）为红色, 上升为绿色</span>
    <span class="token punctuation">.</span>bar<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;#ffe4e4&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;#bbf9ce&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> vmin<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> vmax<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;增长率&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> align<span class="token operator">=</span><span class="token string">&#39;zero&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># 给样式表格起个名字</span>
    <span class="token punctuation">.</span>set_caption<span class="token punctuation">(</span><span class="token string">&#39;2018 Sales Performance&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>hide_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 按条件给整行加背景色（样式）</span>
<span class="token keyword">def</span> <span class="token function">background_color</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> row<span class="token punctuation">.</span>pv_num <span class="token operator">&gt;=</span> <span class="token number">10000</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">&#39;background-color: red&#39;</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> row<span class="token punctuation">.</span>pv_num <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">&#39;background-color: yellow&#39;</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">&#39;&#39;</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
<span class="token comment"># 使用</span>
df<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>background_color<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="表格中的直方图-sparkline-图形" tabindex="-1"><a class="header-anchor" href="#表格中的直方图-sparkline-图形" aria-hidden="true">#</a> 表格中的直方图，sparkline 图形</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> sparklines
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">def</span> <span class="token function">sparkline_str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    bins<span class="token operator">=</span>np<span class="token punctuation">.</span>histogram<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    sl <span class="token operator">=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>sparklines<span class="token punctuation">.</span>sparklines<span class="token punctuation">(</span>bins<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> sl
sparkline_str<span class="token punctuation">.</span>__name__ <span class="token operator">=</span> <span class="token string">&quot;sparkline&quot;</span>
<span class="token comment"># 画出趋势图，保留两位小数</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;quantity&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ext price&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;mean&#39;</span><span class="token punctuation">,</span> sparkline_str<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># sparkline 图形</span>
<span class="token comment"># https://hugoworld.wordpress.com/2019/01/26/sparklines-in-jupyter-notebooks-ipython-and-pandas/</span>
<span class="token keyword">def</span> <span class="token function">sparkline</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    creates a sparkline
    &quot;&quot;&quot;</span>

    <span class="token comment"># Turn off the max column width so the images won&#39;t be truncated</span>
    pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">&#39;display.max_colwidth&#39;</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># Turning off the max column will display all the data</span>
    <span class="token comment"># if gathering into sets / array we might want to restrict to a few items</span>
    pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">&#39;display.max_seq_items&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

    <span class="token comment">#Monkey patch the dataframe so the sparklines are displayed</span>
    pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">.</span>_repr_html_ <span class="token operator">=</span> <span class="token keyword">lambda</span> self<span class="token punctuation">:</span> self<span class="token punctuation">.</span>to_html<span class="token punctuation">(</span>escape<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

    <span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt
    <span class="token keyword">import</span> base64
    <span class="token keyword">from</span> io <span class="token keyword">import</span> BytesIO

    data <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>

    <span class="token operator">*</span>_<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span>figsize<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>fill_between<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">[</span><span class="token builtin">min</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_axis_off<span class="token punctuation">(</span><span class="token punctuation">)</span>

    img <span class="token operator">=</span> BytesIO<span class="token punctuation">(</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">&#39;&lt;img src=&quot;data:image/png;base64, {}&quot; /&gt;&#39;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>img<span class="token punctuation">.</span>getvalue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 使用</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;quantity&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ext price&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;mean&#39;</span><span class="token punctuation">,</span> sparkline<span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>sparkline<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 仅支持横向数据画线，可做 T 转置</span>

df88<span class="token punctuation">.</span>plot<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>y<span class="token operator">=</span><span class="token string">&#39;rate&#39;</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 图形大小，单位英寸</span>
df_1<span class="token punctuation">[</span>df_1<span class="token punctuation">.</span>p_day <span class="token operator">&gt;</span> <span class="token string">&#39;2019-06-01&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">&#39;p_day&#39;</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;total_order_num&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;order_user&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 柱状图</span>
<span class="token comment"># 每条线一个站点，各站点的 home_remain, stack的意思是堆叠，堆积</span>
<span class="token comment"># unstack 即“不要堆叠”</span>
<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>p_day <span class="token operator">&gt;=</span> <span class="token string">&#39;2019-05-1&#39;</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">.</span>utype <span class="token operator">==</span> <span class="token string">&#39;老客&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;p_day&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;site_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;home_remain&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unstack<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">.</span>line<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#  折线图，多条, x 轴默认为 index</span>
dd<span class="token punctuation">.</span>plot<span class="token punctuation">.</span>line<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">&#39;p_day&#39;</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;uv_all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;home_remain&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
dd<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">&#39;新访客&#39;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">&#39;order_user&#39;</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">&#39;paid_order_user&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 散点图</span>
dd<span class="token punctuation">.</span>plot<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">&#39;blue&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 柱状图, barh 为横向柱状图</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>dd<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 相关性可视化</span>
<span class="token comment">#  刻度从0开始，指定范围 ylim=(0,100), x 轴相同</span>
s<span class="token punctuation">.</span>plot<span class="token punctuation">.</span>line<span class="token punctuation">(</span>ylim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># 折线颜色 https://matplotlib.org/examples/color/named_colors.html</span>
<span class="token comment"># 样式( &#39;-&#39;,&#39;--&#39;,&#39;-.&#39;,&#39;:&#39; )</span>
<span class="token comment"># 折线标记 https://matplotlib.org/api/markers_api.html</span>
<span class="token comment"># grid=True 显示刻度 etc: https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html</span>
s<span class="token punctuation">.</span>plot<span class="token punctuation">.</span>line<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">&#39;green&#39;</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">&#39;-&#39;</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">&#39;o&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># 两个图绘在一起</span>
<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;数量&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">.</span>kde<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">&#39;数量&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">.</span>hist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># 对表中的数据按颜色可视化</span>
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
cm <span class="token operator">=</span> sns<span class="token punctuation">.</span>light_palette<span class="token punctuation">(</span><span class="token string">&quot;green&quot;</span><span class="token punctuation">,</span> as_cmap<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>style<span class="token punctuation">.</span>background_gradient<span class="token punctuation">(</span>cmap<span class="token operator">=</span>cm<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># 将数据转化为二维数组</span>
<span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token punctuation">[</span>i<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">&#39;%Y-%m-%d&#39;</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">.</span>index<span class="token punctuation">.</span>to_list<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>to_list<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># 和 plot 用法一样 https://hvplot.pyviz.org/user_guide/Plotting.html</span>
<span class="token keyword">import</span> hvplot<span class="token punctuation">.</span>pandas

<span class="token comment"># 打印 Sqlite 建表语句</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>io<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>get_schema<span class="token punctuation">(</span>fdf<span class="token punctuation">,</span> <span class="token string">&#39;table_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># jupyter notebooks plt 图表配置</span>
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">&#39;figure.figsize&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">15.0</span><span class="token punctuation">,</span> <span class="token number">8.0</span><span class="token punctuation">)</span> <span class="token comment"># 固定显示大小</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">&#39;font.family&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;sans-serif&#39;</span><span class="token punctuation">]</span> <span class="token comment"># 显示中文问题</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">&#39;font.sans-serif&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;SimHei&#39;</span><span class="token punctuation">]</span> <span class="token comment"># 显示中文问题</span>

<span class="token comment"># 输出单行全部变量</span>
<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>core<span class="token punctuation">.</span>interactiveshell <span class="token keyword">import</span> InteractiveShell
InteractiveShell<span class="token punctuation">.</span>ast_node_interactivity <span class="token operator">=</span> <span class="token string">&#39;all&#39;</span>

<span class="token comment"># jupyter notebooks 页面自适应宽度</span>
<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>core<span class="token punctuation">.</span>display <span class="token keyword">import</span> display<span class="token punctuation">,</span> HTML
display<span class="token punctuation">(</span>HTML<span class="token punctuation">(</span><span class="token string">&quot;&lt;style&gt;.container { width:100% !important; }&lt;/style&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 背景白色 &lt;style&gt;#notebook_panel {background: #ffffff;}&lt;/style&gt;</span>

<span class="token comment"># jupyter notebooks 嵌入页面内容</span>
<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> IFrame
IFrame<span class="token punctuation">(</span><span class="token string">&#39;https://arxiv.org/pdf/1406.2661.pdf&#39;</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">450</span><span class="token punctuation">)</span>

<span class="token comment"># Markdown 一个 cell 不支持多张粘贴图片</span>
<span class="token comment"># 一个文件打印打开只显示一张图片问题解决</span>
<span class="token comment"># /site-packages/notebook/static/notebook/js/main.min.js var key 处</span>
<span class="token comment"># 33502、33504 行</span>
key <span class="token operator">=</span> utils<span class="token punctuation">.</span>uuid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">+</span>encodeURIandParens<span class="token punctuation">(</span>blob<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
key <span class="token operator">=</span> utils<span class="token punctuation">.</span>uuid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">+</span>Object<span class="token punctuation">.</span>keys<span class="token punctuation">(</span>that<span class="token punctuation">.</span>attachments<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token comment"># https://github.com/ihnorton/notebook/commit/55687c2dc08817da587977cb6f19f8cc0103bab1</span>

<span class="token comment"># 多行输出</span>
<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>core<span class="token punctuation">.</span>interactiveshell <span class="token keyword">import</span> InteractiveShell
InteractiveShell<span class="token punctuation">.</span>ast_node_interactivity <span class="token operator">=</span> <span class="token string">&#39;all&#39;</span> <span class="token comment">#默认为&#39;last&#39;</span>

<span class="token comment"># 执行 shell 命令: ! &lt;命令语句&gt;</span>

<span class="token comment"># 在线可视化工具</span>
https<span class="token punctuation">:</span><span class="token operator">//</span>plot<span class="token punctuation">.</span>ly<span class="token operator">/</span>create
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="slideshow-幻灯片" tabindex="-1"><a class="header-anchor" href="#slideshow-幻灯片" aria-hidden="true">#</a> Slideshow 幻灯片</h4><p><code>pip install RISE</code></p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/token01/token01.github.io/edit/main/docs/python/pandas.md" rel="noopener noreferrer" target="_blank" aria-label="编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">上次编辑于: </span><!----></div><!----></footer><nav class="page-nav"><a href="/python/JupyterNotebook.html" class="nav-link prev" aria-label="Jupyter Notebook"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><span class="icon iconfont icon-python"></span>Jupyter Notebook</div></a><a href="/python/pySpark.html" class="nav-link next" aria-label="Spark in Python"><div class="hint">下一页<span class="arrow right"></span></div><div class="link">Spark in Python<span class="icon iconfont icon-python"></span></div></a></nav><div class="waline-wrapper" darkmode="false" style="display:block;"><div data-waline provider="Waline"><!--v-if--><div class="wl-comment"><!--v-if--><div class="wl-panel"><div class="wl-header item3"><!--[--><div class="wl-header-item"><label for="wl-nick">昵称</label><input id="wl-nick" class="wl-input wl-nick" name="nick" type="text" value></div><div class="wl-header-item"><label for="wl-mail">邮箱</label><input id="wl-mail" class="wl-input wl-mail" name="mail" type="email" value></div><div class="wl-header-item"><label for="wl-link">网址</label><input id="wl-link" class="wl-input wl-link" name="link" type="text" value></div><!--]--></div><textarea id="wl-edit" class="wl-editor" placeholder="请留言。(填写邮箱可在被回复时收到邮件提醒)"></textarea><div class="wl-preview" style="display:none;"><hr><h4>预览:</h4><!-- eslint-disable-next-line vue/no-v-html --><div class="wl-content"></div></div><div class="wl-footer"><div class="wl-actions"><a href="https://guides.github.com/features/mastering-markdown/" title="Markdown Guide" aria-label="Markdown is supported" class="wl-action" target="_blank" rel="noreferrer"><svg width="16" height="16" ariaHidden="true"><path d="M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z" fill="currentColor"></path></svg></a><button class="wl-action" title="表情" style="display:none;"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M563.2 463.3 677 540c1.7 1.2 3.7 1.8 5.8 1.8.7 0 1.4-.1 2-.2 2.7-.5 5.1-2.1 6.6-4.4l25.3-37.8c1.5-2.3 2.1-5.1 1.6-7.8s-2.1-5.1-4.4-6.6l-73.6-49.1 73.6-49.1c2.3-1.5 3.9-3.9 4.4-6.6.5-2.7 0-5.5-1.6-7.8l-25.3-37.8a10.1 10.1 0 0 0-6.6-4.4c-.7-.1-1.3-.2-2-.2-2.1 0-4.1.6-5.8 1.8l-113.8 76.6c-9.2 6.2-14.7 16.4-14.7 27.5.1 11 5.5 21.3 14.7 27.4zM387 348.8h-45.5c-5.7 0-10.4 4.7-10.4 10.4v153.3c0 5.7 4.7 10.4 10.4 10.4H387c5.7 0 10.4-4.7 10.4-10.4V359.2c0-5.7-4.7-10.4-10.4-10.4zm333.8 241.3-41-20a10.3 10.3 0 0 0-8.1-.5c-2.6.9-4.8 2.9-5.9 5.4-30.1 64.9-93.1 109.1-164.4 115.2-5.7.5-9.9 5.5-9.5 11.2l3.9 45.5c.5 5.3 5 9.5 10.3 9.5h.9c94.8-8 178.5-66.5 218.6-152.7 2.4-5 .3-11.2-4.8-13.6zm186-186.1c-11.9-42-30.5-81.4-55.2-117.1-24.1-34.9-53.5-65.6-87.5-91.2-33.9-25.6-71.5-45.5-111.6-59.2-41.2-14-84.1-21.1-127.8-21.1h-1.2c-75.4 0-148.8 21.4-212.5 61.7-63.7 40.3-114.3 97.6-146.5 165.8-32.2 68.1-44.3 143.6-35.1 218.4 9.3 74.8 39.4 145 87.3 203.3.1.2.3.3.4.5l36.2 38.4c1.1 1.2 2.5 2.1 3.9 2.6 73.3 66.7 168.2 103.5 267.5 103.5 73.3 0 145.2-20.3 207.7-58.7 37.3-22.9 70.3-51.5 98.1-85 27.1-32.7 48.7-69.5 64.2-109.1 15.5-39.7 24.4-81.3 26.6-123.8 2.4-43.6-2.5-87-14.5-129zm-60.5 181.1c-8.3 37-22.8 72-43 104-19.7 31.1-44.3 58.6-73.1 81.7-28.8 23.1-61 41-95.7 53.4-35.6 12.7-72.9 19.1-110.9 19.1-82.6 0-161.7-30.6-222.8-86.2l-34.1-35.8c-23.9-29.3-42.4-62.2-55.1-97.7-12.4-34.7-18.8-71-19.2-107.9-.4-36.9 5.4-73.3 17.1-108.2 12-35.8 30-69.2 53.4-99.1 31.7-40.4 71.1-72 117.2-94.1 44.5-21.3 94-32.6 143.4-32.6 49.3 0 97 10.8 141.8 32 34.3 16.3 65.3 38.1 92 64.8 26.1 26 47.5 56 63.6 89.2 16.2 33.2 26.6 68.5 31 105.1 4.6 37.5 2.7 75.3-5.6 112.3z" fill="currentColor"></path></svg></button><button class="wl-action" title="表情包"><svg width="24" height="24" fill="currentcolor" viewBox="0 0 24 24"><path style="transform: translateY(0.5px)" d="M18.968 10.5H15.968V11.484H17.984V12.984H15.968V15H14.468V9H18.968V10.5V10.5ZM8.984 9C9.26533 9 9.49967 9.09367 9.687 9.281C9.87433 9.46833 9.968 9.70267 9.968 9.984V10.5H6.499V13.5H8.468V12H9.968V14.016C9.968 14.2973 9.87433 14.5317 9.687 14.719C9.49967 14.9063 9.26533 15 8.984 15H5.984C5.70267 15 5.46833 14.9063 5.281 14.719C5.09367 14.5317 5 14.2973 5 14.016V9.985C5 9.70367 5.09367 9.46933 5.281 9.282C5.46833 9.09467 5.70267 9.001 5.984 9.001H8.984V9ZM11.468 9H12.968V15H11.468V9V9Z"></path><path d="M18.5 3H5.75C3.6875 3 2 4.6875 2 6.75V18C2 20.0625 3.6875 21.75 5.75 21.75H18.5C20.5625 21.75 22.25 20.0625 22.25 18V6.75C22.25 4.6875 20.5625 3 18.5 3ZM20.75 18C20.75 19.2375 19.7375 20.25 18.5 20.25H5.75C4.5125 20.25 3.5 19.2375 3.5 18V6.75C3.5 5.5125 4.5125 4.5 5.75 4.5H18.5C19.7375 4.5 20.75 5.5125 20.75 6.75V18Z"></path></svg></button><input id="wl-image-upload" class="upload" type="file" accept=".png,.jpg,.jpeg,.webp,.bmp,.gif"><label for="wl-image-upload" class="wl-action" title="上传图片"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M784 112H240c-88 0-160 72-160 160v480c0 88 72 160 160 160h544c88 0 160-72 160-160V272c0-88-72-160-160-160zm96 640c0 52.8-43.2 96-96 96H240c-52.8 0-96-43.2-96-96V272c0-52.8 43.2-96 96-96h544c52.8 0 96 43.2 96 96v480z" fill="currentColor"></path><path d="M352 480c52.8 0 96-43.2 96-96s-43.2-96-96-96-96 43.2-96 96 43.2 96 96 96zm0-128c17.6 0 32 14.4 32 32s-14.4 32-32 32-32-14.4-32-32 14.4-32 32-32zm462.4 379.2-3.2-3.2-177.6-177.6c-25.6-25.6-65.6-25.6-91.2 0l-80 80-36.8-36.8c-25.6-25.6-65.6-25.6-91.2 0L200 728c-4.8 6.4-8 14.4-8 24 0 17.6 14.4 32 32 32 9.6 0 16-3.2 22.4-9.6L380.8 640l134.4 134.4c6.4 6.4 14.4 9.6 24 9.6 17.6 0 32-14.4 32-32 0-9.6-4.8-17.6-9.6-24l-52.8-52.8 80-80L769.6 776c6.4 4.8 12.8 8 20.8 8 17.6 0 32-14.4 32-32 0-8-3.2-16-8-20.8z" fill="currentColor"></path></svg></label><button class="wl-action" title="预览"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M710.816 654.301c70.323-96.639 61.084-230.578-23.705-314.843-46.098-46.098-107.183-71.109-172.28-71.109-65.008 0-126.092 25.444-172.28 71.109-45.227 46.098-70.756 107.183-70.756 172.106 0 64.923 25.444 126.007 71.194 172.106 46.099 46.098 107.184 71.109 172.28 71.109 51.414 0 100.648-16.212 142.824-47.404l126.53 126.006c7.058 7.06 16.297 10.979 26.406 10.979 10.105 0 19.343-3.919 26.402-10.979 14.467-14.467 14.467-38.172 0-52.723L710.816 654.301zm-315.107-23.265c-65.88-65.88-65.88-172.54 0-238.42 32.069-32.07 74.245-49.149 119.471-49.149 45.227 0 87.407 17.603 119.472 49.149 65.88 65.879 65.88 172.539 0 238.42-63.612 63.178-175.242 63.178-238.943 0zm0 0" fill="currentColor"></path><path d="M703.319 121.603H321.03c-109.8 0-199.469 89.146-199.469 199.38v382.034c0 109.796 89.236 199.38 199.469 199.38h207.397c20.653 0 37.384-16.645 37.384-37.299 0-20.649-16.731-37.296-37.384-37.296H321.03c-68.582 0-124.352-55.77-124.352-124.267V321.421c0-68.496 55.77-124.267 124.352-124.267h382.289c68.582 0 124.352 55.771 124.352 124.267V524.72c0 20.654 16.736 37.299 37.385 37.299 20.654 0 37.384-16.645 37.384-37.299V320.549c-.085-109.8-89.321-198.946-199.121-198.946zm0 0" fill="currentColor"></path></svg></button></div><div class="wl-info"><div class="wl-text-number">0 <!--v-if-->  字</div><button class="wl-btn">登录</button><button class="wl-btn primary" title="Cmd|Ctrl + Enter"><!--[-->提交<!--]--></button></div><div class="wl-gif-popup"><input type="text" placeholder="搜索表情包"><div class="wl-gallery" style="gap:6px;"><!--[--><!--]--></div><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div></div><div class="wl-emoji-popup"><!--[--><!--]--><!--v-if--></div></div></div><!--v-if--></div><div class="wl-meta-head"><div class="wl-count"><!--v-if--> 评论</div><ul class="wl-sort"><!--[--><li class="active">按正序</li><li class="">按倒序</li><li class="">按热度</li><!--]--></ul></div><div class="wl-cards"><!--[--><!--]--></div><!--[--><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div><!--]--><!-- Copyright Information --><div class="wl-power"> Powered by <a href="https://github.com/walinejs/waline" target="_blank" rel="noreferrer"> Waline </a> v2.14.1</div></div></div><!----><!--]--></main><!--]--><!----><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.9fe353dd.js" defer></script>
  </body>
</html>
