import{_ as n}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as s,c as a,f as t}from"./app.89148984.js";const p={},e=t(`<h1 id="_03-gorm\u6846\u67B6\u66F4\u65B0\u4E0E\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#_03-gorm\u6846\u67B6\u66F4\u65B0\u4E0E\u5220\u9664" aria-hidden="true">#</a> 03.gorm\u6846\u67B6\u66F4\u65B0\u4E0E\u5220\u9664</h1><h2 id="_1-\u66F4\u65B0" tabindex="-1"><a class="header-anchor" href="#_1-\u66F4\u65B0" aria-hidden="true">#</a> 1\uFF0C\u66F4\u65B0</h2><h3 id="_1-\u66F4\u65B0\u6240\u6709\u5B57\u6BB5" tabindex="-1"><a class="header-anchor" href="#_1-\u66F4\u65B0\u6240\u6709\u5B57\u6BB5" aria-hidden="true">#</a> 1\uFF0C\u66F4\u65B0\u6240\u6709\u5B57\u6BB5</h3><p><code>Save()</code>\u9ED8\u8BA4\u4F1A\u66F4\u65B0\u8BE5\u5BF9\u8C61\u7684\u6240\u6709\u5B57\u6BB5\uFF0C\u5373\u4F7F\u4F60\u6CA1\u6709\u8D4B\u503C\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;github.com/jinzhu/gorm&quot;</span>
    <span class="token boolean">_</span> <span class="token string">&quot;github.com/jinzhu/gorm/dialects/mysql&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// 1,\u5B9A\u4E49\u6A21\u578B</span>
<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    ID     <span class="token builtin">int64</span>
    Name   <span class="token builtin">string</span>
    Age    <span class="token builtin">int64</span>
    Active <span class="token builtin">bool</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 2, \u8FDE\u63A5\u6570\u636E\u5E93</span>
    db<span class="token punctuation">,</span> err <span class="token operator">:=</span> gorm<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;root:root1234@(127.0.0.1:13306)/db1?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">defer</span> db<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// \u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0Cgorm\u521B\u5EFA\u7684\u8868\u5C06\u4F1A\u662F\u7ED3\u6784\u4F53\u540D\u79F0\u7684\u590D\u6570\u5F62\u5F0F\uFF0C\u5982\u679C\u4E0D\u60F3\u8BA9\u5B83\u81EA\u52A8\u590D\u6570\uFF0C\u53EF\u4EE5\u52A0\u4E00\u4E0B\u7981\u7528</span>
    db<span class="token punctuation">.</span><span class="token function">SingularTable</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

    <span class="token comment">// 3, \u628A\u6A21\u578B\u4E0E\u6570\u636E\u5E93\u4E2D\u7684\u8868\u5BF9\u5E94\u8D77\u6765</span>
    db<span class="token punctuation">.</span><span class="token function">AutoMigrate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 4, \u521B\u5EFA</span>
    <span class="token comment">//u1 := User{Name: &quot;eryajf&quot;, Age: 20, Active: true}</span>
    <span class="token comment">//db.Create(&amp;u1)</span>
    <span class="token comment">//u2 := User{Name: &quot;jinzhu&quot;, Age: 22, Active: false}</span>
    <span class="token comment">//db.Create(&amp;u2)</span>

    <span class="token comment">// 5, \u67E5\u8BE2</span>
    <span class="token keyword">var</span> user User
    db<span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>

    <span class="token comment">// 6, \u66F4\u65B0</span>
    user<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;\u4E8C\u4E2B\u8BB2\u68B5&quot;</span>
    user<span class="token punctuation">.</span>Age <span class="token operator">=</span> <span class="token number">20</span>
    <span class="token comment">// save \u9ED8\u8BA4\u4F1A\u66F4\u65B0\u8BE5\u5BF9\u8C61\u7684\u6240\u6709\u5B57\u6BB5\uFF0C\u5373\u4F7F\u6CA1\u6709\u8D4B\u503C</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`name\` = &#39;\u4E8C\u4E2B\u8BB2\u68B5&#39;, \`age\` = 20, \`active\` = true  WHERE \`user\`.\`id\` = 1</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-\u66F4\u65B0\u4FEE\u6539\u5B57\u6BB5" tabindex="-1"><a class="header-anchor" href="#_2-\u66F4\u65B0\u4FEE\u6539\u5B57\u6BB5" aria-hidden="true">#</a> 2\uFF0C\u66F4\u65B0\u4FEE\u6539\u5B57\u6BB5</h3><p>\u5982\u679C\u4F60\u53EA\u5E0C\u671B\u66F4\u65B0\u6307\u5B9A\u5B57\u6BB5\uFF0C\u53EF\u4EE5\u4F7F\u7528<code>Update</code>\u6216\u8005<code>Updates</code></p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;github.com/jinzhu/gorm&quot;</span>
    <span class="token boolean">_</span> <span class="token string">&quot;github.com/jinzhu/gorm/dialects/mysql&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// 1,\u5B9A\u4E49\u6A21\u578B</span>
<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    ID     <span class="token builtin">int64</span>
    Name   <span class="token builtin">string</span>
    Age    <span class="token builtin">int64</span>
    Active <span class="token builtin">bool</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 2, \u8FDE\u63A5\u6570\u636E\u5E93</span>
    db<span class="token punctuation">,</span> err <span class="token operator">:=</span> gorm<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;root:root1234@(127.0.0.1:13306)/db1?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">defer</span> db<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// \u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0Cgorm\u521B\u5EFA\u7684\u8868\u5C06\u4F1A\u662F\u7ED3\u6784\u4F53\u540D\u79F0\u7684\u590D\u6570\u5F62\u5F0F\uFF0C\u5982\u679C\u4E0D\u60F3\u8BA9\u5B83\u81EA\u52A8\u590D\u6570\uFF0C\u53EF\u4EE5\u52A0\u4E00\u4E0B\u7981\u7528</span>
    db<span class="token punctuation">.</span><span class="token function">SingularTable</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

    <span class="token comment">// 3, \u628A\u6A21\u578B\u4E0E\u6570\u636E\u5E93\u4E2D\u7684\u8868\u5BF9\u5E94\u8D77\u6765</span>
    db<span class="token punctuation">.</span><span class="token function">AutoMigrate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 4, \u521B\u5EFA</span>
    <span class="token comment">//u1 := User{Name: &quot;eryajf&quot;, Age: 20, Active: true}</span>
    <span class="token comment">//db.Create(&amp;u1)</span>
    <span class="token comment">//u2 := User{Name: &quot;jinzhu&quot;, Age: 22, Active: false}</span>
    <span class="token comment">//db.Create(&amp;u2)</span>

    <span class="token comment">// 5, \u67E5\u8BE2</span>
    <span class="token keyword">var</span> user User
    db<span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>

    <span class="token comment">// 6, \u66F4\u65B0</span>
    <span class="token comment">// \u66F4\u65B0\u5355\u4E2A\u5C5E\u6027\uFF0C\u5982\u679C\u4ED6\u6709\u53D8\u5316</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`name\` = &#39;hello&#39;  WHERE \`user\`.\`id\` = 1</span>

    <span class="token comment">// \u6839\u636E\u7ED9\u5B9A\u7684\u6761\u4EF6\u66F4\u65B0\u5355\u4E2A\u5C5E\u6027</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;active = ?&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`name\` = &#39;hello&#39;  WHERE \`user\`.\`id\` = 1 AND ((active = true))</span>

    <span class="token comment">// \u4F7F\u7528map \u66F4\u65B0\u591A\u4E2A\u5C5E\u6027\uFF0C\u53EA\u4F1A\u66F4\u65B0\u5176\u4E2D\u6709\u53D8\u5316\u7684\u5C5E\u6027</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Updates</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">&quot;active&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;false&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`active\` = true, \`age\` = 18, \`name\` = &#39;hello&#39;  WHERE \`user\`.\`id\` = 1</span>

    <span class="token comment">// \u4F7F\u7528struct \u66F4\u65B0\u591A\u4E2A\u5C5E\u6027\uFF0C\u53EA\u4F1A\u66F4\u65B0\u5176\u4E2D\u6709\u53D8\u5316\u4E14\u4E3A\u975E\u96F6\u503C\u7684\u5B57\u6BB5</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Updates</span><span class="token punctuation">(</span>User<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">23</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`age\` = 23, \`name\` = &#39;hello&#39;  WHERE \`user\`.\`id\` = 1</span>

    <span class="token comment">// \u8B66\u544A\uFF1A\u5F53\u4F7F\u7528struct\u66F4\u65B0\u65F6\uFF0CGORM\u53EA\u4F1A\u66F4\u65B0\u90A3\u4E9B\u975E\u96F6\u503C\u7684\u5B57\u6BB5</span>
    <span class="token comment">// \u5BF9\u4E8E\u4E0B\u9762\u7684\u64CD\u4F5C\uFF0C\u4E0D\u4F1A\u53D1\u751F\u4EFB\u4F55\u66F4\u65B0</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Updates</span><span class="token punctuation">(</span>User<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> Active<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">//db.Debug().Model(&amp;user)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-\u66F4\u65B0\u9009\u5B9A\u5B57\u6BB5" tabindex="-1"><a class="header-anchor" href="#_3-\u66F4\u65B0\u9009\u5B9A\u5B57\u6BB5" aria-hidden="true">#</a> 3\uFF0C\u66F4\u65B0\u9009\u5B9A\u5B57\u6BB5</h3><p>\u5982\u679C\u4F60\u60F3\u66F4\u65B0\u6216\u5FFD\u7565\u67D0\u4E9B\u5B57\u6BB5\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528 <code>Select</code>\uFF0C<code>Omit</code></p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;github.com/jinzhu/gorm&quot;</span>
    <span class="token boolean">_</span> <span class="token string">&quot;github.com/jinzhu/gorm/dialects/mysql&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// 1,\u5B9A\u4E49\u6A21\u578B</span>
<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    ID     <span class="token builtin">int64</span>
    Name   <span class="token builtin">string</span>
    Age    <span class="token builtin">int64</span>
    Active <span class="token builtin">bool</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 2, \u8FDE\u63A5\u6570\u636E\u5E93</span>
    db<span class="token punctuation">,</span> err <span class="token operator">:=</span> gorm<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;root:root1234@(127.0.0.1:13306)/db1?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">defer</span> db<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// \u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0Cgorm\u521B\u5EFA\u7684\u8868\u5C06\u4F1A\u662F\u7ED3\u6784\u4F53\u540D\u79F0\u7684\u590D\u6570\u5F62\u5F0F\uFF0C\u5982\u679C\u4E0D\u60F3\u8BA9\u5B83\u81EA\u52A8\u590D\u6570\uFF0C\u53EF\u4EE5\u52A0\u4E00\u4E0B\u7981\u7528</span>
    db<span class="token punctuation">.</span><span class="token function">SingularTable</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

    <span class="token comment">// 3, \u628A\u6A21\u578B\u4E0E\u6570\u636E\u5E93\u4E2D\u7684\u8868\u5BF9\u5E94\u8D77\u6765</span>
    db<span class="token punctuation">.</span><span class="token function">AutoMigrate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 4, \u521B\u5EFA</span>
    <span class="token comment">//u1 := User{Name: &quot;eryajf&quot;, Age: 20, Active: true}</span>
    <span class="token comment">//db.Create(&amp;u1)</span>
    <span class="token comment">//u2 := User{Name: &quot;jinzhu&quot;, Age: 22, Active: false}</span>
    <span class="token comment">//db.Create(&amp;u2)</span>

    <span class="token comment">// 5, \u67E5\u8BE2</span>
    <span class="token keyword">var</span> user User
    db<span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>

    <span class="token comment">// 6, \u66F4\u65B0</span>
    m1 <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span>
        <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span>   <span class="token string">&quot;liqilong&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span>    <span class="token number">20</span><span class="token punctuation">,</span>
        <span class="token string">&quot;active&quot;</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// \u9009\u62E9 m1 \u4E2D\u67D0\u4E2A\u5B57\u6BB5\u8FDB\u884C\u66F4\u65B0</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Updates</span><span class="token punctuation">(</span>m1<span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`name\` = &#39;liqilong&#39;  WHERE \`user\`.\`id\` = 1</span>

    <span class="token comment">// \u5FFD\u7565 m1 \u4E2Dactive\u5B57\u6BB5\u66F4\u65B0\u5176\u4ED6\u5B57\u6BB5</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Omit</span><span class="token punctuation">(</span><span class="token string">&quot;active&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Updates</span><span class="token punctuation">(</span>m1<span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`age\` = 20, \`name\` = &#39;liqilong&#39;  WHERE \`user\`.\`id\` = 1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-\u65E0hooks\u66F4\u65B0" tabindex="-1"><a class="header-anchor" href="#_4-\u65E0hooks\u66F4\u65B0" aria-hidden="true">#</a> 4\uFF0C\u65E0Hooks\u66F4\u65B0</h3><p>\u4E0A\u9762\u7684\u66F4\u65B0\u64CD\u4F5C\u4F1A\u81EA\u52A8\u8FD0\u884C model \u7684 <code>BeforeUpdate</code>, <code>AfterUpdate</code> \u65B9\u6CD5\uFF0C\u66F4\u65B0 <code>UpdatedAt</code> \u65F6\u95F4\u6233, \u5728\u66F4\u65B0\u65F6\u4FDD\u5B58\u5176 <code>Associations</code>, \u5982\u679C\u4F60\u4E0D\u60F3\u8C03\u7528\u8FD9\u4E9B\u65B9\u6CD5\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528 <code>UpdateColumn</code>\uFF0C <code>UpdateColumns</code></p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;github.com/jinzhu/gorm&quot;</span>
    <span class="token boolean">_</span> <span class="token string">&quot;github.com/jinzhu/gorm/dialects/mysql&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// 1,\u5B9A\u4E49\u6A21\u578B</span>
<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    ID     <span class="token builtin">int64</span>
    Name   <span class="token builtin">string</span>
    Age    <span class="token builtin">int64</span>
    Active <span class="token builtin">bool</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 2, \u8FDE\u63A5\u6570\u636E\u5E93</span>
    db<span class="token punctuation">,</span> err <span class="token operator">:=</span> gorm<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;root:root1234@(127.0.0.1:13306)/db1?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">defer</span> db<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// \u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0Cgorm\u521B\u5EFA\u7684\u8868\u5C06\u4F1A\u662F\u7ED3\u6784\u4F53\u540D\u79F0\u7684\u590D\u6570\u5F62\u5F0F\uFF0C\u5982\u679C\u4E0D\u60F3\u8BA9\u5B83\u81EA\u52A8\u590D\u6570\uFF0C\u53EF\u4EE5\u52A0\u4E00\u4E0B\u7981\u7528</span>
    db<span class="token punctuation">.</span><span class="token function">SingularTable</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

    <span class="token comment">// 3, \u628A\u6A21\u578B\u4E0E\u6570\u636E\u5E93\u4E2D\u7684\u8868\u5BF9\u5E94\u8D77\u6765</span>
    db<span class="token punctuation">.</span><span class="token function">AutoMigrate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 4, \u521B\u5EFA</span>
    <span class="token comment">//u1 := User{Name: &quot;eryajf&quot;, Age: 20, Active: true}</span>
    <span class="token comment">//db.Create(&amp;u1)</span>
    <span class="token comment">//u2 := User{Name: &quot;jinzhu&quot;, Age: 22, Active: false}</span>
    <span class="token comment">//db.Create(&amp;u2)</span>

    <span class="token comment">// 5, \u67E5\u8BE2</span>
    <span class="token keyword">var</span> user User
    db<span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>

    <span class="token comment">// 6, \u66F4\u65B0</span>

    <span class="token comment">// \u66F4\u65B0\u5355\u4E2A\u5C5E\u6027\uFF0C\u7C7B\u4F3C\u4E8E update</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">UpdateColumn</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`name\` = &#39;hello&#39;  WHERE \`user\`.\`id\` = 1</span>
    <span class="token comment">// \u66F4\u65B0\u591A\u4E2A\u5C5E\u6027\uFF0C\u7C7B\u4F3C\u4E8E updates</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">UpdateColumns</span><span class="token punctuation">(</span>User<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`age\` = 18, \`name\` = &#39;hello&#39;  WHERE \`user\`.\`id\` = 1</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-\u6279\u91CF\u66F4\u65B0" tabindex="-1"><a class="header-anchor" href="#_5-\u6279\u91CF\u66F4\u65B0" aria-hidden="true">#</a> 5\uFF0C\u6279\u91CF\u66F4\u65B0</h3><p>\u6279\u91CF\u66F4\u65B0\u65F6<code>Hooks\uFF08\u94A9\u5B50\u51FD\u6570\uFF09</code>\u4E0D\u4F1A\u8FD0\u884C\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;github.com/jinzhu/gorm&quot;</span>
    <span class="token boolean">_</span> <span class="token string">&quot;github.com/jinzhu/gorm/dialects/mysql&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// 1,\u5B9A\u4E49\u6A21\u578B</span>
<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    ID     <span class="token builtin">int64</span>
    Name   <span class="token builtin">string</span>
    Age    <span class="token builtin">int64</span>
    Active <span class="token builtin">bool</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 2, \u8FDE\u63A5\u6570\u636E\u5E93</span>
    db<span class="token punctuation">,</span> err <span class="token operator">:=</span> gorm<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;root:root1234@(127.0.0.1:13306)/db1?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">defer</span> db<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// \u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0Cgorm\u521B\u5EFA\u7684\u8868\u5C06\u4F1A\u662F\u7ED3\u6784\u4F53\u540D\u79F0\u7684\u590D\u6570\u5F62\u5F0F\uFF0C\u5982\u679C\u4E0D\u60F3\u8BA9\u5B83\u81EA\u52A8\u590D\u6570\uFF0C\u53EF\u4EE5\u52A0\u4E00\u4E0B\u7981\u7528</span>
    db<span class="token punctuation">.</span><span class="token function">SingularTable</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

    <span class="token comment">// 3, \u628A\u6A21\u578B\u4E0E\u6570\u636E\u5E93\u4E2D\u7684\u8868\u5BF9\u5E94\u8D77\u6765</span>
    db<span class="token punctuation">.</span><span class="token function">AutoMigrate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 4, \u521B\u5EFA</span>
    <span class="token comment">//u1 := User{Name: &quot;eryajf&quot;, Age: 20, Active: true}</span>
    <span class="token comment">//db.Create(&amp;u1)</span>
    <span class="token comment">//u2 := User{Name: &quot;jinzhu&quot;, Age: 22, Active: false}</span>
    <span class="token comment">//db.Create(&amp;u2)</span>

    <span class="token comment">// 5, \u67E5\u8BE2</span>
    <span class="token keyword">var</span> user User
    db<span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>

    <span class="token comment">// 6, \u66F4\u65B0</span>

    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Table</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;id IN (?)&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Updates</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`age\` = 20, \`name\` = &#39;hello&#39;  WHERE (id IN (10,11))</span>
    <span class="token comment">// \u4F7F\u7528struct\u66F4\u65B0\u65F6\uFF0C\u53EA\u4F1A\u66F4\u65B0\u975E\u96F6\u503C\u5B57\u6BB5\uFF0C\u82E5\u60F3\u66F4\u65B0\u6240\u6709\u5B57\u6BB5\uFF0C\u5E94\u4F7F\u7528\u5982\u4E0Amap\u65B9\u5F0F</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Updates</span><span class="token punctuation">(</span>User<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">23</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`age\` = 23, \`name\` = &#39;hello&#39;</span>

    <span class="token comment">// \u4F7F\u7528 RowsAffected \u83B7\u53D6\u66F4\u65B0\u8BB0\u5F55\u603B\u6570</span>
    chageNum <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Updates</span><span class="token punctuation">(</span>User<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">23</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>RowsAffected <span class="token comment">//UPDATE \`user\` SET \`age\` = 23, \`name\` = &#39;hello&#39;</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>chageNum<span class="token punctuation">)</span>

    <span class="token comment">//db.Debug().Model(&amp;user)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-\u4F7F\u7528sql\u8868\u8FBE\u5F0F\u66F4\u65B0" tabindex="-1"><a class="header-anchor" href="#_6-\u4F7F\u7528sql\u8868\u8FBE\u5F0F\u66F4\u65B0" aria-hidden="true">#</a> 6\uFF0C\u4F7F\u7528SQL\u8868\u8FBE\u5F0F\u66F4\u65B0</h3><p>\u5148\u67E5\u8BE2\u8868\u4E2D\u7684\u7B2C\u4E00\u6761\u6570\u636E\u4FDD\u5B58\u81F3user\u53D8\u91CF\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;github.com/jinzhu/gorm&quot;</span>
    <span class="token boolean">_</span> <span class="token string">&quot;github.com/jinzhu/gorm/dialects/mysql&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// 1,\u5B9A\u4E49\u6A21\u578B</span>
<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    ID     <span class="token builtin">int64</span>
    Name   <span class="token builtin">string</span>
    Age    <span class="token builtin">int64</span>
    Active <span class="token builtin">bool</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 2, \u8FDE\u63A5\u6570\u636E\u5E93</span>
    db<span class="token punctuation">,</span> err <span class="token operator">:=</span> gorm<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;root:root1234@(127.0.0.1:13306)/db1?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">defer</span> db<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// \u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0Cgorm\u521B\u5EFA\u7684\u8868\u5C06\u4F1A\u662F\u7ED3\u6784\u4F53\u540D\u79F0\u7684\u590D\u6570\u5F62\u5F0F\uFF0C\u5982\u679C\u4E0D\u60F3\u8BA9\u5B83\u81EA\u52A8\u590D\u6570\uFF0C\u53EF\u4EE5\u52A0\u4E00\u4E0B\u7981\u7528</span>
    db<span class="token punctuation">.</span><span class="token function">SingularTable</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

    <span class="token comment">// 3, \u628A\u6A21\u578B\u4E0E\u6570\u636E\u5E93\u4E2D\u7684\u8868\u5BF9\u5E94\u8D77\u6765</span>
    db<span class="token punctuation">.</span><span class="token function">AutoMigrate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 4, \u521B\u5EFA</span>
    <span class="token comment">//u1 := User{Name: &quot;eryajf&quot;, Age: 20, Active: true}</span>
    <span class="token comment">//db.Create(&amp;u1)</span>
    <span class="token comment">//u2 := User{Name: &quot;jinzhu&quot;, Age: 22, Active: false}</span>
    <span class="token comment">//db.Create(&amp;u2)</span>

    <span class="token comment">// 5, \u67E5\u8BE2</span>
    <span class="token keyword">var</span> user User
    db<span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>

    <span class="token comment">// 6, \u66F4\u65B0</span>

    <span class="token comment">// \u7ED9\u5339\u914D\u5230\u7684\u7528\u6237\u589E\u52A03\u5C81</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> gorm<span class="token punctuation">.</span><span class="token function">Expr</span><span class="token punctuation">(</span><span class="token string">&quot;age + ?&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`age\` = age + 3  WHERE \`user\`.\`id\` = 1</span>
    <span class="token comment">// \u4EE5map\u7684\u65B9\u5F0F\u8FDB\u884C\u5E74\u9F84\u8FD0\u7B97</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Updates</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> gorm<span class="token punctuation">.</span><span class="token function">Expr</span><span class="token punctuation">(</span><span class="token string">&quot;age * ? + ?&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`age\` = age * 2 + 100  WHERE \`user\`.\`id\` = 1</span>
    <span class="token comment">// \u5E74\u9F84\u51CF\u6CD5</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">UpdateColumn</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> gorm<span class="token punctuation">.</span><span class="token function">Expr</span><span class="token punctuation">(</span><span class="token string">&quot;age - ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`age\` = age - &#39;2&#39;  WHERE \`user\`.\`id\` = 1</span>
    <span class="token comment">// \u7ED9\u7B26\u5408\u67E5\u8BE2\u6761\u4EF6\u7684\u7528\u6237\u5E74\u9F84-1</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;age &gt; 10&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">UpdateColumn</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> gorm<span class="token punctuation">.</span><span class="token function">Expr</span><span class="token punctuation">(</span><span class="token string">&quot;age - ?&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`age\` = age - 1  WHERE \`user\`.\`id\` = 1 AND ((age &gt; 10))</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-\u4FEE\u6539hooks\u4E2D\u7684\u503C" tabindex="-1"><a class="header-anchor" href="#_7-\u4FEE\u6539hooks\u4E2D\u7684\u503C" aria-hidden="true">#</a> 7\uFF0C\u4FEE\u6539Hooks\u4E2D\u7684\u503C</h3><p>\u5982\u679C\u4F60\u60F3\u4FEE\u6539 <code>BeforeUpdate</code>, <code>BeforeSave</code> \u7B49 Hooks \u4E2D\u66F4\u65B0\u7684\u503C\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528 <code>scope.SetColumn</code>, \u4F8B\u5982\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>user <span class="token operator">*</span>User<span class="token punctuation">)</span> <span class="token function">BeforeSave</span><span class="token punctuation">(</span>scope <span class="token operator">*</span>gorm<span class="token punctuation">.</span>Scope<span class="token punctuation">)</span> <span class="token punctuation">(</span>err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> pw<span class="token punctuation">,</span> err <span class="token operator">:=</span> bcrypt<span class="token punctuation">.</span><span class="token function">GenerateFromPassword</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>Password<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    scope<span class="token punctuation">.</span><span class="token function">SetColumn</span><span class="token punctuation">(</span><span class="token string">&quot;EncryptedPassword&quot;</span><span class="token punctuation">,</span> pw<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-\u5176\u5B83\u66F4\u65B0\u9009\u9879" tabindex="-1"><a class="header-anchor" href="#_8-\u5176\u5B83\u66F4\u65B0\u9009\u9879" aria-hidden="true">#</a> 8\uFF0C\u5176\u5B83\u66F4\u65B0\u9009\u9879</h3><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u4E3A update SQL \u6DFB\u52A0\u5176\u5B83\u7684 SQL</span>
db<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">&quot;gorm:update_option&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;OPTION (OPTIMIZE FOR UNKNOWN)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>
<span class="token comment">//// UPDATE users SET name=&#39;hello&#39;, updated_at = &#39;2013-11-17 21:34:10&#39; WHERE id=111 OPTION (OPTIMIZE FOR UNKNOWN);</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#_2-\u5220\u9664" aria-hidden="true">#</a> 2\uFF0C\u5220\u9664</h2><h3 id="_1-\u5220\u9664\u8BB0\u5F55" tabindex="-1"><a class="header-anchor" href="#_1-\u5220\u9664\u8BB0\u5F55" aria-hidden="true">#</a> 1\uFF0C\u5220\u9664\u8BB0\u5F55</h3><p><strong>\u8B66\u544A</strong> \u5220\u9664\u8BB0\u5F55\u65F6\uFF0C\u8BF7\u786E\u4FDD\u4E3B\u952E\u5B57\u6BB5\u6709\u503C\uFF0CGORM \u4F1A\u901A\u8FC7\u4E3B\u952E\u53BB\u5220\u9664\u8BB0\u5F55\uFF0C\u5982\u679C\u4E3B\u952E\u4E3A\u7A7A\uFF0CGORM \u4F1A\u5220\u9664\u8BE5 model \u7684\u6240\u6709\u8BB0\u5F55\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u5220\u9664\u73B0\u6709\u8BB0\u5F55</span>
db<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>email<span class="token punctuation">)</span>
<span class="token comment">//// DELETE from emails where id=10;</span>

<span class="token comment">// \u4E3A\u5220\u9664 SQL \u6DFB\u52A0\u989D\u5916\u7684 SQL \u64CD\u4F5C</span>
db<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">&quot;gorm:delete_option&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;OPTION (OPTIMIZE FOR UNKNOWN)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>email<span class="token punctuation">)</span>
<span class="token comment">//// DELETE from emails where id=10 OPTION (OPTIMIZE FOR UNKNOWN);</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-\u6279\u91CF\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#_2-\u6279\u91CF\u5220\u9664" aria-hidden="true">#</a> 2\uFF0C\u6279\u91CF\u5220\u9664</h3><p>\u5220\u9664\u5168\u90E8\u5339\u914D\u7684\u8BB0\u5F55</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;github.com/jinzhu/gorm&quot;</span>
    <span class="token boolean">_</span> <span class="token string">&quot;github.com/jinzhu/gorm/dialects/mysql&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// \u5B9A\u4E49\u6A21\u578B</span>
<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    gorm<span class="token punctuation">.</span>Model
    Name   <span class="token builtin">string</span>
    Age    <span class="token builtin">int64</span>
    Active <span class="token builtin">bool</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    db<span class="token punctuation">,</span> err <span class="token operator">:=</span> gorm<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;root:root1234@(127.0.0.1:13306)/db1?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">defer</span> db<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// \u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0Cgorm\u521B\u5EFA\u7684\u8868\u5C06\u4F1A\u662F\u7ED3\u6784\u4F53\u540D\u79F0\u7684\u590D\u6570\u5F62\u5F0F\uFF0C\u5982\u679C\u4E0D\u60F3\u8BA9\u5B83\u81EA\u52A8\u590D\u6570\uFF0C\u53EF\u4EE5\u52A0\u4E00\u4E0B\u7981\u7528</span>
    db<span class="token punctuation">.</span><span class="token function">SingularTable</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

    <span class="token comment">// 2, \u628A\u6A21\u578B\u4E0E\u6570\u636E\u5E93\u4E2D\u7684\u8868\u5BF9\u5E94\u8D77\u6765</span>
    db<span class="token punctuation">.</span><span class="token function">AutoMigrate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 3, \u521B\u5EFA</span>
    <span class="token comment">//u1 := User{Name: &quot;eryajf&quot;, Age: 20, Active: true}</span>
    <span class="token comment">//  //db.Create(&amp;u1)</span>
    <span class="token comment">//  //u2 := User{Name: &quot;jinzhu&quot;, Age: 22, Active: false}</span>
    <span class="token comment">//  //db.Create(&amp;u2)</span>
    <span class="token comment">//  //u3 := User{Name: &quot;eryajf2&quot;, Age: 20, Active: true}</span>
    <span class="token comment">//  //db.Create(&amp;u3)</span>
    <span class="token comment">//  //u4 := User{Name: &quot;jinzhu2&quot;, Age: 22, Active: false}</span>
    <span class="token comment">//  //db.Create(&amp;u4)</span>

    <span class="token comment">// \u5220\u9664\u7B26\u5408\u6761\u4EF6\u7684\u8BB0\u5F55</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;name LIKE ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;%jinzhu%&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`deleted_at\`=&#39;2020-03-08 23:48:05&#39;  WHERE \`user\`.\`deleted_at\` IS NULL AND ((name LIKE &#39;jinzhu&#39;))</span>
    <span class="token comment">// \u4E0E\u4E0A\u8FB9\u6548\u679C\u4E00\u6837</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;name LIKE ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;%jinzhu%&quot;</span><span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`deleted_at\`=&#39;2020-03-08 23:49:34&#39;  WHERE \`user\`.\`deleted_at\` IS NULL AND ((name LIKE &#39;%jinzhu%&#39;))</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-\u8F6F\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#_3-\u8F6F\u5220\u9664" aria-hidden="true">#</a> 3\uFF0C\u8F6F\u5220\u9664</h3><p>\u5982\u679C\u4E00\u4E2A model \u6709 <code>DeletedAt</code> \u5B57\u6BB5\uFF0C\u4ED6\u5C06\u81EA\u52A8\u83B7\u5F97\u8F6F\u5220\u9664\u7684\u529F\u80FD\uFF01 \u5F53\u8C03\u7528 <code>Delete</code> \u65B9\u6CD5\u65F6\uFF0C \u8BB0\u5F55\u4E0D\u4F1A\u771F\u6B63\u7684\u4ECE\u6570\u636E\u5E93\u4E2D\u88AB\u5220\u9664\uFF0C \u53EA\u4F1A\u5C06<code>DeletedAt</code> \u5B57\u6BB5\u7684\u503C\u4F1A\u88AB\u8BBE\u7F6E\u4E3A\u5F53\u524D\u65F6\u95F4</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>db<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
<span class="token comment">//// UPDATE users SET deleted_at=&quot;2013-10-29 10:23&quot; WHERE id = 111;</span>

<span class="token comment">// \u6279\u91CF\u5220\u9664</span>
db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;age = ?&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//// UPDATE users SET deleted_at=&quot;2013-10-29 10:23&quot; WHERE age = 20;</span>

<span class="token comment">// \u67E5\u8BE2\u8BB0\u5F55\u65F6\u4F1A\u5FFD\u7565\u88AB\u8F6F\u5220\u9664\u7684\u8BB0\u5F55</span>
db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;age = 20&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
<span class="token comment">//// SELECT * FROM users WHERE age = 20 AND deleted_at IS NULL;</span>

<span class="token comment">// Unscoped \u65B9\u6CD5\u53EF\u4EE5\u67E5\u8BE2\u88AB\u8F6F\u5220\u9664\u7684\u8BB0\u5F55</span>
db<span class="token punctuation">.</span><span class="token function">Unscoped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;age = 20&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>users<span class="token punctuation">)</span>
<span class="token comment">//// SELECT * FROM users WHERE age = 20;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-\u7269\u7406\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#_4-\u7269\u7406\u5220\u9664" aria-hidden="true">#</a> 4\uFF0C\u7269\u7406\u5220\u9664</h3><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// Unscoped \u65B9\u6CD5\u53EF\u4EE5\u7269\u7406\u5220\u9664\u8BB0\u5F55</span>
db<span class="token punctuation">.</span><span class="token function">Unscoped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>order<span class="token punctuation">)</span>
<span class="token comment">//// DELETE FROM orders WHERE id=10;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4EE3\u7801\u793A\u4F8B\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;github.com/jinzhu/gorm&quot;</span>
    <span class="token boolean">_</span> <span class="token string">&quot;github.com/jinzhu/gorm/dialects/mysql&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// \u5B9A\u4E49\u6A21\u578B</span>
<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    gorm<span class="token punctuation">.</span>Model
    Name   <span class="token builtin">string</span>
    Age    <span class="token builtin">int64</span>
    Active <span class="token builtin">bool</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    db<span class="token punctuation">,</span> err <span class="token operator">:=</span> gorm<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;root:root1234@(127.0.0.1:13306)/db1?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">defer</span> db<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// \u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0Cgorm\u521B\u5EFA\u7684\u8868\u5C06\u4F1A\u662F\u7ED3\u6784\u4F53\u540D\u79F0\u7684\u590D\u6570\u5F62\u5F0F\uFF0C\u5982\u679C\u4E0D\u60F3\u8BA9\u5B83\u81EA\u52A8\u590D\u6570\uFF0C\u53EF\u4EE5\u52A0\u4E00\u4E0B\u7981\u7528</span>
    db<span class="token punctuation">.</span><span class="token function">SingularTable</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

    <span class="token comment">// 2, \u628A\u6A21\u578B\u4E0E\u6570\u636E\u5E93\u4E2D\u7684\u8868\u5BF9\u5E94\u8D77\u6765</span>
    db<span class="token punctuation">.</span><span class="token function">AutoMigrate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 3, \u521B\u5EFA</span>
    <span class="token comment">//u1 := User{Name: &quot;eryajf&quot;, Age: 20, Active: true}</span>
    <span class="token comment">//  //db.Create(&amp;u1)</span>
    <span class="token comment">//  //u2 := User{Name: &quot;jinzhu&quot;, Age: 22, Active: false}</span>
    <span class="token comment">//  //db.Create(&amp;u2)</span>
    <span class="token comment">//  //u3 := User{Name: &quot;eryajf2&quot;, Age: 20, Active: true}</span>
    <span class="token comment">//  //db.Create(&amp;u3)</span>
    <span class="token comment">//  //u4 := User{Name: &quot;jinzhu2&quot;, Age: 22, Active: false}</span>
    <span class="token comment">//  //db.Create(&amp;u4)</span>

    <span class="token comment">// \u6279\u91CF\u5220\u9664</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;age = ?&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">//UPDATE \`user\` SET \`deleted_at\`=&#39;2020-03-08 23:53:03&#39;  WHERE \`user\`.\`deleted_at\` IS NULL AND ((age = 20))</span>

    <span class="token comment">// \u67E5\u8BE2\u8BB0\u5F55\u65F6\u4F1A\u5FFD\u7565\u88AB\u8F6F\u5220\u9664\u7684\u8BB0\u5F55</span>
    <span class="token keyword">var</span> user User
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;age = 20&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span> <span class="token comment">//SELECT * FROM \`user\`  WHERE \`user\`.\`deleted_at\` IS NULL AND ((age = 20))</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>

    <span class="token comment">// Unscoped \u65B9\u6CD5\u53EF\u4EE5\u67E5\u8BE2\u88AB\u8F6F\u5220\u9664\u7684\u8BB0\u5F55</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Unscoped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;age = 20&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span> <span class="token comment">//SELECT * FROM \`user\`  WHERE (age = 20)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>

    <span class="token comment">// Unscoped \u65B9\u6CD5\u53EF\u4EE5\u7269\u7406\u5220\u9664\u8BB0\u5F55</span>
    db<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Unscoped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;name = ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;eryajf&quot;</span><span class="token punctuation">)</span> <span class="token comment">//DELETE FROM \`user\`  WHERE (name = &#39;eryajf&#39;)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-\u94FE\u5F0F\u64CD\u4F5C\u76F8\u5173" tabindex="-1"><a class="header-anchor" href="#_3-\u94FE\u5F0F\u64CD\u4F5C\u76F8\u5173" aria-hidden="true">#</a> 3\uFF0C\u94FE\u5F0F\u64CD\u4F5C\u76F8\u5173</h2><h3 id="_1-\u94FE\u5F0F\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_1-\u94FE\u5F0F\u64CD\u4F5C" aria-hidden="true">#</a> 1\uFF0C\u94FE\u5F0F\u64CD\u4F5C</h3><p>Method Chaining\uFF0CGorm \u5B9E\u73B0\u4E86\u94FE\u5F0F\u64CD\u4F5C\u63A5\u53E3\uFF0C\u6240\u4EE5\u4F60\u53EF\u4EE5\u628A\u4EE3\u7801\u5199\u6210\u8FD9\u6837\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A\u67E5\u8BE2</span>
tx <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;name = ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;jinzhu&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// \u6DFB\u52A0\u66F4\u591A\u6761\u4EF6</span>
<span class="token keyword">if</span> someCondition <span class="token punctuation">{</span>
  tx <span class="token operator">=</span> tx<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;age = ?&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  tx <span class="token operator">=</span> tx<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;age = ?&quot;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> yetAnotherCondition <span class="token punctuation">{</span>
  tx <span class="token operator">=</span> tx<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;active = ?&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728\u8C03\u7528\u7ACB\u5373\u6267\u884C\u65B9\u6CD5\u524D\u4E0D\u4F1A\u751F\u6210<code>Query</code>\u8BED\u53E5\uFF0C\u501F\u52A9\u8FD9\u4E2A\u7279\u6027\u4F60\u53EF\u4EE5\u521B\u5EFA\u4E00\u4E2A\u51FD\u6570\u6765\u5904\u7406\u4E00\u4E9B\u901A\u7528\u903B\u8F91\u3002</p><h3 id="_2-\u7ACB\u5373\u6267\u884C\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_2-\u7ACB\u5373\u6267\u884C\u65B9\u6CD5" aria-hidden="true">#</a> 2\uFF0C\u7ACB\u5373\u6267\u884C\u65B9\u6CD5</h3><p>Immediate methods \uFF0C\u7ACB\u5373\u6267\u884C\u65B9\u6CD5\u662F\u6307\u90A3\u4E9B\u4F1A\u7ACB\u5373\u751F\u6210<code>SQL</code>\u8BED\u53E5\u5E76\u53D1\u9001\u5230\u6570\u636E\u5E93\u7684\u65B9\u6CD5, \u4ED6\u4EEC\u4E00\u822C\u662F<code>CRUD</code>\u65B9\u6CD5\uFF0C\u6BD4\u5982\uFF1A</p><p><code>Create</code>, <code>First</code>, <code>Find</code>, <code>Take</code>, <code>Save</code>, <code>UpdateXXX</code>, <code>Delete</code>, <code>Scan</code>, <code>Row</code>, <code>Rows</code>\u2026</p><p>\u8FD9\u6709\u4E00\u4E2A\u57FA\u4E8E\u4E0A\u9762\u94FE\u5F0F\u65B9\u6CD5\u4EE3\u7801\u7684\u7ACB\u5373\u6267\u884C\u65B9\u6CD5\u7684\u4F8B\u5B50\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>tx<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u751F\u6210\u7684SQL\u8BED\u53E5\u5982\u4E0B\uFF1A</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">&#39;jinzhu&#39;</span> <span class="token operator">AND</span> age <span class="token operator">=</span> <span class="token number">30</span> <span class="token operator">AND</span> active <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_3-\u8303\u56F4" tabindex="-1"><a class="header-anchor" href="#_3-\u8303\u56F4" aria-hidden="true">#</a> 3\uFF0C\u8303\u56F4</h3><p><code>Scopes</code>\uFF0CScope\u662F\u5EFA\u7ACB\u5728\u94FE\u5F0F\u64CD\u4F5C\u7684\u57FA\u7840\u4E4B\u4E0A\u7684\u3002</p><p>\u57FA\u4E8E\u5B83\uFF0C\u4F60\u53EF\u4EE5\u62BD\u53D6\u4E00\u4E9B\u901A\u7528\u903B\u8F91\uFF0C\u5199\u51FA\u66F4\u591A\u53EF\u91CD\u7528\u7684\u51FD\u6570\u5E93\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">AmountGreaterThan1000</span><span class="token punctuation">(</span>db <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB<span class="token punctuation">)</span> <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB <span class="token punctuation">{</span>
  <span class="token keyword">return</span> db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;amount &gt; ?&quot;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">PaidWithCreditCard</span><span class="token punctuation">(</span>db <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB<span class="token punctuation">)</span> <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB <span class="token punctuation">{</span>
  <span class="token keyword">return</span> db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;pay_mode_sign = ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">PaidWithCod</span><span class="token punctuation">(</span>db <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB<span class="token punctuation">)</span> <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB <span class="token punctuation">{</span>
  <span class="token keyword">return</span> db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;pay_mode_sign = ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">OrderStatus</span><span class="token punctuation">(</span>status <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token keyword">func</span> <span class="token punctuation">(</span>db <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB<span class="token punctuation">)</span> <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">func</span> <span class="token punctuation">(</span>db <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB<span class="token punctuation">)</span> <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB <span class="token punctuation">{</span>
    <span class="token keyword">return</span> db<span class="token punctuation">.</span><span class="token function">Scopes</span><span class="token punctuation">(</span>AmountGreaterThan1000<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;status IN (?)&quot;</span><span class="token punctuation">,</span> status<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

db<span class="token punctuation">.</span><span class="token function">Scopes</span><span class="token punctuation">(</span>AmountGreaterThan1000<span class="token punctuation">,</span> PaidWithCreditCard<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>orders<span class="token punctuation">)</span>
<span class="token comment">// \u67E5\u627E\u6240\u6709\u91D1\u989D\u5927\u4E8E 1000 \u7684\u4FE1\u7528\u5361\u8BA2\u5355</span>

db<span class="token punctuation">.</span><span class="token function">Scopes</span><span class="token punctuation">(</span>AmountGreaterThan1000<span class="token punctuation">,</span> PaidWithCod<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>orders<span class="token punctuation">)</span>
<span class="token comment">// \u67E5\u627E\u6240\u6709\u91D1\u989D\u5927\u4E8E 1000 \u7684 COD \u8BA2\u5355</span>

db<span class="token punctuation">.</span><span class="token function">Scopes</span><span class="token punctuation">(</span>AmountGreaterThan1000<span class="token punctuation">,</span> <span class="token function">OrderStatus</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;paid&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;shipped&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>orders<span class="token punctuation">)</span>
<span class="token comment">// \u67E5\u627E\u6240\u6709\u91D1\u989D\u5927\u4E8E 1000 \u4E14\u5DF2\u4ED8\u6B3E\u6216\u8005\u5DF2\u53D1\u8D27\u7684\u8BA2\u5355</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-\u591A\u4E2A\u7ACB\u5373\u6267\u884C\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_4-\u591A\u4E2A\u7ACB\u5373\u6267\u884C\u65B9\u6CD5" aria-hidden="true">#</a> 4\uFF0C\u591A\u4E2A\u7ACB\u5373\u6267\u884C\u65B9\u6CD5</h3><p>Multiple Immediate Methods\uFF0C\u5728 GORM \u4E2D\u4F7F\u7528\u591A\u4E2A\u7ACB\u5373\u6267\u884C\u65B9\u6CD5\u65F6\uFF0C\u540E\u4E00\u4E2A\u7ACB\u5373\u6267\u884C\u65B9\u6CD5\u4F1A\u590D\u7528\u524D\u4E00\u4E2A<strong>\u7ACB\u5373\u6267\u884C\u65B9\u6CD5</strong>\u7684\u6761\u4EF6 (\u4E0D\u5305\u62EC\u5185\u8054\u6761\u4EF6) \u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;name LIKE ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;jinzhu%&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>users<span class="token punctuation">,</span> <span class="token string">&quot;id IN (?)&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>count<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u751F\u6210\u7684 Sql</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> name <span class="token operator">LIKE</span> <span class="token string">&#39;jinzhu%&#39;</span> <span class="token operator">AND</span> id <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

<span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> name <span class="token operator">LIKE</span> <span class="token string">&#39;jinzhu%&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,60),o=[e];function c(i,u){return s(),a("div",null,o)}const r=n(p,[["render",c],["__file","03.gorm\u6846\u67B6\u66F4\u65B0\u4E0E\u5220\u9664.html.vue"]]);export{r as default};
