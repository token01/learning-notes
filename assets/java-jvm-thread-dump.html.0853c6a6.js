import{_ as a}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as t,c as p,a as n,d as e,f as o,r as c}from"./app.251cf86e.js";const l={},i=o(`<h1 id="\u8C03\u8BD5\u6392\u9519-java-\u7EBF\u7A0B\u5206\u6790\u4E4B\u7EBF\u7A0Bdump\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#\u8C03\u8BD5\u6392\u9519-java-\u7EBF\u7A0B\u5206\u6790\u4E4B\u7EBF\u7A0Bdump\u5206\u6790" aria-hidden="true">#</a> \u8C03\u8BD5\u6392\u9519 - Java \u7EBF\u7A0B\u5206\u6790\u4E4B\u7EBF\u7A0BDump\u5206\u6790</h1><blockquote><p>Thread Dump\u662F\u975E\u5E38\u6709\u7528\u7684\u8BCA\u65ADJava\u5E94\u7528\u95EE\u9898\u7684\u5DE5\u5177\u3002</p></blockquote><h2 id="_1-thread-dump\u4ECB\u7ECD" tabindex="-1"><a class="header-anchor" href="#_1-thread-dump\u4ECB\u7ECD" aria-hidden="true">#</a> 1. Thread Dump\u4ECB\u7ECD</h2><h3 id="_1-1-\u4EC0\u4E48\u662Fthread-dump" tabindex="-1"><a class="header-anchor" href="#_1-1-\u4EC0\u4E48\u662Fthread-dump" aria-hidden="true">#</a> 1.1 \u4EC0\u4E48\u662FThread Dump</h3><p>Thread Dump\u662F\u975E\u5E38\u6709\u7528\u7684\u8BCA\u65ADJava\u5E94\u7528\u95EE\u9898\u7684\u5DE5\u5177\u3002\u6BCF\u4E00\u4E2AJava\u865A\u62DF\u673A\u90FD\u6709\u53CA\u65F6\u751F\u6210\u6240\u6709\u7EBF\u7A0B\u5728\u67D0\u4E00\u70B9\u72B6\u6001\u7684thread-dump\u7684\u80FD\u529B\uFF0C\u867D\u7136\u5404\u4E2A Java\u865A\u62DF\u673A\u6253\u5370\u7684thread dump\u7565\u6709\u4E0D\u540C\uFF0C\u4F46\u662F \u5927\u591A\u90FD\u63D0\u4F9B\u4E86\u5F53\u524D\u6D3B\u52A8\u7EBF\u7A0B\u7684\u5FEB\u7167\uFF0C\u53CAJVM\u4E2D\u6240\u6709Java\u7EBF\u7A0B\u7684\u5806\u6808\u8DDF\u8E2A\u4FE1\u606F\uFF0C\u5806\u6808\u4FE1\u606F\u4E00\u822C\u5305\u542B\u5B8C\u6574\u7684\u7C7B\u540D\u53CA\u6240\u6267\u884C\u7684\u65B9\u6CD5\uFF0C\u5982\u679C\u53EF\u80FD\u7684\u8BDD\u8FD8\u6709\u6E90\u4EE3\u7801\u7684\u884C\u6570\u3002</p><h3 id="_1-2-thread-dump\u7279\u70B9" tabindex="-1"><a class="header-anchor" href="#_1-2-thread-dump\u7279\u70B9" aria-hidden="true">#</a> 1.2 Thread Dump\u7279\u70B9</h3><ul><li>\u80FD\u5728\u5404\u79CD\u64CD\u4F5C\u7CFB\u7EDF\u4E0B\u4F7F\u7528\uFF1B</li><li>\u80FD\u5728\u5404\u79CDJava\u5E94\u7528\u670D\u52A1\u5668\u4E0B\u4F7F\u7528\uFF1B</li><li>\u80FD\u5728\u751F\u4EA7\u73AF\u5883\u4E0B\u4F7F\u7528\u800C\u4E0D\u5F71\u54CD\u7CFB\u7EDF\u7684\u6027\u80FD\uFF1B</li><li>\u80FD\u5C06\u95EE\u9898\u76F4\u63A5\u5B9A\u4F4D\u5230\u5E94\u7528\u7A0B\u5E8F\u7684\u4EE3\u7801\u884C\u4E0A\uFF1B</li></ul><h3 id="_1-3-thread-dump\u6293\u53D6" tabindex="-1"><a class="header-anchor" href="#_1-3-thread-dump\u6293\u53D6" aria-hidden="true">#</a> 1.3 Thread Dump\u6293\u53D6</h3><p>\u4E00\u822C\u5F53\u670D\u52A1\u5668\u6302\u8D77\uFF0C\u5D29\u6E83\u6216\u8005\u6027\u80FD\u4F4E\u4E0B\u65F6\uFF0C\u5C31\u9700\u8981\u6293\u53D6\u670D\u52A1\u5668\u7684\u7EBF\u7A0B\u5806\u6808\uFF08Thread Dump\uFF09\u7528\u4E8E\u540E\u7EED\u7684\u5206\u6790\u3002\u5728\u5B9E\u9645\u8FD0\u884C\u4E2D\uFF0C\u5F80\u5F80\u4E00\u6B21 dump\u7684\u4FE1\u606F\uFF0C\u8FD8\u4E0D\u8DB3\u4EE5\u786E\u8BA4\u95EE\u9898\u3002\u4E3A\u4E86\u53CD\u6620\u7EBF\u7A0B\u72B6\u6001\u7684\u52A8\u6001\u53D8\u5316\uFF0C\u9700\u8981\u63A5\u8FDE\u591A\u6B21\u505Athread dump\uFF0C\u6BCF\u6B21\u95F4\u969410-20s\uFF0C\u5EFA\u8BAE\u81F3\u5C11\u4EA7\u751F\u4E09\u6B21 dump\u4FE1\u606F\uFF0C\u5982\u679C\u6BCF\u6B21 dump\u90FD\u6307\u5411\u540C\u4E00\u4E2A\u95EE\u9898\uFF0C\u6211\u4EEC\u624D\u786E\u5B9A\u95EE\u9898\u7684\u5178\u578B\u6027\u3002</p><ul><li>\u64CD\u4F5C\u7CFB\u7EDF\u547D\u4EE4\u83B7\u53D6ThreadDump</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">ps</span> \u2013ef <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">java</span>
<span class="token function">kill</span> <span class="token parameter variable">-3</span> <span class="token operator">&lt;</span>pid<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6CE8\u610F\uFF1A</p><blockquote><p>\u4E00\u5B9A\u8981\u8C28\u614E, \u4E00\u6B65\u4E0D\u614E\u5C31\u53EF\u80FD\u8BA9\u670D\u52A1\u5668\u8FDB\u7A0B\u88AB\u6740\u6B7B\u3002kill -9 \u547D\u4EE4\u4F1A\u6740\u6B7B\u8FDB\u7A0B\u3002</p></blockquote><ul><li>JVM \u81EA\u5E26\u7684\u5DE5\u5177\u83B7\u53D6\u7EBF\u7A0B\u5806\u6808</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>jps \u6216 <span class="token function">ps</span> \u2013ef <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">java</span> \uFF08\u83B7\u53D6PID\uFF09
jstack <span class="token punctuation">[</span>-l <span class="token punctuation">]</span> <span class="token operator">&lt;</span>pid<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token function">tee</span> <span class="token parameter variable">-a</span> jstack.log\uFF08\u83B7\u53D6ThreadDump\uFF09
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-thread-dump\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#_2-thread-dump\u5206\u6790" aria-hidden="true">#</a> 2. Thread Dump\u5206\u6790</h2><h3 id="_2-1-thread-dump\u4FE1\u606F" tabindex="-1"><a class="header-anchor" href="#_2-1-thread-dump\u4FE1\u606F" aria-hidden="true">#</a> 2.1 Thread Dump\u4FE1\u606F</h3><ul><li>\u5934\u90E8\u4FE1\u606F\uFF1A\u65F6\u95F4\uFF0CJVM\u4FE1\u606F</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">2011</span>-11-02 <span class="token number">19</span>:05:06  
Full thread dump Java HotSpot<span class="token punctuation">(</span>TM<span class="token punctuation">)</span> Server VM <span class="token punctuation">(</span><span class="token number">16.3</span>-b01 mixed mode<span class="token punctuation">)</span>: 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u7EBF\u7A0BINFO\u4FE1\u606F\u5757\uFF1A</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">1</span>. <span class="token string">&quot;Timer-0&quot;</span> daemon <span class="token assign-left variable">prio</span><span class="token operator">=</span><span class="token number">10</span> <span class="token assign-left variable">tid</span><span class="token operator">=</span>0xac190c00 <span class="token assign-left variable">nid</span><span class="token operator">=</span>0xaef <span class="token keyword">in</span> Object.wait<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>0xae77d000<span class="token punctuation">]</span> 
<span class="token comment"># \u7EBF\u7A0B\u540D\u79F0\uFF1ATimer-0\uFF1B\u7EBF\u7A0B\u7C7B\u578B\uFF1Adaemon\uFF1B\u4F18\u5148\u7EA7: 10\uFF0C\u9ED8\u8BA4\u662F5\uFF1B</span>
<span class="token comment"># JVM\u7EBF\u7A0Bid\uFF1Atid=0xac190c00\uFF0CJVM\u5185\u90E8\u7EBF\u7A0B\u7684\u552F\u4E00\u6807\u8BC6\uFF08\u901A\u8FC7java.lang.Thread.getId()\u83B7\u53D6\uFF0C\u901A\u5E38\u7528\u81EA\u589E\u65B9\u5F0F\u5B9E\u73B0\uFF09\u3002</span>
<span class="token comment"># \u5BF9\u5E94\u7CFB\u7EDF\u7EBF\u7A0Bid\uFF08NativeThread ID\uFF09\uFF1Anid=0xaef\uFF0C\u548Ctop\u547D\u4EE4\u67E5\u770B\u7684\u7EBF\u7A0Bpid\u5BF9\u5E94\uFF0C\u4E0D\u8FC7\u4E00\u4E2A\u662F10\u8FDB\u5236\uFF0C\u4E00\u4E2A\u662F16\u8FDB\u5236\u3002\uFF08\u901A\u8FC7\u547D\u4EE4\uFF1Atop -H -p pid\uFF0C\u53EF\u4EE5\u67E5\u770B\u8BE5\u8FDB\u7A0B\u7684\u6240\u6709\u7EBF\u7A0B\u4FE1\u606F\uFF09</span>
<span class="token comment"># \u7EBF\u7A0B\u72B6\u6001\uFF1Ain Object.wait()\uFF1B</span>
<span class="token comment"># \u8D77\u59CB\u6808\u5730\u5740\uFF1A[0xae77d000]\uFF0C\u5BF9\u8C61\u7684\u5185\u5B58\u5730\u5740\uFF0C\u901A\u8FC7JVM\u5185\u5B58\u67E5\u770B\u5DE5\u5177\uFF0C\u80FD\u591F\u770B\u51FA\u7EBF\u7A0B\u662F\u5728\u54EA\u513F\u4E2A\u5BF9\u8C61\u4E0A\u7B49\u5F85\uFF1B</span>
<span class="token number">2</span>.  java.lang.Thread.State: TIMED_WAITING <span class="token punctuation">(</span>on object monitor<span class="token punctuation">)</span>
<span class="token number">3</span>.  at java.lang.Object.wait<span class="token punctuation">(</span>Native Method<span class="token punctuation">)</span>
<span class="token number">4</span>.  <span class="token parameter variable">-waiting</span> on <span class="token operator">&lt;</span>0xb3885f6<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> <span class="token punctuation">(</span>a java.util.TaskQueue<span class="token punctuation">)</span>     <span class="token comment"># \u7EE7\u7EEDwait </span>
<span class="token number">5</span>.  at java.util.TimerThread.mainLoop<span class="token punctuation">(</span>Timer.java:509<span class="token punctuation">)</span>
<span class="token number">6</span>.  <span class="token parameter variable">-locked</span> <span class="token operator">&lt;</span>0xb3885f6<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> <span class="token punctuation">(</span>a java.util.TaskQueue<span class="token punctuation">)</span>         <span class="token comment"># \u5DF2\u7ECFlocked</span>
<span class="token number">7</span>.  at java.util.TimerThread.run<span class="token punctuation">(</span>Timer.java:462<span class="token punctuation">)</span>
Java thread statck trace\uFF1A\u662F\u4E0A\u97622-7\u884C\u7684\u4FE1\u606F\u3002\u5230\u76EE\u524D\u4E3A\u6B62\u8FD9\u662F\u6700\u91CD\u8981\u7684\u6570\u636E\uFF0CJava stack trace\u63D0\u4F9B\u4E86\u5927\u90E8\u5206\u4FE1\u606F\u6765\u7CBE\u786E\u5B9A\u4F4D\u95EE\u9898\u6839\u6E90\u3002

  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Java thread statck trace\u8BE6\u89E3\uFF1A</li></ul><p><strong>\u5806\u6808\u4FE1\u606F\u5E94\u8BE5\u9006\u5411\u89E3\u8BFB</strong>\uFF1A\u7A0B\u5E8F\u5148\u6267\u884C\u7684\u662F\u7B2C7\u884C\uFF0C\u7136\u540E\u662F\u7B2C6\u884C\uFF0C\u4F9D\u6B21\u7C7B\u63A8\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>- locked <span class="token operator">&lt;</span>0xb3885f6<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> <span class="token punctuation">(</span>a java.util.ArrayList<span class="token punctuation">)</span>
- waiting on <span class="token operator">&lt;</span>0xb3885f6<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> <span class="token punctuation">(</span>a java.util.ArrayList<span class="token punctuation">)</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u4E5F\u5C31\u662F\u8BF4\u5BF9\u8C61\u5148\u4E0A\u9501\uFF0C\u9501\u4F4F\u5BF9\u8C610xb3885f60\uFF0C\u7136\u540E\u91CA\u653E\u8BE5\u5BF9\u8C61\u9501\uFF0C\u8FDB\u5165waiting\u72B6\u6001</strong>\u3002\u4E3A\u5565\u4F1A\u51FA\u73B0\u8FD9\u6837\u7684\u60C5\u51B5\u5462\uFF1F\u770B\u770B\u4E0B\u9762\u7684java\u4EE3\u7801\u793A\u4F8B\uFF0C\u5C31\u4F1A\u660E\u767D\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">synchronized</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  
   obj<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u4E0A\uFF0C\u7EBF\u7A0B\u7684\u6267\u884C\u8FC7\u7A0B\uFF0C\u5148\u7528 <code>synchronized</code> \u83B7\u5F97\u4E86\u8FD9\u4E2A\u5BF9\u8C61\u7684 Monitor\uFF08\u5BF9\u5E94\u4E8E <code>locked &lt;0xb3885f60&gt;</code> \uFF09\u3002\u5F53\u6267\u884C\u5230 <code>obj.wait()</code>\uFF0C\u7EBF\u7A0B\u5373\u653E\u5F03\u4E86 Monitor\u7684\u6240\u6709\u6743\uFF0C\u8FDB\u5165 \u201Cwait set\u201D\u961F\u5217\uFF08\u5BF9\u5E94\u4E8E <code>waiting on &lt;0xb3885f60&gt;</code> \uFF09\u3002</p><p><strong>\u5728\u5806\u6808\u7684\u7B2C\u4E00\u884C\u4FE1\u606F\u4E2D\uFF0C\u8FDB\u4E00\u6B65\u6807\u660E\u4E86\u7EBF\u7A0B\u5728\u4EE3\u7801\u7EA7\u7684\u72B6\u6001</strong>\uFF0C\u4F8B\u5982\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>java.lang.Thread.State: TIMED_WAITING <span class="token punctuation">(</span>parking<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u89E3\u91CA\u5982\u4E0B\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token operator">|</span>blocked<span class="token operator">|</span>

<span class="token operator">&gt;</span> This thread tried to enter asynchronized block, but the lock was taken by another thread. This thread isblocked <span class="token keyword">until</span> the lock gets released.

<span class="token operator">|</span>blocked <span class="token punctuation">(</span>on thin lock<span class="token punctuation">)</span><span class="token operator">|</span>

<span class="token operator">&gt;</span> This is the same state asblocked, but the lock <span class="token keyword">in</span> question is a thin lock.

<span class="token operator">|</span>waiting<span class="token operator">|</span>

<span class="token operator">&gt;</span> This thread calledObject.wait<span class="token punctuation">(</span><span class="token punctuation">)</span> on an object. The thread will remain there <span class="token keyword">until</span> some otherthread sends a notification to that object.

<span class="token operator">|</span>sleeping<span class="token operator">|</span>

<span class="token operator">&gt;</span> This thread calledjava.lang.Thread.sleep<span class="token punctuation">(</span><span class="token punctuation">)</span>.

<span class="token operator">|</span>parked<span class="token operator">|</span>

<span class="token operator">&gt;</span> This thread calledjava.util.concurrent.locks.LockSupport.park<span class="token punctuation">(</span><span class="token punctuation">)</span>.

<span class="token operator">|</span>suspended<span class="token operator">|</span>

<span class="token operator">&gt;</span> The thread&#39;s execution wassuspended by java.lang.Thread.suspend<span class="token punctuation">(</span><span class="token punctuation">)</span> or a JVMTI agent call.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-thread\u72B6\u6001\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#_2-2-thread\u72B6\u6001\u5206\u6790" aria-hidden="true">#</a> 2.2 Thread\u72B6\u6001\u5206\u6790</h3><p>\u7EBF\u7A0B\u7684\u72B6\u6001\u662F\u4E00\u4E2A\u5F88\u91CD\u8981\u7684\u4E1C\u897F\uFF0C\u56E0\u6B64thread dump\u4E2D\u4F1A\u663E\u793A\u8FD9\u4E9B\u72B6\u6001\uFF0C\u901A\u8FC7\u5BF9\u8FD9\u4E9B\u72B6\u6001\u7684\u5206\u6790\uFF0C\u80FD\u591F\u5F97\u51FA\u7EBF\u7A0B\u7684\u8FD0\u884C\u72B6\u51B5\uFF0C\u8FDB\u800C\u53D1\u73B0\u53EF\u80FD\u5B58\u5728\u7684\u95EE\u9898\u3002<strong>\u7EBF\u7A0B\u7684\u72B6\u6001\u5728Thread.State\u8FD9\u4E2A\u679A\u4E3E\u7C7B\u578B\u4E2D\u5B9A\u4E49</strong>\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">State</span>   
<span class="token punctuation">{</span>  
       <span class="token doc-comment comment">/** 
        * Thread state for a thread which has not yet started. 
        */</span>  
       <span class="token constant">NEW</span><span class="token punctuation">,</span>  
         
       <span class="token doc-comment comment">/** 
        * Thread state for a runnable thread.  A thread in the runnable 
        * state is executing in the Java virtual machine but it may 
        * be waiting for other resources from the operating system 
        * such as processor. 
        */</span>  
       <span class="token constant">RUNNABLE</span><span class="token punctuation">,</span>  
         
       <span class="token doc-comment comment">/** 
        * Thread state for a thread blocked waiting for a monitor lock. 
        * A thread in the blocked state is waiting for a monitor lock 
        * to enter a synchronized block/method or  
        * reenter a synchronized block/method after calling 
        * <span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token class-name">Object</span><span class="token punctuation">#</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span> Object.wait<span class="token punctuation">}</span>. 
        */</span>  
       <span class="token constant">BLOCKED</span><span class="token punctuation">,</span>  
     
       <span class="token doc-comment comment">/** 
        * Thread state for a waiting thread. 
        * A thread is in the waiting state due to calling one of the  
        * following methods: 
        * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span> 
        *   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token class-name">Object</span><span class="token punctuation">#</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span> Object.wait<span class="token punctuation">}</span> with no timeout<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span> 
        *   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token punctuation">#</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span> Thread.join<span class="token punctuation">}</span> with no timeout<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span> 
        *   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token class-name">LockSupport</span><span class="token punctuation">#</span><span class="token function">park</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span> LockSupport.park<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span> 
        * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span> 
        *  
        * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>A thread in the waiting state is waiting for another thread to 
        * perform a particular action.   
        * 
        * For example, a thread that has called <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tt</span><span class="token punctuation">&gt;</span></span><span class="token code-section"><span class="token line"><span class="token code language-java"><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tt</span><span class="token punctuation">&gt;</span></span> 
        * on an object is waiting for another thread to call  
        * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tt</span><span class="token punctuation">&gt;</span></span><span class="token code-section"><span class="token line"><span class="token code language-java"><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tt</span><span class="token punctuation">&gt;</span></span> or <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tt</span><span class="token punctuation">&gt;</span></span><span class="token code-section"><span class="token line"><span class="token code language-java"><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token function">notifyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tt</span><span class="token punctuation">&gt;</span></span> on  
        * that object. A thread that has called <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tt</span><span class="token punctuation">&gt;</span></span><span class="token code-section"><span class="token line"><span class="token code language-java"><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tt</span><span class="token punctuation">&gt;</span></span>  
        * is waiting for a specified thread to terminate. 
        */</span>  
       <span class="token constant">WAITING</span><span class="token punctuation">,</span>  
         
       <span class="token doc-comment comment">/** 
        * Thread state for a waiting thread with a specified waiting time. 
        * A thread is in the timed waiting state due to calling one of  
        * the following methods with a specified positive waiting time: 
        * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span> 
        *   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token punctuation">#</span><span class="token field">sleep</span></span> Thread.sleep<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span> 
        *   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token class-name">Object</span><span class="token punctuation">#</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span></span> Object.wait<span class="token punctuation">}</span> with timeout<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span> 
        *   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token punctuation">#</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span></span> Thread.join<span class="token punctuation">}</span> with timeout<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span> 
        *   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token class-name">LockSupport</span><span class="token punctuation">#</span><span class="token field">parkNanos</span></span> LockSupport.parkNanos<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>  
        *   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token class-name">LockSupport</span><span class="token punctuation">#</span><span class="token field">parkUntil</span></span> LockSupport.parkUntil<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span> 
        * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span> 
        */</span>  
       <span class="token constant">TIMED_WAITING</span><span class="token punctuation">,</span>  
  
       <span class="token doc-comment comment">/** 
        * Thread state for a terminated thread. 
        * The thread has completed execution. 
        */</span>  
       <span class="token constant">TERMINATED</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>NEW\uFF1A</li></ul><p>\u6BCF\u4E00\u4E2A\u7EBF\u7A0B\uFF0C\u5728\u5806\u5185\u5B58\u4E2D\u90FD\u6709\u4E00\u4E2A\u5BF9\u5E94\u7684Thread\u5BF9\u8C61\u3002Thread t = new Thread();\u5F53\u521A\u521A\u5728\u5806\u5185\u5B58\u4E2D\u521B\u5EFAThread\u5BF9\u8C61\uFF0C\u8FD8\u6CA1\u6709\u8C03\u7528t.start()\u65B9\u6CD5\u4E4B\u524D\uFF0C\u7EBF\u7A0B\u5C31\u5904\u5728NEW\u72B6\u6001\u3002\u5728\u8FD9\u4E2A\u72B6\u6001\u4E0A\uFF0C\u7EBF\u7A0B\u4E0E\u666E\u901A\u7684java\u5BF9\u8C61\u6CA1\u6709\u4EC0\u4E48\u533A\u522B\uFF0C\u5C31\u4EC5\u4EC5\u662F\u4E00\u4E2A\u5806\u5185\u5B58\u4E2D\u7684\u5BF9\u8C61\u3002</p><ul><li>RUNNABLE\uFF1A</li></ul><p>\u8BE5\u72B6\u6001\u8868\u793A\u7EBF\u7A0B\u5177\u5907\u6240\u6709\u8FD0\u884C\u6761\u4EF6\uFF0C\u5728\u8FD0\u884C\u961F\u5217\u4E2D\u51C6\u5907\u64CD\u4F5C\u7CFB\u7EDF\u7684\u8C03\u5EA6\uFF0C\u6216\u8005\u6B63\u5728\u8FD0\u884C\u3002 \u8FD9\u4E2A\u72B6\u6001\u7684\u7EBF\u7A0B\u6BD4\u8F83\u6B63\u5E38\uFF0C\u4F46\u5982\u679C\u7EBF\u7A0B\u957F\u65F6\u95F4\u505C\u7559\u5728\u5728\u8FD9\u4E2A\u72B6\u6001\u5C31\u4E0D\u6B63\u5E38\u4E86\uFF0C\u8FD9\u8BF4\u660E\u7EBF\u7A0B\u8FD0\u884C\u7684\u65F6\u95F4\u5F88\u957F\uFF08\u5B58\u5728\u6027\u80FD\u95EE\u9898\uFF09\uFF0C\u6216\u8005\u662F\u7EBF\u7A0B\u4E00\u76F4\u5F97\u4E0D\u5F97\u6267\u884C\u7684\u673A\u4F1A\uFF08\u5B58\u5728\u7EBF\u7A0B\u9965\u997F\u7684\u95EE\u9898\uFF09\u3002</p><ul><li>BLOCKED\uFF1A</li></ul><p>\u7EBF\u7A0B\u6B63\u5728\u7B49\u5F85\u83B7\u53D6java\u5BF9\u8C61\u7684\u76D1\u89C6\u5668(\u4E5F\u53EB\u5185\u7F6E\u9501)\uFF0C\u5373\u7EBF\u7A0B\u6B63\u5728\u7B49\u5F85\u8FDB\u5165\u7531synchronized\u4FDD\u62A4\u7684\u65B9\u6CD5\u6216\u8005\u4EE3\u7801\u5757\u3002synchronized\u7528\u6765\u4FDD\u8BC1\u539F\u5B50\u6027\uFF0C\u4EFB\u610F\u65F6\u523B\u6700\u591A\u53EA\u80FD\u7531\u4E00\u4E2A\u7EBF\u7A0B\u8FDB\u5165\u8BE5\u4E34\u754C\u533A\u57DF\uFF0C\u5176\u4ED6\u7EBF\u7A0B\u53EA\u80FD\u6392\u961F\u7B49\u5F85\u3002</p><ul><li>WAITING\uFF1A</li></ul><p>\u5904\u5728\u8BE5\u7EBF\u7A0B\u7684\u72B6\u6001\uFF0C\u6B63\u5728\u7B49\u5F85\u67D0\u4E2A\u4E8B\u4EF6\u7684\u53D1\u751F\uFF0C\u53EA\u6709\u7279\u5B9A\u7684\u6761\u4EF6\u6EE1\u8DB3\uFF0C\u624D\u80FD\u83B7\u5F97\u6267\u884C\u673A\u4F1A\u3002\u800C\u4EA7\u751F\u8FD9\u4E2A\u7279\u5B9A\u7684\u4E8B\u4EF6\uFF0C\u901A\u5E38\u90FD\u662F\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u3002\u4E5F\u5C31\u662F\u8BF4\uFF0C\u5982\u679C\u4E0D\u53D1\u751F\u7279\u5B9A\u7684\u4E8B\u4EF6\uFF0C\u90A3\u4E48\u5904\u5728\u8BE5\u72B6\u6001\u7684\u7EBF\u7A0B\u4E00\u76F4\u7B49\u5F85\uFF0C\u4E0D\u80FD\u83B7\u53D6\u6267\u884C\u7684\u673A\u4F1A\u3002\u6BD4\u5982\uFF1A</p><p>A\u7EBF\u7A0B\u8C03\u7528\u4E86obj\u5BF9\u8C61\u7684obj.wait()\u65B9\u6CD5\uFF0C\u5982\u679C\u6CA1\u6709\u7EBF\u7A0B\u8C03\u7528obj.notify\u6216obj.notifyAll\uFF0C\u90A3\u4E48A\u7EBF\u7A0B\u5C31\u6CA1\u6709\u529E\u6CD5\u6062\u590D\u8FD0\u884C\uFF1B \u5982\u679CA\u7EBF\u7A0B\u8C03\u7528\u4E86LockSupport.park()\uFF0C\u6CA1\u6709\u522B\u7684\u7EBF\u7A0B\u8C03\u7528LockSupport.unpark(A)\uFF0C\u90A3\u4E48A\u6CA1\u6709\u529E\u6CD5\u6062\u590D\u8FD0\u884C\u3002 TIMED_WAITING\uFF1A</p><p>J.U.C\u4E2D\u5F88\u591A\u4E0E\u7EBF\u7A0B\u76F8\u5173\u7C7B\uFF0C\u90FD\u63D0\u4F9B\u4E86\u9650\u65F6\u7248\u672C\u548C\u4E0D\u9650\u65F6\u7248\u672C\u7684API\u3002TIMED_WAITING\u610F\u5473\u7740\u7EBF\u7A0B\u8C03\u7528\u4E86\u9650\u65F6\u7248\u672C\u7684API\uFF0C\u6B63\u5728\u7B49\u5F85\u65F6\u95F4\u6D41\u901D\u3002\u5F53\u7B49\u5F85\u65F6\u95F4\u8FC7\u53BB\u540E\uFF0C\u7EBF\u7A0B\u4E00\u6837\u53EF\u4EE5\u6062\u590D\u8FD0\u884C\u3002\u5982\u679C\u7EBF\u7A0B\u8FDB\u5165\u4E86WAITING\u72B6\u6001\uFF0C\u4E00\u5B9A\u8981\u7279\u5B9A\u7684\u4E8B\u4EF6\u53D1\u751F\u624D\u80FD\u6062\u590D\u8FD0\u884C\uFF1B\u800C\u5904\u5728TIMED_WAITING\u7684\u7EBF\u7A0B\uFF0C\u5982\u679C\u7279\u5B9A\u7684\u4E8B\u4EF6\u53D1\u751F\u6216\u8005\u662F\u65F6\u95F4\u6D41\u901D\u5B8C\u6BD5\uFF0C\u90FD\u4F1A\u6062\u590D\u8FD0\u884C\u3002</p><ul><li>TERMINATED\uFF1A</li></ul><p>\u7EBF\u7A0B\u6267\u884C\u5B8C\u6BD5\uFF0C\u6267\u884C\u5B8Crun\u65B9\u6CD5\u6B63\u5E38\u8FD4\u56DE\uFF0C\u6216\u8005\u629B\u51FA\u4E86\u8FD0\u884C\u65F6\u5F02\u5E38\u800C\u7ED3\u675F\uFF0C\u7EBF\u7A0B\u90FD\u4F1A\u505C\u7559\u5728\u8FD9\u4E2A\u72B6\u6001\u3002\u8FD9\u4E2A\u65F6\u5019\u7EBF\u7A0B\u53EA\u5269\u4E0BThread\u5BF9\u8C61\u4E86\uFF0C\u6CA1\u6709\u4EC0\u4E48\u7528\u4E86\u3002</p><h3 id="_2-3-\u5173\u952E\u72B6\u6001\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#_2-3-\u5173\u952E\u72B6\u6001\u5206\u6790" aria-hidden="true">#</a> 2.3 \u5173\u952E\u72B6\u6001\u5206\u6790</h3><ul><li><strong>Wait on condition</strong>\uFF1AThe thread is either sleeping or waiting to be notified by another thread.</li></ul><p>\u8BE5\u72B6\u6001\u8BF4\u660E\u5B83\u5728\u7B49\u5F85\u53E6\u4E00\u4E2A\u6761\u4EF6\u7684\u53D1\u751F\uFF0C\u6765\u628A\u81EA\u5DF1\u5524\u9192\uFF0C\u6216\u8005\u5E72\u8106\u5B83\u662F\u8C03\u7528\u4E86 sleep(n)\u3002</p><p>\u6B64\u65F6\u7EBF\u7A0B\u72B6\u6001\u5927\u81F4\u4E3A\u4EE5\u4E0B\u51E0\u79CD\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>java.lang.Thread.State: WAITING <span class="token punctuation">(</span>parking<span class="token punctuation">)</span>\uFF1A\u4E00\u76F4\u7B49\u90A3\u4E2A\u6761\u4EF6\u53D1\u751F\uFF1B
java.lang.Thread.State: TIMED_WAITING <span class="token punctuation">(</span>parking\u6216sleeping<span class="token punctuation">)</span>\uFF1A\u5B9A\u65F6\u7684\uFF0C\u90A3\u4E2A\u6761\u4EF6\u4E0D\u5230\u6765\uFF0C\u4E5F\u5C06\u5B9A\u65F6\u5524\u9192\u81EA\u5DF1\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>Waiting for Monitor Entry \u548C in Object.wait()</strong>\uFF1AThe thread is waiting to get the lock for an object (some other thread may be holding the lock). This happens if two or more threads try to execute synchronized code. Note that the lock is always for an object and not for individual methods.</li></ul><p>\u5728\u591A\u7EBF\u7A0B\u7684JAVA\u7A0B\u5E8F\u4E2D\uFF0C\u5B9E\u73B0\u7EBF\u7A0B\u4E4B\u95F4\u7684\u540C\u6B65\uFF0C\u5C31\u8981\u8BF4\u8BF4 Monitor\u3002<strong>Monitor\u662FJava\u4E2D\u7528\u4EE5\u5B9E\u73B0\u7EBF\u7A0B\u4E4B\u95F4\u7684\u4E92\u65A5\u4E0E\u534F\u4F5C\u7684\u4E3B\u8981\u624B\u6BB5\uFF0C\u5B83\u53EF\u4EE5\u770B\u6210\u662F\u5BF9\u8C61\u6216\u8005Class\u7684\u9501\u3002\u6BCF\u4E00\u4E2A\u5BF9\u8C61\u90FD\u6709\uFF0C\u4E5F\u4EC5\u6709\u4E00\u4E2A Monitor</strong> \u3002\u4E0B\u9762\u8FD9\u4E2A\u56FE\uFF0C\u63CF\u8FF0\u4E86\u7EBF\u7A0B\u548C Monitor\u4E4B\u95F4\u5173\u7CFB\uFF0C\u4EE5\u53CA\u7EBF\u7A0B\u7684\u72B6\u6001\u8F6C\u6362\u56FE\uFF1A</p><p><img src="https://abelsun-1256449468.cos.ap-beijing.myqcloud.com/image/image-20220825223611520.png" alt="image-20220825223611520"></p><p>\u5982\u4E0A\u56FE\uFF0C\u6BCF\u4E2AMonitor\u5728\u67D0\u4E2A\u65F6\u523B\uFF0C\u53EA\u80FD\u88AB\u4E00\u4E2A\u7EBF\u7A0B\u62E5\u6709\uFF0C<strong>\u8BE5\u7EBF\u7A0B\u5C31\u662F \u201CActiveThread\u201D\uFF0C\u800C\u5176\u5B83\u7EBF\u7A0B\u90FD\u662F \u201CWaiting Thread\u201D\uFF0C\u5206\u522B\u5728\u4E24\u4E2A\u961F\u5217\u201CEntry Set\u201D\u548C\u201CWait Set\u201D\u91CC\u7B49\u5019</strong>\u3002\u5728\u201CEntry Set\u201D\u4E2D\u7B49\u5F85\u7684\u7EBF\u7A0B\u72B6\u6001\u662F\u201CWaiting for monitor entry\u201D\uFF0C\u800C\u5728\u201CWait Set\u201D\u4E2D\u7B49\u5F85\u7684\u7EBF\u7A0B\u72B6\u6001\u662F\u201Cin Object.wait()\u201D\u3002</p><p>\u5148\u770B\u201CEntry Set\u201D\u91CC\u9762\u7684\u7EBF\u7A0B\u3002\u6211\u4EEC\u79F0\u88AB synchronized\u4FDD\u62A4\u8D77\u6765\u7684\u4EE3\u7801\u6BB5\u4E3A\u4E34\u754C\u533A\u3002<strong>\u5F53\u4E00\u4E2A\u7EBF\u7A0B\u7533\u8BF7\u8FDB\u5165\u4E34\u754C\u533A\u65F6\uFF0C\u5B83\u5C31\u8FDB\u5165\u4E86\u201CEntry Set\u201D\u961F\u5217</strong>\u3002\u5BF9\u5E94\u7684 code\u5C31\u50CF\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">synchronized</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>

  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u65F6\u6709\u4E24\u79CD\u53EF\u80FD\u6027\uFF1A</p><ul><li>\u8BE5 monitor\u4E0D\u88AB\u5176\u5B83\u7EBF\u7A0B\u62E5\u6709\uFF0C Entry Set\u91CC\u9762\u4E5F\u6CA1\u6709\u5176\u5B83\u7B49\u5F85\u7EBF\u7A0B\u3002\u672C\u7EBF\u7A0B\u5373\u6210\u4E3A\u76F8\u5E94\u7C7B\u6216\u8005\u5BF9\u8C61\u7684 Monitor\u7684 Owner\uFF0C\u6267\u884C\u4E34\u754C\u533A\u7684\u4EE3\u7801\u3002</li><li>\u8BE5 monitor\u88AB\u5176\u5B83\u7EBF\u7A0B\u62E5\u6709\uFF0C\u672C\u7EBF\u7A0B\u5728 Entry Set\u961F\u5217\u4E2D\u7B49\u5F85\u3002</li></ul><p>\u5728\u7B2C\u4E00\u79CD\u60C5\u51B5\u4E0B\uFF0C\u7EBF\u7A0B\u5C06\u5904\u4E8E \u201CRunnable\u201D\u7684\u72B6\u6001\uFF0C\u800C\u7B2C\u4E8C\u79CD\u60C5\u51B5\u4E0B\uFF0C\u7EBF\u7A0B DUMP\u4F1A\u663E\u793A\u5904\u4E8E \u201Cwaiting for monitor entry\u201D\u3002\u5982\u4E0B\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token string">&quot;Thread-0&quot;</span> <span class="token assign-left variable">prio</span><span class="token operator">=</span><span class="token number">10</span> <span class="token assign-left variable">tid</span><span class="token operator">=</span>0x08222eb0 <span class="token assign-left variable">nid</span><span class="token operator">=</span>0x9 waiting <span class="token keyword">for</span> monitor entry <span class="token punctuation">[</span>0xf927b000<span class="token punctuation">..</span>0xf927bdb8<span class="token punctuation">]</span> 
at testthread.WaitThread.run<span class="token punctuation">(</span>WaitThread.java:39<span class="token punctuation">)</span> 
- waiting to lock <span class="token operator">&lt;</span>0xef63bf0<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span> <span class="token punctuation">(</span>a java.lang.Object<span class="token punctuation">)</span> 
- locked <span class="token operator">&lt;</span>0xef63beb<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span> <span class="token punctuation">(</span>a java.util.ArrayList<span class="token punctuation">)</span> 
at java.lang.Thread.run<span class="token punctuation">(</span>Thread.java:595<span class="token punctuation">)</span> 

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u4E34\u754C\u533A\u7684\u8BBE\u7F6E\uFF0C\u662F\u4E3A\u4E86\u4FDD\u8BC1\u5176\u5185\u90E8\u7684\u4EE3\u7801\u6267\u884C\u7684\u539F\u5B50\u6027\u548C\u5B8C\u6574\u6027</strong>\u3002\u4F46\u662F\u56E0\u4E3A\u4E34\u754C\u533A\u5728\u4EFB\u4F55\u65F6\u95F4\u53EA\u5141\u8BB8\u7EBF\u7A0B\u4E32\u884C\u901A\u8FC7\uFF0C\u8FD9\u548C\u6211\u4EEC\u591A\u7EBF\u7A0B\u7684\u7A0B\u5E8F\u7684\u521D\u8877\u662F\u76F8\u53CD\u7684\u3002<strong>\u5982\u679C\u5728\u591A\u7EBF\u7A0B\u7684\u7A0B\u5E8F\u4E2D\uFF0C\u5927\u91CF\u4F7F\u7528 synchronized\uFF0C\u6216\u8005\u4E0D\u9002\u5F53\u7684\u4F7F\u7528\u4E86\u5B83\uFF0C\u4F1A\u9020\u6210\u5927\u91CF\u7EBF\u7A0B\u5728\u4E34\u754C\u533A\u7684\u5165\u53E3\u7B49\u5F85\uFF0C\u9020\u6210\u7CFB\u7EDF\u7684\u6027\u80FD\u5927\u5E45\u4E0B\u964D</strong>\u3002\u5982\u679C\u5728\u7EBF\u7A0B DUMP\u4E2D\u53D1\u73B0\u4E86\u8FD9\u4E2A\u60C5\u51B5\uFF0C\u5E94\u8BE5\u5BA1\u67E5\u6E90\u7801\uFF0C\u6539\u8FDB\u7A0B\u5E8F\u3002</p><p>\u518D\u770B\u201CWait Set\u201D\u91CC\u9762\u7684\u7EBF\u7A0B\u3002<strong>\u5F53\u7EBF\u7A0B\u83B7\u5F97\u4E86 Monitor\uFF0C\u8FDB\u5165\u4E86\u4E34\u754C\u533A\u4E4B\u540E\uFF0C\u5982\u679C\u53D1\u73B0\u7EBF\u7A0B\u7EE7\u7EED\u8FD0\u884C\u7684\u6761\u4EF6\u6CA1\u6709\u6EE1\u8DB3\uFF0C\u5B83\u5219\u8C03\u7528\u5BF9\u8C61\uFF08\u4E00\u822C\u5C31\u662F\u88AB synchronized \u7684\u5BF9\u8C61\uFF09\u7684 wait() \u65B9\u6CD5\uFF0C\u653E\u5F03 Monitor\uFF0C\u8FDB\u5165 \u201CWait Set\u201D\u961F\u5217\u3002\u53EA\u6709\u5F53\u522B\u7684\u7EBF\u7A0B\u5728\u8BE5\u5BF9\u8C61\u4E0A\u8C03\u7528\u4E86 notify() \u6216\u8005 notifyAll()\uFF0C\u201CWait Set\u201D\u961F\u5217\u4E2D\u7EBF\u7A0B\u624D\u5F97\u5230\u673A\u4F1A\u53BB\u7ADE\u4E89</strong>\uFF0C\u4F46\u662F\u53EA\u6709\u4E00\u4E2A\u7EBF\u7A0B\u83B7\u5F97\u5BF9\u8C61\u7684Monitor\uFF0C\u6062\u590D\u5230\u8FD0\u884C\u6001\u3002\u5728 \u201CWait Set\u201D\u4E2D\u7684\u7EBF\u7A0B\uFF0C DUMP\u4E2D\u8868\u73B0\u4E3A\uFF1A in Object.wait()\u3002\u5982\u4E0B\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token string">&quot;Thread-1&quot;</span> <span class="token assign-left variable">prio</span><span class="token operator">=</span><span class="token number">10</span> <span class="token assign-left variable">tid</span><span class="token operator">=</span>0x08223250 <span class="token assign-left variable">nid</span><span class="token operator">=</span>0xa <span class="token keyword">in</span> Object.wait<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>0xef47a000<span class="token punctuation">..</span>0xef47aa38<span class="token punctuation">]</span> 
 at java.lang.Object.wait<span class="token punctuation">(</span>Native Method<span class="token punctuation">)</span> 
 - waiting on <span class="token operator">&lt;</span>0xef63beb<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span> <span class="token punctuation">(</span>a java.util.ArrayList<span class="token punctuation">)</span> 
 at java.lang.Object.wait<span class="token punctuation">(</span>Object.java:474<span class="token punctuation">)</span> 
 at testthread.MyWaitThread.run<span class="token punctuation">(</span>MyWaitThread.java:40<span class="token punctuation">)</span> 
 - locked <span class="token operator">&lt;</span>0xef63beb<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span> <span class="token punctuation">(</span>a java.util.ArrayList<span class="token punctuation">)</span> 
 at java.lang.Thread.run<span class="token punctuation">(</span>Thread.java:595<span class="token punctuation">)</span> 
\u7EFC\u4E0A\uFF0C\u4E00\u822CCPU\u5F88\u5FD9\u65F6\uFF0C\u5219\u5173\u6CE8runnable\u7684\u7EBF\u7A0B\uFF0CCPU\u5F88\u95F2\u65F6\uFF0C\u5219\u5173\u6CE8waiting <span class="token keyword">for</span> monitor entry\u7684\u7EBF\u7A0B\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>JDK 5.0 \u7684 Lock</strong></li></ul><p>\u4E0A\u9762\u63D0\u5230\u5982\u679C synchronized\u548C monitor\u673A\u5236\u8FD0\u7528\u4E0D\u5F53\uFF0C\u53EF\u80FD\u4F1A\u9020\u6210\u591A\u7EBF\u7A0B\u7A0B\u5E8F\u7684\u6027\u80FD\u95EE\u9898\u3002\u5728 JDK 5.0\u4E2D\uFF0C\u5F15\u5165\u4E86 Lock\u673A\u5236\uFF0C\u4ECE\u800C\u4F7F\u5F00\u53D1\u8005\u80FD\u66F4\u7075\u6D3B\u7684\u5F00\u53D1\u9AD8\u6027\u80FD\u7684\u5E76\u53D1\u591A\u7EBF\u7A0B\u7A0B\u5E8F\uFF0C\u53EF\u4EE5\u66FF\u4EE3\u4EE5\u5F80 JDK\u4E2D\u7684 synchronized\u548C Monitor\u7684 \u673A\u5236\u3002\u4F46\u662F\uFF0C<strong>\u8981\u6CE8\u610F\u7684\u662F\uFF0C\u56E0\u4E3A Lock\u7C7B\u53EA\u662F\u4E00\u4E2A\u666E\u901A\u7C7B\uFF0CJVM\u65E0\u4ECE\u5F97\u77E5 Lock\u5BF9\u8C61\u7684\u5360\u7528\u60C5\u51B5\uFF0C\u6240\u4EE5\u5728\u7EBF\u7A0B DUMP\u4E2D\uFF0C\u4E5F\u4E0D\u4F1A\u5305\u542B\u5173\u4E8E Lock\u7684\u4FE1\u606F</strong>\uFF0C \u5173\u4E8E\u6B7B\u9501\u7B49\u95EE\u9898\uFF0C\u5C31\u4E0D\u5982\u7528 synchronized\u7684\u7F16\u7A0B\u65B9\u5F0F\u5BB9\u6613\u8BC6\u522B\u3002</p><h3 id="_2-4-\u5173\u952E\u72B6\u6001\u793A\u4F8B" tabindex="-1"><a class="header-anchor" href="#_2-4-\u5173\u952E\u72B6\u6001\u793A\u4F8B" aria-hidden="true">#</a> 2.4 \u5173\u952E\u72B6\u6001\u793A\u4F8B</h3><h4 id="_2-4-1-\u663E\u793Ablocked\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#_2-4-1-\u663E\u793Ablocked\u72B6\u6001" aria-hidden="true">#</a> 2.4.1 <strong>\u663E\u793ABLOCKED\u72B6\u6001</strong></h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">jstack</span><span class="token punctuation">;</span>  

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BlockedState</span>  
<span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Object</span> object <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>  
    <span class="token punctuation">{</span>  
        <span class="token class-name">Runnable</span> task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  

            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
            <span class="token punctuation">{</span>  
                <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>object<span class="token punctuation">)</span>  
                <span class="token punctuation">{</span>  
                    <span class="token keyword">long</span> begin <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
                    <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

                    <span class="token comment">// \u8BA9\u7EBF\u7A0B\u8FD0\u884C5\u5206\u949F,\u4F1A\u4E00\u76F4\u6301\u6709object\u7684\u76D1\u89C6\u5668  </span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>end <span class="token operator">-</span> begin<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span>  
                    <span class="token punctuation">{</span>  
  
                    <span class="token punctuation">}</span>  
                <span class="token punctuation">}</span>  
            <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span><span class="token punctuation">;</span>  

        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token string">&quot;t1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token string">&quot;t2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span> 

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5148\u83B7\u53D6object\u7684\u7EBF\u7A0B\u4F1A\u6267\u884C5\u5206\u949F\uFF0C<strong>\u8FD95\u5206\u949F\u5185\u4F1A\u4E00\u76F4\u6301\u6709object\u7684\u76D1\u89C6\u5668\uFF0C\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u65E0\u6CD5\u6267\u884C\u5904\u5728BLOCKED\u72B6\u6001</strong>\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Full</span> thread dump <span class="token class-name">Java</span> <span class="token class-name">HotSpot</span><span class="token punctuation">(</span><span class="token constant">TM</span><span class="token punctuation">)</span> <span class="token class-name">Server</span> <span class="token constant">VM</span> <span class="token punctuation">(</span><span class="token number">20.12</span><span class="token operator">-</span>b01 mixed mode<span class="token punctuation">)</span><span class="token operator">:</span>  
  
<span class="token string">&quot;DestroyJavaVM&quot;</span> prio<span class="token operator">=</span><span class="token number">6</span> tid<span class="token operator">=</span><span class="token number">0x00856c00</span> nid<span class="token operator">=</span><span class="token number">0x1314</span> waiting on condition <span class="token punctuation">[</span><span class="token number">0x00000000</span><span class="token punctuation">]</span>  
<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Thread<span class="token punctuation">.</span>State</span><span class="token operator">:</span> <span class="token constant">RUNNABLE</span>  

<span class="token string">&quot;t2&quot;</span> prio<span class="token operator">=</span><span class="token number">6</span> tid<span class="token operator">=</span><span class="token number">0x27d7a800</span> nid<span class="token operator">=</span><span class="token number">0x1350</span> waiting <span class="token keyword">for</span> monitor entry <span class="token punctuation">[</span><span class="token number">0x2833f000</span><span class="token punctuation">]</span>  
<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Thread<span class="token punctuation">.</span>State</span><span class="token operator">:</span> <span class="token constant">BLOCKED</span> <span class="token punctuation">(</span>on object monitor<span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">jstack<span class="token punctuation">.</span></span>BlockedState</span>$<span class="token number">1.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">BlockedState</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">17</span><span class="token punctuation">)</span>  
     <span class="token operator">-</span> waiting <span class="token keyword">to</span> <span class="token namespace">lock</span> <span class="token generics"><span class="token punctuation">&lt;</span>0x1cfcdc00<span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>a <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Thread</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">662</span><span class="token punctuation">)</span>  

<span class="token string">&quot;t1&quot;</span> prio<span class="token operator">=</span><span class="token number">6</span> tid<span class="token operator">=</span><span class="token number">0x27d79400</span> nid<span class="token operator">=</span><span class="token number">0x1338</span> runnable <span class="token punctuation">[</span><span class="token number">0x282ef000</span><span class="token punctuation">]</span>  
 <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Thread<span class="token punctuation">.</span>State</span><span class="token operator">:</span> <span class="token constant">RUNNABLE</span>  
     at <span class="token class-name"><span class="token namespace">jstack<span class="token punctuation">.</span></span>BlockedState</span>$<span class="token number">1.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">BlockedState</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">22</span><span class="token punctuation">)</span>  
     <span class="token operator">-</span> locked <span class="token generics"><span class="token punctuation">&lt;</span>0x1cfcdc00<span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>a <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Thread</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">662</span><span class="token punctuation">)</span>
 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u901A\u8FC7thread dump\u53EF\u4EE5\u770B\u5230\uFF1A<strong>t2\u7EBF\u7A0B\u786E\u5B9E\u5904\u5728BLOCKED (on object monitor)\u3002waiting for monitor entry \u7B49\u5F85\u8FDB\u5165synchronized\u4FDD\u62A4\u7684\u533A\u57DF</strong>\u3002</p><h4 id="_2-4-2-\u663E\u793Awaiting\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#_2-4-2-\u663E\u793Awaiting\u72B6\u6001" aria-hidden="true">#</a> 2.4.2 <strong>\u663E\u793AWAITING\u72B6\u6001</strong></h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">jstack</span><span class="token punctuation">;</span>  
  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WaitingState</span>  
<span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Object</span> object <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>  
    <span class="token punctuation">{</span>  
        <span class="token class-name">Runnable</span> task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  

            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
            <span class="token punctuation">{</span>  
                <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>object<span class="token punctuation">)</span>  
                <span class="token punctuation">{</span>  
                    <span class="token keyword">long</span> begin <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                    <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

                    <span class="token comment">// \u8BA9\u7EBF\u7A0B\u8FD0\u884C5\u5206\u949F,\u4F1A\u4E00\u76F4\u6301\u6709object\u7684\u76D1\u89C6\u5668  </span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>end <span class="token operator">-</span> begin<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span>  
                    <span class="token punctuation">{</span>  
                        <span class="token keyword">try</span>  
                        <span class="token punctuation">{</span>  
                            <span class="token comment">// \u8FDB\u5165\u7B49\u5F85\u7684\u540C\u65F6,\u4F1A\u8FDB\u5165\u91CA\u653E\u76D1\u89C6\u5668  </span>
                            object<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span>  
                        <span class="token punctuation">{</span>  
                            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                        <span class="token punctuation">}</span>  
                    <span class="token punctuation">}</span>  
                <span class="token punctuation">}</span>  
            <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span><span class="token punctuation">;</span>  

        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token string">&quot;t1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token string">&quot;t2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Full</span> thread dump <span class="token class-name">Java</span> <span class="token class-name">HotSpot</span><span class="token punctuation">(</span><span class="token constant">TM</span><span class="token punctuation">)</span> <span class="token class-name">Server</span> <span class="token constant">VM</span> <span class="token punctuation">(</span><span class="token number">20.12</span><span class="token operator">-</span>b01 mixed mode<span class="token punctuation">)</span><span class="token operator">:</span>  

<span class="token string">&quot;DestroyJavaVM&quot;</span> prio<span class="token operator">=</span><span class="token number">6</span> tid<span class="token operator">=</span><span class="token number">0x00856c00</span> nid<span class="token operator">=</span><span class="token number">0x1734</span> waiting on condition <span class="token punctuation">[</span><span class="token number">0x00000000</span><span class="token punctuation">]</span>  
<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Thread<span class="token punctuation">.</span>State</span><span class="token operator">:</span> <span class="token constant">RUNNABLE</span>  

<span class="token string">&quot;t2&quot;</span> prio<span class="token operator">=</span><span class="token number">6</span> tid<span class="token operator">=</span><span class="token number">0x27d7e000</span> nid<span class="token operator">=</span><span class="token number">0x17f4</span> in <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">0x2833f000</span><span class="token punctuation">]</span>  
<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Thread<span class="token punctuation">.</span>State</span><span class="token operator">:</span> <span class="token constant">WAITING</span> <span class="token punctuation">(</span>on object monitor<span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token class-name">Native</span> <span class="token class-name">Method</span><span class="token punctuation">)</span>  
     <span class="token operator">-</span> waiting on <span class="token generics"><span class="token punctuation">&lt;</span>0x1cfcdc00<span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>a <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">485</span><span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">jstack<span class="token punctuation">.</span></span>WaitingState</span>$<span class="token number">1.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">WaitingState</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">26</span><span class="token punctuation">)</span>  
     <span class="token operator">-</span> locked <span class="token generics"><span class="token punctuation">&lt;</span>0x1cfcdc00<span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>a <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Thread</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">662</span><span class="token punctuation">)</span>  

<span class="token string">&quot;t1&quot;</span> prio<span class="token operator">=</span><span class="token number">6</span> tid<span class="token operator">=</span><span class="token number">0x27d7d400</span> nid<span class="token operator">=</span><span class="token number">0x17f0</span> in <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">0x282ef000</span><span class="token punctuation">]</span>  
<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Thread<span class="token punctuation">.</span>State</span><span class="token operator">:</span> <span class="token constant">WAITING</span> <span class="token punctuation">(</span>on object monitor<span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token class-name">Native</span> <span class="token class-name">Method</span><span class="token punctuation">)</span>  
     <span class="token operator">-</span> waiting on <span class="token generics"><span class="token punctuation">&lt;</span>0x1cfcdc00<span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>a <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">485</span><span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">jstack<span class="token punctuation">.</span></span>WaitingState</span>$<span class="token number">1.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">WaitingState</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">26</span><span class="token punctuation">)</span>  
     <span class="token operator">-</span> locked <span class="token generics"><span class="token punctuation">&lt;</span>0x1cfcdc00<span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>a <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Thread</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">662</span><span class="token punctuation">)</span>  

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u53D1\u73B0t1\u548Ct2\u90FD\u5904\u5728WAITING (on object monitor)\uFF0C\u8FDB\u5165\u7B49\u5F85\u72B6\u6001\u7684\u539F\u56E0\u662F\u8C03\u7528\u4E86in Object.wait()\u3002\u901A\u8FC7J.U.C\u5305\u4E0B\u7684\u9501\u548C\u6761\u4EF6\u961F\u5217\uFF0C\u4E5F\u662F\u8FD9\u4E2A\u6548\u679C\uFF0C\u5927\u5BB6\u53EF\u4EE5\u81EA\u5DF1\u5B9E\u8DF5\u4E0B\u3002</p><h4 id="_2-4-3-\u663E\u793Atimed-waiting\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#_2-4-3-\u663E\u793Atimed-waiting\u72B6\u6001" aria-hidden="true">#</a> 2.4.3 <strong>\u663E\u793ATIMED_WAITING\u72B6\u6001</strong></h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">jstack</span><span class="token punctuation">;</span>  

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">TimeUnit</span></span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span></span><span class="token class-name">Condition</span></span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span></span><span class="token class-name">Lock</span></span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span></span><span class="token class-name">ReentrantLock</span></span><span class="token punctuation">;</span>  
  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TimedWaitingState</span>  
<span class="token punctuation">{</span>  
    <span class="token comment">// java\u7684\u663E\u793A\u9501,\u7C7B\u4F3Cjava\u5BF9\u8C61\u5185\u7F6E\u7684\u76D1\u89C6\u5668  </span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Lock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token comment">// \u9501\u5173\u8054\u7684\u6761\u4EF6\u961F\u5217(\u7C7B\u4F3C\u4E8Eobject.wait)  </span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Condition</span> condition <span class="token operator">=</span> lock<span class="token punctuation">.</span><span class="token function">newCondition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>  
    <span class="token punctuation">{</span>  
        <span class="token class-name">Runnable</span> task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  

            <span class="token annotation punctuation">@Override</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
            <span class="token punctuation">{</span>  
                <span class="token comment">// \u52A0\u9501,\u8FDB\u5165\u4E34\u754C\u533A  </span>
                lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
                <span class="token keyword">try</span>  
                <span class="token punctuation">{</span>  
                    condition<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MINUTES</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span>  
                <span class="token punctuation">{</span>  
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token punctuation">}</span>  
  
                <span class="token comment">// \u89E3\u9501,\u9000\u51FA\u4E34\u754C\u533A  </span>
                lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span><span class="token punctuation">;</span>  
  
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token string">&quot;t1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token string">&quot;t2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Full</span> thread dump <span class="token class-name">Java</span> <span class="token class-name">HotSpot</span><span class="token punctuation">(</span><span class="token constant">TM</span><span class="token punctuation">)</span> <span class="token class-name">Server</span> <span class="token constant">VM</span> <span class="token punctuation">(</span><span class="token number">20.12</span><span class="token operator">-</span>b01 mixed mode<span class="token punctuation">)</span><span class="token operator">:</span>  

<span class="token string">&quot;DestroyJavaVM&quot;</span> prio<span class="token operator">=</span><span class="token number">6</span> tid<span class="token operator">=</span><span class="token number">0x00856c00</span> nid<span class="token operator">=</span><span class="token number">0x169c</span> waiting on condition <span class="token punctuation">[</span><span class="token number">0x00000000</span><span class="token punctuation">]</span>  
<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Thread<span class="token punctuation">.</span>State</span><span class="token operator">:</span> <span class="token constant">RUNNABLE</span>  

<span class="token string">&quot;t2&quot;</span> prio<span class="token operator">=</span><span class="token number">6</span> tid<span class="token operator">=</span><span class="token number">0x27d7d800</span> nid<span class="token operator">=</span><span class="token number">0xc30</span> waiting on condition <span class="token punctuation">[</span><span class="token number">0x2833f000</span><span class="token punctuation">]</span>  
<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Thread<span class="token punctuation">.</span>State</span><span class="token operator">:</span> <span class="token constant">TIMED_WAITING</span> <span class="token punctuation">(</span>parking<span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Unsafe</span><span class="token punctuation">.</span><span class="token function">park</span><span class="token punctuation">(</span><span class="token class-name">Native</span> <span class="token class-name">Method</span><span class="token punctuation">)</span>  
     <span class="token operator">-</span> parking <span class="token keyword">to</span> <span class="token namespace">wait</span> <span class="token keyword">for</span>  <span class="token generics"><span class="token punctuation">&lt;</span>0x1cfce5b8<span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>a <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span></span>AbstractQueuedSynchronizer</span>$<span class="token class-name">ConditionObject</span><span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span></span>LockSupport</span><span class="token punctuation">.</span><span class="token function">parkNanos</span><span class="token punctuation">(</span><span class="token class-name">LockSupport</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">196</span><span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span></span>AbstractQueuedSynchronizer</span>$<span class="token class-name">ConditionObject</span><span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token class-name">AbstractQueuedSynchronizer</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2116</span><span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">jstack<span class="token punctuation">.</span></span>TimedWaitingState</span>$<span class="token number">1.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">TimedWaitingState</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">28</span><span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Thread</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">662</span><span class="token punctuation">)</span>  

<span class="token string">&quot;t1&quot;</span> prio<span class="token operator">=</span><span class="token number">6</span> tid<span class="token operator">=</span><span class="token number">0x280d0c00</span> nid<span class="token operator">=</span><span class="token number">0x16e0</span> waiting on condition <span class="token punctuation">[</span><span class="token number">0x282ef000</span><span class="token punctuation">]</span>  
<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Thread<span class="token punctuation">.</span>State</span><span class="token operator">:</span> <span class="token constant">TIMED_WAITING</span> <span class="token punctuation">(</span>parking<span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Unsafe</span><span class="token punctuation">.</span><span class="token function">park</span><span class="token punctuation">(</span><span class="token class-name">Native</span> <span class="token class-name">Method</span><span class="token punctuation">)</span>  
     <span class="token operator">-</span> parking <span class="token keyword">to</span> <span class="token namespace">wait</span> <span class="token keyword">for</span>  <span class="token generics"><span class="token punctuation">&lt;</span>0x1cfce5b8<span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>a <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span></span>AbstractQueuedSynchronizer</span>$<span class="token class-name">ConditionObject</span><span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span></span>LockSupport</span><span class="token punctuation">.</span><span class="token function">parkNanos</span><span class="token punctuation">(</span><span class="token class-name">LockSupport</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">196</span><span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span></span>AbstractQueuedSynchronizer</span>$<span class="token class-name">ConditionObject</span><span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token class-name">AbstractQueuedSynchronizer</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2116</span><span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">jstack<span class="token punctuation">.</span></span>TimedWaitingState</span>$<span class="token number">1.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">TimedWaitingState</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">28</span><span class="token punctuation">)</span>  
     at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Thread</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">662</span><span class="token punctuation">)</span>  

  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u770B\u5230t1\u548Ct2\u7EBF\u7A0B\u90FD\u5904\u5728java.lang.Thread.State: TIMED_WAITING (parking)\uFF0C\u8FD9\u4E2Aparking\u4EE3\u8868\u662F\u8C03\u7528\u7684JUC\u4E0B\u7684\u5DE5\u5177\u7C7B\uFF0C\u800C\u4E0D\u662Fjava\u9ED8\u8BA4\u7684\u76D1\u89C6\u5668\u3002</p><h2 id="_3-\u6848\u4F8B\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#_3-\u6848\u4F8B\u5206\u6790" aria-hidden="true">#</a> 3. \u6848\u4F8B\u5206\u6790</h2><h3 id="_3-1-\u95EE\u9898\u573A\u666F" tabindex="-1"><a class="header-anchor" href="#_3-1-\u95EE\u9898\u573A\u666F" aria-hidden="true">#</a> 3.1 \u95EE\u9898\u573A\u666F</h3><ul><li><strong>CPU\u98D9\u9AD8\uFF0Cload\u9AD8\uFF0C\u54CD\u5E94\u5F88\u6162</strong><ol><li>\u4E00\u4E2A\u8BF7\u6C42\u8FC7\u7A0B\u4E2D\u591A\u6B21dump\uFF1B</li><li>\u5BF9\u6BD4\u591A\u6B21dump\u6587\u4EF6\u7684runnable\u7EBF\u7A0B\uFF0C\u5982\u679C\u6267\u884C\u7684\u65B9\u6CD5\u6709\u6BD4\u8F83\u5927\u53D8\u5316\uFF0C\u8BF4\u660E\u6BD4\u8F83\u6B63\u5E38\u3002\u5982\u679C\u5728\u6267\u884C\u540C\u4E00\u4E2A\u65B9\u6CD5\uFF0C\u5C31\u6709\u4E00\u4E9B\u95EE\u9898\u4E86\uFF1B</li></ol></li><li><strong>\u67E5\u627E\u5360\u7528CPU\u6700\u591A\u7684\u7EBF\u7A0B</strong><ol><li>\u4F7F\u7528\u547D\u4EE4\uFF1Atop -H -p pid\uFF08pid\u4E3A\u88AB\u6D4B\u7CFB\u7EDF\u7684\u8FDB\u7A0B\u53F7\uFF09\uFF0C\u627E\u5230\u5BFC\u81F4CPU\u9AD8\u7684\u7EBF\u7A0BID\uFF0C\u5BF9\u5E94thread dump\u4FE1\u606F\u4E2D\u7EBF\u7A0B\u7684nid\uFF0C\u53EA\u4E0D\u8FC7\u4E00\u4E2A\u662F\u5341\u8FDB\u5236\uFF0C\u4E00\u4E2A\u662F\u5341\u516D\u8FDB\u5236\uFF1B</li><li>\u5728thread dump\u4E2D\uFF0C\u6839\u636Etop\u547D\u4EE4\u67E5\u627E\u7684\u7EBF\u7A0Bid\uFF0C\u67E5\u627E\u5BF9\u5E94\u7684\u7EBF\u7A0B\u5806\u6808\u4FE1\u606F\uFF1B</li></ol></li><li><strong>CPU\u4F7F\u7528\u7387\u4E0D\u9AD8\u4F46\u662F\u54CD\u5E94\u5F88\u6162</strong></li></ul><p>\u8FDB\u884Cdump\uFF0C\u67E5\u770B\u662F\u5426\u6709\u5F88\u591Athread struck\u5728\u4E86i/o\u3001\u6570\u636E\u5E93\u7B49\u5730\u65B9\uFF0C\u5B9A\u4F4D\u74F6\u9888\u539F\u56E0\uFF1B</p><ul><li><strong>\u8BF7\u6C42\u65E0\u6CD5\u54CD\u5E94</strong></li></ul><p>\u591A\u6B21dump\uFF0C\u5BF9\u6BD4\u662F\u5426\u6240\u6709\u7684runnable\u7EBF\u7A0B\u90FD\u4E00\u76F4\u5728\u6267\u884C\u76F8\u540C\u7684\u65B9\u6CD5\uFF0C\u5982\u679C\u662F\u7684\uFF0C\u606D\u559C\u4F60\uFF0C\u9501\u4F4F\u4E86\uFF01</p><h3 id="_3-2-\u6B7B\u9501" tabindex="-1"><a class="header-anchor" href="#_3-2-\u6B7B\u9501" aria-hidden="true">#</a> 3.2 \u6B7B\u9501</h3><p>\u6B7B\u9501\u7ECF\u5E38\u8868\u73B0\u4E3A\u7A0B\u5E8F\u7684\u505C\u987F\uFF0C\u6216\u8005\u4E0D\u518D\u54CD\u5E94\u7528\u6237\u7684\u8BF7\u6C42\u3002\u4ECE\u64CD\u4F5C\u7CFB\u7EDF\u4E0A\u89C2\u5BDF\uFF0C\u5BF9\u5E94\u8FDB\u7A0B\u7684CPU\u5360\u7528\u7387\u4E3A\u96F6\uFF0C\u5F88\u5FEB\u4F1A\u4ECEtop\u6216prstat\u7684\u8F93\u51FA\u4E2D\u6D88\u5931\u3002</p><p>\u6BD4\u5982\u5728\u4E0B\u9762\u8FD9\u4E2A\u793A\u4F8B\u4E2D\uFF0C\u662F\u4E2A\u8F83\u4E3A\u5178\u578B\u7684\u6B7B\u9501\u60C5\u51B5\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token string">&quot;Thread-1&quot;</span> prio<span class="token operator">=</span><span class="token number">5</span> tid<span class="token operator">=</span><span class="token number">0x00acc490</span> nid<span class="token operator">=</span><span class="token number">0xe50</span> waiting <span class="token keyword">for</span> monitor entry <span class="token punctuation">[</span><span class="token number">0x02d3f000</span> 
<span class="token punctuation">.</span><span class="token number">.0</span>x02d3fd68<span class="token punctuation">]</span> 
at <span class="token class-name"><span class="token namespace">deadlockthreads<span class="token punctuation">.</span></span>TestThread</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">TestThread</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">31</span><span class="token punctuation">)</span> 
<span class="token operator">-</span> waiting <span class="token keyword">to</span> <span class="token namespace">lock</span> <span class="token generics"><span class="token punctuation">&lt;</span>0x22c19f18<span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>a <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">)</span> 
<span class="token operator">-</span> locked <span class="token generics"><span class="token punctuation">&lt;</span>0x22c19f20<span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>a <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">)</span> 

<span class="token string">&quot;Thread-0&quot;</span> prio<span class="token operator">=</span><span class="token number">5</span> tid<span class="token operator">=</span><span class="token number">0x00accdb0</span> nid<span class="token operator">=</span><span class="token number">0xdec</span> waiting <span class="token keyword">for</span> monitor entry <span class="token punctuation">[</span><span class="token number">0x02cff000</span> 
<span class="token punctuation">.</span><span class="token number">.0</span>x02cff9e8<span class="token punctuation">]</span> 
at <span class="token class-name"><span class="token namespace">deadlockthreads<span class="token punctuation">.</span></span>TestThread</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">TestThread</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">31</span><span class="token punctuation">)</span> 
<span class="token operator">-</span> waiting <span class="token keyword">to</span> <span class="token namespace">lock</span> <span class="token generics"><span class="token punctuation">&lt;</span>0x22c19f20<span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>a <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">)</span> 
<span class="token operator">-</span> locked <span class="token generics"><span class="token punctuation">&lt;</span>0x22c19f18<span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>a <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">)</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728 JAVA 5\u4E2D\u52A0\u5F3A\u4E86\u5BF9\u6B7B\u9501\u7684\u68C0\u6D4B\u3002<strong>\u7EBF\u7A0B Dump\u4E2D\u53EF\u4EE5\u76F4\u63A5\u62A5\u544A\u51FA Java\u7EA7\u522B\u7684\u6B7B\u9501</strong>\uFF0C\u5982\u4E0B\u6240\u793A\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Found</span> one <span class="token class-name">Java</span><span class="token operator">-</span>level deadlock<span class="token operator">:</span> 
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span> 
<span class="token string">&quot;Thread-1&quot;</span><span class="token operator">:</span> 
waiting <span class="token keyword">to</span> <span class="token namespace">lock</span> monitor <span class="token number">0x0003f334</span> <span class="token punctuation">(</span>object <span class="token number">0x22c19f18</span><span class="token punctuation">,</span> a <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
which is held by <span class="token string">&quot;Thread-0&quot;</span> 

<span class="token string">&quot;Thread-0&quot;</span><span class="token operator">:</span> 
waiting <span class="token keyword">to</span> <span class="token namespace">lock</span> monitor <span class="token number">0x0003f314</span> <span class="token punctuation">(</span>object <span class="token number">0x22c19f20</span><span class="token punctuation">,</span> a <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
which is held by <span class="token string">&quot;Thread-1&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-\u70ED\u9501" tabindex="-1"><a class="header-anchor" href="#_3-3-\u70ED\u9501" aria-hidden="true">#</a> 3.3 \u70ED\u9501</h3><p>\u70ED\u9501\uFF0C\u4E5F\u5F80\u5F80\u662F\u5BFC\u81F4\u7CFB\u7EDF\u6027\u80FD\u74F6\u9888\u7684\u4E3B\u8981\u56E0\u7D20\u3002\u5176\u8868\u73B0\u7279\u5F81\u4E3A\uFF1A<strong>\u7531\u4E8E\u591A\u4E2A\u7EBF\u7A0B\u5BF9\u4E34\u754C\u533A\uFF0C\u6216\u8005\u9501\u7684\u7ADE\u4E89</strong>\uFF0C\u53EF\u80FD\u51FA\u73B0\uFF1A</p><ul><li><strong>\u9891\u7E41\u7684\u7EBF\u7A0B\u7684\u4E0A\u4E0B\u6587\u5207\u6362</strong>\uFF1A\u4ECE\u64CD\u4F5C\u7CFB\u7EDF\u5BF9\u7EBF\u7A0B\u7684\u8C03\u5EA6\u6765\u770B\uFF0C\u5F53\u7EBF\u7A0B\u5728\u7B49\u5F85\u8D44\u6E90\u800C\u963B\u585E\u7684\u65F6\u5019\uFF0C\u64CD\u4F5C\u7CFB\u7EDF\u4F1A\u5C06\u4E4B\u5207\u6362\u51FA\u6765\uFF0C\u653E\u5230\u7B49\u5F85\u7684\u961F\u5217\uFF0C\u5F53\u7EBF\u7A0B\u83B7\u5F97\u8D44\u6E90\u4E4B\u540E\uFF0C\u8C03\u5EA6\u7B97\u6CD5\u4F1A\u5C06\u8FD9\u4E2A\u7EBF\u7A0B\u5207\u6362\u8FDB\u53BB\uFF0C\u653E\u5230\u6267\u884C\u961F\u5217\u4E2D\u3002</li><li><strong>\u5927\u91CF\u7684\u7CFB\u7EDF\u8C03\u7528</strong>\uFF1A\u56E0\u4E3A\u7EBF\u7A0B\u7684\u4E0A\u4E0B\u6587\u5207\u6362\uFF0C\u4EE5\u53CA\u70ED\u9501\u7684\u7ADE\u4E89\uFF0C\u6216\u8005\u4E34\u754C\u533A\u7684\u9891\u7E41\u7684\u8FDB\u51FA\uFF0C\u90FD\u53EF\u80FD\u5BFC\u81F4\u5927\u91CF\u7684\u7CFB\u7EDF\u8C03\u7528\u3002</li><li><strong>\u5927\u90E8\u5206CPU\u5F00\u9500\u7528\u5728\u201C\u7CFB\u7EDF\u6001\u201D</strong>\uFF1A\u7EBF\u7A0B\u4E0A\u4E0B\u6587\u5207\u6362\uFF0C\u548C\u7CFB\u7EDF\u8C03\u7528\uFF0C\u90FD\u4F1A\u5BFC\u81F4 CPU\u5728 \u201C\u7CFB\u7EDF\u6001 \u201D\u8FD0\u884C\uFF0C\u6362\u800C\u8A00\u4E4B\uFF0C\u867D\u7136\u7CFB\u7EDF\u5F88\u5FD9\u788C\uFF0C\u4F46\u662FCPU\u7528\u5728 \u201C\u7528\u6237\u6001 \u201D\u7684\u6BD4\u4F8B\u8F83\u5C0F\uFF0C\u5E94\u7528\u7A0B\u5E8F\u5F97\u4E0D\u5230\u5145\u5206\u7684 CPU\u8D44\u6E90\u3002</li><li><strong>\u968F\u7740CPU\u6570\u76EE\u7684\u589E\u591A\uFF0C\u7CFB\u7EDF\u7684\u6027\u80FD\u53CD\u800C\u4E0B\u964D</strong>\u3002\u56E0\u4E3ACPU\u6570\u76EE\u591A\uFF0C\u540C\u65F6\u8FD0\u884C\u7684\u7EBF\u7A0B\u5C31\u8D8A\u591A\uFF0C\u53EF\u80FD\u5C31\u4F1A\u9020\u6210\u66F4\u9891\u7E41\u7684\u7EBF\u7A0B\u4E0A\u4E0B\u6587\u5207\u6362\u548C\u7CFB\u7EDF\u6001\u7684CPU\u5F00\u9500\uFF0C\u4ECE\u800C\u5BFC\u81F4\u66F4\u7CDF\u7CD5\u7684\u6027\u80FD\u3002</li></ul><p>\u4E0A\u9762\u7684\u63CF\u8FF0\uFF0C\u90FD\u662F\u4E00\u4E2A scalability\uFF08\u53EF\u6269\u5C55\u6027\uFF09\u5F88\u5DEE\u7684\u7CFB\u7EDF\u7684\u8868\u73B0\u3002\u4ECE\u6574\u4F53\u7684\u6027\u80FD\u6307\u6807\u770B\uFF0C\u7531\u4E8E\u7EBF\u7A0B\u70ED\u9501\u7684\u5B58\u5728\uFF0C\u7A0B\u5E8F\u7684\u54CD\u5E94\u65F6\u95F4\u4F1A\u53D8\u957F\uFF0C\u541E\u5410\u91CF\u4F1A\u964D\u4F4E\u3002</p><p><strong>\u90A3\u4E48\uFF0C\u600E\u4E48\u53BB\u4E86\u89E3 \u201C\u70ED\u9501 \u201D\u51FA\u73B0\u5728\u4EC0\u4E48\u5730\u65B9\u5462</strong>\uFF1F</p><p>\u4E00\u4E2A\u91CD\u8981\u7684\u65B9\u6CD5\u662F \u7ED3\u5408\u64CD\u4F5C\u7CFB\u7EDF\u7684\u5404\u79CD\u5DE5\u5177\u89C2\u5BDF\u7CFB\u7EDF\u8D44\u6E90\u4F7F\u7528\u72B6\u51B5\uFF0C\u4EE5\u53CA\u6536\u96C6Java\u7EBF\u7A0B\u7684DUMP\u4FE1\u606F\uFF0C\u770B\u7EBF\u7A0B\u90FD\u963B\u585E\u5728\u4EC0\u4E48\u65B9\u6CD5\u4E0A\uFF0C\u4E86\u89E3\u539F\u56E0\uFF0C\u624D\u80FD\u627E\u5230\u5BF9\u5E94\u7684\u89E3\u51B3\u65B9\u6CD5\u3002</p><h2 id="_4-jvm\u91CD\u8981\u7EBF\u7A0B" tabindex="-1"><a class="header-anchor" href="#_4-jvm\u91CD\u8981\u7EBF\u7A0B" aria-hidden="true">#</a> 4. JVM\u91CD\u8981\u7EBF\u7A0B</h2><p>JVM\u8FD0\u884C\u8FC7\u7A0B\u4E2D\u4EA7\u751F\u7684\u4E00\u4E9B\u6BD4\u8F83\u91CD\u8981\u7684\u7EBF\u7A0B\u7F57\u5217\u5982\u4E0B\uFF1A</p><table><thead><tr><th>\u7EBF\u7A0B\u540D\u79F0</th><th>\u89E3\u91CA\u8BF4\u660E</th></tr></thead><tbody><tr><td>Attach Listener</td><td>Attach Listener \u7EBF\u7A0B\u662F\u8D1F\u8D23\u63A5\u6536\u5230\u5916\u90E8\u7684\u547D\u4EE4\uFF0C\u800C\u5BF9\u8BE5\u547D\u4EE4\u8FDB\u884C\u6267\u884C\u7684\u5E76\u628A\u7ED3\u679C\u8FD4\u56DE\u7ED9\u53D1\u9001\u8005\u3002\u901A\u5E38\u6211\u4EEC\u4F1A\u7528\u4E00\u4E9B\u547D\u4EE4\u53BB\u8981\u6C42JVM\u7ED9\u6211\u4EEC\u4E00\u4E9B\u53CD\u9988\u4FE1\u606F\uFF0C\u5982\uFF1Ajava -version\u3001jmap\u3001jstack\u7B49\u7B49\u3002 \u5982\u679C\u8BE5\u7EBF\u7A0B\u5728JVM\u542F\u52A8\u7684\u65F6\u5019\u6CA1\u6709\u521D\u59CB\u5316\uFF0C\u90A3\u4E48\uFF0C\u5219\u4F1A\u5728\u7528\u6237\u7B2C\u4E00\u6B21\u6267\u884CJVM\u547D\u4EE4\u65F6\uFF0C\u5F97\u5230\u542F\u52A8\u3002</td></tr><tr><td>Signal Dispatcher</td><td>\u524D\u9762\u63D0\u5230Attach Listener\u7EBF\u7A0B\u7684\u804C\u8D23\u662F\u63A5\u6536\u5916\u90E8JVM\u547D\u4EE4\uFF0C\u5F53\u547D\u4EE4\u63A5\u6536\u6210\u529F\u540E\uFF0C\u4F1A\u4EA4\u7ED9signal dispather\u7EBF\u7A0B\u53BB\u8FDB\u884C\u5206\u53D1\u5230\u5404\u4E2A\u4E0D\u540C\u7684\u6A21\u5757\u5904\u7406\u547D\u4EE4\uFF0C\u5E76\u4E14\u8FD4\u56DE\u5904\u7406\u7ED3\u679C\u3002signal dispather\u7EBF\u7A0B\u4E5F\u662F\u5728\u7B2C\u4E00\u6B21\u63A5\u6536\u5916\u90E8JVM\u547D\u4EE4\u65F6\uFF0C\u8FDB\u884C\u521D\u59CB\u5316\u5DE5\u4F5C\u3002</td></tr><tr><td>CompilerThread0</td><td>\u7528\u6765\u8C03\u7528JITing\uFF0C\u5B9E\u65F6\u7F16\u8BD1\u88C5\u5378class \u3002 \u901A\u5E38\uFF0CJVM\u4F1A\u542F\u52A8\u591A\u4E2A\u7EBF\u7A0B\u6765\u5904\u7406\u8FD9\u90E8\u5206\u5DE5\u4F5C\uFF0C\u7EBF\u7A0B\u540D\u79F0\u540E\u9762\u7684\u6570\u5B57\u4E5F\u4F1A\u7D2F\u52A0\uFF0C\u4F8B\u5982\uFF1ACompilerThread1\u3002</td></tr><tr><td>Concurrent Mark-Sweep GC Thread</td><td>\u5E76\u53D1\u6807\u8BB0\u6E05\u9664\u5783\u573E\u56DE\u6536\u5668\uFF08\u5C31\u662F\u901A\u5E38\u6240\u8BF4\u7684CMS GC\uFF09\u7EBF\u7A0B\uFF0C \u8BE5\u7EBF\u7A0B\u4E3B\u8981\u9488\u5BF9\u4E8E\u8001\u5E74\u4EE3\u5783\u573E\u56DE\u6536\u3002ps\uFF1A\u542F\u7528\u8BE5\u5783\u573E\u56DE\u6536\u5668\uFF0C\u9700\u8981\u5728JVM\u542F\u52A8\u53C2\u6570\u4E2D\u52A0\u4E0A\uFF1A-XX:+UseConcMarkSweepGC\u3002</td></tr><tr><td>DestroyJavaVM</td><td>\u6267\u884Cmain()\u7684\u7EBF\u7A0B\uFF0C\u5728main\u6267\u884C\u5B8C\u540E\u8C03\u7528JNI\u4E2D\u7684 jni_DestroyJavaVM() \u65B9\u6CD5\u5524\u8D77DestroyJavaVM \u7EBF\u7A0B\uFF0C\u5904\u4E8E\u7B49\u5F85\u72B6\u6001\uFF0C\u7B49\u5F85\u5176\u5B83\u7EBF\u7A0B\uFF08Java\u7EBF\u7A0B\u548CNative\u7EBF\u7A0B\uFF09\u9000\u51FA\u65F6\u901A\u77E5\u5B83\u5378\u8F7DJVM\u3002\u6BCF\u4E2A\u7EBF\u7A0B\u9000\u51FA\u65F6\uFF0C\u90FD\u4F1A\u5224\u65AD\u81EA\u5DF1\u5F53\u524D\u662F\u5426\u662F\u6574\u4E2AJVM\u4E2D\u6700\u540E\u4E00\u4E2A\u975Edeamon\u7EBF\u7A0B\uFF0C\u5982\u679C\u662F\uFF0C\u5219\u901A\u77E5DestroyJavaVM \u7EBF\u7A0B\u5378\u8F7DJVM\u3002</td></tr><tr><td>Finalizer Thread</td><td>\u8FD9\u4E2A\u7EBF\u7A0B\u4E5F\u662F\u5728main\u7EBF\u7A0B\u4E4B\u540E\u521B\u5EFA\u7684\uFF0C\u5176\u4F18\u5148\u7EA7\u4E3A10\uFF0C\u4E3B\u8981\u7528\u4E8E\u5728\u5783\u573E\u6536\u96C6\u524D\uFF0C\u8C03\u7528\u5BF9\u8C61\u7684finalize()\u65B9\u6CD5\uFF1B\u5173\u4E8EFinalizer\u7EBF\u7A0B\u7684\u51E0\u70B9\uFF1A1) \u53EA\u6709\u5F53\u5F00\u59CB\u4E00\u8F6E\u5783\u573E\u6536\u96C6\u65F6\uFF0C\u624D\u4F1A\u5F00\u59CB\u8C03\u7528finalize()\u65B9\u6CD5\uFF1B\u56E0\u6B64\u5E76\u4E0D\u662F\u6240\u6709\u5BF9\u8C61\u7684finalize()\u65B9\u6CD5\u90FD\u4F1A\u88AB\u6267\u884C\uFF1B2) \u8BE5\u7EBF\u7A0B\u4E5F\u662Fdaemon\u7EBF\u7A0B\uFF0C\u56E0\u6B64\u5982\u679C\u865A\u62DF\u673A\u4E2D\u6CA1\u6709\u5176\u4ED6\u975Edaemon\u7EBF\u7A0B\uFF0C\u4E0D\u7BA1\u8BE5\u7EBF\u7A0B\u6709\u6CA1\u6709\u6267\u884C\u5B8Cfinalize()\u65B9\u6CD5\uFF0CJVM\u4E5F\u4F1A\u9000\u51FA\uFF1B3) JVM\u5728\u5783\u573E\u6536\u96C6\u65F6\u4F1A\u5C06\u5931\u53BB\u5F15\u7528\u7684\u5BF9\u8C61\u5305\u88C5\u6210Finalizer\u5BF9\u8C61\uFF08Reference\u7684\u5B9E\u73B0\uFF09\uFF0C\u5E76\u653E\u5165ReferenceQueue\uFF0C\u7531Finalizer\u7EBF\u7A0B\u6765\u5904\u7406\uFF1B\u6700\u540E\u5C06\u8BE5Finalizer\u5BF9\u8C61\u7684\u5F15\u7528\u7F6E\u4E3Anull\uFF0C\u7531\u5783\u573E\u6536\u96C6\u5668\u6765\u56DE\u6536\uFF1B4) JVM\u4E3A\u4EC0\u4E48\u8981\u5355\u72EC\u7528\u4E00\u4E2A\u7EBF\u7A0B\u6765\u6267\u884Cfinalize()\u65B9\u6CD5\u5462\uFF1F\u5982\u679CJVM\u7684\u5783\u573E\u6536\u96C6\u7EBF\u7A0B\u81EA\u5DF1\u6765\u505A\uFF0C\u5F88\u6709\u53EF\u80FD\u7531\u4E8E\u5728finalize()\u65B9\u6CD5\u4E2D\u8BEF\u64CD\u4F5C\u5BFC\u81F4GC\u7EBF\u7A0B\u505C\u6B62\u6216\u4E0D\u53EF\u63A7\uFF0C\u8FD9\u5BF9GC\u7EBF\u7A0B\u6765\u8BF4\u662F\u4E00\u79CD\u707E\u96BE\uFF1B</td></tr><tr><td>Low Memory Detector</td><td>\u8FD9\u4E2A\u7EBF\u7A0B\u662F\u8D1F\u8D23\u5BF9\u53EF\u4F7F\u7528\u5185\u5B58\u8FDB\u884C\u68C0\u6D4B\uFF0C\u5982\u679C\u53D1\u73B0\u53EF\u7528\u5185\u5B58\u4F4E\uFF0C\u5206\u914D\u65B0\u7684\u5185\u5B58\u7A7A\u95F4\u3002</td></tr><tr><td>Reference Handler</td><td>JVM\u5728\u521B\u5EFAmain\u7EBF\u7A0B\u540E\u5C31\u521B\u5EFAReference Handler\u7EBF\u7A0B\uFF0C\u5176\u4F18\u5148\u7EA7\u6700\u9AD8\uFF0C\u4E3A10\uFF0C\u5B83\u4E3B\u8981\u7528\u4E8E\u5904\u7406\u5F15\u7528\u5BF9\u8C61\u672C\u8EAB\uFF08\u8F6F\u5F15\u7528\u3001\u5F31\u5F15\u7528\u3001\u865A\u5F15\u7528\uFF09\u7684\u5783\u573E\u56DE\u6536\u95EE\u9898 \u3002</td></tr><tr><td>VM Thread</td><td>\u8FD9\u4E2A\u7EBF\u7A0B\u5C31\u6BD4\u8F83\u725Bb\u4E86\uFF0C\u662FJVM\u91CC\u9762\u7684\u7EBF\u7A0B\u6BCD\u4F53\uFF0C\u6839\u636Ehotspot\u6E90\u7801\uFF08vmThread.hpp\uFF09\u91CC\u9762\u7684\u6CE8\u91CA\uFF0C\u5B83\u662F\u4E00\u4E2A\u5355\u4E2A\u7684\u5BF9\u8C61\uFF08\u6700\u539F\u59CB\u7684\u7EBF\u7A0B\uFF09\u4F1A\u4EA7\u751F\u6216\u89E6\u53D1\u6240\u6709\u5176\u4ED6\u7684\u7EBF\u7A0B\uFF0C\u8FD9\u4E2A\u5355\u4E2A\u7684VM\u7EBF\u7A0B\u662F\u4F1A\u88AB\u5176\u4ED6\u7EBF\u7A0B\u6240\u4F7F\u7528\u6765\u505A\u4E00\u4E9BVM\u64CD\u4F5C\uFF08\u5982\uFF1A\u6E05\u626B\u5783\u573E\u7B49\uFF09\u3002</td></tr></tbody></table><h2 id="\u53C2\u8003\u6587\u7AE0" tabindex="-1"><a class="header-anchor" href="#\u53C2\u8003\u6587\u7AE0" aria-hidden="true">#</a> \u53C2\u8003\u6587\u7AE0</h2>`,102),u={href:"https://pdai.tech/md/java/jvm/java-jvm-thread-dump.html",target:"_blank",rel:"noopener noreferrer"},r=n("strong",null,"\u8C03\u8BD5\u6392\u9519 - Java \u7EBF\u7A0B\u5206\u6790\u4E4B\u7EBF\u7A0BDump\u5206\u6790",-1);function k(d,v){const s=c("ExternalLinkIcon");return t(),p("div",null,[i,n("p",null,[n("a",u,[r,e(s)])])])}const g=a(l,[["render",k],["__file","java-jvm-thread-dump.html.vue"]]);export{g as default};
