import{_ as o}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as p,c as i,a as n,b as s,d as e,f as t,r as c}from"./app.ca571650.js";const l={},u={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.interpreter",target:"_blank",rel:"noopener noreferrer"},r=t('<h1 id="_1-\u4ECB\u7ECD" tabindex="-1"><a class="header-anchor" href="#_1-\u4ECB\u7ECD" aria-hidden="true">#</a> 1. \u4ECB\u7ECD</h1><p>Filecoin\u662F\u4E00\u4E2A\u57FA\u4E8E\u533A\u5757\u94FE\u673A\u5236\u7684\u5206\u5E03\u5F0F\u5B58\u50A8\u7F51\u7EDC\u3002Filecoin\u77FF\u5DE5\u53EF\u4EE5\u9009\u62E9\u4E3A\u7F51\u7EDC\u63D0\u4F9B\u5B58\u50A8\u5BB9\u91CF\uFF0C\u4ECE\u800C\u901A\u8FC7\u5B9A\u671F\u751F\u6210\u52A0\u5BC6\u8BC1\u660E\u6765\u83B7\u5F97Filecoin\u52A0\u5BC6\u8D27\u5E01(FIL)\u7684\u5355\u4F4D\uFF0C\u8BC1\u660E\u4ED6\u4EEC\u6B63\u5728\u63D0\u4F9B\u6307\u5B9A\u7684\u5BB9\u91CF\u3002\u6B64\u5916\uFF0CFilecoin\u5141\u8BB8\u5404\u65B9\u901A\u8FC7Filecoin\u533A\u5757\u94FE\u4E0A\u7684\u5171\u4EAB\u5206\u7C7B\u8D26\u8BB0\u5F55\u7684\u4EA4\u6613\u6765\u4EA4\u6362Filecoin\u8D27\u5E01\u3002\u7136\u800C\uFF0CFilecoin\u5E76\u6CA1\u6709\u4F7F\u7528\u5DE5\u4F5C\u91CF\u8BC1\u660E\u6765\u7EF4\u62A4\u94FE\u4E0A\u7684\u5171\u8BC6\uFF0C\u800C\u662F\u4F7F\u7528\u4E86\u5B58\u50A8\u8BC1\u660E\u672C\u8EAB:\u4E00\u4E2A\u77FF\u5DE5\u5728\u5171\u8BC6\u534F\u8BAE\u4E2D\u7684\u80FD\u529B\u4E0E\u5B83\u63D0\u4F9B\u7684\u5B58\u50A8\u91CF\u6210\u6BD4\u4F8B\u3002</p><p>Filecoin\u533A\u5757\u94FE\u4E0D\u4EC5\u7EF4\u62A4Filecoin\u4EA4\u6613\u548C\u8D26\u6237\u7684\u5206\u7C7B\u8D26\u672C\uFF0C\u8FD8\u5B9E\u73B0\u4E86Filecoin VM\uFF0C\u8FD9\u662F\u4E00\u4E2A\u53EF\u590D\u5236\u7684\u72B6\u6001\u673A\uFF0C\u5728\u7F51\u7EDC\u4E0A\u7684\u53C2\u4E0E\u8005\u4E4B\u95F4\u6267\u884C\u5404\u79CD\u52A0\u5BC6\u5408\u7EA6\u548C\u5E02\u573A\u673A\u5236\u3002\u8FD9\u4E9B\u5408\u7EA6\u5305\u62EC\u5B58\u50A8\u4EA4\u6613\uFF0C\u5BA2\u6237\u5411\u77FF\u5DE5\u652F\u4ED8FIL\u8D27\u5E01\uFF0C\u4EE5\u6362\u53D6\u5B58\u50A8\u5BA2\u6237\u8BF7\u6C42\u7684\u7279\u5B9A\u6587\u4EF6\u6570\u636E\u3002\u901A\u8FC7Filecoin VM\u7684\u5206\u5E03\u5F0F\u5B9E\u73B0\uFF0C\u5B58\u50A8\u4EA4\u6613\u548C\u5176\u4ED6\u8BB0\u5F55\u5728\u94FE\u4E0A\u7684\u5408\u7EA6\u673A\u5236\u5C06\u968F\u7740\u65F6\u95F4\u7684\u63A8\u79FB\u7EE7\u7EED\u5904\u7406\uFF0C\u800C\u4E0D\u9700\u8981\u539F\u59CB\u5404\u65B9(\u5982\u8BF7\u6C42\u6570\u636E\u5B58\u50A8\u7684\u5BA2\u6237\u7AEF)\u7684\u8FDB\u4E00\u6B65\u4EA4\u4E92\u3002</p><h2 id="_1-2-\u67B6\u6784\u56FE" tabindex="-1"><a class="header-anchor" href="#_1-2-\u67B6\u6784\u56FE" aria-hidden="true">#</a> 1.2 \u67B6\u6784\u56FE</h2><p>Actor\u72B6\u6001\u56FE\uFF1A</p><p><img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gn7sf9164mj31r10u0jza.jpg" alt="image-20210201094233728"></p><h2 id="_1-3-\u5173\u952E\u5185\u5BB9" tabindex="-1"><a class="header-anchor" href="#_1-3-\u5173\u952E\u5185\u5BB9" aria-hidden="true">#</a> 1.3 \u5173\u952E\u5185\u5BB9</h2><ul><li><strong>Data structures</strong>\u662F\u5E26\u6709\u8BED\u4E49\u6807\u8BB0\u7684\u6570\u636E\u6210\u5458(\u4F8B\u5982\uFF0C\u7ED3\u6784\u3001\u63A5\u53E3\u6216\u679A\u4E3E)\u7684\u96C6\u5408\u3002</li><li><strong>Function</strong>\u662F\u4E0D\u4F9D\u8D56\u4E8E\u5916\u90E8\u72B6\u6001\u7684\u8BA1\u7B97\u8FC7\u7A0B(\u4F8B\u5982\uFF0C\u6570\u5B66\u51FD\u6570\u6216\u4E0D\u5F15\u7528\u5168\u5C40\u53D8\u91CF\u7684\u7F16\u7A0B\u8BED\u8A00\u51FD\u6570)</li><li><strong>Components</strong>\u662F\u4E00\u7EC4\u529F\u80FD\uFF0C\u5728\u5B9E\u73B0\u7ED3\u6784\u4E2D\u88AB\u8868\u793A\u4E3A\u5355\u4E2A\u8F6F\u4EF6\u5355\u5143\u3002\u6839\u636E\u8BED\u8A00\u548C\u7279\u5B9A\u7EC4\u4EF6\u7684\u9009\u62E9\uFF0C\u8FD9\u53EF\u80FD\u5BF9\u5E94\u4E8E\u5355\u4E2A\u8F6F\u4EF6\u6A21\u5757\u3001\u8FD0\u884C\u4E3B\u5FAA\u73AF\u7684\u7EBF\u7A0B\u6216\u8FDB\u7A0B\u3001\u78C1\u76D8\u652F\u6301\u7684\u6570\u636E\u5E93\u6216\u5404\u79CD\u5176\u4ED6\u8BBE\u8BA1\u9009\u62E9\u3002\u4F8B\u5982\uFF0CChainSync\u662F\u4E00\u4E2A\u7EC4\u4EF6:\u5B83\u53EF\u4EE5\u88AB\u5B9E\u73B0\u4E3A\u4E00\u4E2A\u8FDB\u7A0B\u6216\u7EBF\u7A0B\u8FD0\u884C\u5355\u4E2A\u6307\u5B9A\u7684\u4E3B\u5FAA\u73AF\uFF0C\u5B83\u7B49\u5F85\u7F51\u7EDC\u6D88\u606F\uFF0C\u5E76\u901A\u8FC7\u8BB0\u5F55\u548C/\u6216\u8F6C\u53D1\u5757\u6570\u636E\u6765\u54CD\u5E94\u3002</li><li><strong>api</strong>\u662F\u5C06\u6D88\u606F\u4F20\u9012\u7ED9\u7EC4\u4EF6\u7684\u63A5\u53E3\u3002\u4E00\u4E2A\u7ED9\u5B9A\u5B50\u534F\u8BAE\u7684\u5BA2\u6237\u7AEF\u89C6\u56FE\uFF0C\u4F8B\u5982\u5411\u4E00\u4E2Aminer\u8282\u70B9\u7684Storage Provider\u7EC4\u4EF6\u8BF7\u6C42\u5728\u5B58\u50A8\u5E02\u573A\u4E2D\u5B58\u50A8\u6587\u4EF6\uFF0C\u53EF\u80FD\u9700\u8981\u6267\u884C\u4E00\u7CFB\u5217\u7684API\u8BF7\u6C42\u3002</li><li><strong>Nodes</strong>\u662F\u4E0E\u534F\u8BAE\u4EA4\u4E92\u7684\u5B8C\u6574\u7684\u8F6F\u4EF6\u548C\u786C\u4EF6\u7CFB\u7EDF\u3002\u4E00\u4E2A\u8282\u70B9\u53EF\u80FD\u4F1A\u4E0D\u65AD\u5730\u8FD0\u884C\u4E0A\u8FF0\u51E0\u4E2A\u7EC4\u4EF6\uFF0C\u53C2\u4E0E\u591A\u4E2A\u5B50\u7CFB\u7EDF\uFF0C\u5E76\u5728\u672C\u5730\u548C/\u6216\u901A\u8FC7\u7F51\u7EDC\u516C\u5F00api\uFF0C\u8FD9\u53D6\u51B3\u4E8E\u8282\u70B9\u914D\u7F6E\u3002\u672F\u8BED\u201C\u5B8C\u6574\u8282\u70B9\u201D\u662F\u6307\u8FD0\u884C\u4E0A\u8FF0\u6240\u6709\u7EC4\u4EF6\u5E76\u652F\u6301\u89C4\u8303\u4E2D\u8BE6\u7EC6\u63CF\u8FF0\u7684\u6240\u6709api\u7684\u7CFB\u7EDF\u3002</li><li><strong>Subsystems</strong>\u662F\u6574\u4E2AFilecoin\u534F\u8BAE\u7684\u6982\u5FF5\u5212\u5206\uFF0C\u8981\u4E48\u662F\u6309\u7167\u5B8C\u6574\u7684\u534F\u8BAE(\u5982\u5B58\u50A8\u5E02\u573A\u6216\u68C0\u7D22\u5E02\u573A)\uFF0C\u8981\u4E48\u662F\u6309\u7167\u529F\u80FD(\u5982VM - Virtual Machine)\u3002\u5B83\u4EEC\u4E0D\u4E00\u5B9A\u5BF9\u5E94\u4E8E\u4EFB\u4F55\u7279\u5B9A\u7684\u8282\u70B9\u6216\u8F6F\u4EF6\u7EC4\u4EF6\u3002</li><li><strong>Actor</strong>\u662F\u4F53\u73B0\u5728Filecoin VM\u72B6\u6001\u4E2D\u7684\u865A\u62DF\u5B9E\u4F53\u3002\u534F\u8BAE\u53C2\u4E0E\u8005\u7C7B\u4F3C\u4E8E\u667A\u80FD\u5408\u7EA6\u7684\u53C2\u4E0E\u8005;\u53C2\u4E0E\u8005\u643A\u5E26FIL\u8D27\u5E01\u4F59\u989D\uFF0C\u5E76\u53EF\u4EE5\u901A\u8FC7VM\u7684\u64CD\u4F5C\u4E0E\u5176\u4ED6\u53C2\u4E0E\u8005\u4EA4\u4E92\uFF0C\u4F46\u5E76\u4E0D\u4E00\u5B9A\u5BF9\u5E94\u4E8E\u4EFB\u4F55\u7279\u5B9A\u7684\u8282\u70B9\u6216\u8F6F\u4EF6\u7EC4\u4EF6\u3002</li></ul><h2 id="_1-4-filecoin-vm" tabindex="-1"><a class="header-anchor" href="#_1-4-filecoin-vm" aria-hidden="true">#</a> 1.4 FileCoin VM</h2><p>Filecoin\u7684\u5927\u591A\u6570\u7528\u6237\u6240\u9762\u5BF9\u7684\u529F\u80FD(\u652F\u4ED8\u3001\u5B58\u50A8\u5E02\u573A\u3001\u80FD\u91CF\u8868\u7B49)\u662F\u901A\u8FC7Filecoin\u865A\u62DF\u673A(Filecoin VM)\u7BA1\u7406\u7684\u3002\u8BE5\u7F51\u7EDC\u751F\u6210\u4E00\u7CFB\u5217\u533A\u5757\uFF0C\u5E76\u540C\u610F\u54EA\u4E2A\u533A\u5757\u94FE\u662F\u6B63\u786E\u7684\u3002\u6BCF\u4E2A\u5757\u5305\u542B\u4E00\u7CFB\u5217\u79F0\u4E3A\u6D88\u606F\u7684\u72B6\u6001\u8F6C\u6362\uFF0C\u4EE5\u53CA\u5E94\u7528\u8FD9\u4E9B\u6D88\u606F\u540E\u7684\u5F53\u524D\u5168\u5C40\u72B6\u6001\u68C0\u67E5\u70B9\u3002</p><p>\u8FD9\u91CC\u7684\u5168\u5C40\u72B6\u6001\u7531\u4E00\u7EC4\u53C2\u4E0E\u8005\uFF08<strong>Actor</strong>\uFF09\u7EC4\u6210\uFF0C\u6BCF\u4E2A\u53C2\u4E0E\u8005\u90FD\u6709\u81EA\u5DF1\u7684\u79C1\u6709\u72B6\u6001\u3002</p><p>\u4E00\u4E2A\u53C2\u4E0E\u8005\u662FFilecoin\u7B49\u4EF7\u4E8E\u4EE5\u592A\u574A\u7684\u667A\u80FD\u5408\u7EA6\uFF0C\u5B83\u672C\u8D28\u4E0A\u662FFilecoin\u7F51\u7EDC\u4E2D\u7684\u4E00\u4E2A\u201C\u5BF9\u8C61\u201D\uFF0C\u5177\u6709\u72B6\u6001\u548C\u4E00\u7EC4\u53EF\u4EE5\u7528\u6765\u4E0E\u4E4B\u4EA4\u4E92\u7684\u65B9\u6CD5\u3002\u6BCF\u4E2A\u53C2\u4E0E\u8005\u90FD\u6709\u4E00\u4E2AFilecoin balance\uFF0C\u4E00\u4E2A\u72B6\u6001\u6307\u9488\uFF0C\u4E00\u4E2A\u4EE3\u7801CID(\u544A\u8BC9\u7CFB\u7EDF\u53C2\u4E0E\u8005\u662F\u4EC0\u4E48\u7C7B\u578B\u7684\u53C2\u4E0E\u8005)\uFF0C\u4EE5\u53CA\u4E00\u4E2Anonce(\u8DDF\u8E2A\u53C2\u4E0E\u8005\u53D1\u9001\u7684\u6D88\u606F\u6570\u91CF)\u3002</p><p>\u5728\u53C2\u4E0E\u8005\u4E0A\u8C03\u7528\u65B9\u6CD5\u6709\u4E24\u79CD\u9014\u5F84\u3002\u9996\u5148\uFF0C\u8981\u4F5C\u4E3A\u7CFB\u7EDF\u7684\u5916\u90E8\u53C2\u4E0E\u8005(\u4E5F\u5C31\u662F\u4F7F\u7528Filecoin\u7684\u666E\u901A\u7528\u6237)\u8C03\u7528\u65B9\u6CD5\uFF0C\u60A8\u5FC5\u987B\u5411\u7F51\u7EDC\u53D1\u9001\u4E00\u4E2A\u7B7E\u540D\u6D88\u606F\uFF0C\u5E76\u5411\u5305\u542B\u60A8\u7684\u6D88\u606F\u7684\u77FF\u5DE5\u652F\u4ED8\u8D39\u7528\u3002\u6D88\u606F\u4E0A\u7684\u7B7E\u540D\u5FC5\u987B\u4E0E\u4E00\u4E2A\u5E10\u6237\u76F8\u5339\u914D\uFF0C\u8BE5\u5E10\u6237\u6709\u8DB3\u591F\u7684Filecoin\u6765\u652F\u4ED8\u6D88\u606F\u7684\u6267\u884C\u8D39\u7528\u3002\u8FD9\u91CC\u7684\u8D39\u7528\u76F8\u5F53\u4E8E\u6BD4\u7279\u5E01\u548C\u4EE5\u592A\u574A\u7684\u4EA4\u6613\u8D39\u7528\uFF0C\u5B83\u4E0E\u5904\u7406\u6D88\u606F\u6240\u505A\u7684\u5DE5\u4F5C\u6210\u6BD4\u4F8B(\u6BD4\u7279\u5E01\u6309\u5B57\u8282\u4E3A\u6D88\u606F\u5B9A\u4EF7\uFF0C\u4EE5\u592A\u574A\u4F7F\u7528\u201Cgas\u201D\u7684\u6982\u5FF5\u3002\u6211\u4EEC\u4E5F\u7528gas)\u3002</p><p>\u5176\u6B21\uFF0C\u53C2\u4E0E\u8005\u53EF\u4EE5\u5728\u8C03\u7528\u5176\u65B9\u6CD5\u4E4B\u4E00\u7684\u8FC7\u7A0B\u4E2D\u8C03\u7528\u53E6\u4E00\u4E2A\u53C2\u4E0E\u8005\u7684\u65B9\u6CD5\u3002\u7136\u800C\uFF0C\u552F\u4E00\u53EF\u80FD\u53D1\u751F\u8FD9\u79CD\u60C5\u51B5\u7684\u65F6\u5019\u662F\u67D0\u4E2A\u53C2\u4E0E\u8005\u88AB\u5916\u90E8\u7528\u6237\u6D88\u606F\u8C03\u7528\u7684\u7ED3\u679C(\u6CE8\u610F:\u7528\u6237\u8C03\u7528\u7684\u53C2\u4E0E\u8005\u53EF\u80FD\u8C03\u7528\u53E6\u4E00\u4E2A\u53C2\u4E0E\u8005\uFF0C\u7136\u540E\u8C03\u7528\u53E6\u4E00\u4E2A\u53C2\u4E0E\u8005\uFF0C\u5728\u6267\u884C\u80FD\u591F\u627F\u53D7\u7684\u5C42\u6B21\u4E0A\u5C3D\u53EF\u80FD\u591A)\u3002</p><p>\u5177\u4F53\u5B9E\u73B0\u8BF7\u53C2\u89C1\u865A\u62DF\u673A\u5B50\u7CFB\u7EDF\u3002</p><h2 id="_1-5-\u7CFB\u7EDF\u5206\u89E3" tabindex="-1"><a class="header-anchor" href="#_1-5-\u7CFB\u7EDF\u5206\u89E3" aria-hidden="true">#</a> 1.5 \u7CFB\u7EDF\u5206\u89E3</h2><h3 id="_1-5-1-\u7CFB\u7EDF\u662F\u4EC0\u4E48-\u5982\u4F55\u5DE5\u4F5C" tabindex="-1"><a class="header-anchor" href="#_1-5-1-\u7CFB\u7EDF\u662F\u4EC0\u4E48-\u5982\u4F55\u5DE5\u4F5C" aria-hidden="true">#</a> 1.5.1 \u7CFB\u7EDF\u662F\u4EC0\u4E48\uFF0C\u5982\u4F55\u5DE5\u4F5C</h3><p>Filecoin\u5C06\u529F\u80FD\u89E3\u8026\u5E76\u6A21\u5757\u5316\u5230\u677E\u6563\u8FDE\u63A5\u7684\u7CFB\u7EDF\u4E2D\u3002\u6BCF\u4E2A\u7CFB\u7EDF\u90FD\u589E\u52A0\u4E86\u91CD\u8981\u7684\u529F\u80FD\uFF0C\u901A\u5E38\u662F\u4E3A\u4E86\u5B9E\u73B0\u4E00\u7EC4\u91CD\u8981\u4E14\u7D27\u5BC6\u76F8\u5173\u7684\u76EE\u6807\u3002</p><p>\u4F8B\u5982\uFF0C\u533A\u5757\u94FE\u7CFB\u7EDF\u63D0\u4F9B\u4E86\u5757\u3001Tipset\u548C\u94FE\u7B49\u7ED3\u6784\uFF0C\u5E76\u63D0\u4F9B\u4E86\u5757\u540C\u6B65\u3001\u5757\u4F20\u64AD\u3001\u5757\u9A8C\u8BC1\u3001\u94FE\u9009\u62E9\u548C\u94FE\u8BBF\u95EE\u7B49\u529F\u80FD\u3002\u8FD9\u4E0E\u6587\u4EF6\u3001\u7247\u6BB5\u3001\u7247\u6BB5\u51C6\u5907\u548C\u6570\u636E\u4F20\u8F93\u662F\u5206\u5F00\u7684\u3002\u8FD9\u4E24\u4E2A\u7CFB\u7EDF\u90FD\u4E0E\u5E02\u573A\u5206\u79BB\uFF0C\u5E02\u573A\u63D0\u4F9B\u8BA2\u5355\u3001\u4EA4\u6613\u3001\u5E02\u573A\u53EF\u89C1\u6027\u548C\u4EA4\u6613\u7ED3\u7B97\u3002</p><h4 id="_1-5-1-1-\u4E3A\u4EC0\u4E48\u7CFB\u7EDF\u89E3\u8026\u6709\u7528" tabindex="-1"><a class="header-anchor" href="#_1-5-1-1-\u4E3A\u4EC0\u4E48\u7CFB\u7EDF\u89E3\u8026\u6709\u7528" aria-hidden="true">#</a> 1.5.1.1 \u4E3A\u4EC0\u4E48\u7CFB\u7EDF\u89E3\u8026\u6709\u7528?</h4><p>\u7406\u7531\u5982\u4E0B\uFF1A</p><ul><li>**\u5B9E\u65BD\u8FB9\u754C\uFF1A**\u53EF\u4EE5\u6784\u5EFA\u4EC5\u5B9E\u65BD\u4E00\u90E8\u5206\u7CFB\u7EDF\u7684Filecoin\u5B9E\u65BD\u3002\u8FD9\u5BF9\u4E8E<em>\u5B9E\u73B0\u591A\u6837\u6027</em>\u7279\u522B\u6709\u7528\uFF1A\u6211\u4EEC\u9700\u8981\u8BB8\u591A\u5B89\u5168\u5173\u952E\u7CFB\u7EDF\uFF08\u4F8B\u5982\uFF0C\u533A\u5757\u94FE\uFF09\u7684\u5B9E\u73B0\uFF0C\u4F46\u4E0D\u9700\u8981\u8BB8\u591A\u53EF\u4EE5\u5206\u79BB\u7684\u7CFB\u7EDF\u5B9E\u73B0\u3002</li><li>**\u8FD0\u884C\u65F6\u89E3\u8026\uFF1A**\u7CFB\u7EDF\u89E3\u8026\u4F7F\u6784\u5EFA\u548C\u8FD0\u884C\u5C06\u7CFB\u7EDF\u9694\u79BB\u5230\u5355\u72EC\u7A0B\u5E8F\u751A\u81F3\u5355\u72EC\u7269\u7406\u8BA1\u7B97\u673A\u4E2D\u7684Filecoin\u8282\u70B9\u53D8\u5F97\u66F4\u52A0\u5BB9\u6613\u3002</li><li>**\u5B89\u5168\u9694\u79BB\uFF1A**\u67D0\u4E9B\u7CFB\u7EDF\u6BD4\u5176\u4ED6\u7CFB\u7EDF\u9700\u8981\u66F4\u9AD8\u7684\u64CD\u4F5C\u5B89\u5168\u6027\u3002\u7CFB\u7EDF\u89E3\u8026\u4F7F\u5B9E\u73B0\u80FD\u591F\u6EE1\u8DB3\u5176\u5B89\u5168\u6027\u548C\u529F\u80FD\u6027\u9700\u6C42\u3002\u4E00\u4E2A\u5F88\u597D\u7684\u4F8B\u5B50\u662F\u5C06\u533A\u5757\u94FE\u5904\u7406\u4E0E\u6570\u636E\u4F20\u8F93\u5206\u5F00\u3002</li><li>**\u53EF\u4F38\u7F29\u6027\uFF1A**\u7CFB\u7EDF\u548C\u5404\u79CD\u7528\u4F8B\u53EF\u80FD\u4F1A\u4E3A\u4E0D\u540C\u7684\u64CD\u4F5C\u5458\u5E26\u6765\u4E0D\u540C\u7684\u6027\u80FD\u8981\u6C42\u3002\u7CFB\u7EDF\u89E3\u8026\u4F7F\u8FD0\u8425\u5546\u66F4\u5BB9\u6613\u6CBF\u7740\u7CFB\u7EDF\u8FB9\u754C\u6269\u5C55\u5176\u90E8\u7F72\u3002</li></ul><h4 id="_1-5-1-2-filecoin-\u8282\u70B9\u4E0D\u9700\u8981\u6240\u6709\u7CFB\u7EDF" tabindex="-1"><a class="header-anchor" href="#_1-5-1-2-filecoin-\u8282\u70B9\u4E0D\u9700\u8981\u6240\u6709\u7CFB\u7EDF" aria-hidden="true">#</a> 1.5.1.2 FileCoin \u8282\u70B9\u4E0D\u9700\u8981\u6240\u6709\u7CFB\u7EDF</h4><ul><li>**\u5B9E\u65BD\u8FB9\u754C\uFF1A**\u53EF\u4EE5\u6784\u5EFA\u4EC5\u5B9E\u65BD\u4E00\u90E8\u5206\u7CFB\u7EDF\u7684Filecoin\u5B9E\u65BD\u3002\u8FD9\u5BF9\u4E8E<em>\u5B9E\u73B0\u591A\u6837\u6027</em>\u7279\u522B\u6709\u7528\uFF1A\u6211\u4EEC\u9700\u8981\u8BB8\u591A\u5B89\u5168\u5173\u952E\u7CFB\u7EDF\uFF08\u4F8B\u5982\uFF0C\u533A\u5757\u94FE\uFF09\u7684\u5B9E\u73B0\uFF0C\u4F46\u4E0D\u9700\u8981\u8BB8\u591A\u53EF\u4EE5\u5206\u79BB\u7684\u7CFB\u7EDF\u5B9E\u73B0\u3002</li><li>**\u8FD0\u884C\u65F6\u89E3\u8026\uFF1A**\u7CFB\u7EDF\u89E3\u8026\u4F7F\u6784\u5EFA\u548C\u8FD0\u884C\u5C06\u7CFB\u7EDF\u9694\u79BB\u5230\u5355\u72EC\u7A0B\u5E8F\u751A\u81F3\u5355\u72EC\u7269\u7406\u8BA1\u7B97\u673A\u4E2D\u7684Filecoin\u8282\u70B9\u53D8\u5F97\u66F4\u52A0\u5BB9\u6613\u3002</li><li>**\u5B89\u5168\u9694\u79BB\uFF1A**\u67D0\u4E9B\u7CFB\u7EDF\u6BD4\u5176\u4ED6\u7CFB\u7EDF\u9700\u8981\u66F4\u9AD8\u7684\u64CD\u4F5C\u5B89\u5168\u6027\u3002\u7CFB\u7EDF\u89E3\u8026\u4F7F\u5B9E\u73B0\u80FD\u591F\u6EE1\u8DB3\u5176\u5B89\u5168\u6027\u548C\u529F\u80FD\u6027\u9700\u6C42\u3002\u4E00\u4E2A\u5F88\u597D\u7684\u4F8B\u5B50\u662F\u5C06\u533A\u5757\u94FE\u5904\u7406\u4E0E\u6570\u636E\u4F20\u8F93\u5206\u5F00\u3002</li><li>**\u53EF\u4F38\u7F29\u6027\uFF1A**\u7CFB\u7EDF\u548C\u5404\u79CD\u7528\u4F8B\u53EF\u80FD\u4F1A\u4E3A\u4E0D\u540C\u7684\u64CD\u4F5C\u5458\u5E26\u6765\u4E0D\u540C\u7684\u6027\u80FD\u8981\u6C42\u3002\u7CFB\u7EDF\u89E3\u8026\u4F7F\u8FD0\u8425\u5546\u66F4\u5BB9\u6613\u6CBF\u7740\u7CFB\u7EDF\u8FB9\u754C\u6269\u5C55\u5176\u90E8\u7F72\u3002</li></ul><h4 id="_1-5-1-3-\u5206\u79BB\u7CFB\u7EDF" tabindex="-1"><a class="header-anchor" href="#_1-5-1-3-\u5206\u79BB\u7CFB\u7EDF" aria-hidden="true">#</a> 1.5.1.3 \u5206\u79BB\u7CFB\u7EDF</h4><blockquote><p>\u6211\u4EEC\u5982\u4F55\u786E\u5B9A\u4E00\u4E2A\u7CFB\u7EDF\u4E0E\u53E6\u4E00\u4E2A\u7CFB\u7EDF\u5C5E\u4E8E\u4EC0\u4E48\u529F\u80FD\uFF1F</p></blockquote><p>\u5728\u7CFB\u7EDF\u4E4B\u95F4\u5212\u5B9A\u754C\u9650\u662F\u5C06\u7D27\u5BC6\u76F8\u5173\u7684\u529F\u80FD\u4E0E\u65E0\u5173\u90E8\u5206\u5206\u5F00\u7684\u6280\u672F\u3002\u4ECE\u67D0\u79CD\u610F\u4E49\u4E0A\u8BF4\uFF0C\u6211\u4EEC\u5BFB\u6C42\u5C06\u7D27\u5BC6\u96C6\u6210\u7684\u7EC4\u4EF6\u4FDD\u7559\u5728\u540C\u4E00\u7CFB\u7EDF\u4E2D\uFF0C\u5E76\u8FDC\u79BB\u5176\u4ED6\u65E0\u5173\u7684\u7EC4\u4EF6\u3002\u6709\u65F6\u8FD9\u5F88\u7B80\u5355\uFF0C\u8FB9\u754C\u81EA\u7136\u662F\u6765\u81EA\u6570\u636E\u7ED3\u6784\u6216\u529F\u80FD\u3002\u4F8B\u5982\uFF0C\u5F88\u5BB9\u6613\u89C2\u5BDF\u5230\uFF0C\u5BA2\u6237\u548C\u77FF\u5DE5\u5F7C\u6B64\u534F\u5546\u4EA4\u6613\u4E0EVM\u6267\u884C\u975E\u5E38\u65E0\u5173\u3002</p><p>\u6709\u65F6\u8FD9\u6BD4\u8F83\u56F0\u96BE\uFF0C\u5E76\u4E14\u9700\u8981\u6574\u7406\uFF0C\u6DFB\u52A0\u6216\u5220\u9664\u62BD\u8C61\u3002\u4F8B\u5982\uFF0C<code>StoragePowerActor</code>\u548C\u548C\u4EE5\u524D<code>StorageMarketActor</code>\u662F\u5355\u4E2A<code>Actor</code>\u3002\u8FD9\u5BFC\u81F4\u4E86\u6574\u4E2A<code>StorageDeal</code>\u751F\u4EA7<code>StorageMarket</code>\u5E02\u573A\uFF0C\u5B58\u50A8\u5E02\u573A\uFF0C\u90E8\u95E8\u5BC6\u5C01\uFF0CPoSt\u751F\u6210\u7B49\u529F\u80FD\u4E4B\u95F4\u7684\u5DE8\u5927\u8026\u5408\u3002\u7EA0\u7ED3\u8FD9\u4E24\u7EC4\u76F8\u5173\u529F\u80FD\u9700\u8981\u5C06\u4E00\u4E2A\u53C2\u4E0E\u8005\u5206\u6210\u4E24\u4E2A\u3002</p><h4 id="_1-5-1-4-\u5728\u7CFB\u7EDF\u5185\u90E8\u5206\u89E3" tabindex="-1"><a class="header-anchor" href="#_1-5-1-4-\u5728\u7CFB\u7EDF\u5185\u90E8\u5206\u89E3" aria-hidden="true">#</a> 1.5.1.4 \u5728\u7CFB\u7EDF\u5185\u90E8\u5206\u89E3</h4><p>\u7CFB\u7EDF\u672C\u8EAB\u5206\u89E3\u4E3A\u8F83\u5C0F\u7684\u5B50\u5355\u5143\u3002\u8FD9\u4E9B\u6709\u65F6\u79F0\u4E3A\u201C\u5B50\u7CFB\u7EDF\u201D\uFF0C\u4EE5\u907F\u514D\u4E0E\u66F4\u5927\u7684\u4E00\u6D41\u7CFB\u7EDF\u6DF7\u6DC6\u3002\u5B50\u7CFB\u7EDF\u672C\u8EAB\u53EF\u80FD\u4F1A\u8FDB\u4E00\u6B65\u5D29\u6E83\u3002\u6B64\u5904\u7684\u547D\u540D\u672A\u4E25\u683C\u6267\u884C\uFF0C\u56E0\u4E3A\u8FD9\u4E9B\u7EC6\u5206\u4E0E\u534F\u8BAE\u548C\u5B9E\u73B0\u5DE5\u7A0B\u65B9\u9762\u7684\u95EE\u9898\u76F8\u6BD4\uFF0C\u4E0E\u7528\u6237\u529F\u80FD\u66F4\u76F8\u5173\u3002</p><h3 id="_1-5-2-\u5B9E\u73B0\u7CFB\u7EDF" tabindex="-1"><a class="header-anchor" href="#_1-5-2-\u5B9E\u73B0\u7CFB\u7EDF" aria-hidden="true">#</a> 1.5.2 \u5B9E\u73B0\u7CFB\u7EDF</h3><h4 id="_1-5-2-1-\u7CFB\u7EDF\u8981\u6C42" tabindex="-1"><a class="header-anchor" href="#_1-5-2-1-\u7CFB\u7EDF\u8981\u6C42" aria-hidden="true">#</a> 1.5.2.1 \u7CFB\u7EDF\u8981\u6C42</h4><p>\u4E3A\u4E86\u66F4\u8F7B\u677E\u5730\u5C06\u529F\u80FD\u5206\u79BB\u5230\u7CFB\u7EDF\u4E2D\uFF0CFilecoin\u534F\u8BAE\u5047\u5B9A\u4E86\u4E00\u7EC4\u53EF\u7528\u4E8E\u6240\u6709\u7CFB\u7EDF\u7684\u529F\u80FD\u3002\u6B64\u529F\u80FD\u53EF\u4EE5\u901A\u8FC7\u5404\u79CD\u65B9\u5F0F\u7684\u5B9E\u73B0\u6765\u5B9E\u73B0\uFF0C\u5E76\u4E14\u5E94\u5C06\u6B64\u5904\u7684\u6307\u5357\u4F5C\u4E3A\u5EFA\u8BAE\uFF08\u5E94\u8BE5\uFF09\u3002</p><p>\u672C\u6587\u6863\u4E2D\u5B9A\u4E49\u7684\u6240\u6709\u7CFB\u7EDF\u90FD\u8981\u6C42\u5177\u5907\u4EE5\u4E0B\u6761\u4EF6\uFF1A</p><ul><li>\u4ED3\u5E93\uFF1A <ul><li>**\u672C\u5730\u7684<code>IpldStore</code>\u3002**\u7528\u4E8E\u6570\u636E\u7ED3\u6784\uFF08\u5C0F\u578B\u7ED3\u6784\u5316\u5BF9\u8C61\uFF09\u7684\u4E00\u5B9A\u6570\u91CF\u7684\u6301\u4E45\u672C\u5730\u5B58\u50A8\u3002\u7CFB\u7EDF\u671F\u671B\u4F7F\u7528IpldStore\u8FDB\u884C\u521D\u59CB\u5316\uFF0C\u5728\u8BE5\u7CFB\u7EDF\u4E2D\u5B58\u50A8\u5B83\u4EEC\u5E0C\u671B\u5728\u5D29\u6E83\u4E2D\u6301\u7EED\u5B58\u5728\u7684\u6570\u636E\u7ED3\u6784\u3002</li><li>**\u7528\u6237\u914D\u7F6E\u503C\u3002**\u5C11\u91CF\u7528\u6237\u53EF\u7F16\u8F91\u7684\u914D\u7F6E\u503C\u3002\u8FD9\u4E9B\u5E94\u8BE5\u4F7F\u6700\u7EC8\u7528\u6237\u6613\u4E8E\u8BBF\u95EE\uFF0C\u67E5\u770B\u548C\u7F16\u8F91\u3002</li><li>**\u672C\u5730\uFF0C\u5B89\u5168<code>KeyStore</code>\u3002**\u7528\u4E8E\u751F\u6210\u548C\u4F7F\u7528\u52A0\u5BC6\u5BC6\u94A5\u7684\u5DE5\u5177\uFF0C\u5FC5\u987B\u5BF9Filecoin\u8282\u70B9\u4FDD\u5BC6\u3002\u7CFB\u7EDF\u4E0D\u5E94\u76F4\u63A5\u8BBF\u95EE\u5BC6\u94A5\uFF0C\u800C\u5E94\u901A\u8FC7<code>KeyStore</code>\u63D0\u4F9B\u52A0\u5BC6\uFF0C\u89E3\u5BC6\uFF0C\u7B7E\u540D\uFF0CSigVerify\u7B49\u529F\u80FD\u7684\u62BD\u8C61\uFF08\u5373\uFF09\u8FDB\u884C\u8BBF\u95EE\u3002</li></ul></li><li>**\u672C\u5730\u7684<code>FileStore</code>\u3002**\u67D0\u4E9B\u6587\u4EF6\u7684\u6301\u4E45\u672C\u5730\u5B58\u50A8\uFF08\u5927\u5B57\u8282\u6570\u7EC4\uFF09\u3002\u7CFB\u7EDF\u671F\u671B\u4F7F\u7528\u5B58\u50A8\u5927\u6587\u4EF6\u7684FileStore\u8FDB\u884C\u521D\u59CB\u5316\u3002\u67D0\u4E9B\u7CFB\u7EDF\uFF08\u4F8B\u5982Markets\uFF09\u53EF\u80FD\u9700\u8981\u5B58\u50A8\u548C\u5220\u9664\u5927\u91CF\u8F83\u5C0F\u7684\u6587\u4EF6\uFF081MB-10GB\uFF09\u3002\u5176\u4ED6\u7CFB\u7EDF\uFF08\u4F8B\u5982\u5B58\u50A8\u6316\u6398\uFF09\u53EF\u80FD\u9700\u8981\u5B58\u50A8\u548C\u5220\u9664\u5927\u91CF\u5927\u6587\u4EF6\uFF081GB-1TB\uFF09\u3002</li><li>**\u7F51\u7EDC\u3002**\u5927\u591A\u6570\u7CFB\u7EDF\u9700\u8981\u8BBF\u95EE\u7F51\u7EDC\uFF0C\u624D\u80FD\u8FDE\u63A5\u5230\u5176\u4ED6Filecoin\u8282\u70B9\u4E2D\u7684\u5BF9\u5E94\u7CFB\u7EDF\u3002\u7CFB\u7EDF\u671F\u671B\u4F7F\u7528\u53EF<code>libp2p.Node</code>\u5728\u5176\u4E0A\u5B89\u88C5\u81EA\u5DF1\u7684\u534F\u8BAE\u7684\u8FDB\u884C\u521D\u59CB\u5316\u3002</li><li>**\u65F6\u949F\u3002**\u6709\u4E9B\u7CFB\u7EDF\u9700\u8981\u8BBF\u95EE\u5F53\u524D\u7684\u7F51\u7EDC\u65F6\u95F4\uFF0C\u800C\u6709\u4E9B\u7CFB\u7EDF\u7684\u6F02\u79FB\u5BB9\u5DEE\u8F83\u4F4E\u3002\u7CFB\u7EDF\u671F\u671B\u4F7F\u7528\u4E00\u4E2A\u65F6\u949F\u6765\u521D\u59CB\u5316\uFF0C\u4EE5\u4ECE\u4E2D\u5F97\u77E5\u7F51\u7EDC\u65F6\u95F4\u3002\u4E00\u4E9B\u7CFB\u7EDF\uFF08\u5982\u533A\u5757\u94FE\uFF09\u9700\u8981\u5F88\u5C11\u7684\u65F6\u949F\u6F02\u79FB\uFF0C\u5E76\u4E14\u9700\u8981<em>\u5B89\u5168\u7684</em>\u65F6\u95F4\u3002</li></ul><p>\u4E3A\u6B64\uFF0C\u6211\u4EEC\u4F7F\u7528<code>FilecoinNode</code>\u6570\u636E\u7ED3\u6784\uFF0C\u8BE5\u6570\u636E\u7ED3\u6784\u5728\u521D\u59CB\u5316\u65F6\u4F20\u9012\u7ED9\u6240\u6709\u7CFB\u7EDF\u3002</p><h4 id="_1-5-2-2\u7CFB\u7EDF\u9650\u5236" tabindex="-1"><a class="header-anchor" href="#_1-5-2-2\u7CFB\u7EDF\u9650\u5236" aria-hidden="true">#</a> 1.5.2.2\u7CFB\u7EDF\u9650\u5236</h4><p>\u6B64\u5916\uFF0C\u7CFB\u7EDF\u5FC5\u987B\u9075\u5B88\u4EE5\u4E0B\u9650\u5236\uFF1A</p><ul><li>**\u968F\u673A\u5D29\u6E83\u3002**Filecoin\u8282\u70B9\u53EF\u80FD\u968F\u65F6\u5D29\u6E83\u3002\u901A\u8FC7\u5D29\u6E83\uFF0C\u7CFB\u7EDF\u5FC5\u987B\u662F\u5B89\u5168\u4E14\u4E00\u81F4\u7684\u3002\u8FD9\u4E3B\u8981\u662F\u901A\u8FC7\u9650\u5236\u6301\u4E45\u72B6\u6001\u7684\u4F7F\u7528\uFF0C\u901A\u8FC7Ipld\u6570\u636E\u7ED3\u6784\u6301\u4E45\u5316\u8FD9\u79CD\u72B6\u6001\uFF0C\u4EE5\u53CA\u901A\u8FC7\u4F7F\u7528\u68C0\u67E5\u72B6\u6001\u7684\u521D\u59CB\u5316\u4F8B\u7A0B\u4EE5\u53CA\u53EF\u80FD\u7EA0\u6B63\u9519\u8BEF\u6765\u5B9E\u73B0\u7684\u3002</li><li>**\u9694\u79BB\u3002**\u7CFB\u7EDF\u5FC5\u987B\u901A\u8FC7\u5B9A\u4E49\u826F\u597D\u7684\u9694\u79BB\u63A5\u53E3\u8FDB\u884C\u901A\u4FE1\u3002\u4ED6\u4EEC\u4E0D\u5F97\u5728\u5171\u4EAB\u5185\u5B58\u7A7A\u95F4\u4E0A\u6784\u5EFA\u5173\u952E\u529F\u80FD\u3002\uFF08\u6CE8\u610F\uFF1A\u4E3A\u4E86\u63D0\u9AD8\u6027\u80FD\uFF0C\u5171\u4EAB\u5185\u5B58\u62BD\u8C61\u53EF\u7528\u4E8E\u4E3AIpldStore\uFF0CFileStore\u548Clibp2p\u4F9B\u7535\uFF0C\u4F46\u662F\u7CFB\u7EDF\u672C\u8EAB\u4E0D\u5E94\u8BE5\u9700\u8981\u5B83\u3002\uFF09\u5B83\u8FD8\u663E\u7740\u7B80\u5316\u4E86\u534F\u8BAE\uFF0C\u5E76\u4F7F\u5176\u66F4\u6613\u4E8E\u7406\u89E3\uFF0C\u5206\u6790\uFF0C\u8C03\u8BD5\u548C\u66F4\u6539\u3002</li><li>**\u65E0\u6CD5\u76F4\u63A5\u8BBF\u95EE\u4E3B\u673A\u64CD\u4F5C\u7CFB\u7EDF\u6587\u4EF6\u7CFB\u7EDF\u6216\u78C1\u76D8\u3002**\u7CFB\u7EDF\u65E0\u6CD5\u76F4\u63A5\u8BBF\u95EE\u78C1\u76D8\uFF0C\u800C\u662F\u901A\u8FC7FileStore\u548CIpldStore\u62BD\u8C61\u6765\u8FDB\u884C\u3002\u8FD9\u5C06\u4E3A\u6700\u7EC8\u7528\u6237\uFF08\u5C24\u5176\u662F\u5B58\u50A8\u77FF\u5DE5\u548C\u5927\u91CF\u6570\u636E\u7684\u5BA2\u6237\u7AEF\uFF09\u63D0\u4F9B\u9AD8\u5EA6\u7684\u53EF\u79FB\u690D\u6027\u548C\u7075\u6D3B\u6027\uFF0C\u8FD9\u9700\u8981\u80FD\u591F\u8F7B\u677E\u66FF\u6362\u5176Filecoin\u8282\u70B9\u8BBF\u95EE\u672C\u5730\u5B58\u50A8\u7684\u65B9\u5F0F\u3002</li><li>**\u4E0D\u80FD\u76F4\u63A5\u8BBF\u95EE\u4E3B\u673AOS\u7F51\u7EDC\u5806\u6808\u6216TCP / IP\u3002**\u7CFB\u7EDF\u65E0\u6CD5\u76F4\u63A5\u8BBF\u95EE\u7F51\u7EDC-\u5B83\u4EEC\u901A\u8FC7libp2p\u5E93\u8FDB\u884C\u8BBF\u95EE\u3002\u4E0D\u5F97\u6709\u4EFB\u4F55\u5176\u4ED6\u7C7B\u578B\u7684\u7F51\u7EDC\u8BBF\u95EE\u3002\u8FD9\u63D0\u4F9B\u4E86\u8DE8\u5E73\u53F0\u548C\u7F51\u7EDC\u534F\u8BAE\u7684\u9AD8\u5EA6\u53EF\u79FB\u690D\u6027\uFF0C\u4F7FFilecoin\u8282\u70B9\uFF08\u53CA\u5176\u6240\u6709\u5173\u952E\u7CFB\u7EDF\uFF09\u53EF\u4EE5\u4F7F\u7528\u5404\u79CD\u534F\u8BAE\uFF08\u4F8B\u5982\u84DD\u7259\uFF0CLAN\u7B49\uFF09\u5728\u591A\u79CD\u8BBE\u7F6E\u4E0B\u8FD0\u884C\u3002</li></ul><h1 id="_2-\u7CFB\u7EDF" tabindex="-1"><a class="header-anchor" href="#_2-\u7CFB\u7EDF" aria-hidden="true">#</a> 2. \u7CFB\u7EDF</h1><p>\u5728\u672C\u8282\u4E2D\uFF0C\u6211\u4EEC\u5C06\u9010\u4E00\u8BE6\u7EC6\u8BF4\u660E\u6240\u6709\u7CFB\u7EDF\u7EC4\u4EF6\uFF0C\u4EE5\u63D0\u9AD8\u5176\u590D\u6742\u6027\u548C/\u6216\u4E0E\u5176\u4ED6\u7CFB\u7EDF\u7EC4\u4EF6\u7684\u76F8\u4E92\u4F9D\u8D56\u6027\u3002\u7EC4\u4EF6\u4E4B\u95F4\u7684\u4EA4\u4E92\u4EC5\u5728\u9002\u5F53\u7684\u5730\u65B9\u7B80\u8981\u8BA8\u8BBA\uFF0C\u4F46\u603B\u4F53\u5DE5\u4F5C\u6D41\u7A0B\u5728\u201C\u7B80\u4ECB\u201D\u90E8\u5206\u7ED9\u51FA\u3002\u7279\u522B\u662F\uFF0C\u5728\u672C\u8282\u4E2D\uFF0C\u6211\u4EEC\u8BA8\u8BBA\uFF1A</p><ul><li>Filecoin\u8282\u70B9\uFF1A\u53C2\u4E0EFilecoin\u7F51\u7EDC\u7684\u4E0D\u540C\u7C7B\u578B\u7684\u8282\u70B9\uFF0C\u4EE5\u53CA\u8FD9\u4E9B\u8282\u70B9\u8FD0\u884C\u7684\u91CD\u8981\u90E8\u5206\u548C\u8FC7\u7A0B\uFF0C\u4F8B\u5982\u5BC6\u94A5\u5E93\u548CIPLD\u5B58\u50A8\uFF0C\u4EE5\u53CAlibp2p\u7684\u7F51\u7EDC\u63A5\u53E3\u3002</li><li>\u6587\u4EF6\u548C\u6570\u636E\uFF1AFilecoin\u7684\u6570\u636E\u5355\u4F4D\uFF0C\u4F8B\u5982\u201C\u90E8\u95E8\u201D\u548C\u201C\u788E\u7247\u201D\u3002</li><li>\u865A\u62DF\u673A\uFF1AFilecoin VM\u7684\u5B50\u7EC4\u4EF6\uFF0C\u4F8B\u5982\u53C2\u4E0E\u8005\uFF0C\u5373\u5728Filecoin\u533A\u5757\u94FE\u4E0A\u8FD0\u884C\u7684\u667A\u80FD\u5408\u7EA6\u548C\u72B6\u6001\u6811\u3002</li><li>\u533A\u5757\u94FE\uFF1AFilecoin\u533A\u5757\u94FE\u7684\u4E3B\u8981\u6784\u5EFA\u5757\uFF0C\u4F8B\u5982\u6D88\u606F\u548C\u5757\u7684\u7ED3\u6784\uFF0C\u6D88\u606F\u6C60\uFF0C\u4EE5\u53CA\u8282\u70B9\u9996\u6B21\u52A0\u5165\u7F51\u7EDC\u65F6\u5982\u4F55\u540C\u6B65\u533A\u5757\u94FE\u3002</li><li>\u4EE4\u724C\uFF1A\u94B1\u5305\u6240\u9700\u7684\u7EC4\u4EF6\u3002</li><li>\u5B58\u50A8\u6316\u6398\uFF1A\u5B58\u50A8\u6316\u6398\u7684\u8BE6\u7EC6\u4FE1\u606F\uFF0C\u5B58\u50A8\u80FD\u529B\u5171\u8BC6\u4EE5\u53CA\u5B58\u50A8\u77FF\u5DE5\u5982\u4F55\u8BC1\u660E\u5B58\u50A8\uFF08\u4E0D\u6D89\u53CA\u8BC1\u660E\u7684\u7EC6\u8282\uFF0C\u8FD9\u5C06\u5728\u540E\u9762\u8BA8\u8BBA\uFF09\u3002</li><li>\u5E02\u573A\uFF1A\u5B58\u50A8\u548C\u68C0\u7D22\u5E02\u573A\uFF0C\u4E3B\u8981\u662F\u8131\u94FE\u7684\u8FC7\u7A0B\uFF0C\u4F46\u5BF9\u4E8E\u5206\u6563\u5B58\u50A8\u5E02\u573A\u7684\u5E73\u7A33\u8FD0\u884C\u975E\u5E38\u91CD\u8981\u3002</li></ul>',42),d={id:"_2-1-filecoin\u8282\u70B9",tabindex:"-1"},k=n("a",{class:"header-anchor",href:"#_2-1-filecoin\u8282\u70B9","aria-hidden":"true"},"#",-1),v={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes",target:"_blank",rel:"noopener noreferrer"},m=n("p",null,[s("\u672C\u8282\u9996\u5148\u8BA8\u8BBAFilecoin\u8282\u70B9\u7684\u6982\u5FF5\u3002\u5C3D\u7BA1\u5728Filecoin\u7684Lotus\u5B9E\u73B0\u4E2D\u4E0D\u50CF\u5728\u5176\u4ED6\u533A\u5757\u94FE\u7F51\u7EDC\u4E2D\u90A3\u6837\u4E25\u683C\u5B9A\u4E49\u4E0D\u540C\u7684\u8282\u70B9\u7C7B\u578B\uFF0C\u4F46\u662F\u4E0D\u540C\u7C7B\u578B\u7684\u8282\u70B9\u5E94\u8BE5\u5B9E\u73B0\u4E0D\u540C\u7684\u5C5E\u6027\u548C\u529F\u80FD\u3002\u7B80\u800C\u8A00\u4E4B\uFF0C\u57FA\u4E8E\u8282\u70B9\u63D0\u4F9B\u7684"),n("em",null,"\u670D\u52A1"),s("\u96C6\u5BF9\u5176\u8FDB\u884C\u5B9A\u4E49\u3002")],-1),b=n("p",null,"\u5728\u672C\u8282\u4E2D\uFF0C\u6211\u4EEC\u8FD8\u5C06\u8BA8\u8BBA\u4E0E\u5728Filecoin\u8282\u70B9\u4E2D\u5B58\u50A8\u7CFB\u7EDF\u6587\u4EF6\u6709\u5173\u7684\u95EE\u9898\u3002\u8BF7\u6CE8\u610F\uFF0C\u5728\u672C\u8282\u4E2D\uFF0C\u901A\u8FC7\u5B58\u50A8\uFF0C\u6211\u4EEC\u4E0D\u662F\u6307\u8282\u70B9\u4E3A\u5728\u7F51\u7EDC\u4E2D\u8FDB\u884C\u6316\u6398\u800C\u63D0\u4EA4\u7684\u5B58\u50A8\uFF0C\u800C\u662F\u6307\u5B83\u9700\u8981\u53EF\u7528\u4E8E\u5BC6\u94A5\u548CIPLD\u6570\u636E\u7684\u672C\u5730\u5B58\u50A8\u5E93\u3002",-1),h=n("p",null,"\u5728\u672C\u8282\u4E2D\uFF0C\u6211\u4EEC\u8FD8\u5C06\u8BA8\u8BBA\u7F51\u7EDC\u63A5\u53E3\u4EE5\u53CA\u8282\u70B9\u4E4B\u95F4\u5982\u4F55\u67E5\u627E\u548C\u8FDE\u63A5\uFF0C\u5982\u4F55\u4F7F\u7528libp2p\u4EA4\u4E92\u548C\u4F20\u64AD\u6D88\u606F\u4EE5\u53CA\u5982\u4F55\u8BBE\u7F6E\u8282\u70B9\u7684\u65F6\u949F\u3002",-1),f={id:"_2-1-1\u8282\u70B9\u7C7B\u578B",tabindex:"-1"},_=n("a",{class:"header-anchor",href:"#_2-1-1\u8282\u70B9\u7C7B\u578B","aria-hidden":"true"},"#",-1),g={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes.node_types",target:"_blank",rel:"noopener noreferrer"},y=t("<p>Filecoin\u7F51\u7EDC\u4E2D\u7684\u8282\u70B9\u4E3B\u8981\u6839\u636E\u5176\u63D0\u4F9B\u7684\u670D\u52A1\u8FDB\u884C\u6807\u8BC6\u3002\u56E0\u6B64\uFF0C\u8282\u70B9\u7684\u7C7B\u578B\u53D6\u51B3\u4E8E\u8282\u70B9\u63D0\u4F9B\u7684\u670D\u52A1\u3002Filecoin\u7F51\u7EDC\u4E2D\u7684\u4E00\u7EC4\u57FA\u672C\u670D\u52A1\u5305\u62EC\uFF1A</p><ul><li>\u94FE\u9A8C\u8BC1</li><li>\u4ED3\u50A8\u5E02\u573A\u5BA2\u6237</li><li>\u5B58\u50A8\u5E02\u573A\u63D0\u4F9B\u5546</li><li>\u68C0\u7D22\u5E02\u573A\u5BA2\u6237</li><li>\u68C0\u7D22\u5E02\u573A\u63D0\u4F9B\u8005</li><li>\u4ED3\u50A8\u91C7\u77FF</li></ul><p>\u53C2\u4E0EFilecoin\u7F51\u7EDC\u7684\u4EFB\u4F55\u8282\u70B9\u90FD\u5E94\u81F3\u5C11\u63D0\u4F9B<em>\u94FE\u9A8C\u8BC1</em>\u670D\u52A1\u3002\u6839\u636E\u8282\u70B9\u5728\u94FE\u9A8C\u8BC1\u4E4B\u4E0A\u63D0\u4F9B\u7684\u989D\u5916\u670D\u52A1\uFF0C\u5B83\u4F1A\u83B7\u5F97\u76F8\u5E94\u7684\u529F\u80FD\u548C\u8282\u70B9\u7C7B\u578B\u201C\u6807\u7B7E\u201D\u3002</p><p>\u53EF\u4EE5\u4F7F\u7528\u4E3B\u673A\u4E2D\u7684\u5B58\u50A8\u5E93\uFF08\u76EE\u5F55\uFF09\u4EE5\u4E00\u5BF9\u4E00\u5173\u7CFB\u5B9E\u73B0\u8282\u70B9-\u5373\uFF0C\u4E00\u4E2A\u5B58\u50A8\u5E93\u5C5E\u4E8E\u5355\u4E2A\u8282\u70B9\u3002\u4E5F\u5C31\u662F\u8BF4\uFF0C\u4E00\u53F0\u4E3B\u673A\u53EF\u4EE5\u901A\u8FC7\u5177\u6709\u76F8\u5E94\u7684\u5B58\u50A8\u5E93\u6765\u5B9E\u73B0\u591A\u4E2AFilecoin\u8282\u70B9\u3002</p><p>Filecoin\u5B9E\u73B0\u53EF\u4EE5\u652F\u6301\u4EE5\u4E0B\u5B50\u7CFB\u7EDF\u6216\u8282\u70B9\u7C7B\u578B\uFF1A</p><ul><li><strong>\u94FE\u9A8C\u8BC1\u5668\u8282\u70B9\uFF1A<strong>\u8FD9\u662F\u8282\u70B9\u52A0\u5165Filecoin\u7F51\u7EDC\u6240\u9700\u7684\u6700\u4F4E\u529F\u80FD\u3002\u9664\u975E\u5B9E\u73B0\u4EE5\u4E0B\u6240\u8FF0\u7684</strong>\u5BA2\u6237\u7AEF\u8282\u70B9</strong>\u529F\u80FD\uFF0C\u5426\u5219\u8FD9\u79CD\u7C7B\u578B\u7684\u8282\u70B9\u65E0\u6CD5\u5728\u7F51\u7EDC\u4E2D\u53D1\u6325\u79EF\u6781\u4F5C\u7528\u3002\u94FE\u9A8C\u8BC1\u5668\u8282\u70B9\u9996\u6B21\u52A0\u5165\u7F51\u7EDC\u65F6\u5FC5\u987B\u540C\u6B65\u94FE\uFF08ChainSync\uFF09\uFF0C\u4EE5\u8FBE\u6210\u5F53\u524D\u5171\u8BC6\u3002\u4ECE\u90A3\u65F6\u8D77\uFF0C\u8BE5\u8282\u70B9\u5FC5\u987B\u4E0D\u65AD\u83B7\u53D6\u94FE\u4E2D\u7684\u4EFB\u4F55\u9644\u52A0\u5185\u5BB9\uFF08\u5373\uFF0C\u63A5\u6536\u6700\u65B0\u7684\u5757\uFF09\u5E76\u9A8C\u8BC1\u5B83\u4EEC\u662F\u5426\u8FBE\u5230\u5171\u8BC6\u72B6\u6001\u3002</li><li><strong>\u5BA2\u6237\u7AEF\u8282\u70B9\uFF1A<strong>\u8FD9\u79CD\u7C7B\u578B\u7684\u8282\u70B9\u5EFA\u7ACB\u5728</strong>Chain Verifier\u8282\u70B9</strong>\u4E4B\u4E0A\uFF0C\u5E76\u4E14\u5FC5\u987B\u7531Filecoin\u7F51\u7EDC\u4E0A\u6784\u5EFA\u7684\u4EFB\u4F55\u5E94\u7528\u7A0B\u5E8F\u6765\u5B9E\u73B0\u3002\u53EF\u4EE5\u5C06\u5176\u89C6\u4E3A\u57FA\u4E8EFilecoin\u7684\u5E94\u7528\u7A0B\u5E8F\uFF08\u4F8B\u5982\u4EA4\u6613\u6240\u6216\u5206\u6563\u5B58\u50A8\u5E94\u7528\u7A0B\u5E8F\uFF09\u7684\u4E3B\u8981\u57FA\u7840\u7ED3\u6784\u8282\u70B9\uFF08\u81F3\u5C11\u5C31\u4E0E\u533A\u5757\u94FE\u7684\u4EA4\u4E92\u800C\u8A00\uFF09\u3002\u8BE5\u8282\u70B9\u5E94\u5B9E\u73B0<em>\u5B58\u50A8\u5E02\u573A\u548C\u68C0\u7D22\u5E02\u573A\u5BA2\u6237</em>\u670D\u52A1\u3002\u5BA2\u6237\u7AEF\u8282\u70B9\u5E94\u4E0E\u5B58\u50A8\u548C\u68C0\u7D22\u5E02\u573A\u8FDB\u884C\u4EA4\u4E92\uFF0C\u5E76\u80FD\u591F\u901A\u8FC7\u6570\u636E\u4F20\u8F93\u6A21\u5757\u8FDB\u884C\u6570\u636E\u4F20\u8F93\u3002</li><li><strong>Retrieval Miner Node\uFF08\u68C0\u7D22\u77FF\u5DE5\u8282\u70B9\uFF09\uFF1A<strong>\u6B64\u8282\u70B9\u7C7B\u578B\u6269\u5C55\u4E86</strong>Chain Verifier\u8282\u70B9</strong>\u4EE5\u6DFB\u52A0<em>\u68C0\u7D22\u77FF\u5DE5</em>\u529F\u80FD\uFF0C\u5373\u53C2\u4E0E\u4E86\u68C0\u7D22\u5E02\u573A\u3002\u8FD9\u6837\uFF0C\u6B64\u8282\u70B9\u7C7B\u578B\u9700\u8981\u5B9E\u73B0<em>\u68C0\u7D22\u5E02\u573A\u63D0\u4F9B\u8005</em>\u670D\u52A1\uFF0C\u5E76\u80FD\u591F\u901A\u8FC7\u6570\u636E\u4F20\u8F93\u6A21\u5757\u8FDB\u884C\u6570\u636E\u4F20\u8F93\u3002</li><li>**Storage Miner Node\uFF1A**\u8FD9\u79CD\u7C7B\u578B\u7684\u8282\u70B9\u5FC5\u987B\u5B9E\u73B0\u9A8C\u8BC1\uFF0C\u521B\u5EFA\u548C\u6DFB\u52A0\u5757\u4EE5\u6269\u5C55\u533A\u5757\u94FE\u6240\u9700\u7684\u6240\u6709\u5FC5\u9700\u529F\u80FD\u3002\u5B83\u5E94\u5B9E\u65BD\u94FE\u9A8C\u8BC1\uFF0C\u5B58\u50A8\u6316\u6398\u548C\u5B58\u50A8\u5E02\u573A\u63D0\u4F9B\u5546\u670D\u52A1\uFF0C\u5E76\u80FD\u591F\u901A\u8FC7\u6570\u636E\u4F20\u8F93\u6A21\u5757\u8FDB\u884C\u6570\u636E\u4F20\u8F93\u3002</li></ul>",6),w={id:"_2-1-1-1\u8282\u70B9\u63A5\u53E3",tabindex:"-1"},x=n("a",{class:"header-anchor",href:"#_2-1-1-1\u8282\u70B9\u63A5\u53E3","aria-hidden":"true"},"#",-1),C={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes.node_types.node-interface",target:"_blank",rel:"noopener noreferrer"},S={href:"https://github.com/filecoin-project/lotus/blob/master/node/repo/interface.go",target:"_blank",rel:"noopener noreferrer"},F={id:"_2-1-1-2\u94FE\u9A8C\u8BC1\u5668\u8282\u70B9",tabindex:"-1"},q=n("a",{class:"header-anchor",href:"#_2-1-1-2\u94FE\u9A8C\u8BC1\u5668\u8282\u70B9","aria-hidden":"true"},"#",-1),P={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes.node_types.chain-verifier-node",target:"_blank",rel:"noopener noreferrer"},A=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> ChainVerifierNode <span class="token keyword">interface</span> <span class="token punctuation">{</span>
  FilecoinNode

  systems<span class="token punctuation">.</span>Blockchain
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),B={href:"https://github.com/filecoin-project/lotus/blob/master/node/impl/full.go",target:"_blank",rel:"noopener noreferrer"},E={id:"_2-1-1-3\u5BA2\u6237\u7AEF\u8282\u70B9",tabindex:"-1"},T=n("a",{class:"header-anchor",href:"#_2-1-1-3\u5BA2\u6237\u7AEF\u8282\u70B9","aria-hidden":"true"},"#",-1),I={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes.node_types.client-node",target:"_blank",rel:"noopener noreferrer"},R=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> ClientNode <span class="token keyword">struct</span> <span class="token punctuation">{</span>
  FilecoinNode

  systems<span class="token punctuation">.</span>Blockchain
  markets<span class="token punctuation">.</span>StorageMarketClient
  markets<span class="token punctuation">.</span>RetrievalMarketClient
  markets<span class="token punctuation">.</span>DataTransfers
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),M={href:"https://github.com/filecoin-project/lotus/blob/master/node/impl/client/client.go",target:"_blank",rel:"noopener noreferrer"},D={id:"_2-1-1-4\u5B58\u50A8\u77FF\u5DE5\u8282\u70B9",tabindex:"-1"},G=n("a",{class:"header-anchor",href:"#_2-1-1-4\u5B58\u50A8\u77FF\u5DE5\u8282\u70B9","aria-hidden":"true"},"#",-1),V={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes.node_types.storage-miner-node",target:"_blank",rel:"noopener noreferrer"},L=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> StorageMinerNode <span class="token keyword">interface</span> <span class="token punctuation">{</span>
  FilecoinNode

  systems<span class="token punctuation">.</span>Blockchain
  systems<span class="token punctuation">.</span>Mining
  markets<span class="token punctuation">.</span>StorageMarketProvider
  markets<span class="token punctuation">.</span>DataTransfers
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),N={href:"https://github.com/filecoin-project/lotus/blob/master/node/impl/storminer.go",target:"_blank",rel:"noopener noreferrer"},j={id:"_2-1-1-5\u68C0\u7D22\u77FF\u5DE5\u8282\u70B9",tabindex:"-1"},H=n("a",{class:"header-anchor",href:"#_2-1-1-5\u68C0\u7D22\u77FF\u5DE5\u8282\u70B9","aria-hidden":"true"},"#",-1),O={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes.node_types.retrieval-miner-node",target:"_blank",rel:"noopener noreferrer"},U=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> RetrievalMinerNode <span class="token keyword">interface</span> <span class="token punctuation">{</span>
  FilecoinNode

  blockchain<span class="token punctuation">.</span>Blockchain
  markets<span class="token punctuation">.</span>RetrievalMarketProvider
  markets<span class="token punctuation">.</span>DataTransfers
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),z={id:"_2-1-1-6\u4E2D\u7EE7\u8282\u70B9",tabindex:"-1"},W=n("a",{class:"header-anchor",href:"#_2-1-1-6\u4E2D\u7EE7\u8282\u70B9","aria-hidden":"true"},"#",-1),Z={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes.node_types.relayer-node",target:"_blank",rel:"noopener noreferrer"},K=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> RelayerNode <span class="token keyword">interface</span> <span class="token punctuation">{</span>
  FilecoinNode

  blockchain<span class="token punctuation">.</span>MessagePool
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Q={id:"_2-1-1-7\u8282\u70B9\u914D\u7F6E",tabindex:"-1"},J=n("a",{class:"header-anchor",href:"#_2-1-1-7\u8282\u70B9\u914D\u7F6E","aria-hidden":"true"},"#",-1),X={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes.node_types.node-configuration",target:"_blank",rel:"noopener noreferrer"},Y={href:"https://github.com/filecoin-project/lotus/blob/master/node/config/def.go",target:"_blank",rel:"noopener noreferrer"},$={id:"_2-1-2\u8282\u70B9\u5B58\u50A8\u5E93",tabindex:"-1"},nn=n("a",{class:"header-anchor",href:"#_2-1-2\u8282\u70B9\u5B58\u50A8\u5E93","aria-hidden":"true"},"#",-1),sn={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes.repository",target:"_blank",rel:"noopener noreferrer"},an=n("p",null,"Filecoin\u8282\u70B9\u5B58\u50A8\u5E93\u53EA\u662F\u7CFB\u7EDF\u548C\u94FE\u6570\u636E\u7684\u672C\u5730\u5B58\u50A8\u3002\u5B83\u662F\u4EFB\u4F55\u529F\u80FD\u6027Filecoin\u8282\u70B9\u9700\u8981\u5728\u672C\u5730\u5B58\u50A8\u4EE5\u4FBF\u6B63\u786E\u8FD0\u884C\u7684\u6570\u636E\u7684\u62BD\u8C61\u3002",-1),en=n("p",null,[s("\u8BE5\u5B58\u50A8\u5E93\u53EF\u4F9B\u8282\u70B9\u7684\u7CFB\u7EDF\u548C\u5B50\u7CFB\u7EDF\u8BBF\u95EE\uFF0C\u5E76\u4E14\u53EF\u4EE5\u4ECE\u8282\u70B9\u7684\u5B58\u50A8\u533A\u5206\u5F00"),n("code",null,"FileStore"),s("\u3002")],-1),tn=n("p",null,"\u8BE5\u5B58\u50A8\u5E93\u5B58\u50A8\u8282\u70B9\u7684\u5BC6\u94A5\uFF0C\u6709\u72B6\u6001\u5BF9\u8C61\u7684IPLD\u6570\u636E\u7ED3\u6784\u4EE5\u53CA\u8282\u70B9\u914D\u7F6E\u8BBE\u7F6E\u3002",-1),on={href:"https://github.com/filecoin-project/lotus/blob/master/node/repo/fsrepo.go",target:"_blank",rel:"noopener noreferrer"},pn={id:"_2-1-2-1\u5BC6\u94A5\u5E93",tabindex:"-1"},cn=n("a",{class:"header-anchor",href:"#_2-1-2-1\u5BC6\u94A5\u5E93","aria-hidden":"true"},"#",-1),ln={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes.repository.key_store",target:"_blank",rel:"noopener noreferrer"},un=n("p",null,[s("\u8FD9"),n("code",null,"Key Store"),s("\u662F\u4EFB\u4F55\u5B8C\u6574Filecoin\u8282\u70B9\u4E2D\u7684\u57FA\u672C\u62BD\u8C61\uFF0C\u7528\u4E8E\u5B58\u50A8\u4E0E\u7ED9\u5B9A\u77FF\u5DE5\u7684\u5730\u5740\uFF08\u8BF7\u53C2\u9605\u4E0B\u9762\u7684\u5B9E\u9645\u5B9A\u4E49\uFF09\u548C\u4E0D\u540C\u7684\u5DE5\u4F5C\u7A0B\u5E8F\uFF08\u77FF\u5DE5\u5E94\u8BE5\u9009\u62E9\u8FD0\u884C\u591A\u4E2A\u5DE5\u4F5C\u7A0B\u5E8F\uFF09\u5173\u8054\u7684\u5BC6\u94A5\u5BF9\u3002")],-1),rn=n("p",null,"\u8282\u70B9\u5B89\u5168\u6027\u5728\u5F88\u5927\u7A0B\u5EA6\u4E0A\u53D6\u51B3\u4E8E\u4FDD\u6301\u8FD9\u4E9B\u5BC6\u94A5\u7684\u5B89\u5168\u6027\u3002\u4E3A\u6B64\uFF0C\u6211\u4EEC\u5F3A\u70C8\u5EFA\u8BAE\uFF1A1\uFF09\u5C06\u5BC6\u94A5\u4E0E\u6240\u6709\u5B50\u7CFB\u7EDF\u5206\u5F00\uFF0C2\uFF09\u6839\u636E\u5176\u4ED6\u5B50\u7CFB\u7EDF\u7684\u8981\u6C42\u4F7F\u7528\u5355\u72EC\u7684\u5BC6\u94A5\u5B58\u50A8\u6765\u7B7E\u7F72\u8BF7\u6C42\uFF0C\u4EE5\u53CA3\uFF09\u4FDD\u7559\u672A\u7528\u4F5C\u51B7\u5E93\u4E2D\u6316\u6398\u7684\u90A3\u4E9B\u5BC6\u94A5\u3002",-1),dn=n("p",null,"Filecoin\u5B58\u50A8\u77FF\u5DE5\u4F9D\u8D56\u4E09\u4E2A\u4E3B\u8981\u7EC4\u6210\u90E8\u5206\uFF1A",-1),kn=t("<li>\u5728\u8C03\u7528<code>registerMiner()</code>Storage Power Consensus\u5B50\u7CFB\u7EDF\u540E\uFF0C<strong>\u5C06\u5B58\u50A8\u77FF\u5DE5</strong><em><strong>\u53C2\u4E0E\u8005*****\u5730\u5740</strong>\u552F\u4E00\u5730\u5206\u914D\u7ED9\u7ED9\u5B9A\u7684\u5B58\u50A8\u77FF\u5DE5</em><em>\u53C2\u4E0E\u8005****\u5730\u5740</em>*\u3002\u5B9E\u9645\u4E0A\uFF0C\u5B58\u50A8\u77FF\u5DE5\u672C\u8EAB\u6CA1\u6709\u5730\u5740\uFF0C\u800C\u662F\u7531\u4E0E\u5176\u7ED1\u5B9A\u7684\u53C2\u4E0E\u8005\u7684\u5730\u5740\u6765\u6807\u8BC6\u7684\u3002\u8FD9\u662F\u7ED9\u5B9A\u5B58\u50A8\u77FF\u5DE5\u7684\u552F\u4E00\u6807\u8BC6\u7B26\uFF0C\u5176\u7535\u6E90\u548C\u5176\u4ED6\u5BC6\u94A5\u5C06\u4E0E\u4E4B\u5173\u8054\u3002\u8BE5<code>actor value</code>\u6307\u5B9A\u4E00\u4E2A\u5DF2\u7ECF\u521B\u5EFA\u7684\u77FF\u5DE5\u6F14\u5458\u7684\u5730\u5740\u3002</li><li><strong>\u6240\u6709\u8005\u5BC6\u94A5\u5BF9</strong>\u7531\u77FF\u5DE5\u5728\u6CE8\u518C\u4E4B\u524D\u63D0\u4F9B\uFF0C\u5E76\u4E14\u5176\u516C\u94A5\u4E0E\u77FF\u5DE5\u5730\u5740\u76F8\u5173\u3002\u6240\u6709\u8005\u5BC6\u94A5\u5BF9\u53EF\u7528\u4E8E\u7BA1\u7406\u77FF\u5DE5\u548C\u63D0\u53D6\u8D44\u91D1\u3002</li>",2),vn=n("strong",null,"\u5DE5\u4EBA\u5BC6\u94A5\u5BF9",-1),mn={href:"https://spec.filecoin.io/#section-algorithms.crypto.vrf",target:"_blank",rel:"noopener noreferrer"},bn=n("p",null,"\u591A\u4E2A\u5B58\u50A8\u77FF\u5DE5\u53C2\u4E0E\u8005\u53EF\u4EE5\u5171\u4EAB\u4E00\u4E2A\u6240\u6709\u8005\u516C\u5171\u5BC6\u94A5\uFF0C\u4E5F\u53EF\u4EE5\u5171\u4EAB\u4E00\u4E2A\u5DE5\u4EBA\u516C\u5171\u5BC6\u94A5\u3002",-1),hn={href:"https://spec.filecoin.io/#section-systems.filecoin_mining.storage_mining.storage_miner_actor",target:"_blank",rel:"noopener noreferrer"},fn=n("p",null,[s("\u5BC6\u94A5\u5B89\u5168\u5728Filecoin\u4E2D\u81F3\u5173\u91CD\u8981\uFF0C\u6BCF\u4E2A\u533A\u5757\u94FE\u4E2D\u7684\u5BC6\u94A5\u4E5F\u662F\u5982\u6B64\u3002"),n("strong",null,"\u65E0\u6CD5\u5B89\u5168\u5730\u5B58\u50A8\u548C\u4F7F\u7528\u5BC6\u94A5\u6216\u5C06\u79C1\u94A5\u66B4\u9732\u7ED9\u5BF9\u624B\u53EF\u80FD\u4F1A\u5BFC\u81F4\u5BF9\u624B\u6709\u6743\u4F7F\u7528\u77FF\u5DE5\u7684\u8D44\u91D1\u3002")],-1),_n={id:"_2-1-2-2ipld\u5546\u5E97",tabindex:"-1"},gn=n("a",{class:"header-anchor",href:"#_2-1-2-2ipld\u5546\u5E97","aria-hidden":"true"},"#",-1),yn={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes.repository.ipldstore",target:"_blank",rel:"noopener noreferrer"},wn=n("p",null,"\u661F\u9645\u94FE\u63A5\u6570\u636E\uFF08IPLD\uFF09\u662F\u4E00\u7EC4\u5E93\uFF0C\u8FD9\u4E9B\u5E93\u5141\u8BB8\u8DE8\u4E0D\u540C\u5206\u5E03\u5F0F\u7CFB\u7EDF\u548C\u534F\u8BAE\u7684\u5185\u5BB9\u5BFB\u5740\u6570\u636E\u7ED3\u6784\u4E92\u64CD\u4F5C\u3002\u5B83\u4E3A\u539F\u59CB\u5BC6\u7801\u54C8\u5E0C\u63D0\u4F9B\u4E86\u4E00\u79CD\u57FA\u672C\u7684\u201C\u901A\u7528\u8BED\u8A00\u201D\uFF0C\u4F7F\u6570\u636E\u7ED3\u6784\u53EF\u4EE5\u5728\u4E24\u4E2A\u72EC\u7ACB\u7684\u534F\u8BAE\u4E4B\u95F4\u88AB\u53EF\u9A8C\u8BC1\u5730\u5F15\u7528\u548C\u68C0\u7D22\u3002\u4F8B\u5982\uFF0C\u7528\u6237\u53EF\u4EE5\u5728\u4EE5\u592A\u574A\u4EA4\u6613\u6216\u667A\u80FD\u5408\u7EA6\u4E2D\u5F15\u7528IPFS\u76EE\u5F55\u3002",-1),xn=n("p",null,"Filecoin\u8282\u70B9\u7684IPLD\u5B58\u50A8\u662F\u7528\u4E8E\u6563\u5217\u94FE\u63A5\u6570\u636E\u7684\u672C\u5730\u5B58\u50A8\u3002",-1),Cn=n("p",null,"IPLD\u57FA\u672C\u4E0A\u7531\u4E09\u5C42\u7EC4\u6210\uFF1A",-1),Sn=n("ul",null,[n("li",null,"\u5757\u5C42\uFF0C\u7740\u91CD\u4E8E\u5757\u683C\u5F0F\u548C\u5BFB\u5740\uFF0C\u5757\u5982\u4F55\u5E7F\u544A\u6216\u81EA\u63CF\u8FF0\u5176\u7F16\u89E3\u7801\u5668"),n("li",null,"\u6570\u636E\u6A21\u578B\u5C42\uFF0C\u5B83\u5B9A\u4E49\u4E86\u4E00\u7EC4\u5FC5\u987B\u5305\u542B\u5728\u4EFB\u4F55\u5B9E\u73B0\u4E2D\u7684\u5FC5\u9700\u7C7B\u578B-\u4E0B\u6587\u5C06\u8BE6\u7EC6\u8BA8\u8BBA\u3002"),n("li",null,"\u6A21\u5F0F\u5C42\uFF0C\u5B83\u5141\u8BB8\u6269\u5C55\u6570\u636E\u6A21\u578B\u4EE5\u4E0E\u66F4\u590D\u6742\u7684\u7ED3\u6784\u8FDB\u884C\u4EA4\u4E92\uFF0C\u800C\u65E0\u9700\u81EA\u5B9A\u4E49\u8F6C\u6362\u62BD\u8C61\u3002")],-1),Fn={href:"https://github.com/ipld/specs",target:"_blank",rel:"noopener noreferrer"},qn={id:"_2-1-2-2-1\u6570\u636E\u6A21\u578B",tabindex:"-1"},Pn=n("a",{class:"header-anchor",href:"#_2-1-2-2-1\u6570\u636E\u6A21\u578B","aria-hidden":"true"},"#",-1),An={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes.repository.ipldstore.the-data-model",target:"_blank",rel:"noopener noreferrer"},Bn={href:"https://github.com/ipld/specs/blob/master/data-model-layer/data-model.md",target:"_blank",rel:"noopener noreferrer"},En={href:"https://github.com/multiformats/cid",target:"_blank",rel:"noopener noreferrer"},Tn={href:"https://docs.ipfs.io/guides/concepts/merkle-dag/",target:"_blank",rel:"noopener noreferrer"},In={href:"https://github.com/ipld/specs/blob/master/block-layer/codecs/dag-cbor.md",target:"_blank",rel:"noopener noreferrer"},Rn={href:"https://github.com/ipld/specs/blob/master/block-layer/codecs/dag-json.md",target:"_blank",rel:"noopener noreferrer"},Mn={id:"_2-1-2-2-2-filecoin\u4E2D\u7684ipld",tabindex:"-1"},Dn=n("a",{class:"header-anchor",href:"#_2-1-2-2-2-filecoin\u4E2D\u7684ipld","aria-hidden":"true"},"#",-1),Gn={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes.repository.ipldstore.ipld-in-filecoin",target:"_blank",rel:"noopener noreferrer"},Vn=n("p",null,"Filecoin\u7F51\u7EDC\u4E2D\u6709\u4E24\u79CD\u65B9\u5F0F\u4F7F\u7528IPLD\uFF1A",-1),Ln=n("ul",null,[n("li",null,"\u6240\u6709\u7CFB\u7EDF\u6570\u636E\u7ED3\u6784\u90FD\u4F7F\u7528DAG-CBOR\uFF08IPLD\u7F16\u89E3\u7801\u5668\uFF09\u5B58\u50A8\u3002DAG-CBOR\u662FCBOR\u7684\u66F4\u4E25\u683C\u5B50\u96C6\uFF0C\u5177\u6709\u9884\u5B9A\u4E49\u7684\u6807\u8BB0\u65B9\u6848\uFF0C\u65E8\u5728\u5B58\u50A8\uFF0C\u68C0\u7D22\u548C\u904D\u5386\u6563\u5217\u94FE\u63A5\u7684\u6570\u636EDAG\u3002\u4E0ECBOR\u76F8\u6BD4\uFF0CDAG-CBOR\u53EF\u4EE5\u4FDD\u8BC1\u786E\u5B9A\u6027\u3002"),n("li",null,"Filecoin\u7F51\u7EDC\u4E0A\u5B58\u50A8\u7684\u6587\u4EF6\u548C\u6570\u636E\u4E5F\u4F7F\u7528\u5404\u79CDIPLD\u7F16\u89E3\u7801\u5668\uFF08\u4E0D\u4E00\u5B9A\u662FDAG-CBOR\uFF09\u8FDB\u884C\u5B58\u50A8\u3002")],-1),Nn=n("p",null,"IPLD\u5728\u6570\u636E\u4E0A\u65B9\u63D0\u4F9B\u4E86\u4E00\u81F4\u4E14\u4E00\u81F4\u7684\u62BD\u8C61\uFF0C\u4ECE\u800C\u4F7FFilecoin\u53EF\u4EE5\u6784\u5EFA\u590D\u6742\u7684\u591A\u5757\u6570\u636E\u7ED3\u6784\uFF08\u4F8B\u5982HAMT\u548CAMT\uFF09\u5E76\u4E0E\u4E4B\u4EA4\u4E92\u3002Filecoin\u4F7F\u7528DAG-CBOR\u7F16\u89E3\u7801\u5668\u5BF9\u5176\u6570\u636E\u7ED3\u6784\u8FDB\u884C\u5E8F\u5217\u5316\u548C\u53CD\u5E8F\u5217\u5316\uFF0C\u5E76\u4F7F\u7528IPLD\u6570\u636E\u6A21\u578B\u4E0E\u8BE5\u6570\u636E\u8FDB\u884C\u4EA4\u4E92\uFF0C\u5E76\u5728\u6B64\u6A21\u578B\u4E0A\u6784\u5EFA\u4E86\u5404\u79CD\u5DE5\u5177\u3002IPLD\u9009\u62E9\u5668\u8FD8\u53EF\u7528\u4E8E\u5BFB\u5740\u94FE\u63A5\u6570\u636E\u7ED3\u6784\u4E2D\u7684\u7279\u5B9A\u8282\u70B9\u3002",-1),jn={id:"_2-1-2-2-2-1ipldstores",tabindex:"-1"},Hn=n("a",{class:"header-anchor",href:"#_2-1-2-2-2-1ipldstores","aria-hidden":"true"},"#",-1),On={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes.repository.ipldstore.ipldstores",target:"_blank",rel:"noopener noreferrer"},Un=n("p",null,"Filecoin\u7F51\u7EDC\u4E3B\u8981\u4F9D\u8D56\u4E8E\u4E24\u4E2A\u4E0D\u540C\u7684IPLD GraphStore\uFF1A",-1),zn=n("li",null,[s("\u4E00\u79CD"),n("code",null,"ChainStore"),s("\u5B58\u50A8\u533A\u5757\u94FE\u7684\u6570\u636E\uFF0C\u5305\u62EC\u5757\u5934\uFF0C\u76F8\u5173\u6D88\u606F\u7B49\u3002")],-1),Wn=n("code",null,"StateStore",-1),Zn=n("code",null,"stateTree",-1),Kn={href:"https://spec.filecoin.io/#section-systems.filecoin_vm",target:"_blank",rel:"noopener noreferrer"},Qn={href:"https://spec.filecoin.io/#section-systems.filecoin_vm",target:"_blank",rel:"noopener noreferrer"},Jn=n("code",null,"ChainStore",-1),Xn={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.chainsync",target:"_blank",rel:"noopener noreferrer"},Yn=n("code",null,"StateStore",-1),$n=n("code",null,"ChainStore",-1),ns={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.interpreter",target:"_blank",rel:"noopener noreferrer"},ss={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.block",target:"_blank",rel:"noopener noreferrer"},as=n("code",null,"ParentState",-1),es=n("h3",{id:"_2-1-3-\u7F51\u7EDC\u63A5\u53E3",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_2-1-3-\u7F51\u7EDC\u63A5\u53E3","aria-hidden":"true"},"#"),s(" 2.1.3 \u7F51\u7EDC\u63A5\u53E3")],-1),ts=n("p",null,[s("Filecoin\u8282\u70B9\u4F7F\u7528libp2p\u7F51\u7EDC\u5806\u6808\u7684\u51E0\u79CD\u534F\u8BAE\u6765\u8FDB\u884C\u5BF9\u7B49\u65B9\u53D1\u73B0\uFF0C\u5BF9\u7B49\u65B9\u8DEF\u7531\u4EE5\u53CA\u5757\u548C\u6D88\u606F\u4F20\u64AD\u3002Libp2p\u662F\u7528\u4E8E\u70B9\u5BF9\u70B9\u7F51\u7EDC\u7684\u6A21\u5757\u5316\u7F51\u7EDC\u5806\u6808\u3002\u5B83\u5305\u62EC\u591A\u79CD\u534F\u8BAE\u548C\u673A\u5236\uFF0C\u53EF\u5B9E\u73B0\u9AD8\u6548\uFF0C\u5B89\u5168\u548C\u6709\u5F39\u6027\u7684\u5BF9\u7B49\u901A\u4FE1\u3002Libp2p\u8282\u70B9\u5F7C\u6B64\u4E4B\u95F4\u6253\u5F00\u8FDE\u63A5\uFF0C\u5E76\u5728\u540C\u4E00\u8FDE\u63A5\u4E0A\u5B89\u88C5\u4E0D\u540C\u7684\u534F\u8BAE\u6216\u6D41\u3002\u5728\u6700\u521D\u7684\u63E1\u624B\u4E2D\uFF0C\u8282\u70B9\u4EA4\u6362\u5B83\u4EEC\u5404\u81EA\u652F\u6301\u7684\u534F\u8BAE\uFF0C\u6240\u6709\u4E0EFilecoin\u76F8\u5173\u7684\u534F\u8BAE\u90FD\u5C06\u5B89\u88C5\u5728"),n("code",null,"/fil/..."),s("\u534F\u8BAE\u6807\u8BC6\u7B26\u4E0B\u3002")],-1),os={href:"https://github.com/libp2p/specs",target:"_blank",rel:"noopener noreferrer"},ps=n("strong",null,"Graphsync\uFF1A",-1),is={href:"https://github.com/ipld/specs/blob/master/block-layer/graphsync/graphsync.md",target:"_blank",rel:"noopener noreferrer"},cs={href:"https://github.com/libp2p/specs/tree/master/pubsub/gossipsub",target:"_blank",rel:"noopener noreferrer"},ls=n("code",null,"fil/blocks/<network-name>",-1),us=n("code",null,"fil/msgs/<network-name>",-1),rs=n("strong",null,"Kademlia DHT\uFF1A",-1),ds={href:"https://github.com/libp2p/go-libp2p-kad-dht",target:"_blank",rel:"noopener noreferrer"},ks=n("code",null,"fil/<network-name>/kad/1.0.0",-1),vs=n("li",null,"**\u5F15\u5BFC\u7A0B\u5E8F\u5217\u8868\uFF1A**\u8FD9\u662F\u65B0\u8282\u70B9\u5728\u52A0\u5165\u7F51\u7EDC\u540E\u5C1D\u8BD5\u8FDE\u63A5\u7684\u8282\u70B9\u5217\u8868\u3002\u5F15\u5BFC\u8282\u70B9\u5217\u8868\u53CA\u5176\u5730\u5740\u7531\u7528\u6237\uFF08\u5373\u5E94\u7528\u7A0B\u5E8F\uFF09\u5B9A\u4E49\u3002",-1),ms=n("li",null,"**\u5BF9\u7B49\u4EA4\u6362\uFF1A**\u6B64\u534F\u8BAE\u662F\u5728Kademlia DHT\u4E0A\u9762\u8BA8\u8BBA\u7684\u5BF9\u7B49\u53D1\u73B0\u8FC7\u7A0B\u7684\u5B9E\u73B0\u3002\u901A\u8FC7\u4E0EDHT\u8FDB\u884C\u63A5\u53E3\uFF0C\u5B83\u4F7F\u5BF9\u7B49\u70B9\u53EF\u4EE5\u627E\u5230\u7F51\u7EDC\u4E2D\u5176\u4ED6\u5BF9\u7B49\u70B9\u7684\u4FE1\u606F\u548C\u5730\u5740\uFF0C\u5E76\u4E3A\u8981\u8FDE\u63A5\u7684\u5BF9\u7B49\u70B9\u521B\u5EFA\u548C\u53D1\u51FA\u67E5\u8BE2\u3002",-1),bs={id:"_2-1-4\u65F6\u949F",tabindex:"-1"},hs=n("a",{class:"header-anchor",href:"#_2-1-4\u65F6\u949F","aria-hidden":"true"},"#",-1),fs={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes.clock",target:"_blank",rel:"noopener noreferrer"},_s=n("p",null,"Filecoin\u5047\u5B9A\u7CFB\u7EDF\u53C2\u4E0E\u8005\u4E4B\u95F4\u7684\u65F6\u949F\u540C\u6B65\u8F83\u5F31\u3002\u4E5F\u5C31\u662F\u8BF4\uFF0C\u7CFB\u7EDF\u4F9D\u8D56\u4E8E\u53C2\u4E0E\u8005\u53EF\u4EE5\u8BBF\u95EE\u5168\u5C40\u540C\u6B65\u65F6\u949F\uFF08\u5141\u8BB8\u67D0\u4E9B\u6709\u754C\u504F\u79FB\uFF09\u3002",-1),gs=n("p",null,"Filecoin\u4F9D\u9760\u6B64\u7CFB\u7EDF\u65F6\u949F\u6765\u786E\u4FDD\u5171\u8BC6\u3002\u5177\u4F53\u6765\u8BF4\uFF0C\u65F6\u949F\u662F\u652F\u6301\u9A8C\u8BC1\u89C4\u5219\u6240\u5FC5\u9700\u7684\uFF0C\u9A8C\u8BC1\u89C4\u5219\u53EF\u9632\u6B62\u5757\u751F\u4EA7\u8005\u4F7F\u7528\u534F\u8BAE\u7684\u65F6\u95F4\u6233\u6765\u6316\u6398\u5177\u6709\u672A\u6765\u65F6\u95F4\u6233\u7684\u5757\u5E76\u66F4\u9891\u7E41\u5730\u8FD0\u884C\u9886\u5BFC\u8005\u9009\u4E3E\u3002",-1),ys={id:"_2-1-4-1\u65F6\u949F\u7528\u9014",tabindex:"-1"},ws=n("a",{class:"header-anchor",href:"#_2-1-4-1\u65F6\u949F\u7528\u9014","aria-hidden":"true"},"#",-1),xs={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes.clock.clock-uses",target:"_blank",rel:"noopener noreferrer"},Cs=n("p",null,"\u4F7F\u7528Filecoin\u7CFB\u7EDF\u65F6\u949F\uFF1A",-1),Ss={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.block.block-syntax-validation",target:"_blank",rel:"noopener noreferrer"},Fs=n("li",null,"\u901A\u8FC7\u540C\u6B65\u8282\u70B9\u4EE5\u653E\u7F6E\u6765\u81EA\u672A\u6765\u7EAA\u5143\u7684\u6570\u636E\u5757",-1),qs={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus",target:"_blank",rel:"noopener noreferrer"},Ps=n("p",null,"\u4E3A\u4E86\u5141\u8BB8\u77FF\u5DE5\u6267\u884C\u4E0A\u8FF0\u64CD\u4F5C\uFF0C\u7CFB\u7EDF\u65F6\u949F\u5FC5\u987B\uFF1A",-1),As={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.block.block-semantic-validation",target:"_blank",rel:"noopener noreferrer"},Bs={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.block.block-semantic-validation",target:"_blank",rel:"noopener noreferrer"},Es=n("li",null,[s("\u8BBE\u7F6E\u8282\u70B9\u521D\u59CB\u5316\u7684\u65F6\u671F\u6570\u7B49\u4E8E "),n("code",null,"epoch = Floor[(current_time - genesis_time) / epoch_time]")],-1),Ts=n("p",null,[s("\u9884\u8BA1\u5176\u4ED6\u5B50\u7CFB\u7EDF\u5C06\u4ECE"),n("code",null,"NewRound()"),s("\u65F6\u949F\u5B50\u7CFB\u7EDF\u6CE8\u518C\u5230\u4E8B\u4EF6\u3002")],-1),Is={id:"_2-1-4-2\u65F6\u949F\u8981\u6C42",tabindex:"-1"},Rs=n("a",{class:"header-anchor",href:"#_2-1-4-2\u65F6\u949F\u8981\u6C42","aria-hidden":"true"},"#",-1),Ms={href:"https://spec.filecoin.io/#section-systems.filecoin_nodes.clock.clock-requirements",target:"_blank",rel:"noopener noreferrer"},Ds=n("p",null,"\u7528\u4F5CFilecoin\u534F\u8BAE\u4E00\u90E8\u5206\u7684\u65F6\u949F\u5E94\u4FDD\u6301\u540C\u6B65\uFF0C\u4E14\u504F\u79FB\u5C0F\u4E8E1\u79D2\uFF0C\u4EE5\u4FBF\u8FDB\u884C\u9002\u5F53\u7684\u9A8C\u8BC1\u3002",-1),Gs={href:"https://www.hindawi.com/journals/jcnc/2008/583162/",target:"_blank",rel:"noopener noreferrer"},Vs=n("strong",null,[n("code",null,"pool.ntp.org")],-1),Ls={href:"https://www.ntppool.org/en/use.html",target:"_blank",rel:"noopener noreferrer"},Ns=n("code",null,"time.cloudflare.com:1234",-1),js={href:"https://www.cloudflare.com/time/",target:"_blank",rel:"noopener noreferrer"},Hs=n("code",null,"time.google.com",-1),Os={href:"https://developers.google.com/time",target:"_blank",rel:"noopener noreferrer"},Us=n("code",null,"time.nist.gov",-1),zs={href:"https://tf.nist.gov/tf-cgi/servers.cgi",target:"_blank",rel:"noopener noreferrer"},Ws=n("li",null,"\u8F83\u5927\u7684\u91C7\u77FF\u4F5C\u4E1A\u53EF\u80FD\u4F1A\u8003\u8651\u4F7F\u7528\u5177\u6709GPS\u53C2\u8003\u548C/\u6216\u9891\u7387\u7A33\u5B9A\u7684\u5916\u90E8\u65F6\u949F\u7684\u672C\u5730NTP / PTP\u670D\u52A1\u5668\uFF0C\u4EE5\u6539\u5584\u8BA1\u65F6\u529F\u80FD\u3002",-1),Zs=n("p",null,"\u91C7\u77FF\u4E1A\u52A1\u6709\u5F3A\u70C8\u7684\u52A8\u673A\u6765\u9632\u6B62\u65F6\u949F\u5411\u524D\u503E\u659C\u4E00\u4E2A\u7EAA\u5143\u4EE5\u4E0A\uFF0C\u4EE5\u9632\u6B62\u5757\u72B6\u63D0\u4EA4\u88AB\u62D2\u7EDD\u3002\u540C\u6837\uFF0C\u4ED6\u4EEC\u6709\u52A8\u673A\u9632\u6B62\u65F6\u949F\u504F\u79BB\u4E00\u4E2A\u4EE5\u4E0A\u7684\u65F6\u95F4\uFF0C\u4EE5\u907F\u514D\u5C06\u81EA\u5DF1\u4E0E\u7F51\u7EDC\u4E2D\u7684\u540C\u6B65\u8282\u70B9\u5206\u5F00\u3002",-1),Ks={id:"_2-2\u6587\u4EF6\u548C\u6570\u636E",tabindex:"-1"},Qs=n("a",{class:"header-anchor",href:"#_2-2\u6587\u4EF6\u548C\u6570\u636E","aria-hidden":"true"},"#",-1),Js={href:"https://spec.filecoin.io/#section-systems.filecoin_files",target:"_blank",rel:"noopener noreferrer"},Xs=n("p",null,[s("Filecoin\u7684\u4E3B\u8981\u76EE\u7684\u662F\u5B58\u50A8\u5BA2\u6237\u7684\u6587\u4EF6\u548C\u6570\u636E\u3002\u672C\u8282\u8BE6\u7EC6\u4ECB\u7ECD\u4E0E\u5904\u7406\u6587\u4EF6\uFF0C\u5206\u5757\uFF0C\u7F16\u7801\uFF0C\u56FE\u5F62\u8868\u793A"),n("code",null,"Pieces"),s("\uFF0C\uFF0C\u5B58\u50A8\u62BD\u8C61\u7B49\u76F8\u5173\u7684\u6570\u636E\u7ED3\u6784\u548C\u5DE5\u5177\u3002")],-1),Ys={id:"_2-2-1\u6587\u4EF6",tabindex:"-1"},$s=n("a",{class:"header-anchor",href:"#_2-2-1\u6587\u4EF6","aria-hidden":"true"},"#",-1),na={href:"https://spec.filecoin.io/#section-systems.filecoin_files.file",target:"_blank",rel:"noopener noreferrer"},sa={href:"https://spec.filecoin.io/#example-",target:"_blank",rel:"noopener noreferrer"},aa=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// Path is an opaque locator for a file (e.g. in a unix-style filesystem).</span>
<span class="token keyword">type</span> Path <span class="token builtin">string</span>

<span class="token comment">// File is a variable length data container.</span>
<span class="token comment">// The File interface is modeled after a unix-style file, but abstracts the</span>
<span class="token comment">// underlying storage system.</span>
<span class="token keyword">type</span> File <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">Path</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   Path
    <span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token builtin">int</span>
    <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token builtin">error</span>

    <span class="token comment">// Read reads from File into buf, starting at offset, and for size bytes.</span>
    <span class="token function">Read</span><span class="token punctuation">(</span>offset <span class="token builtin">int</span><span class="token punctuation">,</span> size <span class="token builtin">int</span><span class="token punctuation">,</span> buf Bytes<span class="token punctuation">)</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span>size <span class="token builtin">int</span><span class="token punctuation">,</span> e <span class="token builtin">error</span><span class="token punctuation">}</span>

    <span class="token comment">// Write writes from buf into File, starting at offset, and for size bytes.</span>
    <span class="token function">Write</span><span class="token punctuation">(</span>offset <span class="token builtin">int</span><span class="token punctuation">,</span> size <span class="token builtin">int</span><span class="token punctuation">,</span> buf Bytes<span class="token punctuation">)</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span>size <span class="token builtin">int</span><span class="token punctuation">,</span> e <span class="token builtin">error</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),ea={id:"_2-2-1-1filestore-\u6587\u4EF6\u7684\u672C\u5730\u5B58\u50A8",tabindex:"-1"},ta=n("a",{class:"header-anchor",href:"#_2-2-1-1filestore-\u6587\u4EF6\u7684\u672C\u5730\u5B58\u50A8","aria-hidden":"true"},"#",-1),oa={href:"https://spec.filecoin.io/#section-systems.filecoin_files.file.filestore",target:"_blank",rel:"noopener noreferrer"},pa=n("p",null,[s("\u7684"),n("code",null,"FileStore"),s("\u662F\u7528\u6765\u6307\u4EFB\u4F55\u5E95\u5C42\u7CFB\u7EDF\u6216\u8BBE\u5907\uFF0C\u5176\u5C06Filecoin\u5176\u6570\u636E\u5B58\u50A8\u5230\u4E00\u4E2A\u62BD\u8C61\u3002\u5B83\u57FA\u4E8EUnix\u6587\u4EF6\u7CFB\u7EDF\u8BED\u4E49\uFF0C\u5E76\u5305\u542B\u7684\u6982\u5FF5"),n("code",null,"Paths"),s("\u3002\u5728\u8FD9\u91CC\u4F7F\u7528\u8FD9\u79CD\u62BD\u8C61\u662F\u4E3A\u4E86\u786E\u4FDDFilecoin\u7684\u5B9E\u73B0\u4F7F\u6700\u7EC8\u7528\u6237\u53EF\u4EE5\u8F7B\u677E\u5730\u4F7F\u7528\u9002\u5408\u4ED6\u4EEC\u9700\u6C42\u7684\u57FA\u7840\u66FF\u6362\u5E95\u5C42\u5B58\u50A8\u7CFB\u7EDF\u3002\u6700\u7B80\u5355\u7684\u7248\u672C"),n("code",null,"FileStore"),s("\u53EA\u662F\u4E3B\u673A\u64CD\u4F5C\u7CFB\u7EDF\u7684\u6587\u4EF6\u7CFB\u7EDF\u3002")],-1),ia={href:"https://spec.filecoin.io/#example-",target:"_blank",rel:"noopener noreferrer"},ca=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// FileStore is an object that can store and retrieve files by path.</span>
<span class="token keyword">type</span> FileStore <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token function">Open</span><span class="token punctuation">(</span>p Path<span class="token punctuation">)</span>           union <span class="token punctuation">{</span>f File<span class="token punctuation">,</span> e <span class="token builtin">error</span><span class="token punctuation">}</span>
    <span class="token function">Create</span><span class="token punctuation">(</span>p Path<span class="token punctuation">)</span>         union <span class="token punctuation">{</span>f File<span class="token punctuation">,</span> e <span class="token builtin">error</span><span class="token punctuation">}</span>
    <span class="token function">Store</span><span class="token punctuation">(</span>p Path<span class="token punctuation">,</span> f File<span class="token punctuation">)</span>  <span class="token builtin">error</span>
    <span class="token function">Delete</span><span class="token punctuation">(</span>p Path<span class="token punctuation">)</span>         <span class="token builtin">error</span>

    <span class="token comment">// maybe add:</span>
    <span class="token comment">// Copy(SrcPath, DstPath)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),la={id:"_2-2-1-1-1\u53D8\u5316\u7684\u7528\u6237\u9700\u6C42",tabindex:"-1"},ua=n("a",{class:"header-anchor",href:"#_2-2-1-1-1\u53D8\u5316\u7684\u7528\u6237\u9700\u6C42","aria-hidden":"true"},"#",-1),ra={href:"https://spec.filecoin.io/#section-systems.filecoin_files.file.filestore.varying-user-needs",target:"_blank",rel:"noopener noreferrer"},da=n("p",null,[s("Filecoin\u7528\u6237\u7684\u9700\u6C42\u5DEE\u5F02\u5F88\u5927\uFF0C\u8BB8\u591A\u7528\u6237\uFF08\u5C24\u5176\u662F\u77FF\u5DE5\uFF09\u5C06\u5728Filecoin\u7684\u4E0B\u65B9\u548C\u5468\u56F4\u5B9E\u65BD\u590D\u6742\u7684\u5B58\u50A8\u67B6\u6784\u3002"),n("code",null,"FileStore"),s("\u8FD9\u91CC\u7684\u62BD\u8C61\u662F\u4E3A\u4E86\u4F7F\u8FD9\u4E9B\u53D8\u5316\u7684\u9700\u6C42\u6613\u4E8E\u6EE1\u8DB3\u3002Filecoin\u534F\u8BAE\u4E2D\u7684\u6240\u6709\u6587\u4EF6\u548C\u6247\u533A\u672C\u5730\u6570\u636E\u5B58\u50A8\u90FD\u662F\u901A\u8FC7\u6B64"),n("code",null,"FileStore"),s("\u63A5\u53E3\u5B9A\u4E49\u7684\uFF0C\u8FD9\u4F7F\u5B9E\u73B0\u6613\u4E8E\u5B9E\u73B0\u53EF\u4EA4\u6362\uFF0C\u5E76\u4E14\u4F7F\u6700\u7EC8\u7528\u6237\u53EF\u4EE5\u8F7B\u677E\u9009\u62E9\u6240\u9009\u62E9\u7684\u7CFB\u7EDF\u3002")],-1),ka={id:"_2-2-1-1-2\u5B9E\u65BD\u5B9E\u4F8B",tabindex:"-1"},va=n("a",{class:"header-anchor",href:"#_2-2-1-1-2\u5B9E\u65BD\u5B9E\u4F8B","aria-hidden":"true"},"#",-1),ma={href:"https://spec.filecoin.io/#section-systems.filecoin_files.file.filestore.implementation-examples",target:"_blank",rel:"noopener noreferrer"},ba=t("<p>\u8BE5<code>FileStore</code>\u63A5\u53E3\u53EF\u4EE5\u7531\u591A\u79CD\u540E\u5907\u6570\u636E\u5B58\u50A8\u7CFB\u7EDF\u6765\u5B9E\u73B0\u3002\u4F8B\u5982\uFF1A</p><ul><li>\u4E3B\u673A\u64CD\u4F5C\u7CFB\u7EDF\u6587\u4EF6\u7CFB\u7EDF</li><li>\u4EFB\u4F55Unix / Posix\u6587\u4EF6\u7CFB\u7EDF</li><li>RAID\u652F\u6301\u7684\u6587\u4EF6\u7CFB\u7EDF</li><li>\u8054\u7F51\u7684\u5206\u5E03\u5F0F\u6587\u4EF6\u7CFB\u7EDF\uFF08NFS\uFF0CHDFS\u7B49\uFF09</li><li>IPFS</li><li>\u8D44\u6599\u5E93</li><li>NAS\u7CFB\u7EDF</li><li>\u539F\u59CB\u4E32\u884C\u6216\u5757\u8BBE\u5907</li><li>\u539F\u59CB\u786C\u76D8\u9A71\u52A8\u5668\uFF08hdd\u6247\u533A\u7B49\uFF09</li></ul><p>\u5B9E\u73B0\u5E94\u5B9E\u73B0\u5BF9\u4E3B\u673AOS\u6587\u4EF6\u7CFB\u7EDF\u7684\u652F\u6301\u3002\u5B9E\u73B0\u53EF\u4EE5\u5B9E\u73B0\u5BF9\u5176\u4ED6\u5B58\u50A8\u7CFB\u7EDF\u7684\u652F\u6301\u3002</p>",3),ha={id:"_2-2-2\u6587\u4EF6\u5E01\u7247",tabindex:"-1"},fa=n("a",{class:"header-anchor",href:"#_2-2-2\u6587\u4EF6\u5E01\u7247","aria-hidden":"true"},"#",-1),_a={href:"https://spec.filecoin.io/#section-systems.filecoin_files.piece",target:"_blank",rel:"noopener noreferrer"},ga=t('<p>\u8BE5<em>Filecoin\u7247</em>\u662F\u4E3B\u8981\u7684<em>\u8C08\u5224\u5355\u4F4D</em>\u4E3A\u7528\u6237\u5B58\u50A8Filecoin\u7F51\u7EDC\u4E0A\u7684\u6570\u636E\u3002Filecoin Piece<em>\u4E0D\u662F\u5B58\u50A8\u5355\u4F4D</em>\uFF0C\u5B83\u6CA1\u6709\u7279\u5B9A\u5927\u5C0F\uFF0C\u4F46\u662F\u53D7<em>Sector</em>\u5927\u5C0F\u7684\u9650\u5236\u3002Filecoin\u7247\u6BB5\u7684\u5927\u5C0F\u53EF\u4EE5\u4EFB\u610F\uFF0C\u4F46\u662F\u5982\u679C\u7247\u6BB5\u5927\u4E8E\u77FF\u5DE5\u652F\u6301\u7684\u6247\u533A\u7684\u5927\u5C0F\uFF0C\u5219\u5FC5\u987B\u5C06\u5176\u62C6\u5206\u6210\u66F4\u591A\u7684\u7247\u6BB5\uFF0C\u4EE5\u4F7F\u6BCF\u4E2A\u7247\u6BB5\u90FD\u9002\u5408\u4E00\u4E2A\u6247\u533A\u3002</p><p>A<code>Piece</code>\u662F\u4EE3\u8868a\u7684\u5168\u90E8\u6216\u4E00\u90E8\u5206\u7684\u5BF9\u8C61\uFF0C<code>File</code>\u7531<code>Storage Clients</code>\u548C<code>Storage Miners</code>\u5728\u4E2D\u4F7F\u7528<code>Deals</code>\u3002<code>Storage Clients</code>\u79DF\u7528<code>Storage Miners</code>\u5B58\u653E<code>Pieces</code>\u3002</p><p>Piece\u6570\u636E\u7ED3\u6784\u7528\u4E8E\u8BC1\u660E\u5B58\u50A8\u4EFB\u610FIPLD\u56FE\u548C\u5BA2\u6237\u7AEF\u6570\u636E\u3002\u8BE5\u56FE\u663E\u793A\u4E86\u4E00\u4E2A\u90E8\u4EF6\u53CA\u5176\u8BC1\u660E\u6811\u7684\u8BE6\u7EC6\u7EC4\u6210\uFF0C\u5305\u62EC\u5B8C\u6574\u7684\u548C\u5E26\u5BBD\u4F18\u5316\u7684\u90E8\u4EF6\u6570\u636E\u7ED3\u6784\u3002</p><p><img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gn7ulf31hej31900pmn9l.jpg" alt="image-20210201105729280"></p>',4),ya={id:"_2-2-2-1\u6570\u636E\u8868\u793A",tabindex:"-1"},wa=n("a",{class:"header-anchor",href:"#_2-2-2-1\u6570\u636E\u8868\u793A","aria-hidden":"true"},"#",-1),xa={href:"https://spec.filecoin.io/#section-systems.filecoin_files.piece.data-representation",target:"_blank",rel:"noopener noreferrer"},Ca=n("p",null,[s("\u91CD\u8981\u7684\u662F\u8981\u5F3A\u8C03\uFF0C\u63D0\u4EA4\u7ED9Filecoin\u7F51\u7EDC\u7684\u6570\u636E\u5728\u7ECF\u8FC7\u8F6C\u6362\u4E4B\u540E\u624D\u53D8\u6210"),n("code",null,"StorageProvider"),s("\u5B58\u50A8\u6570\u636E\u7684\u683C\u5F0F\u3002")],-1),Sa=n("p",null,"\u4ECE\u7528\u6237\u5F00\u59CB\u51C6\u5907\u8981\u5B58\u50A8\u5728Filecoin\u4E2D\u7684\u6587\u4EF6\u5230\u63D0\u4F9B\u8005\u751F\u6210\u5B58\u50A8\u5728\u4E00\u4E2A\u90E8\u95E8\u4E2D\u7684\u6240\u6709\u4F5C\u54C1\u6807\u8BC6\u7B26\u7684\u8FC7\u7A0B\uFF0C\u4E0B\u9762\u662F\u8FC7\u7A0B\u3002",-1),Fa=n("p",null,"\u524D\u4E09\u4E2A\u6B65\u9AA4\u5728\u5BA2\u6237\u7AEF\u8FDB\u884C\u3002",-1),qa=n("li",null,[s("\u5F53\u5BA2\u6237\u60F3\u8981\u5728Filecoin\u7F51\u7EDC\u4E2D\u5B58\u50A8\u6587\u4EF6\u65F6\uFF0C\u4ED6\u4EEC\u9996\u5148\u751F\u6210\u6587\u4EF6\u7684IPLD DAG\u3002\u8868\u793ADAG\u6839\u8282\u70B9\u7684\u54C8\u5E0C\u662FIPFS\u6837\u5F0F\u7684CID\uFF0C\u79F0\u4E3A"),n("em",null,"\u6709\u6548\u8D1F\u8F7DCID"),s("\u3002")],-1),Pa=n("em",null,"Filecoin Piece",-1),Aa={href:"https://github.com/ipld/specs/blob/master/block-layer/content-addressable-archives.md#summary",target:"_blank",rel:"noopener noreferrer"},Ba=n("em",null,"\u6709\u6548\u8F7D\u8377CID",-1),Ea=n("li",null,[s("\u751F\u6210\u7684.car\u6587\u4EF6\u7528\u989D\u5916\u7684\u96F6\u4F4D"),n("em",null,"\u586B\u5145"),s("\uFF0C\u4EE5\u4F7F\u8BE5\u6587\u4EF6\u5F62\u6210\u4E8C\u8FDB\u5236Merkle\u6811\u3002\u4E3A\u4E86\u83B7\u5F97\u5E72\u51C0\u7684\u4E8C\u8FDB\u5236Merkle\u6811\uFF0C.car\u6587\u4EF6\u7684\u5927\u5C0F\u5FC5\u987B\u4E3A2\uFF08^ 2\uFF09\u7684\u5E42\u3002\u586B\u5145\u8FC7\u7A0B\u79F0\u4E3A"),n("code",null,"Fr32 padding"),s("\uFF0C\u5C06\u6BCF256\u4F4D\u4E2D\u7684254\u4F4D\u4E2D\u7684\u4E24\uFF082\uFF09\u4E2A\u96F6\u4F4D\u52A0\u5230\u8F93\u5165\u6587\u4EF6\u4E2D\u3002\u4E0B\u4E00\u6B65\uFF0C\u586B\u5145\u8FC7\u7A0B\u83B7\u53D6\u8FC7\u7A0B\u7684\u8F93\u51FA\uFF0C"),n("code",null,"Fr32 padding"),s("\u5E76\u627E\u5230\u5176\u4E0A\u65B9\u7684\u5927\u5C0F\uFF0C\u4ECE\u800C\u5F97\u52302\u7684\u5E42\u3002"),n("code",null,"Fr32 padding"),s("\u4E0B\u4E00\u4E2A2\u7684\u5E42\u6B21\u65B9\u7684\u7ED3\u679C\u4E4B\u95F4\u7684\u5DEE\u8DDD\u7528\u96F6\u586B\u5145\u3002")],-1),Ta=t("<p>\u4E3A\u4E86\u8BF4\u660E\u8FD9\u4E9B\u6B65\u9AA4\u80CC\u540E\u7684\u539F\u56E0\uFF0C\u91CD\u8981\u7684\u662F\u4E86\u89E3<code>StorageClient</code>\u548C\u4E4B\u95F4\u7684\u603B\u4F53\u8C08\u5224\u8FC7\u7A0B<code>StorageProvider</code>\u3002CID\u6216CommP\u662F\u5BA2\u6237\u4E0E\u5B58\u50A8\u63D0\u4F9B\u5546\u534F\u5546\u5E76\u540C\u610F\u7684\u4EA4\u6613\u4E2D\u5305\u542B\u7684\u5185\u5BB9\u3002\u8FBE\u6210\u534F\u8BAE\u540E\uFF0C\u5BA2\u6237\u7AEF\u5C06\u6587\u4EF6\u53D1\u9001\u7ED9\u63D0\u4F9B\u8005\uFF08\u4F7F\u7528GraphSync\uFF09\u3002\u63D0\u4F9B\u8005\u5FC5\u987B\u4ECE\u63A5\u6536\u5230\u7684\u6587\u4EF6\u4E2D\u6784\u9020\u51FACAR\u6587\u4EF6\uFF0C\u5E76\u4ECE\u5176\u4E00\u4FA7\u5BFC\u51FAPiece CID\u3002\u4E3A\u4E86\u907F\u514D\u5BA2\u6237\u5411\u5546\u5B9A\u7684\u6587\u4EF6\u53D1\u9001\u4E0D\u540C\u7684\u6587\u4EF6\uFF0C\u63D0\u4F9B\u8005\u751F\u6210\u7684\u4EF6CID\u5FC5\u987B\u4E0E\u5148\u524D\u534F\u5546\u7684\u4EA4\u6613\u4E2D\u5305\u542B\u7684\u6587\u4EF6CID\u76F8\u540C\u3002</p><p>\u4EE5\u4E0B\u6B65\u9AA4\u5728<code>StorageProvider</code>\u4E00\u4FA7\u8FDB\u884C\uFF08\u9664\u4E86\u6B65\u9AA44\uFF0C\u4E5F\u53EF\u4EE5\u5728\u5BA2\u6237\u7AEF\u8FDB\u884C\uFF09\u3002</p><ol><li>\u4E00\u65E6<code>StorageProvider</code>\u63A5\u6536\u5230\u6765\u81EA\u5BA2\u6237\u7AEF\u7684\u6587\u4EF6\uFF0C\u4ED6\u4EEC\u5C31\u4F1A\u4ECEPiece\u7684\u54C8\u5E0C\u503C\uFF08\u586B\u5145\u7684.car\u6587\u4EF6\uFF09\u4E2D\u8BA1\u7B97\u51FAMerkle\u6839\u3002\u5E72\u51C0\u7684\u4E8C\u53C9\u6811Merkle\u6811\u7684\u7ED3\u679C\u6839\u662F<strong>Piece CID</strong>\u3002\u8FD9\u4E5F\u79F0\u4E3A<em>CommP</em>\u6216<em>\u8BA1\u4EF6\u627F\u8BFA</em>\uFF0C\u5982\u524D\u6240\u8FF0\uFF0C\u5FC5\u987B\u4E0E\u4EA4\u6613\u4E2D\u5305\u542B\u7684<em>\u627F\u8BFA</em>\u76F8\u540C\u3002</li><li>\u8BE5\u90E8\u5206\u4E0E\u5176\u4ED6\u4EA4\u6613\u7684\u6570\u636E\u4E00\u8D77\u5305\u542B\u5728\u4E00\u4E2A\u90E8\u95E8\u4E2D\u3002\u5728<code>StorageProvider</code>\u968F\u540E\u8BA1\u7B97\u6240\u6709\u90E8\u95E8\u5185\u4EF6\u6885\u514B\u5C14\u6839\u3002\u8BE5\u6811\u7684\u6839\u662F<em>CommD</em>\uFF08\u53C8\u79F0<em>\u6570\u636E\u627F\u8BFA</em>\u6216<code>UnsealedSectorCID</code>\uFF09\u3002</li><li>\u6240\u8FF0<code>StorageProvider</code>\u7136\u540E\u5BC6\u5C01\u8BE5\u6247\u533A\u5E76\u4E14\u5C06\u6240\u5F97\u6885\u514B\u5C14\u6839\u7684\u6839\u662F<em>CommRLast</em>\u3002</li><li>\u7279\u522B\u662F\u590D\u5236\u8BC1\u660E\uFF08PoRep\uFF09\uFF0C\u7279\u522B\u662FSDR\uFF0C\u4F1A\u751F\u6210\u53E6\u4E00\u4E2A\u540D\u4E3A<em>CommC\u7684</em>Merkle\u6839\u54C8\u5E0C\uFF0C\u4EE5\u8BC1\u660E\u5DF2\u6B63\u786E\u6267\u884C\u4E86\u627F\u8BFA\u4E3A<em>CommD</em>\u7684\u6570\u636E\u7684\u590D\u5236\u3002</li><li>\u6700\u540E\uFF0C<em>CommR</em>\uFF08\u6216<em>\u590D\u5236\u627F\u8BFA</em>\uFF09\u662FCommC\u7684\u54C8\u5E0C\u3002CommRLast\u3002</li></ol><p><strong>\u91CD\u8981\u7B14\u8BB0\uFF1A</strong></p><ul><li><code>Fr32</code>\u662F\u5B57\u6BB5\u5143\u7D20\u768432\u4F4D\u8868\u793A\u5F62\u5F0F\uFF08\u5728\u6211\u4EEC\u7684\u60C5\u51B5\u4E0B\u4E3ABLS12-381\u7684\u7B97\u672F\u5B57\u6BB5\uFF09\u3002\u4E3A\u4E86\u683C\u5F0F\u6B63\u786E\uFF0C\u7C7B\u578B\u503C<code>Fr32</code>\u5FC5\u987B<em>\u5B9E\u9645\u4E0A</em>\u9002\u5408\u8BE5\u5B57\u6BB5\uFF0C\u4F46\u662F\u7C7B\u578B\u7CFB\u7EDF\u4E0D\u5F3A\u5236\u6267\u884C\u8BE5\u503C\u3002\u5B83\u662F\u4E0D\u53D8\u91CF\uFF0C\u5FC5\u987B\u6B63\u786E\u4F7F\u7528\u624D\u80FD\u4FDD\u7559\u3002\u5728\u6240\u8C13\u7684\u60C5\u51B5\u4E0B<code>Fr32 padding</code>\uFF0C\u4E24\u4E2A\u96F6\u4F4D\u88AB\u63D2\u5165\u5230\u4E00\u4E2A\u201C\u9700\u8981\u201D\u6700\u591A254\u4F4D\u624D\u80FD\u8868\u793A\u7684\u6570\u5B57\u4E4B\u540E\u3002\u8FD9\u4FDD\u8BC1\u4E86\u7ED3\u679C\u5C06\u4E3A<code>Fr32</code>\uFF0C\u800C\u4E0D\u7BA1\u521D\u59CB254\u4F4D\u7684\u503C\u5982\u4F55\u3002\u8FD9\u662F\u4E00\u79CD\u201C\u4FDD\u5B88\u201D\u6280\u672F\uFF0C\u56E0\u4E3A\u5BF9\u4E8E\u67D0\u4E9B\u521D\u59CB\u503C\uFF0C\u5B9E\u9645\u4E0A\u53EA\u9700\u8981\u4E00\u70B9\u96F6\u586B\u5145\u3002</li><li>\u4E0A\u9762\u7684\u6B65\u9AA42\u548C3\u662F\u7279\u5B9A\u4E8ELotus\u5B9E\u73B0\u7684\u3002\u53EF\u4EE5\u901A\u8FC7\u4E0D\u540C\u7684\u65B9\u5F0F\u6765\u5B9E\u73B0\u76F8\u540C\u7684\u7ED3\u679C\uFF0C\u4F8B\u5982\uFF0C\u65E0\u9700\u4F7F\u7528<code>Fr32</code>\u4F4D\u586B\u5145\u3002\u4F46\u662F\uFF0C\u4EFB\u4F55\u5B9E\u73B0\u90FD\u5FC5\u987B\u786E\u4FDD\u5BF9\u521D\u59CBIPLD DAG\u8FDB\u884C\u4E86\u5E8F\u5217\u5316\u548C\u586B\u5145\uFF0C\u4EE5\u4FBF\u63D0\u4F9B\u5E72\u51C0\u7684\u4E8C\u53C9\u6811\uFF0C\u56E0\u6B64\uFF0C\u4ECE\u6240\u5F97\u6570\u636E\u6591\u70B9\u4E2D\u8BA1\u7B97\u51FAMerkle\u6839\u65F6\uFF0C\u5C06\u5F97\u5230\u76F8\u540C\u7684<strong>Piece CID</strong>\u3002\u53EA\u8981\u662F\u8FD9\u79CD\u60C5\u51B5\uFF0C\u5B9E\u73B0\u53EF\u80FD\u4F1A\u504F\u79BB\u4E0A\u9762\u7684\u524D\u4E09\u4E2A\u6B65\u9AA4\u3002</li><li>\u6700\u540E\uFF0C\u91CD\u8981\u7684\u662F\u6DFB\u52A0\u4E0E<em>\u6709\u6548\u8F7D\u8377CID</em>\uFF08\u5728\u4E0A\u9762\u7684\u524D\u4E24\u4E2A\u6B65\u9AA4\u4E2D\u8BA8\u8BBA\u8FC7\uFF09\u548C\u6570\u636E\u68C0\u7D22\u8FC7\u7A0B\u6709\u5173\u7684\u6CE8\u91CA\u3002\u68C0\u7D22\u4EA4\u6613\u6839\u636E<em>\u6709\u6548\u8D1F\u8F7DCID</em>\u8FDB\u884C\u534F\u5546\u3002\u8FBE\u6210\u68C0\u7D22\u534F\u8BAE\u540E\uFF0C\u68C0\u7D22\u77FF\u5DE5\u5C06\u5F00\u59CB\u5C06\u672A\u5BC6\u5C01\u548C\u201C\u672ACAR&#39;ed\u201D\u7684\u6587\u4EF6\u53D1\u9001\u7ED9\u5BA2\u6237\u7AEF\u3002\u4F20\u8F93\u4ECEIPLD Merkle\u6811\u7684\u6839\u8282\u70B9\u5F00\u59CB\uFF0C\u8FD9\u6837\u5BA2\u6237\u7AEF\u53EF\u4EE5\u4ECE\u4F20\u8F93\u5F00\u59CB\u5C31\u9A8C\u8BC1<em>\u6709\u6548\u8D1F\u8F7DCID</em>\uFF0C\u5E76\u9A8C\u8BC1\u4ED6\u4EEC\u63A5\u6536\u7684\u6587\u4EF6\u662F\u4ED6\u4EEC\u5728\u4EA4\u6613\u4E2D\u534F\u5546\u7684\u6587\u4EF6\uFF0C\u800C\u4E0D\u662F\u968F\u673A\u4F4D\u3002</li></ul>",5),Ia={id:"_2-2-2-2\u4EF6\u5546\u5E97",tabindex:"-1"},Ra=n("a",{class:"header-anchor",href:"#_2-2-2-2\u4EF6\u5546\u5E97","aria-hidden":"true"},"#",-1),Ma={href:"https://spec.filecoin.io/#section-systems.filecoin_files.piece.piecestore",target:"_blank",rel:"noopener noreferrer"},Da=n("code",null,"PieceStore",-1),Ga={href:"https://github.com/filecoin-project/go-fil-markets/blob/master/storagemarket",target:"_blank",rel:"noopener noreferrer"},Va={href:"https://github.com/filecoin-project/go-fil-markets/blob/master/retrievalmarket",target:"_blank",rel:"noopener noreferrer"},La={href:"https://github.com/filecoin-project/go-fil-markets/tree/master/piecestore",target:"_blank",rel:"noopener noreferrer"},Na={id:"_2-2-3filecoin\u4E2D\u7684\u6570\u636E\u4F20\u8F93",tabindex:"-1"},ja=n("a",{class:"header-anchor",href:"#_2-2-3filecoin\u4E2D\u7684\u6570\u636E\u4F20\u8F93","aria-hidden":"true"},"#",-1),Ha={href:"https://spec.filecoin.io/#section-systems.filecoin_files.data_transfer",target:"_blank",rel:"noopener noreferrer"},Oa=n("p",null,[s("\u7684"),n("em",null,"\u6570\u636E\u4F20\u8F93\u534F\u8BAE"),s("\u662F\u7528\u4E8E\u4F20\u8F93\u7684\u5168\u90E8\u6216\u4E00\u90E8\u5206\u7684\u534F\u8BAE"),n("code",null,"Piece"),s("\u8DE8\u8D8A\u7F51\u7EDC\u65F6\u5904\u7406\u662F\u5236\u6210\u3002\u6570\u636E\u4F20\u8F93\u6A21\u5757\u7684\u603B\u4F53\u76EE\u6807\u662F\u4F7F\u5176\u6210\u4E3A\u5E95\u5C42\u4F20\u8F93\u4ECB\u8D28\u7684\u62BD\u8C61\uFF0C\u901A\u8FC7\u8BE5\u5E95\u5C42\u4F20\u8F93\u4ECB\u8D28\u5728Filecoin\u7F51\u7EDC\u4E2D\u4E0D\u540C\u5404\u65B9\u4E4B\u95F4\u4F20\u8F93\u6570\u636E\u3002\u5F53\u524D\uFF0C\u7528\u4E8E\u5B9E\u9645\u8FDB\u884C\u6570\u636E\u4F20\u8F93\u7684\u5E95\u5C42\u4ECB\u8D28\u6216\u534F\u8BAE\u662FGraphSync\u3002\u8FD9\u6837\uFF0C\u53EF\u4EE5\u5C06\u6570\u636E\u4F20\u8F93\u534F\u8BAE\u89C6\u4E3A\u534F\u5546\u534F\u8BAE\u3002")],-1),Ua=n("p",null,[s("\u6570\u636E\u4F20\u8F93\u534F\u8BAE\u65E2\u7528\u4E8E\u5B58\u50A8\u53C8\u7528\u4E8E\u68C0\u7D22\u4EA4\u6613\u3002\u5728\u8FD9\u4E24\u79CD\u60C5\u51B5\u4E0B\uFF0C\u6570\u636E\u4F20\u8F93\u8BF7\u6C42\u90FD\u662F\u7531\u5BA2\u6237\u7AEF\u53D1\u8D77\u7684\u3002\u8FD9\u6837\u505A\u7684\u4E3B\u8981\u539F\u56E0\u662F\uFF0C\u5BA2\u6237\u7AEF\u901A\u5E38\u6BD4NAT\u843D\u540E\u5F88\u591A\uFF0C\u56E0\u6B64\u4ECE\u5176\u7AEF\u5F00\u59CB\u4EFB\u4F55\u6570\u636E\u4F20\u8F93\u66F4\u52A0\u65B9\u4FBF\u3002\u5BF9\u4E8E\u5B58\u50A8\u4EA4\u6613\uFF0C\u6570\u636E\u4F20\u8F93\u8BF7\u6C42\u5C06\u4F5C\u4E3A"),n("em",null,"\u63A8\u9001\u8BF7\u6C42"),s("\u542F\u52A8\uFF0C\u4EE5\u5C06\u6570\u636E\u53D1\u9001\u5230\u5B58\u50A8\u63D0\u4F9B\u5546\u3002\u5728\u201C\u68C0\u7D22\u4EA4\u6613\u201D\u7684\u60C5\u51B5\u4E0B\uFF0C\u6570\u636E\u4F20\u8F93\u8BF7\u6C42\u4F5C\u4E3A"),n("em",null,"\u62C9\u53D6\u8BF7\u6C42"),s("\u542F\u52A8\uFF0C\u4EE5\u7531\u5B58\u50A8\u63D0\u4F9B\u5546\u68C0\u7D22\u6570\u636E\u3002")],-1),za=n("p",null,"\u53D1\u8D77\u6570\u636E\u4F20\u8F93\u7684\u8BF7\u6C42\u5305\u62EC\u51ED\u8BC1\u6216\u4EE4\u724C\uFF08\u4E0D\u8981\u4E0E\u4ED8\u6B3E\u6E20\u9053\u51ED\u8BC1\u6DF7\u6DC6\uFF09\uFF0C\u8BE5\u51ED\u8BC1\u6216\u4EE4\u724C\u6307\u5411\u53CC\u65B9\u4E4B\u524D\u5DF2\u8FBE\u6210\u7684\u7279\u5B9A\u4EA4\u6613\u3002\u8FD9\u6837\u4E00\u6765\uFF0C\u5B58\u50A8\u63D0\u4F9B\u5546\u4FBF\u53EF\u4EE5\u8BC6\u522B\u8BF7\u6C42\u5E76\u5C06\u5176\u94FE\u63A5\u5230\u5DF2\u540C\u610F\u7684\u4EA4\u6613\uFF0C\u800C\u4E0D\u4F1A\u5FFD\u7565\u8BE5\u8BF7\u6C42\u3002\u5982\u4E0B\u6240\u8FF0\uFF0C\u68C0\u7D22\u4EA4\u6613\u7684\u60C5\u51B5\u53EF\u80FD\u7565\u6709\u4E0D\u540C\uFF0C\u5728\u6B64\u60C5\u51B5\u4E0B\uFF0C\u4EA4\u6613\u63D0\u8BAE\u548C\u6570\u636E\u4F20\u8F93\u8BF7\u6C42\u90FD\u53EF\u4EE5\u4E00\u6B21\u53D1\u9001\u3002",-1),Wa={id:"_2-2-3-1\u6A21\u7EC4",tabindex:"-1"},Za=n("a",{class:"header-anchor",href:"#_2-2-3-1\u6A21\u7EC4","aria-hidden":"true"},"#",-1),Ka={href:"https://spec.filecoin.io/#section-systems.filecoin_files.data_transfer.modules",target:"_blank",rel:"noopener noreferrer"},Qa=n("p",null,"\u8BE5\u56FE\u663E\u793A\u4E86\u6570\u636E\u4F20\u8F93\u53CA\u5176\u6A21\u5757\u5982\u4F55\u4E0E\u5B58\u50A8\u548C\u68C0\u7D22\u5E02\u573A\u76F8\u5339\u914D\u3002\u7279\u522B\u8981\u6CE8\u610F\uFF0C\u5982\u4F55\u5C06\u6765\u81EA\u5E02\u573A\u7684\u6570\u636E\u4F20\u8F93\u8BF7\u6C42\u9A8C\u8BC1\u5668\u63D2\u5165\u201C\u6570\u636E\u4F20\u8F93\u201D\u6A21\u5757\uFF0C\u4F46\u5176\u4EE3\u7801\u5C5E\u4E8E\u5E02\u573A\u7CFB\u7EDF\u3002",-1),Ja=n("p",null,[n("img",{src:"https://tva1.sinaimg.cn/large/008eGmZEgy1gn7unqn5ipj31980pan1w.jpg",alt:"image-20210201105943338"})],-1),Xa={id:"_2-2-3-2\u672F\u8BED",tabindex:"-1"},Ya=n("a",{class:"header-anchor",href:"#_2-2-3-2\u672F\u8BED","aria-hidden":"true"},"#",-1),$a={href:"https://spec.filecoin.io/#section-systems.filecoin_files.data_transfer.terminology",target:"_blank",rel:"noopener noreferrer"},ne=t("<li><strong>\u63A8\u9001\u8BF7\u6C42</strong>\uFF1A\u5C06\u6570\u636E\u53D1\u9001\u7ED9\u53E6\u4E00\u65B9\u7684\u8BF7\u6C42-\u901A\u5E38\u7531\u5BA2\u6237\u7AEF\u53D1\u8D77\uFF0C\u4E3B\u8981\u662F\u5728\u53D1\u751F\u5B58\u50A8\u4EA4\u6613\u7684\u60C5\u51B5\u4E0B\u3002</li><li>\u63D0\u53D6<strong>\u8BF7\u6C42</strong>\uFF1A\u8BF7\u6C42\u5BF9\u65B9\u53D1\u9001\u6570\u636E\u7684\u8BF7\u6C42-\u901A\u5E38\u7531\u5BA2\u6237\u53D1\u8D77\uFF0C\u4E3B\u8981\u662F\u5728\u201C\u68C0\u7D22\u4EA4\u6613\u201D\u7684\u60C5\u51B5\u4E0B\u3002</li><li><strong>\u8BF7\u6C42\u8005</strong>\uFF1A\u53D1\u8D77\u6570\u636E\u4F20\u8F93\u8BF7\u6C42\u7684\u4E00\u65B9\uFF08\u65E0\u8BBA\u662F\u63A8\u8FD8\u662F\u62C9\uFF09-\u901A\u5E38\u81F3\u5C11\u5728Filecoin\u4E2D\u5F53\u524D\u5B9E\u73B0\u7684\u5BA2\u6237\u7AEF\uFF0C\u4EE5\u514B\u670DNAT\u904D\u5386\u95EE\u9898\u3002</li><li><strong>\u54CD\u5E94\u8005</strong>\uFF1A\u63A5\u6536\u6570\u636E\u4F20\u8F93\u8BF7\u6C42\u7684\u4E00\u65B9-\u901A\u5E38\u662F\u5B58\u50A8\u63D0\u4F9B\u8005\u3002</li><li><strong>\u6570\u636E\u4F20\u8F93\u51ED\u8BC1\u6216\u4EE4\u724C</strong>\uFF1A\u56F4\u7ED5\u5B58\u50A8\u6216\u68C0\u7D22\u76F8\u5173\u6570\u636E\u7684\u5305\u88C5\uFF0C\u53EF\u4EE5\u8BC6\u522B\u548C\u9A8C\u8BC1\u5411\u53E6\u4E00\u65B9\u7684\u4F20\u8F93\u8BF7\u6C42\u3002</li><li><strong>\u8BF7\u6C42\u9A8C\u8BC1\u5668</strong>\uFF1A\u4EC5\u5F53\u54CD\u5E94\u8005\u53EF\u4EE5\u9A8C\u8BC1\u8BF7\u6C42\u662F\u5426\u76F4\u63A5\u7ED1\u5B9A\u5230\u73B0\u6709\u5B58\u50A8\u6216\u68C0\u7D22\u4EA4\u6613\u65F6\uFF0C\u6570\u636E\u4F20\u8F93\u6A21\u5757\u624D\u542F\u52A8\u4F20\u8F93\u3002\u9A8C\u8BC1\u4E0D\u7531\u6570\u636E\u4F20\u8F93\u6A21\u5757\u672C\u8EAB\u6267\u884C\u3002\u53D6\u800C\u4EE3\u4E4B\u7684\u662F\uFF0C\u8BF7\u6C42\u9A8C\u8BC1\u5668\u68C0\u67E5\u6570\u636E\u4F20\u8F93\u51ED\u5355\u4EE5\u786E\u5B9A\u662F\u5426\u54CD\u5E94\u8BF7\u6C42\u6216\u4E0D\u7406\u4F1A\u8BF7\u6C42\u3002</li><li><strong>\u8FD0\u8F93\u8005</strong>\uFF1A\u534F\u5546\u548C\u786E\u8BA4\u8BF7\u6C42\u540E\uFF0C\u5B9E\u9645\u7684\u8F6C\u79FB\u7531\u53CC\u65B9\u7684\u8FD0\u8F93\u8005\u7BA1\u7406\u3002\u4F20\u8F93\u5668\u662F\u6570\u636E\u4F20\u8F93\u6A21\u5757\u7684\u4E00\u90E8\u5206\uFF0C\u4F46\u4E0E\u534F\u5546\u8FC7\u7A0B\u9694\u79BB\u3002\u5B83\u53EF\u4EE5\u8BBF\u95EE\u57FA\u7840\u53EF\u9A8C\u8BC1\u7684\u4F20\u8F93\u534F\u8BAE\uFF0C\u5E76\u4F7F\u7528\u5B83\u6765\u53D1\u9001\u6570\u636E\u548C\u8DDF\u8E2A\u8FDB\u5EA6\u3002</li><li><strong>\u8BA2\u6237</strong>\uFF1A\u4E00\u4E2A\u5916\u90E8\u7EC4\u4EF6\uFF0C\u901A\u8FC7\u8BA2\u9605\u6570\u636E\u4F20\u8F93\u4E8B\u4EF6\uFF08\u4F8B\u5982\u8FDB\u5EA6\u6216\u5B8C\u6210\uFF09\u6765\u76D1\u89C6\u6570\u636E\u4F20\u8F93\u7684\u8FDB\u5EA6\u3002</li>",8),se=n("strong",null,"GraphSync",-1),ae={href:"https://github.com/ipld/specs/blob/master/block-layer/graphsync/graphsync.md",target:"_blank",rel:"noopener noreferrer"},ee={id:"_2-2-3-3\u8BF7\u6C42\u9636\u6BB5",tabindex:"-1"},te=n("a",{class:"header-anchor",href:"#_2-2-3-3\u8BF7\u6C42\u9636\u6BB5","aria-hidden":"true"},"#",-1),oe={href:"https://spec.filecoin.io/#section-systems.filecoin_files.data_transfer.request-phases",target:"_blank",rel:"noopener noreferrer"},pe=n("p",null,"\u4EFB\u4F55\u6570\u636E\u4F20\u8F93\u90FD\u6709\u4E24\u4E2A\u57FA\u672C\u9636\u6BB5\uFF1A",-1),ie=n("ol",null,[n("li",null,"\u534F\u5546\uFF1A\u8BF7\u6C42\u8005\u548C\u54CD\u5E94\u8005\u901A\u8FC7\u4F7F\u7528\u6570\u636E\u4F20\u8F93\u51ED\u8BC1\u9A8C\u8BC1\u4F20\u8F93\u6765\u540C\u610F\u4F20\u8F93\u3002"),n("li",null,"\u4F20\u8F93\uFF1A\u534F\u5546\u9636\u6BB5\u5B8C\u6210\u540E\uFF0C\u5B9E\u9645\u4E0A\u5C31\u4F20\u8F93\u4E86\u6570\u636E\u3002\u7528\u4E8E\u8FDB\u884C\u4F20\u8F93\u7684\u9ED8\u8BA4\u534F\u8BAE\u662FGraphsync\u3002")],-1),ce={href:"https://github.com/ipld/specs/blob/master/block-layer/graphsync/graphsync.md#extensions",target:"_blank",rel:"noopener noreferrer"},le={href:"https://github.com/ipld/specs/blob/master/block-layer/graphsync/graphsync.md#extensions",target:"_blank",rel:"noopener noreferrer"},ue=n("code",null,"push",-1),re=n("code",null,"/fil/datatransfer/1.0.0",-1),de=t('<p>\u503C\u5F97\u6CE8\u610F\u7684\u662F\uFF0C\u5728\u53D6\u56DE\u7684\u60C5\u51B5\u4E0B\uFF0C\u63D0\u4F9B\u8005\u53EF\u4EE5\u63A5\u53D7\u4EA4\u6613\u548C\u6570\u636E\u4F20\u8F93\u8BF7\u6C42\uFF0C\u4F46\u662F\u53EF\u4EE5\u6682\u505C\u53D6\u56DE\u672C\u8EAB\u4EE5\u6267\u884C\u542F\u5C01\u8FC7\u7A0B\u3002\u5728\u5F00\u59CB\u5B9E\u9645\u7684\u6570\u636E\u4F20\u8F93\u4E4B\u524D\uFF0C\u5B58\u50A8\u63D0\u4F9B\u5546\u5FC5\u987B\u89E3\u5C01\u6240\u6709\u8BF7\u6C42\u7684\u6570\u636E\u3002\u6B64\u5916\uFF0C\u5B58\u50A8\u63D0\u4F9B\u5546\u53EF\u4EE5\u9009\u62E9\u5728\u5F00\u59CB\u5F00\u5C01\u8FC7\u7A0B\u4E4B\u524D\u6682\u505C\u68C0\u7D22\u6D41\u7A0B\uFF0C\u4EE5\u8BF7\u6C42\u5F00\u5C01\u4ED8\u6B3E\u8BF7\u6C42\u3002\u5B58\u50A8\u4F9B\u5E94\u5546\u53EF\u4EE5\u9009\u62E9\u8981\u6C42\u652F\u4ED8\u8FD9\u7B14\u6B3E\u9879\uFF0C\u4EE5\u652F\u4ED8\u4E0D\u53EF\u601D\u8BAE\u7684\u8BA1\u7B97\u6210\u672C\uFF0C\u5E76\u907F\u514D\u6210\u4E3A\u884C\u4E3A\u4E0D\u7AEF\u7684\u5BA2\u6237\u7684\u53D7\u5BB3\u8005\u3002</p><h4 id="_2-2-3-4-\u6D41\u7A0B\u793A\u4F8B" tabindex="-1"><a class="header-anchor" href="#_2-2-3-4-\u6D41\u7A0B\u793A\u4F8B" aria-hidden="true">#</a> 2.2.3.4 \u6D41\u7A0B\u793A\u4F8B</h4><h5 id="_2-2-3-4-1-\u63A8\u6D41" tabindex="-1"><a class="header-anchor" href="#_2-2-3-4-1-\u63A8\u6D41" aria-hidden="true">#</a> 2.2.3.4.1 \u63A8\u6D41</h5><p><img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gn7urnqsigj31cs0owjuk.jpg" alt="image-20210201110343745"></p><ol><li>\u5F53\u8BF7\u6C42\u8005\u60F3\u8981\u5C06\u6570\u636E\u53D1\u9001\u7ED9\u53E6\u4E00\u65B9\u65F6\uFF0C\u5B83\u4F1A\u53D1\u8D77\u201C\u63A8\u201D\u4F20\u8F93\u3002</li><li>\u8BF7\u6C42\u8005\u7684\u6570\u636E\u4F20\u8F93\u6A21\u5757\u5C06\u628A\u63A8\u9001\u8BF7\u6C42\u4E0E\u6570\u636E\u4F20\u8F93\u51ED\u8BC1\u4E00\u8D77\u53D1\u9001\u7ED9\u54CD\u5E94\u8005\u3002</li><li>\u54CD\u5E94\u8005\u7684\u6570\u636E\u4F20\u8F93\u6A21\u5757\u901A\u8FC7\u9A8C\u8BC1\u5668\u9A8C\u8BC1\u6570\u636E\u4F20\u8F93\u8BF7\u6C42\uFF0C\u8BE5\u9A8C\u8BC1\u5668\u662F\u54CD\u5E94\u8005\u63D0\u4F9B\u7684\u4F9D\u8D56\u9879\u3002</li><li>\u54CD\u5E94\u8005\u7684\u6570\u636E\u4F20\u8F93\u6A21\u5757\u901A\u8FC7\u53D1\u51FAGraphSync\u8BF7\u6C42\u6765\u542F\u52A8\u4F20\u8F93\u3002</li><li>\u8BF7\u6C42\u8005\u63A5\u6536GraphSync\u8BF7\u6C42\uFF0C\u9A8C\u8BC1\u5B83\u662F\u5426\u8BC6\u522B\u51FA\u6570\u636E\u4F20\u8F93\u5E76\u5F00\u59CB\u53D1\u9001\u6570\u636E\u3002</li><li>\u54CD\u5E94\u8005\u63A5\u6536\u6570\u636E\u5E76\u53EF\u4EE5\u4EA7\u751F\u8FDB\u5EA6\u6307\u793A\u3002</li><li>\u54CD\u5E94\u8005\u5B8C\u6210\u63A5\u6536\u6570\u636E\uFF0C\u5E76\u901A\u77E5\u6240\u6709\u4FA6\u542C\u5668\u3002</li></ol><p>\u63A8\u9001\u6D41\u7A0B\u975E\u5E38\u9002\u5408\u5B58\u50A8\u4EA4\u6613\uFF0C\u5728\u5B58\u50A8\u4EA4\u6613\u4E2D\uFF0C\u4E00\u65E6\u63D0\u4F9B\u8005\u8868\u660E\u4ED6\u4EEC\u6253\u7B97\u63A5\u53D7\u5E76\u53D1\u5E03\u5BA2\u6237\u7684\u4EA4\u6613\u5EFA\u8BAE\uFF0C\u5BA2\u6237\u4FBF\u4F1A\u7ACB\u5373\u542F\u52A8\u6570\u636E\u4F20\u8F93\u3002</p><h4 id="_2-2-3-5-\u62C9\u6D41-\u5355\u7A0B\u5F80\u8FD4" tabindex="-1"><a class="header-anchor" href="#_2-2-3-5-\u62C9\u6D41-\u5355\u7A0B\u5F80\u8FD4" aria-hidden="true">#</a> 2.2.3.5 \u62C9\u6D41-\u5355\u7A0B\u5F80\u8FD4</h4><p><img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gn7usyj977j31a40pmtbe.jpg" alt="image-20210201110446569"></p>',8),ke={id:"_2-2-3-6\u534F\u8BAE",tabindex:"-1"},ve=n("a",{class:"header-anchor",href:"#_2-2-3-6\u534F\u8BAE","aria-hidden":"true"},"#",-1),me={href:"https://spec.filecoin.io/#section-systems.filecoin_files.data_transfer.protocol",target:"_blank",rel:"noopener noreferrer"},be=n("p",null,"\u53EF\u4EE5\u901A\u8FC7\u6570\u636E\u4F20\u8F93\u534F\u8BAE\uFF08libp2p\u534F\u8BAE\u7C7B\u578B\uFF09\u5728\u7F51\u7EDC\u4E0A\u534F\u5546\u6570\u636E\u4F20\u8F93\u3002",-1),he=n("p",null,"\u4F7F\u7528\u6570\u636E\u4F20\u8F93\u534F\u8BAE\u4F5C\u4E3A\u72EC\u7ACB\u7684libp2p\u901A\u8BAF\u673A\u5236\u5E76\u4E0D\u662F\u786C\u6027\u8981\u6C42-\u53EA\u8981\u53CC\u65B9\u90FD\u5B9E\u73B0\u4E86\u53EF\u4EE5\u4E0E\u5BF9\u65B9\u901A\u4FE1\u7684\u6570\u636E\u4F20\u8F93\u5B50\u7CFB\u7EDF\uFF0C\u4EFB\u4F55\u4F20\u8F93\u673A\u5236\uFF08\u5305\u62EC\u79BB\u7EBF\u673A\u5236\uFF09\u90FD\u662F\u53EF\u4EE5\u63A5\u53D7\u7684\u3002",-1),fe={id:"_2-2-3-7\u6570\u636E\u7ED3\u6784",tabindex:"-1"},_e=n("a",{class:"header-anchor",href:"#_2-2-3-7\u6570\u636E\u7ED3\u6784","aria-hidden":"true"},"#",-1),ge={href:"https://spec.filecoin.io/#section-systems.filecoin_files.data_transfer.data-structures",target:"_blank",rel:"noopener noreferrer"},ye={href:"https://spec.filecoin.io/#example-data-transfer-types",target:"_blank",rel:"noopener noreferrer"},we=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> datatransfer

<span class="token keyword">import</span> <span class="token punctuation">(</span>
 <span class="token string">&quot;fmt&quot;</span>

 <span class="token string">&quot;github.com/ipfs/go-cid&quot;</span>
 <span class="token string">&quot;github.com/ipld/go-ipld-prime&quot;</span>
 <span class="token string">&quot;github.com/libp2p/go-libp2p-core/peer&quot;</span>

 <span class="token string">&quot;github.com/filecoin-project/go-data-transfer/encoding&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">//go:generate cbor-gen-for ChannelID</span>

<span class="token comment">// TypeIdentifier is a unique string identifier for a type of encodable object in a</span>
<span class="token comment">// registry</span>
<span class="token keyword">type</span> TypeIdentifier <span class="token builtin">string</span>

<span class="token comment">// EmptyTypeIdentifier means there is no voucher present</span>
<span class="token keyword">const</span> EmptyTypeIdentifier <span class="token operator">=</span> <span class="token function">TypeIdentifier</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// Registerable is a type of object in a registry. It must be encodable and must</span>
<span class="token comment">// have a single method that uniquely identifies its type</span>
<span class="token keyword">type</span> Registerable <span class="token keyword">interface</span> <span class="token punctuation">{</span>
 encoding<span class="token punctuation">.</span>Encodable
 <span class="token comment">// Type is a unique string identifier for this voucher type</span>
 <span class="token function">Type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> TypeIdentifier
<span class="token punctuation">}</span>

<span class="token comment">// Voucher is used to validate</span>
<span class="token comment">// a data transfer request against the underlying storage or retrieval deal</span>
<span class="token comment">// that precipitated it. The only requirement is a voucher can read and write</span>
<span class="token comment">// from bytes, and has a string identifier type</span>
<span class="token keyword">type</span> Voucher Registerable

<span class="token comment">// VoucherResult is used to provide option additional information about a</span>
<span class="token comment">// voucher being rejected or accepted</span>
<span class="token keyword">type</span> VoucherResult Registerable

<span class="token comment">// TransferID is an identifier for a data transfer, shared between</span>
<span class="token comment">// request/responder and unique to the requester</span>
<span class="token keyword">type</span> TransferID <span class="token builtin">uint64</span>

<span class="token comment">// ChannelID is a unique identifier for a channel, distinct by both the other</span>
<span class="token comment">// party&#39;s peer ID + the transfer ID</span>
<span class="token keyword">type</span> ChannelID <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 Initiator peer<span class="token punctuation">.</span>ID
 Responder peer<span class="token punctuation">.</span>ID
 ID        TransferID
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c ChannelID<span class="token punctuation">)</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%s-%s-%d&quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>Initiator<span class="token punctuation">,</span> c<span class="token punctuation">.</span>Responder<span class="token punctuation">,</span> c<span class="token punctuation">.</span>ID<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// OtherParty returns the peer on the other side of the request, depending</span>
<span class="token comment">// on whether this peer is the initiator or responder</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c ChannelID<span class="token punctuation">)</span> <span class="token function">OtherParty</span><span class="token punctuation">(</span>thisPeer peer<span class="token punctuation">.</span>ID<span class="token punctuation">)</span> peer<span class="token punctuation">.</span>ID <span class="token punctuation">{</span>
 <span class="token keyword">if</span> thisPeer <span class="token operator">==</span> c<span class="token punctuation">.</span>Initiator <span class="token punctuation">{</span>
  <span class="token keyword">return</span> c<span class="token punctuation">.</span>Responder
 <span class="token punctuation">}</span>
 <span class="token keyword">return</span> c<span class="token punctuation">.</span>Initiator
<span class="token punctuation">}</span>

<span class="token comment">// Channel represents all the parameters for a single data transfer</span>
<span class="token keyword">type</span> Channel <span class="token keyword">interface</span> <span class="token punctuation">{</span>
 <span class="token comment">// TransferID returns the transfer id for this channel</span>
 <span class="token function">TransferID</span><span class="token punctuation">(</span><span class="token punctuation">)</span> TransferID

 <span class="token comment">// BaseCID returns the CID that is at the root of this data transfer</span>
 <span class="token function">BaseCID</span><span class="token punctuation">(</span><span class="token punctuation">)</span> cid<span class="token punctuation">.</span>Cid

 <span class="token comment">// Selector returns the IPLD selector for this data transfer (represented as</span>
 <span class="token comment">// an IPLD node)</span>
 <span class="token function">Selector</span><span class="token punctuation">(</span><span class="token punctuation">)</span> ipld<span class="token punctuation">.</span>Node

 <span class="token comment">// Voucher returns the voucher for this data transfer</span>
 <span class="token function">Voucher</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Voucher

 <span class="token comment">// Sender returns the peer id for the node that is sending data</span>
 <span class="token function">Sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span> peer<span class="token punctuation">.</span>ID

 <span class="token comment">// Recipient returns the peer id for the node that is receiving data</span>
 <span class="token function">Recipient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> peer<span class="token punctuation">.</span>ID

 <span class="token comment">// TotalSize returns the total size for the data being transferred</span>
 <span class="token function">TotalSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">uint64</span>

 <span class="token comment">// IsPull returns whether this is a pull request</span>
 <span class="token function">IsPull</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">bool</span>

 <span class="token comment">// ChannelID returns the ChannelID for this request</span>
 <span class="token function">ChannelID</span><span class="token punctuation">(</span><span class="token punctuation">)</span> ChannelID

 <span class="token comment">// OtherPeer returns the counter party peer for this channel</span>
 <span class="token function">OtherPeer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> peer<span class="token punctuation">.</span>ID
<span class="token punctuation">}</span>

<span class="token comment">// ChannelState is channel parameters plus it&#39;s current state</span>
<span class="token keyword">type</span> ChannelState <span class="token keyword">interface</span> <span class="token punctuation">{</span>
 Channel

 <span class="token comment">// SelfPeer returns the peer this channel belongs to</span>
 <span class="token function">SelfPeer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> peer<span class="token punctuation">.</span>ID

 <span class="token comment">// Status is the current status of this channel</span>
 <span class="token function">Status</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Status

 <span class="token comment">// Sent returns the number of bytes sent</span>
 <span class="token function">Sent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">uint64</span>

 <span class="token comment">// Received returns the number of bytes received</span>
 <span class="token function">Received</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">uint64</span>

 <span class="token comment">// Message offers additional information about the current status</span>
 <span class="token function">Message</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span>

 <span class="token comment">// Vouchers returns all vouchers sent on this channel</span>
 <span class="token function">Vouchers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>Voucher

 <span class="token comment">// VoucherResults are results of vouchers sent on the channel</span>
 <span class="token function">VoucherResults</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>VoucherResult

 <span class="token comment">// LastVoucher returns the last voucher sent on the channel</span>
 <span class="token function">LastVoucher</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Voucher

 <span class="token comment">// LastVoucherResult returns the last voucher result sent on the channel</span>
 <span class="token function">LastVoucherResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> VoucherResult

 <span class="token comment">// ReceivedCids returns the cids received so far on the channel</span>
 <span class="token function">ReceivedCids</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>cid<span class="token punctuation">.</span>Cid

 <span class="token comment">// Queued returns the number of bytes read from the node and queued for sending</span>
 <span class="token function">Queued</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">uint64</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),xe={href:"https://spec.filecoin.io/#example-data-transfer-statuses",target:"_blank",rel:"noopener noreferrer"},Ce=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> datatransfer

<span class="token comment">// Status is the status of transfer for a given channel</span>
<span class="token keyword">type</span> Status <span class="token builtin">uint64</span>

<span class="token keyword">const</span> <span class="token punctuation">(</span>
 <span class="token comment">// Requested means a data transfer was requested by has not yet been approved</span>
 Requested Status <span class="token operator">=</span> <span class="token boolean">iota</span>

 <span class="token comment">// Ongoing means the data transfer is in progress</span>
 Ongoing

 <span class="token comment">// TransferFinished indicates the initiator is done sending/receiving</span>
 <span class="token comment">// data but is awaiting confirmation from the responder</span>
 TransferFinished

 <span class="token comment">// ResponderCompleted indicates the initiator received a message from the</span>
 <span class="token comment">// responder that it&#39;s completed</span>
 ResponderCompleted

 <span class="token comment">// Finalizing means the responder is awaiting a final message from the initator to</span>
 <span class="token comment">// consider the transfer done</span>
 Finalizing

 <span class="token comment">// Completing just means we have some final cleanup for a completed request</span>
 Completing

 <span class="token comment">// Completed means the data transfer is completed successfully</span>
 Completed

 <span class="token comment">// Failing just means we have some final cleanup for a failed request</span>
 Failing

 <span class="token comment">// Failed means the data transfer failed</span>
 Failed

 <span class="token comment">// Cancelling just means we have some final cleanup for a cancelled request</span>
 Cancelling

 <span class="token comment">// Cancelled means the data transfer ended prematurely</span>
 Cancelled

 <span class="token comment">// InitiatorPaused means the data sender has paused the channel (only the sender can unpause this)</span>
 InitiatorPaused

 <span class="token comment">// ResponderPaused means the data receiver has paused the channel (only the receiver can unpause this)</span>
 ResponderPaused

 <span class="token comment">// BothPaused means both sender and receiver have paused the channel seperately (both must unpause)</span>
 BothPaused

 <span class="token comment">// ResponderFinalizing is a unique state where the responder is awaiting a final voucher</span>
 ResponderFinalizing

 <span class="token comment">// ResponderFinalizingTransferFinished is a unique state where the responder is awaiting a final voucher</span>
 <span class="token comment">// and we have received all data</span>
 ResponderFinalizingTransferFinished

 <span class="token comment">// ChannelNotFoundError means the searched for data transfer does not exist</span>
 ChannelNotFoundError
<span class="token punctuation">)</span>

<span class="token comment">// Statuses are human readable names for data transfer states</span>
<span class="token keyword">var</span> Statuses <span class="token operator">=</span> <span class="token keyword">map</span><span class="token punctuation">[</span>Status<span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
 <span class="token comment">// Requested means a data transfer was requested by has not yet been approved</span>
 Requested<span class="token punctuation">:</span>                           <span class="token string">&quot;Requested&quot;</span><span class="token punctuation">,</span>
 Ongoing<span class="token punctuation">:</span>                             <span class="token string">&quot;Ongoing&quot;</span><span class="token punctuation">,</span>
 TransferFinished<span class="token punctuation">:</span>                    <span class="token string">&quot;TransferFinished&quot;</span><span class="token punctuation">,</span>
 ResponderCompleted<span class="token punctuation">:</span>                  <span class="token string">&quot;ResponderCompleted&quot;</span><span class="token punctuation">,</span>
 Finalizing<span class="token punctuation">:</span>                          <span class="token string">&quot;Finalizing&quot;</span><span class="token punctuation">,</span>
 Completing<span class="token punctuation">:</span>                          <span class="token string">&quot;Completing&quot;</span><span class="token punctuation">,</span>
 Completed<span class="token punctuation">:</span>                           <span class="token string">&quot;Completed&quot;</span><span class="token punctuation">,</span>
 Failing<span class="token punctuation">:</span>                             <span class="token string">&quot;Failing&quot;</span><span class="token punctuation">,</span>
 Failed<span class="token punctuation">:</span>                              <span class="token string">&quot;Failed&quot;</span><span class="token punctuation">,</span>
 Cancelling<span class="token punctuation">:</span>                          <span class="token string">&quot;Cancelling&quot;</span><span class="token punctuation">,</span>
 Cancelled<span class="token punctuation">:</span>                           <span class="token string">&quot;Cancelled&quot;</span><span class="token punctuation">,</span>
 InitiatorPaused<span class="token punctuation">:</span>                     <span class="token string">&quot;InitiatorPaused&quot;</span><span class="token punctuation">,</span>
 ResponderPaused<span class="token punctuation">:</span>                     <span class="token string">&quot;ResponderPaused&quot;</span><span class="token punctuation">,</span>
 BothPaused<span class="token punctuation">:</span>                          <span class="token string">&quot;BothPaused&quot;</span><span class="token punctuation">,</span>
 ResponderFinalizing<span class="token punctuation">:</span>                 <span class="token string">&quot;ResponderFinalizing&quot;</span><span class="token punctuation">,</span>
 ResponderFinalizingTransferFinished<span class="token punctuation">:</span> <span class="token string">&quot;ResponderFinalizingTransferFinished&quot;</span><span class="token punctuation">,</span>
 ChannelNotFoundError<span class="token punctuation">:</span>                <span class="token string">&quot;ChannelNotFoundError&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Se={href:"https://spec.filecoin.io/#example-data-transfer-manager",target:"_blank",rel:"noopener noreferrer"},Fe=t(`<p>\u7BA1\u7406\u5668\u662F\u6570\u636E\u4F20\u8F93\u5B50\u7CFB\u7EDF\u7684\u6240\u6709\u5B9E\u73B0\u6240\u5448\u73B0\u7684\u6838\u5FC3\u63A5\u53E3</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Manager <span class="token keyword">interface</span> <span class="token punctuation">{</span>

 <span class="token comment">// Start initializes data transfer processing</span>
 <span class="token function">Start</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token builtin">error</span>

 <span class="token comment">// OnReady registers a listener for when the data transfer comes on line</span>
 <span class="token function">OnReady</span><span class="token punctuation">(</span>ReadyFunc<span class="token punctuation">)</span>

 <span class="token comment">// Stop terminates all data transfers and ends processing</span>
 <span class="token function">Stop</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token builtin">error</span>

 <span class="token comment">// RegisterVoucherType registers a validator for the given voucher type</span>
 <span class="token comment">// will error if voucher type does not implement voucher</span>
 <span class="token comment">// or if there is a voucher type registered with an identical identifier</span>
 <span class="token function">RegisterVoucherType</span><span class="token punctuation">(</span>voucherType Voucher<span class="token punctuation">,</span> validator RequestValidator<span class="token punctuation">)</span> <span class="token builtin">error</span>

 <span class="token comment">// RegisterRevalidator registers a revalidator for the given voucher type</span>
 <span class="token comment">// Note: this is the voucher type used to revalidate. It can share a name</span>
 <span class="token comment">// with the initial validator type and CAN be the same type, or a different type.</span>
 <span class="token comment">// The revalidator can simply be the sampe as the original request validator,</span>
 <span class="token comment">// or a different validator that satisfies the revalidator interface.</span>
 <span class="token function">RegisterRevalidator</span><span class="token punctuation">(</span>voucherType Voucher<span class="token punctuation">,</span> revalidator Revalidator<span class="token punctuation">)</span> <span class="token builtin">error</span>

 <span class="token comment">// RegisterVoucherResultType allows deserialization of a voucher result,</span>
 <span class="token comment">// so that a listener can read the metadata</span>
 <span class="token function">RegisterVoucherResultType</span><span class="token punctuation">(</span>resultType VoucherResult<span class="token punctuation">)</span> <span class="token builtin">error</span>

 <span class="token comment">// RegisterTransportConfigurer registers the given transport configurer to be run on requests with the given voucher</span>
 <span class="token comment">// type</span>
 <span class="token function">RegisterTransportConfigurer</span><span class="token punctuation">(</span>voucherType Voucher<span class="token punctuation">,</span> configurer TransportConfigurer<span class="token punctuation">)</span> <span class="token builtin">error</span>

 <span class="token comment">// open a data transfer that will send data to the recipient peer and</span>
 <span class="token comment">// transfer parts of the piece that match the selector</span>
 <span class="token function">OpenPushDataChannel</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> to peer<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> voucher Voucher<span class="token punctuation">,</span> baseCid cid<span class="token punctuation">.</span>Cid<span class="token punctuation">,</span> selector ipld<span class="token punctuation">.</span>Node<span class="token punctuation">)</span> <span class="token punctuation">(</span>ChannelID<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>

 <span class="token comment">// open a data transfer that will request data from the sending peer and</span>
 <span class="token comment">// transfer parts of the piece that match the selector</span>
 <span class="token function">OpenPullDataChannel</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> to peer<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> voucher Voucher<span class="token punctuation">,</span> baseCid cid<span class="token punctuation">.</span>Cid<span class="token punctuation">,</span> selector ipld<span class="token punctuation">.</span>Node<span class="token punctuation">)</span> <span class="token punctuation">(</span>ChannelID<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>

 <span class="token comment">// send an intermediate voucher as needed when the receiver sends a request for revalidation</span>
 <span class="token function">SendVoucher</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> chid ChannelID<span class="token punctuation">,</span> voucher Voucher<span class="token punctuation">)</span> <span class="token builtin">error</span>

 <span class="token comment">// close an open channel (effectively a cancel)</span>
 <span class="token function">CloseDataTransferChannel</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> chid ChannelID<span class="token punctuation">)</span> <span class="token builtin">error</span>

 <span class="token comment">// pause a data transfer channel (only allowed if transport supports it)</span>
 <span class="token function">PauseDataTransferChannel</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> chid ChannelID<span class="token punctuation">)</span> <span class="token builtin">error</span>

 <span class="token comment">// resume a data transfer channel (only allowed if transport supports it)</span>
 <span class="token function">ResumeDataTransferChannel</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> chid ChannelID<span class="token punctuation">)</span> <span class="token builtin">error</span>

 <span class="token comment">// get status of a transfer</span>
 <span class="token function">TransferChannelStatus</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> x ChannelID<span class="token punctuation">)</span> Status

 <span class="token comment">// get notified when certain types of events happen</span>
 <span class="token function">SubscribeToEvents</span><span class="token punctuation">(</span>subscriber Subscriber<span class="token punctuation">)</span> Unsubscribe

 <span class="token comment">// get all in progress transfers</span>
 <span class="token function">InProgressChannels</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span>ChannelID<span class="token punctuation">]</span>ChannelState<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>

 <span class="token comment">// RestartDataTransferChannel restarts an existing data transfer channel</span>
 <span class="token function">RestartDataTransferChannel</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> chid ChannelID<span class="token punctuation">)</span> <span class="token builtin">error</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),qe={id:"_2-2-4\u6570\u636E\u683C\u5F0F\u548C\u5E8F\u5217\u5316",tabindex:"-1"},Pe=n("a",{class:"header-anchor",href:"#_2-2-4\u6570\u636E\u683C\u5F0F\u548C\u5E8F\u5217\u5316","aria-hidden":"true"},"#",-1),Ae={href:"https://spec.filecoin.io/#section-systems.filecoin_files.serialization",target:"_blank",rel:"noopener noreferrer"},Be=n("p",null,"Filecoin\u8BD5\u56FE\u5229\u7528\u6240\u9700\u7684\u6570\u636E\u683C\u5F0F\u66F4\u5C11\uFF0C\u5E76\u91C7\u7528\u89C4\u8303\u5316\u7684\u5E8F\u5217\u5316\u89C4\u5219\uFF0C\u4EE5\u901A\u8FC7\u7B80\u5355\u6027\u63D0\u9AD8\u534F\u8BAE\u5B89\u5168\u6027\uFF0C\u5E76\u5B9E\u73B0Filecoin\u534F\u8BAE\u5B9E\u73B0\u4E4B\u95F4\u7684\u4E92\u64CD\u4F5C\u6027\u3002",-1),Ee={href:"https://github.com/filecoin-project/specs/issues/621",target:"_blank",rel:"noopener noreferrer"},Te={href:"https://github.com/filecoin-project/specs/issues/621",target:"_blank",rel:"noopener noreferrer"},Ie={href:"https://github.com/filecoin-project/specs/issues/615",target:"_blank",rel:"noopener noreferrer"},Re={href:"https://github.com/filecoin-project/specs/issues/615",target:"_blank",rel:"noopener noreferrer"},Me={id:"_2-2-4-1\u8D44\u6599\u683C\u5F0F",tabindex:"-1"},De=n("a",{class:"header-anchor",href:"#_2-2-4-1\u8D44\u6599\u683C\u5F0F","aria-hidden":"true"},"#",-1),Ge={href:"https://spec.filecoin.io/#section-systems.filecoin_files.serialization.data-formats",target:"_blank",rel:"noopener noreferrer"},Ve=n("p",null,"Filecoin\u5185\u5B58\u4E2D\u7684\u6570\u636E\u7C7B\u578B\u901A\u5E38\u5F88\u7B80\u5355\u3002\u5B9E\u73B0\u5E94\u652F\u6301\u4E24\u79CD\u6574\u6570\u7C7B\u578B\uFF1AInt\uFF08\u8868\u793A\u672C\u673A64\u4F4D\u6574\u6570\uFF09\u548CBigInt\uFF08\u8868\u793A\u4EFB\u610F\u957F\u5EA6\uFF09\uFF0C\u5E76\u907F\u514D\u5904\u7406\u6D6E\u70B9\u6570\u4EE5\u6700\u5927\u7A0B\u5EA6\u5730\u51CF\u5C11\u8DE8\u7F16\u7A0B\u8BED\u8A00\u548C\u5B9E\u73B0\u7684\u4E92\u64CD\u4F5C\u6027\u95EE\u9898\u3002",-1),Le={href:"https://spec.filecoin.io/#section-algorithms.crypto.randomness",target:"_blank",rel:"noopener noreferrer"},Ne={href:"https://spec.filecoin.io/#section-algorithms.crypto.randomness",target:"_blank",rel:"noopener noreferrer"},je={id:"_2-2-4-2\u5E8F\u5217\u5316",tabindex:"-1"},He=n("a",{class:"header-anchor",href:"#_2-2-4-2\u5E8F\u5217\u5316","aria-hidden":"true"},"#",-1),Oe={href:"https://spec.filecoin.io/#section-systems.filecoin_files.serialization.serialization",target:"_blank",rel:"noopener noreferrer"},Ue=n("p",null,[n("code",null,"Serialization"),s("Filecoin\u4E2D\u7684\u6570\u636E\u53EF\u786E\u4FDD\u7528\u4E8E\u5E8F\u5217\u5316\u5185\u5B58\u4E2D\u6570\u636E\u7684\u4E00\u81F4\u683C\u5F0F\uFF0C\u4EE5\u8FDB\u884C\u4F20\u8F93\u548C\u5B58\u50A8\u4E2D\u4F20\u8F93\u3002\u5E8F\u5217\u5316\u5BF9\u4E8EFilecoin\u534F\u8BAE\u5B9E\u73B0\u4E4B\u95F4\u7684\u534F\u8BAE\u5B89\u5168\u6027\u548C\u4E92\u64CD\u4F5C\u6027\u81F3\u5173\u91CD\u8981\uFF0C\u4ECE\u800C\u53EF\u4EE5\u8DE8Filecoin\u8282\u70B9\u8FDB\u884C\u4E00\u81F4\u7684\u72B6\u6001\u66F4\u65B0\u3002")],-1),ze={href:"https://tools.ietf.org/html/rfc7049",target:"_blank",rel:"noopener noreferrer"},We={href:"https://tools.ietf.org/html/rfc7049#section-2.1",target:"_blank",rel:"noopener noreferrer"},Ze=n("p",null,"\u4E3A\u4E86\u8BF4\u660E\u8D77\u89C1\uFF0C\u5185\u5B58\u6620\u5C04\u5C06\u4EE5\u6309\u9884\u5B9A\u987A\u5E8F\u5217\u51FA\u7684\u952E\u548C\u503C\u7684CBOR\u6570\u7EC4\u8868\u793A\u3002\u5E8F\u5217\u5316\u683C\u5F0F\u7684\u8FD1\u671F\u66F4\u65B0\u5C06\u6D89\u53CA\u9002\u5F53\u5730\u6807\u8BB0\u5B57\u6BB5\uFF0C\u4EE5\u786E\u4FDD\u968F\u7740\u534F\u8BAE\u7684\u53D1\u5C55\u800C\u8FDB\u884C\u9002\u5F53\u7684\u5E8F\u5217\u5316/\u53CD\u5E8F\u5217\u5316\u3002",-1),Ke={id:"_2-3\u865A\u62DF\u673A",tabindex:"-1"},Qe=n("a",{class:"header-anchor",href:"#_2-3\u865A\u62DF\u673A","aria-hidden":"true"},"#",-1),Je={href:"https://spec.filecoin.io/#section-systems.filecoin_vm",target:"_blank",rel:"noopener noreferrer"},Xe=n("p",null,"Filecoin\u533A\u5757\u94FE\u4E2D\u7684Actor\u7B49\u540C\u4E8E\u4EE5\u592A\u574A\u865A\u62DF\u673A\u4E2D\u7684\u667A\u80FD\u5408\u7EA6\u3002",-1),Ye=n("p",null,"Filecoin\u865A\u62DF\u673A\uFF08VM\uFF09\u662F\u8D1F\u8D23\u6267\u884C\u6240\u6709\u53C2\u4E0E\u8005\u4EE3\u7801\u7684\u7CFB\u7EDF\u7EC4\u4EF6\u3002\u5728Filecoin VM\u4E0A\u6267\u884C\u53C2\u4E0E\u8005\uFF08\u5373\u94FE\u4E0A\u6267\u884C\uFF09\u4F1A\u4EA7\u751F\u6C7D\u6CB9\u8D39\u7528\u3002",-1),$e=n("p",null,[s("\u5728Filecoin VM\u4E0A\u5E94\u7528\uFF08\u5373\u6267\u884C\uFF09\u7684\u4EFB\u4F55\u64CD\u4F5C\u90FD\u5C06\u4EE5"),n("em",null,"\u72B6\u6001\u6811"),s("\u7684\u5F62\u5F0F\u4EA7\u751F\u8F93\u51FA\uFF08\u5982\u4E0B\u6240\u8FF0\uFF09\u3002\u6700\u65B0\u7684"),n("em",null,"\u72B6\u6001\u6811"),s("\u662FFilecoin\u533A\u5757\u94FE\u4E2D\u5F53\u524D\u7684\u771F\u76F8\u6765\u6E90\u3002\u8BE5"),n("em",null,"\u56FD\u6811"),s("\u662F\u7531CID\uFF0C\u5176\u5B58\u50A8\u5728IPLD\u5E97\u9274\u5B9A\u3002")],-1),nt={id:"_2-3-1vm-actor\u63A5\u53E3",tabindex:"-1"},st=n("a",{class:"header-anchor",href:"#_2-3-1vm-actor\u63A5\u53E3","aria-hidden":"true"},"#",-1),at={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.actor",target:"_blank",rel:"noopener noreferrer"},et=t("<p>\u5982\u4E0A\u6240\u8FF0\uFF0CActor\u662F\u4EE5\u592A\u574A\u865A\u62DF\u673A\u4E2D\u667A\u80FD\u5408\u7EA6\u7684Filecoin\u7B49\u6548\u9879\u3002\u56E0\u6B64\uFF0CActor\u662F\u7CFB\u7EDF\u7684\u6838\u5FC3\u7EC4\u4EF6\u3002Filecoin\u533A\u5757\u94FE\u5F53\u524D\u72B6\u6001\u7684\u4EFB\u4F55\u66F4\u6539\u90FD\u5FC5\u987B\u901A\u8FC7\u53C2\u4E0E\u8005\u65B9\u6CD5\u8C03\u7528\u6765\u89E6\u53D1\u3002</p><p>\u672C\u5C0F\u8282\u63CF\u8FF0Actor\u4E0EFilecoin\u865A\u62DF\u673A\u4E4B\u95F4\u7684<em>\u63A5\u53E3</em>\u3002\u8FD9\u610F\u5473\u7740\u4E0B\u9762\u63CF\u8FF0\u7684\u5927\u591A\u6570\u5185\u5BB9\u5E76\u4E0D\u4E25\u683C\u5C5E\u4E8EVM\u3002\u76F8\u53CD\uFF0C\u903B\u8F91\u4F4D\u4E8EVM\u548CActors\u903B\u8F91\u4E4B\u95F4\u7684\u63A5\u53E3\u4E0A\u3002</p><p>\u603B\u5171\u5171\u6709\u5341\u4E00\uFF0811\uFF09\u79CD\u7C7B\u578B\u7684<em>\u5185\u7F6E</em>Actor\uFF0C\u4F46\u5E76\u975E\u6240\u6709\u7C7B\u578B\u90FD\u4E0EVM\u4EA4\u4E92\u3002\u4E00\u4E9BActor\u4E0D\u4F1A\u8C03\u7528\u5BF9\u533A\u5757\u94FE\u7684StateTree\u7684\u66F4\u6539\uFF0C\u56E0\u6B64\u4E0D\u9700\u8981\u4E0EVM\u7684\u63A5\u53E3\u3002\u6211\u4EEC\u7A0D\u540E\u5C06\u5728\u201C\u7CFB\u7EDF\u53C2\u4E0E\u8005\u201D\u5C0F\u8282\u4E2D\u8BA8\u8BBA\u6240\u6709\u7CFB\u7EDF\u53C2\u4E0E\u8005\u7684\u8BE6\u7EC6\u4FE1\u606F\u3002</p><p>\u8BE5<em>\u6F14\u5458\u5730\u5740</em>\u662F\u901A\u8FC7\u6563\u5217\u53D1\u9001\u8005\u7684\u516C\u94A5\u548C\u521B\u5EFA\u968F\u673A\u6570\u751F\u6210\u7A33\u5B9A\u7684\u5730\u5740\u3002\u5728\u6574\u4E2A\u94FE\u91CD\u7EC4\u4E2D\u5E94\u8BE5\u4FDD\u6301\u7A33\u5B9A\u3002\u8BE5<em>\u6F14\u5458ID\u5730\u5740</em>\uFF0C\u53E6\u4E00\u65B9\u9762\uFF0C\u662F\u7D27\u51D1\u7684\uFF0C\u4F46\u53EF\u4EE5\u5728\u94FE\u91CD\u65B0\u7EC4\u7EC7\u7684\u60C5\u51B5\u4E0B\u66F4\u6539\u81EA\u52A8\u9012\u589E\u5730\u5740\u3002\u8BDD\u867D\u5982\u6B64\uFF0C\u6F14\u5458\u521B\u5EFA\u540E\u5E94\u8BE5\u4F7F\u7528<em>\u6F14\u5458\u5730\u5740</em>\u3002</p>",4),tt={href:"https://spec.filecoin.io/#example-",target:"_blank",rel:"noopener noreferrer"},ot=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> builtin

<span class="token keyword">import</span> <span class="token punctuation">(</span>
 addr <span class="token string">&quot;github.com/filecoin-project/go-address&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// Addresses for singleton system actors.</span>
<span class="token keyword">var</span> <span class="token punctuation">(</span>
 <span class="token comment">// Distinguished AccountActor that is the source of system implicit messages.</span>
 SystemActorAddr           <span class="token operator">=</span> <span class="token function">mustMakeAddress</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
 InitActorAddr             <span class="token operator">=</span> <span class="token function">mustMakeAddress</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
 RewardActorAddr           <span class="token operator">=</span> <span class="token function">mustMakeAddress</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
 CronActorAddr             <span class="token operator">=</span> <span class="token function">mustMakeAddress</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
 StoragePowerActorAddr     <span class="token operator">=</span> <span class="token function">mustMakeAddress</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
 StorageMarketActorAddr    <span class="token operator">=</span> <span class="token function">mustMakeAddress</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
 VerifiedRegistryActorAddr <span class="token operator">=</span> <span class="token function">mustMakeAddress</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
 <span class="token comment">// Distinguished AccountActor that is the destination of all burnt funds.</span>
 BurntFundsActorAddr <span class="token operator">=</span> <span class="token function">mustMakeAddress</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token keyword">const</span> FirstNonSingletonActorId <span class="token operator">=</span> <span class="token number">100</span>

<span class="token keyword">func</span> <span class="token function">mustMakeAddress</span><span class="token punctuation">(</span>id <span class="token builtin">uint64</span><span class="token punctuation">)</span> addr<span class="token punctuation">.</span>Address <span class="token punctuation">{</span>
 address<span class="token punctuation">,</span> err <span class="token operator">:=</span> addr<span class="token punctuation">.</span><span class="token function">NewIDAddress</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
 <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">return</span> address
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8BE5<code>ActorState</code>\u7ED3\u6784\u7531\u53C2\u4E0E\u8005\u7684\u4F59\u989D\uFF08\u6839\u636E\u8BE5\u53C2\u4E0E\u8005\u6301\u6709\u7684\u4EE4\u724C\uFF09\u4EE5\u53CA\u4E00\u7EC4\u7528\u4E8E\u67E5\u8BE2\uFF0C\u68C0\u67E5\u94FE\u72B6\u6001\u5E76\u4E0E\u4E4B\u4EA4\u4E92\u7684\u72B6\u6001\u65B9\u6CD5\u7EC4\u6210\u3002</p>`,2),pt={id:"_2-3-2\u72B6\u6001\u6811",tabindex:"-1"},it=n("a",{class:"header-anchor",href:"#_2-3-2\u72B6\u6001\u6811","aria-hidden":"true"},"#",-1),ct={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.state_tree",target:"_blank",rel:"noopener noreferrer"},lt=n("p",null,"\u72B6\u6001\u6811\u662F\u5BF9Filecoin\u533A\u5757\u94FE\u5E94\u7528\u7684\u4EFB\u4F55\u64CD\u4F5C\u7684\u6267\u884C\u8F93\u51FA\u3002\u94FE\u4E0A\uFF08\u5373VM\uFF09\u72B6\u6001\u6570\u636E\u7ED3\u6784\u662F\u5C06\u5730\u5740\u7ED1\u5B9A\u5230\u53C2\u4E0E\u8005\u72B6\u6001\u7684\u6620\u5C04\uFF08\u4EE5\u6563\u5217\u9635\u5217\u6620\u5C04Trie-HAMT\u7684\u5F62\u5F0F\uFF09\u3002VM\u5728\u6BCF\u6B21\u6267\u884Cactor\u65B9\u6CD5\u65F6\u90FD\u4F1A\u8C03\u7528\u5F53\u524D\u7684State Tree\u51FD\u6570\u3002",-1),ut={href:"https://spec.filecoin.io/#example-statetree",target:"_blank",rel:"noopener noreferrer"},rt=t(`<p>StateTree\u5B58\u50A8\u53C2\u4E0E\u8005\u7684ID\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> StateTree <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 root        adt<span class="token punctuation">.</span>Map
 version     types<span class="token punctuation">.</span>StateTreeVersion
 info        cid<span class="token punctuation">.</span>Cid
 Store       cbor<span class="token punctuation">.</span>IpldStore
 lookupIDFun <span class="token keyword">func</span><span class="token punctuation">(</span>address<span class="token punctuation">.</span>Address<span class="token punctuation">)</span> <span class="token punctuation">(</span>address<span class="token punctuation">.</span>Address<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>

 snaps <span class="token operator">*</span>stateSnaps
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),dt={id:"_2-3-3vm\u6D88\u606F-actor\u65B9\u6CD5\u8C03\u7528",tabindex:"-1"},kt=n("a",{class:"header-anchor",href:"#_2-3-3vm\u6D88\u606F-actor\u65B9\u6CD5\u8C03\u7528","aria-hidden":"true"},"#",-1),vt={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.message",target:"_blank",rel:"noopener noreferrer"},mt=n("p",null,"\u6D88\u606F\u662F\u4E24\u4E2A\u53C2\u4E0E\u8005\u4E4B\u95F4\u8FDB\u884C\u901A\u4FE1\u7684\u5355\u4F4D\uFF0C\u56E0\u6B64\u662F\u72B6\u6001\u53D8\u5316\u7684\u6839\u672C\u539F\u56E0\u3002\u4E00\u6761\u6D88\u606F\u7ED3\u5408\u4E86\uFF1A",-1),bt=n("ul",null,[n("li",null,"\u4ECE\u53D1\u9001\u65B9\u8F6C\u79FB\u5230\u63A5\u6536\u65B9\u7684\u4EE4\u724C\u91D1\u989D\uFF0C\u4EE5\u53CA"),n("li",null,"\u5177\u6709\u5728\u63A5\u6536\u65B9\u4E0A\u8C03\u7528\u7684\u53C2\u6570\u7684\u65B9\u6CD5\uFF08\u53EF\u9009/\u5728\u9002\u7528\u7684\u60C5\u51B5\u4E0B\uFF09\u3002")],-1),ht=n("p",null,"\u6F14\u5458\u4EE3\u7801\u53EF\u4EE5\u5728\u5904\u7406\u6536\u5230\u7684\u6D88\u606F\u65F6\u5411\u5176\u4ED6\u6F14\u5458\u53D1\u9001\u5176\u4ED6\u6D88\u606F\u3002\u6D88\u606F\u662F\u540C\u6B65\u5904\u7406\u7684\uFF0C\u4E5F\u5C31\u662F\u8BF4\uFF0C\u53C2\u4E0E\u8005\u5728\u6062\u590D\u63A7\u5236\u4E4B\u524D\u7B49\u5F85\u53D1\u9001\u7684\u6D88\u606F\u5B8C\u6210\u3002",-1),ft=n("p",null,[s("\u6D88\u606F\u7684\u5904\u7406\u6D88\u8017\u4E86\u8BA1\u7B97\u548C\u5B58\u50A8\u5355\u4F4D\uFF0C\u4E24\u8005\u5747\u4EE5gas\u8868\u793A\u3002\u6D88\u606F\u7684"),n("em",null,"\u6C14\u4F53\u9650\u5236"),s("\u4E3A\u5904\u7406\u8BE5\u6D88\u606F\u63D0\u4F9B\u4E86\u6240\u9700\u7684\u8BA1\u7B97\u4E0A\u9650\u3002\u6D88\u606F\u7684\u53D1\u4EF6\u4EBA\u4EE5\u5176\u786E\u5B9A\u7684\u6C7D\u6CB9\u4EF7\u683C\u6765\u652F\u4ED8\u6D88\u606F\u6267\u884C\u6240\u6D88\u8017\u7684\u6C14\u4F53\u5355\u4F4D\uFF08\u5305\u62EC\u6240\u6709\u5D4C\u5957\u7684\u6D88\u606F\uFF09\u3002\u533A\u5757\u751F\u4EA7\u8005\u9009\u62E9\u8981\u5305\u542B\u5728\u533A\u5757\u4E2D\u7684\u6D88\u606F\uFF0C\u5E76\u6839\u636E\u6BCF\u4E2A\u6D88\u606F\u7684\u6C7D\u6CB9\u4EF7\u683C\u548C\u6D88\u8017\u91CF\u83B7\u5F97\u5956\u52B1\uFF0C\u4ECE\u800C\u5F62\u6210\u5E02\u573A\u3002")],-1),_t={id:"_2-3-3-1\u6D88\u606F\u8BED\u6CD5\u9A8C\u8BC1",tabindex:"-1"},gt=n("a",{class:"header-anchor",href:"#_2-3-3-1\u6D88\u606F\u8BED\u6CD5\u9A8C\u8BC1","aria-hidden":"true"},"#",-1),yt={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.message.message-syntax-validation",target:"_blank",rel:"noopener noreferrer"},wt=t(`<p>\u8BED\u6CD5\u65E0\u6548\u7684\u6D88\u606F\u4E0D\u5F97\u4F20\u8F93\uFF0C\u4FDD\u7559\u5728\u6D88\u606F\u6C60\u4E2D\u6216\u5305\u542B\u5728\u5757\u4E2D\u3002\u5982\u679C\u6536\u5230\u65E0\u6548\u6D88\u606F\uFF0C\u5219\u5E94\u5C06\u5176\u4E22\u5F03\uFF0C\u5E76\u4E14\u4E0D\u8981\u8FDB\u4E00\u6B65\u4F20\u64AD\u3002</p><p>\u5F53\u5355\u72EC\u53D1\u9001\u65F6\uFF08\u5728\u5305\u542B\u5728\u5757\u4E2D\u4E4B\u524D\uFF09<code>SignedMessage</code>\uFF0C\u65E0\u8BBA\u4F7F\u7528\u54EA\u79CD\u7B7E\u540D\u65B9\u6848\uFF0C\u90FD\u5C06\u6D88\u606F\u6253\u5305\u4E3A \u3002\u6709\u6548\u7684\u7B7E\u540D\u90AE\u4EF6\u7684\u5E8F\u5217\u5316\u603B\u5927\u5C0F\u4E0D\u5927\u4E8E<code>message.MessageMaxSize</code>\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> SignedMessage <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 Message   Message
 Signature crypto<span class="token punctuation">.</span>Signature
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8BED\u6CD5\u4E0A\u6709\u6548\u7684<code>UnsignedMessage</code>\uFF1A</p><ul><li>\u5177\u6709\u683C\u5F0F\u6B63\u786E\u7684\u975E\u7A7A<code>To</code>\u5730\u5740\uFF0C</li><li>\u5177\u6709\u683C\u5F0F\u6B63\u786E\u7684\u975E\u7A7A<code>From</code>\u5730\u5740\uFF0C</li><li>\u5177\u6709<code>Value</code>\u4E0D\u5C0F\u4E8E\u96F6\u4E14\u4E0D\u5927\u4E8E\u4EE4\u724C\u603B\u4F9B\u7ED9\uFF08<code>2e9 * 1e18</code>\uFF09\uFF0C\u5E76\u4E14</li><li>\u5177\u6709\u975E\u8D1F\u6570<code>GasPrice</code>\uFF0C</li><li>\u5177\u6709<code>GasLimit</code>\u81F3\u5C11\u7B49\u4E8E\u4E0E\u6D88\u606F\u7684\u5E8F\u5217\u5316\u5B57\u8282\u5173\u8054\u7684\u6C14\u4F53\u6D88\u8017\u7684\u503C\uFF0C</li><li>\u5177\u6709<code>GasLimit</code>\u4E0D\u5927\u4E8E\u533A\u5757\u6C14\u4F53\u9650\u5236\u7F51\u7EDC\u53C2\u6570\u7684\u503C\u3002</li></ul><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Message <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 <span class="token comment">// Version of this message (has to be non-negative)</span>
 Version <span class="token builtin">uint64</span>

 <span class="token comment">// Address of the receiving actor.</span>
 To   address<span class="token punctuation">.</span>Address
 <span class="token comment">// Address of the sending actor.</span>
 From address<span class="token punctuation">.</span>Address

 CallSeqNum <span class="token builtin">uint64</span>

 <span class="token comment">// Value to transfer from sender&#39;s to receiver&#39;s balance.</span>
 Value BigInt

 <span class="token comment">// GasPrice is a Gas-to-FIL cost</span>
 GasPrice BigInt
 <span class="token comment">// Maximum Gas to be spent on the processing of this message</span>
 GasLimit <span class="token builtin">int64</span>

 <span class="token comment">// Optional method to invoke on receiver, zero for a plain value transfer.</span>
 Method abi<span class="token punctuation">.</span>MethodNum
 <span class="token comment">//Serialized parameters to the method.</span>
 Params <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5E94\u8BE5\u6709\u51E0\u4E2A\u529F\u80FD\u53EF\u4EE5\u4ECE\u4E2D\u63D0\u53D6\u4FE1\u606F<code>Message struct</code>\uFF0C\u4F8B\u5982\u53D1\u4EF6\u4EBA\u548C\u6536\u4EF6\u4EBA\u5730\u5740\uFF0C\u8981\u8F6C\u79FB\u7684\u503C\uFF0C\u6267\u884C\u6D88\u606F\u6240\u9700\u7684\u8D44\u91D1\u4EE5\u53CA\u6D88\u606F\u7684CID\u3002</p><p>\u5047\u5B9A\u6D88\u606F\u6700\u7EC8\u5E94\u5305\u542B\u5728\u4E00\u4E2A\u5757\u4E2D\u5E76\u6DFB\u52A0\u5230\u533A\u5757\u94FE\u4E2D\uFF0C\u5219\u5E94\u68C0\u67E5\u6D88\u606F\u7684\u53D1\u9001\u8005\u548C\u63A5\u6536\u8005\u7684\u6D88\u606F\u6709\u6548\u6027\uFF0C\u8BE5\u503C\uFF08\u5E94\u4E3A\u975E\u8D1F\u503C\uFF0C\u5E76\u4E14\u59CB\u7EC8\u5C0F\u4E8E\u5FAA\u73AF\u4F9B\u5E94\uFF09\uFF0C\u5929\u7136\u6C14\u4EF7\u683C\uFF08\u8BE5\u4EF7\u683C\u53C8\u5E94\u4E3A\u975E\u8D1F\u6570\uFF09\u4E14<code>BlockGasLimit</code>\u8BE5\u4EF7\u683C\u4E0D\u5E94\u5927\u4E8E\u8BE5\u533A\u5757\u7684\u5929\u7136\u6C14\u9650\u989D\u3002</p>`,8),xt={id:"_2-3-3-2\u6D88\u606F\u8BED\u4E49\u9A8C\u8BC1",tabindex:"-1"},Ct=n("a",{class:"header-anchor",href:"#_2-3-3-2\u6D88\u606F\u8BED\u4E49\u9A8C\u8BC1","aria-hidden":"true"},"#",-1),St={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.message.message-semantic-validation",target:"_blank",rel:"noopener noreferrer"},Ft=t(`<p>\u8BED\u4E49\u9A8C\u8BC1\u662F\u6307\u9700\u8981\u6D88\u606F\u672C\u8EAB\u4E4B\u5916\u7684\u4FE1\u606F\u7684\u9A8C\u8BC1\u3002</p><p>\u8BED\u4E49\u4E0A\u6709\u6548\u7684<code>SignedMessage</code>\u5FC5\u987B\u5E26\u6709\u7B7E\u540D\uFF0C\u8BE5\u7B7E\u540D\u53EF\u9A8C\u8BC1\u6709\u6548\u8F7D\u8377\u662F\u5426\u5DF2\u88AB<code>From</code>\u5730\u5740\u6807\u8BC6\u7684\u5E10\u6237\u6267\u884C\u8005\u7684\u516C\u94A5\u7B7E\u540D\u3002\u8BF7\u6CE8\u610F\uFF0C\u5F53<code>From</code>\u5730\u5740\u662FID\u5730\u5740\u65F6\uFF0C\u5FC5\u987B\u5728\u5757\u6240\u6807\u8BC6\u7684\u7236\u72B6\u6001\u4E0B\u7684\u53D1\u9001\u5E10\u6237\u53C2\u4E0E\u8005\u7684\u72B6\u6001\u4E0B\u67E5\u627E\u516C\u94A5\u3002</p><p>\u6CE8\u610F\uFF1A\u53D1\u9001\u65B9\u5FC5\u987B<em>\u4EE5</em>\u5305\u542B\u6D88\u606F<em>\u7684\u5757</em>\u6240<em>\u6807\u8BC6\u7684\u7236\u7EA7\u72B6\u6001</em>\u5B58\u5728\u3002\u8FD9\u610F\u5473\u7740\u5355\u4E2A\u5757\u5305\u542B\u521B\u5EFA\u65B0\u5E10\u6237actor\u7684\u6D88\u606F\u548C\u6765\u81EA\u540C\u4E00actor\u7684\u6D88\u606F\u662F\u65E0\u6548\u7684\u3002\u6765\u81EA\u8BE5\u53C2\u4E0E\u8005\u7684\u7B2C\u4E00\u6761\u6D88\u606F\u5FC5\u987B\u7B49\u5230\u4E0B\u4E00\u4E2A\u7EAA\u5143\u3002\u6D88\u606F\u6C60\u53EF\u80FD\u4F1A\u6392\u9664\u6765\u81EA\u53C2\u4E0E\u8005\u7684\uFF0C\u5C1A\u672A\u5904\u4E8E\u94FE\u72B6\u72B6\u6001\u7684\u6D88\u606F\u3002</p><p>\u6D88\u606F\u6CA1\u6709\u8FDB\u4E00\u6B65\u7684\u8BED\u4E49\u9A8C\u8BC1\uFF0C\u53EF\u80FD\u5BFC\u81F4\u5305\u542B\u8BE5\u6D88\u606F\u7684\u5757\u65E0\u6548\u3002\u6BCF\u4E2A\u8BED\u6CD5\u6709\u6548\u4E14\u6B63\u786E\u7B7E\u540D\u7684\u6D88\u606F\u90FD\u53EF\u4EE5\u5305\u542B\u5728\u4E00\u4E2A\u5757\u4E2D\uFF0C\u5E76\u4F1A\u4ECE\u6267\u884C\u4E2D\u4EA7\u751F\u4E00\u4E2A\u6536\u636E\u3002\u5176\u4E2D<code>MessageReceipt sturct</code>\u5305\u62EC\u4EE5\u4E0B\u5185\u5BB9\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> MessageReceipt <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 ExitCode exitcode<span class="token punctuation">.</span>ExitCode
 Return   <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span>
 GasUsed  <span class="token builtin">int64</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F46\u662F\uFF0C\u6D88\u606F\u53EF\u80FD\u65E0\u6CD5\u6267\u884C\u5230\u5B8C\u6210\uFF0C\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u5B83\u4E0D\u4F1A\u89E6\u53D1\u6240\u9700\u7684\u72B6\u6001\u66F4\u6539\u3002</p><p>\u8FD9\u79CD\u201C\u65E0\u6D88\u606F\u8BED\u4E49\u9A8C\u8BC1\u201D\u7B56\u7565\u7684\u539F\u56E0\u662F\uFF0C\u5728\u6D88\u606F<em>\u4F5C\u4E3A\u63D0\u793A\u96C6\u7684\u4E00\u90E8\u5206</em>\u6267\u884C\u4E4B\u524D\uFF0C\u5C06\u4E0D\u77E5\u9053\u6D88\u606F\u5C06\u5E94\u7528\u4E8E\u7684\u72B6\u6001\u3002\u5757\u751F\u4EA7\u8005\u4E0D\u77E5\u9053\u5728\u63D0\u793A\u96C6\u4E2D\u662F\u5426\u6709\u53E6\u4E00\u4E2A\u5757\u4F1A\u5728\u5B83\u4E4B\u524D\uFF0C\u56E0\u6B64\u4ECE\u58F0\u660E\u7684\u7236\u72B6\u6001\u66F4\u6539\u4E86\u8BE5\u5757\u6D88\u606F\u5C06\u5E94\u7528\u5230\u7684\u72B6\u6001\u3002</p>`,7),qt={href:"https://spec.filecoin.io/#example-",target:"_blank",rel:"noopener noreferrer"},Pt=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> types

<span class="token keyword">import</span> <span class="token punctuation">(</span>
 <span class="token string">&quot;bytes&quot;</span>
 <span class="token string">&quot;encoding/json&quot;</span>
 <span class="token string">&quot;fmt&quot;</span>

 <span class="token string">&quot;github.com/filecoin-project/go-state-types/abi&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/go-state-types/big&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/lotus/build&quot;</span>
 block <span class="token string">&quot;github.com/ipfs/go-block-format&quot;</span>
 <span class="token string">&quot;github.com/ipfs/go-cid&quot;</span>
 xerrors <span class="token string">&quot;golang.org/x/xerrors&quot;</span>

 <span class="token string">&quot;github.com/filecoin-project/go-address&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">const</span> MessageVersion <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">type</span> ChainMsg <span class="token keyword">interface</span> <span class="token punctuation">{</span>
 <span class="token function">Cid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> cid<span class="token punctuation">.</span>Cid
 <span class="token function">VMMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>Message
 <span class="token function">ToStorageBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>block<span class="token punctuation">.</span>Block<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
 <span class="token comment">// FIXME: This is the *message* length, this name is misleading.</span>
 <span class="token function">ChainLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Message <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 Version <span class="token builtin">uint64</span>

 To   address<span class="token punctuation">.</span>Address
 From address<span class="token punctuation">.</span>Address

 Nonce <span class="token builtin">uint64</span>

 Value abi<span class="token punctuation">.</span>TokenAmount

 GasLimit   <span class="token builtin">int64</span>
 GasFeeCap  abi<span class="token punctuation">.</span>TokenAmount
 GasPremium abi<span class="token punctuation">.</span>TokenAmount

 Method abi<span class="token punctuation">.</span>MethodNum
 Params <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Message<span class="token punctuation">)</span> <span class="token function">Caller</span><span class="token punctuation">(</span><span class="token punctuation">)</span> address<span class="token punctuation">.</span>Address <span class="token punctuation">{</span>
 <span class="token keyword">return</span> m<span class="token punctuation">.</span>From
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Message<span class="token punctuation">)</span> <span class="token function">Receiver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> address<span class="token punctuation">.</span>Address <span class="token punctuation">{</span>
 <span class="token keyword">return</span> m<span class="token punctuation">.</span>To
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Message<span class="token punctuation">)</span> <span class="token function">ValueReceived</span><span class="token punctuation">(</span><span class="token punctuation">)</span> abi<span class="token punctuation">.</span>TokenAmount <span class="token punctuation">{</span>
 <span class="token keyword">return</span> m<span class="token punctuation">.</span>Value
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">DecodeMessage</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>Message<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">var</span> msg Message
 <span class="token keyword">if</span> err <span class="token operator">:=</span> msg<span class="token punctuation">.</span><span class="token function">UnmarshalCBOR</span><span class="token punctuation">(</span>bytes<span class="token punctuation">.</span><span class="token function">NewReader</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> msg<span class="token punctuation">.</span>Version <span class="token operator">!=</span> MessageVersion <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;decoded message had incorrect version (%d)&quot;</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span>Version<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">return</span> <span class="token operator">&amp;</span>msg<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Message<span class="token punctuation">)</span> <span class="token function">Serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 buf <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>bytes<span class="token punctuation">.</span>Buffer<span class="token punctuation">)</span>
 <span class="token keyword">if</span> err <span class="token operator">:=</span> m<span class="token punctuation">.</span><span class="token function">MarshalCBOR</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
 <span class="token punctuation">}</span>
 <span class="token keyword">return</span> buf<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Message<span class="token punctuation">)</span> <span class="token function">ChainLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
 ser<span class="token punctuation">,</span> err <span class="token operator">:=</span> m<span class="token punctuation">.</span><span class="token function">Serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">return</span> <span class="token function">len</span><span class="token punctuation">(</span>ser<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Message<span class="token punctuation">)</span> <span class="token function">ToStorageBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>block<span class="token punctuation">.</span>Block<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 data<span class="token punctuation">,</span> err <span class="token operator">:=</span> m<span class="token punctuation">.</span><span class="token function">Serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
 <span class="token punctuation">}</span>

 c<span class="token punctuation">,</span> err <span class="token operator">:=</span> abi<span class="token punctuation">.</span>CidBuilder<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
 <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
 <span class="token punctuation">}</span>

 <span class="token keyword">return</span> block<span class="token punctuation">.</span><span class="token function">NewBlockWithCid</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> c<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Message<span class="token punctuation">)</span> <span class="token function">Cid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> cid<span class="token punctuation">.</span>Cid <span class="token punctuation">{</span>
 b<span class="token punctuation">,</span> err <span class="token operator">:=</span> m<span class="token punctuation">.</span><span class="token function">ToStorageBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token function">panic</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to marshal message: %s&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// I think this is maybe sketchy, what happens if we try to serialize a message with an undefined address in it?</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">return</span> b<span class="token punctuation">.</span><span class="token function">Cid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> mCid <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 <span class="token operator">*</span>RawMessage
 CID cid<span class="token punctuation">.</span>Cid
<span class="token punctuation">}</span>

<span class="token keyword">type</span> RawMessage Message

<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Message<span class="token punctuation">)</span> <span class="token function">MarshalJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> json<span class="token punctuation">.</span><span class="token function">Marshal</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mCid<span class="token punctuation">{</span>
  RawMessage<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token operator">*</span>RawMessage<span class="token punctuation">)</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span>
  CID<span class="token punctuation">:</span>        m<span class="token punctuation">.</span><span class="token function">Cid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Message<span class="token punctuation">)</span> <span class="token function">RequiredFunds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> BigInt <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token function">BigMul</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>GasFeeCap<span class="token punctuation">,</span> <span class="token function">NewInt</span><span class="token punctuation">(</span><span class="token function">uint64</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>GasLimit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Message<span class="token punctuation">)</span> <span class="token function">VMMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>Message <span class="token punctuation">{</span>
 <span class="token keyword">return</span> m
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Message<span class="token punctuation">)</span> <span class="token function">Equals</span><span class="token punctuation">(</span>o <span class="token operator">*</span>Message<span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> m<span class="token punctuation">.</span><span class="token function">Cid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> o<span class="token punctuation">.</span><span class="token function">Cid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Message<span class="token punctuation">)</span> <span class="token function">EqualCall</span><span class="token punctuation">(</span>o <span class="token operator">*</span>Message<span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
 m1 <span class="token operator">:=</span> <span class="token operator">*</span>m
 m2 <span class="token operator">:=</span> <span class="token operator">*</span>o

 m1<span class="token punctuation">.</span>GasLimit<span class="token punctuation">,</span> m2<span class="token punctuation">.</span>GasLimit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>
 m1<span class="token punctuation">.</span>GasFeeCap<span class="token punctuation">,</span> m2<span class="token punctuation">.</span>GasFeeCap <span class="token operator">=</span> big<span class="token punctuation">.</span><span class="token function">Zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> big<span class="token punctuation">.</span><span class="token function">Zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 m1<span class="token punctuation">.</span>GasPremium<span class="token punctuation">,</span> m2<span class="token punctuation">.</span>GasPremium <span class="token operator">=</span> big<span class="token punctuation">.</span><span class="token function">Zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> big<span class="token punctuation">.</span><span class="token function">Zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

 <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span>m1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>m2<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Message<span class="token punctuation">)</span> <span class="token function">ValidForBlockInclusion</span><span class="token punctuation">(</span>minGas <span class="token builtin">int64</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
 <span class="token keyword">if</span> m<span class="token punctuation">.</span>Version <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;Version&#39; unsupported&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>To <span class="token operator">==</span> address<span class="token punctuation">.</span>Undef <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;To&#39; address cannot be empty&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>From <span class="token operator">==</span> address<span class="token punctuation">.</span>Undef <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;From&#39; address cannot be empty&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>Value<span class="token punctuation">.</span>Int <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;Value&#39; cannot be nil&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>Value<span class="token punctuation">.</span><span class="token function">LessThan</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span><span class="token function">Zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;Value&#39; field cannot be negative&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>Value<span class="token punctuation">.</span><span class="token function">GreaterThan</span><span class="token punctuation">(</span>TotalFilecoinInt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;Value&#39; field cannot be greater than total filecoin supply&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>GasFeeCap<span class="token punctuation">.</span>Int <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;GasFeeCap&#39; cannot be nil&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>GasFeeCap<span class="token punctuation">.</span><span class="token function">LessThan</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span><span class="token function">Zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;GasFeeCap&#39; field cannot be negative&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>GasPremium<span class="token punctuation">.</span>Int <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;GasPremium&#39; cannot be nil&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>GasPremium<span class="token punctuation">.</span><span class="token function">LessThan</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span><span class="token function">Zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;GasPremium&#39; field cannot be negative&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>GasPremium<span class="token punctuation">.</span><span class="token function">GreaterThan</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>GasFeeCap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;GasFeeCap&#39; less than &#39;GasPremium&#39;&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>GasLimit <span class="token operator">&gt;</span> build<span class="token punctuation">.</span>BlockGasLimit <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;GasLimit&#39; field cannot be greater than a block&#39;s gas limit&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token comment">// since prices might vary with time, this is technically semantic validation</span>
 <span class="token keyword">if</span> m<span class="token punctuation">.</span>GasLimit <span class="token operator">&lt;</span> minGas <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;GasLimit&#39; field cannot be less than the cost of storing a message on chain %d &lt; %d&quot;</span><span class="token punctuation">,</span> m<span class="token punctuation">.</span>GasLimit<span class="token punctuation">,</span> minGas<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> TestGasLimit <span class="token operator">=</span> <span class="token number">100e6</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),At={id:"_2-3-4vm\u8FD0\u884C\u65F6\u73AF\u5883-\u5728vm\u5185\u90E8",tabindex:"-1"},Bt=n("a",{class:"header-anchor",href:"#_2-3-4vm\u8FD0\u884C\u65F6\u73AF\u5883-\u5728vm\u5185\u90E8","aria-hidden":"true"},"#",-1),Et={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.runtime",target:"_blank",rel:"noopener noreferrer"},Tt={id:"_2-3-4-1\u6536\u636E",tabindex:"-1"},It=n("a",{class:"header-anchor",href:"#_2-3-4-1\u6536\u636E","aria-hidden":"true"},"#",-1),Rt={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.runtime.receipts",target:"_blank",rel:"noopener noreferrer"},Mt=t(`<p>\u7532<code>MessageReceipt</code>\u5305\u542B\u4E00\u4E2A\u9876\u5C42\u6D88\u606F\u6267\u884C\u7684\u7ED3\u679C\u3002\u6BCF\u4E2A\u8BED\u6CD5\u6709\u6548\u4E14\u6B63\u786E\u7B7E\u540D\u7684\u6D88\u606F\u90FD\u53EF\u4EE5\u5305\u542B\u5728\u4E00\u4E2A\u5757\u4E2D\uFF0C\u5E76\u4F1A\u4ECE\u6267\u884C\u4E2D\u4EA7\u751F\u4E00\u4E2A\u6536\u636E\u3002</p><p>\u8BED\u6CD5\u6709\u6548\u7684\u6536\u636E\u5177\u6709\uFF1A</p><ul><li>\u4E00\u4E2A\u975E\u8D1F<code>ExitCode</code>\uFF0C</li><li><code>Return</code>\u4EC5\u5F53\u9000\u51FA\u4EE3\u7801\u4E3A\u96F6\u65F6\uFF0C\u624D\u4E3A\u975E\u7A7A\u503C\uFF1B\u5E76\u4E14</li><li>\u975E\u8D1F\u6570<code>GasUsed</code>\u3002</li></ul><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> MessageReceipt <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 ExitCode exitcode<span class="token punctuation">.</span>ExitCode
 Return   <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span>
 GasUsed  <span class="token builtin">int64</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4),Dt={id:"_2-3-4-2vm-runtime-\u6F14\u5458\u754C\u9762",tabindex:"-1"},Gt=n("a",{class:"header-anchor",href:"#_2-3-4-2vm-runtime-\u6F14\u5458\u754C\u9762","aria-hidden":"true"},"#",-1),Vt={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.runtime.vmruntime-actors-interface",target:"_blank",rel:"noopener noreferrer"},Lt=n("code",null,"vm/runtime",-1),Nt={href:"https://github.com/filecoin-project/specs-actors/blob/master/actors/runtime/runtime.go",target:"_blank",rel:"noopener noreferrer"},jt={id:"_2-3-4-3vm-runtime-\u865A\u62DF\u673A\u5B9E\u65BD",tabindex:"-1"},Ht=n("a",{class:"header-anchor",href:"#_2-3-4-3vm-runtime-\u865A\u62DF\u673A\u5B9E\u65BD","aria-hidden":"true"},"#",-1),Ot={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.runtime.vmruntime-vm-implementation",target:"_blank",rel:"noopener noreferrer"},Ut=n("code",null,"vm/runtime",-1),zt={href:"https://github.com/filecoin-project/lotus/blob/master/chain/vm/runtime.go",target:"_blank",rel:"noopener noreferrer"},Wt={id:"_2-3-4-4\u9000\u51FA\u7801",tabindex:"-1"},Zt=n("a",{class:"header-anchor",href:"#_2-3-4-4\u9000\u51FA\u7801","aria-hidden":"true"},"#",-1),Kt={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.runtime.exit-codes",target:"_blank",rel:"noopener noreferrer"},Qt={href:"https://github.com/filecoin-project/go-state-types/blob/master/exitcode/common.go",target:"_blank",rel:"noopener noreferrer"},Jt={id:"_2-3-5\u7164\u6C14\u8D39",tabindex:"-1"},Xt=n("a",{class:"header-anchor",href:"#_2-3-5\u7164\u6C14\u8D39","aria-hidden":"true"},"#",-1),Yt={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.gas_fee",target:"_blank",rel:"noopener noreferrer"},$t={id:"_2-3-5-1\u6982\u8981",tabindex:"-1"},no=n("a",{class:"header-anchor",href:"#_2-3-5-1\u6982\u8981","aria-hidden":"true"},"#",-1),so={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.gas_fee.summary",target:"_blank",rel:"noopener noreferrer"},ao=t("<p>\u4E0E\u8BB8\u591A\u533A\u5757\u94FE\u7684\u4F20\u7EDF\u60C5\u51B5\u4E00\u6837\uFF0CGas\u662F\u8861\u91CF\u94FE\u4E0A\u6D88\u606F\u64CD\u4F5C\u8981\u6267\u884C\u591A\u5C11\u6D88\u8017\u7684\u5B58\u50A8\u548C/\u6216\u8BA1\u7B97\u8D44\u6E90\u7684\u5EA6\u91CF\u5355\u4F4D\u3002\u5728\u8F83\u9AD8\u7EA7\u522B\u4E0A\uFF0C\u5B83\u7684\u5DE5\u4F5C\u65B9\u5F0F\u5982\u4E0B\uFF1A\u6D88\u606F\u53D1\u9001\u8005\u6307\u5B9A\u4ED6\u4EEC\u613F\u610F\u652F\u4ED8\u7684\u6700\u9AD8\u91D1\u989D\uFF0C\u4EE5\u4FBF\u6D88\u606F\u88AB\u6267\u884C\u5E76\u5305\u542B\u5728\u5757\u4E2D\u3002\u8FD9\u662F\u6839\u636E\u603B\u7684\u5929\u7136\u6C14\u5355\u4F4D\u6570\uFF08<code>GasLimit</code>\uFF09\uFF08\u901A\u5E38\u671F\u671B\u9AD8\u4E8E\u5B9E\u9645<code>GasUsed</code>\u5355\u4F4D\uFF09\u548C\u6BCF\u5355\u4F4D\u5929\u7136\u6C14\u7684\u4EF7\u683C\uFF08\u6216\u8D39\u7528<code>GasFeeCap</code>\uFF09\u6765\u6307\u5B9A\u7684\u3002</p><p>\u4F20\u7EDF\u4E0A\uFF0C<code>GasUsed * GasFeeCap</code>\u53BB\u751F\u4EA7\u77FF\u5DE5\u4F5C\u4E3A\u5956\u52B1\u3002\u8BE5\u4EA7\u54C1\u7684\u7ED3\u679C\u88AB\u89C6\u4E3A\u6D88\u606F\u5305\u542B\u7684\u4F18\u5148\u8D39\u7528\uFF0C\u4E5F\u5C31\u662F\u8BF4\uFF0C\u6D88\u606F\u4EE5\u964D\u5E8F\u6392\u5217\uFF0C\u800C\u6D88\u606F\u6700\u9AD8\u7684\u6D88\u606F<code>GasUsed * GasFeeCap</code>\u88AB\u4F18\u5148\u8003\u8651\uFF0C\u56E0\u4E3A\u5B83\u4EEC\u4F1A\u5411\u77FF\u5DE5\u8FD4\u56DE\u66F4\u591A\u7684\u5229\u6DA6\u3002</p><p>\u4F46\u662F\uFF0C\u5DF2\u7ECF\u89C2\u5BDF\u5230\uFF0C<code>GasUsed * GasFee</code>\u51FA\u4E8E\u4E00\u4E9B\u539F\u56E0\uFF0C\u8FD9\u79CD\uFF08\u652F\u4ED8\uFF09\u7B56\u7565\u5BF9\u4E8E\u5757\u751F\u4EA7\u77FF\u5DE5\u662F\u6709\u95EE\u9898\u7684\u3002\u9996\u5148\uFF0C\u4E00\u4E2A\u751F\u4EA7\u533A\u5757\u7684\u77FF\u5DE5\u53EF\u80FD\u514D\u8D39\u5305\u542B\u4E00\u6761\u975E\u5E38\u6602\u8D35\u7684\u6D88\u606F\uFF08\u5C31\u6240\u9700\u7684\u94FE\u8D44\u6E90\u800C\u8A00\uFF09\uFF0C\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u94FE\u672C\u8EAB\u9700\u8981\u627F\u62C5\u6210\u672C\u3002\u5176\u6B21\uFF0C\u6D88\u606F\u53D1\u9001\u8005\u53EF\u4EE5\u4EFB\u610F\u8BBE\u7F6E\u9AD8\u4EF7\uFF0C\u4F46\u5BF9\u4E8E\u4F4E\u6210\u672C\u6D88\u606F\uFF08\u540C\u6837\u4EE5\u94FE\u8D44\u6E90\u800C\u8A00\uFF09\uFF0C\u8FD9\u4F1A\u5BFC\u81F4DoS\u6F0F\u6D1E\u3002</p><p>\u4E3A\u4E86\u514B\u670D\u8FD9\u79CD\u60C5\u51B5\uFF0CFilecoin\u533A\u5757\u94FE\u5B9A\u4E49\u4E86\u4E00\u4E2A<code>BaseFee</code>\uFF0C\u6BCF\u4E2A\u6D88\u606F\u90FD\u4F1A\u5BF9\u5176\u8FDB\u884C\u523B\u5F55\u3002\u7406\u7531\u662F\uFF0C\u8003\u8651\u5230\u5929\u7136\u6C14\u662F\u8861\u91CF\u94FE\u4E0A\u8D44\u6E90\u6D88\u8017\u7684\u4E00\u79CD\u624B\u6BB5\uFF0C\u4E0E\u5C06\u5176\u5956\u52B1\u7ED9\u77FF\u5DE5\u76F8\u6BD4\uFF0C\u5C06\u5176\u71C3\u70E7\u662F\u6709\u610F\u4E49\u7684\u3002\u8FD9\u6837\uFF0C\u907F\u514D\u4E86\u6765\u81EA\u77FF\u5DE5\u7684\u8D39\u7528\u64CD\u7EB5\u3002\u5B83<code>BaseFee</code>\u662F\u52A8\u6001\u7684\uFF0C\u4F1A\u6839\u636E\u7F51\u7EDC\u62E5\u585E\u60C5\u51B5\u81EA\u52A8\u8C03\u6574\u3002\u8FD9\u4E00\u4E8B\u5B9E\u4F7F\u7F51\u7EDC\u53EF\u4EE5\u62B5\u5FA1\u5783\u573E\u90AE\u4EF6\u653B\u51FB\u3002\u9274\u4E8E\u5728SPAM\u653B\u51FB\u671F\u95F4\u7F51\u7EDC\u8D1F\u8F7D\u4F1A\u589E\u52A0\uFF0C\u56E0\u6B64\uFF0C\u653B\u51FB\u8005\u65E0\u6CD5\u5C06SPAM\u6D88\u606F\u7684\u5B8C\u6574\u5757\u957F\u65F6\u95F4\u4FDD\u7559<code>BaseFee</code>\u3002</p><p>\u6700\u540E\uFF0C<code>GasPremium</code>\u662F\u53D1\u4EF6\u4EBA\u5305\u62EC\u7684\u4F18\u5148\u8D39\uFF0C\u4EE5\u6FC0\u52B1\u77FF\u5DE5\u9009\u62E9\u6700\u6709\u5229\u53EF\u56FE\u7684\u6D88\u606F\u3002\u6362\u53E5\u8BDD\u8BF4\uFF0C\u5982\u679C\u6D88\u606F\u53D1\u4EF6\u4EBA\u5E0C\u671B\u66F4\u5FEB\u5730\u5305\u542B\u5176\u6D88\u606F\uFF0C\u5219\u53EF\u4EE5\u8BBE\u7F6E\u66F4\u9AD8\u7684<code>GasPremium</code>\u3002</p>",5),eo={id:"_2-3-5-2\u53C2\u91CF",tabindex:"-1"},to=n("a",{class:"header-anchor",href:"#_2-3-5-2\u53C2\u91CF","aria-hidden":"true"},"#",-1),oo={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.gas_fee.parameters",target:"_blank",rel:"noopener noreferrer"},po=t("<ul><li><code>GasUsed</code>\u662F\u6267\u884C\u4E00\u6761\u6D88\u606F\u6240\u6D88\u8017\u7684\u8D44\u6E90\uFF08\u6216\u6C14\u4F53\u5355\u4F4D\uFF09\u6570\u91CF\u7684\u5EA6\u91CF\u3002\u6BCF\u79CD\u6C14\u4F53\u5355\u4F4D\u90FD\u4EE5attoFIL\u8FDB\u884C\u6D4B\u91CF\uFF0C\u56E0\u6B64<code>GasUsed</code>\u662F\u4EE3\u8868\u80FD\u8017\u5355\u4F4D\u7684\u6570\u5B57\u3002<code>GasUsed</code>\u4E0E\u6D88\u606F\u662F\u6B63\u786E\u6267\u884C\u8FD8\u662F\u5931\u8D25\u65E0\u5173\u3002</li><li><code>BaseFee</code>\u662F\u6BCF\u6B21\u6267\u884C\u6D88\u606F\u65F6\u8981\u71C3\u70E7\uFF08\u53D1\u9001\u5230\u4E0D\u53EF\u6062\u590D\u7684\u5730\u5740\uFF09\u7684\u6BCF\u5355\u4F4D\u5929\u7136\u6C14\u7684\u8BBE\u5B9A\u4EF7\u683C\uFF08\u4EE5attoFIL /\u5929\u7136\u6C14\u5355\u4F4D\u8BA1\u91CF\uFF09\u3002\u7684\u503C<code>BaseFee</code>\u662F\u52A8\u6001\u7684\uFF0C\u5E76\u6839\u636E\u5F53\u524D\u7684\u7F51\u7EDC\u62E5\u585E\u53C2\u6570\u8FDB\u884C\u8C03\u6574\u3002\u4F8B\u5982\uFF0C\u5F53\u7F51\u7EDC\u8D85\u51FA5B\u6C14\u4F53\u9650\u5236\u4F7F\u7528\u91CF\u65F6\uFF0C<code>BaseFee</code>\u589E\u52A0\uFF0C\u800C\u5F53\u6C14\u4F53\u9650\u5236\u4F7F\u7528\u91CF\u4E0B\u964D\u52305B\u4EE5\u4E0B\u65F6\uFF0C\u60C5\u51B5\u76F8\u53CD\u3002\u7684<code>BaseFee</code>\u65BD\u52A0\u5230\u6BCF\u4E2A\u5757\u5E94\u88AB\u5305\u62EC\u5728\u5757\u672C\u8EAB\u3002\u5E94\u8BE5\u6709\u53EF\u80FD<code>BaseFee</code>\u4ECE\u94FE\u7684\u9876\u90E8\u83B7\u5F97\u7535\u6D41\u503C\u3002\u7684<code>BaseFee</code>\u6BCF\u5355\u4F4D\u9002\u7528<code>GasUsed</code>\uFF0C\u56E0\u6B64\uFF0C\u6C14\u4F53\u7684\u603B\u91CF\u70E7\u5236\u7684\u6D88\u606F\u662F<code>BaseFee * GasUsed</code>\u3002\u8BF7\u6CE8\u610F\uFF0C<code>BaseFee</code>\u6BCF\u6761\u6D88\u606F\u90FD\u4F1A\u4EA7\u751F\uFF0C\u4F46\u662F\u540C\u4E00\u5757\u4E2D\u6240\u6709\u6D88\u606F\u7684\u503C\u90FD\u76F8\u540C\u3002</li><li><code>GasLimit</code>\u4EE5\u6C14\u4F53\u4E3A\u5355\u4F4D\u8FDB\u884C\u6D4B\u91CF\uFF0C\u5E76\u7531\u6D88\u606F\u53D1\u9001\u8005\u8BBE\u7F6E\u3002\u5B83\u5BF9\u5E94\u5141\u8BB8\u6D88\u606F\u6267\u884C\u5728\u94FE\u4E0A\u6D88\u8017\u7684\u6C14\u4F53\u91CF\uFF08\u5373\u6C14\u4F53\u5355\u4F4D\u6570\uFF09\u65BD\u52A0\u4E86\u786C\u6027\u9650\u5236\u3002\u6D88\u606F\u89E6\u53D1\u7684\u6BCF\u4E2A\u57FA\u672C\u64CD\u4F5C\u90FD\u4F1A\u6D88\u8017\u6C14\u4F53\uFF0C\u800C\u6D88\u606F\u7528\u5C3D\u7684\u6D88\u606F\u5C06\u5931\u8D25\u3002\u5F53\u6D88\u606F\u5931\u8D25\u65F6\uFF0C\u7531\u4E8E\u6267\u884C\u6B64\u6D88\u606F\u800C\u5BF9\u72B6\u6001\u8FDB\u884C\u7684\u6240\u6709\u4FEE\u6539\u90FD\u5C06\u6062\u590D\u4E3A\u5148\u524D\u7684\u72B6\u6001\u3002\u4E0E\u6D88\u606F\u6267\u884C\u662F\u5426\u6210\u529F\u65E0\u5173\uFF0C\u77FF\u5DE5\u5C06\u83B7\u5F97\u4ED6\u4EEC\u6267\u884C\u6D88\u606F\u6240\u6D88\u8017\u7684\u8D44\u6E90\u7684\u5956\u52B1\uFF08\u89C1<code>GasPremium</code>\u4E0B\u6587\uFF09\u3002</li><li><code>GasFeeCap</code>\u662F\u6D88\u606F\u53D1\u4EF6\u4EBA\u613F\u610F\u4E3A\u6BCF\u5355\u4F4D\u5929\u7136\u6C14\u652F\u4ED8\u7684\u6700\u9AD8\u4EF7\u683C\uFF08\u4EE5attoFIL / gas\u5355\u4F4D\u8861\u91CF\uFF09\u3002\u518D\u52A0\u4E0A<code>GasLimit</code>\uFF0C\u5219<code>GasFeeCap</code>\u662F\u8BBE\u7F6E\u4E00\u4E2A\u53D1\u4EF6\u4EBA\u5C06\u4E00\u4E2A\u6D88\u606FFIL\u652F\u4ED8\u7684\u6700\u9AD8\u91D1\u989D\uFF1A\u53D1\u4EF6\u4EBA\u662F\u4FDD\u8BC1\u4FE1\u606F\u7EDD\u4E0D\u4F1A\u4EE4\u4ED6\u4EEC\u8D85\u8FC7<code>GasLimit * GasFeeCap</code>attoFIL\uFF08\u4E0D\u5305\u62EC\u4EFB\u4F55\u6EA2\u4EF7\uFF0C\u8BE5\u4FE1\u606F\u5305\u542B\u5176\u6536\u4EF6\u4EBA\uFF09\u3002</li><li><code>GasPremium</code>\u662F\u6D88\u606F\u53D1\u9001\u8005\u613F\u610F\u652F\u4ED8\u7684\u6BCF\u5355\u4F4D\u5929\u7136\u6C14\u4EF7\u683C\uFF08\u4EE5attoFIL / gas\u8BA1\u91CF\uFF09\uFF08\u5728\u9876\u90E8<code>BaseFee</code>\uFF09\u4EE5\u201C\u63D0\u793A\u201D\u5C06\u5305\u542B\u8BE5\u6D88\u606F\u7684\u77FF\u5DE5\u3002\u4E00\u6761\u6D88\u606F\u901A\u5E38\u53EF\u4EE5<code>GasLimit * GasPremium</code>\u6709\u6548\u5730\u4F7F\u5B83\u7684\u77FF\u5DE5attoFIL <code>GasPremium = GasFeeCap - BaseFee</code>\u3002\u8BF7\u6CE8\u610F\uFF0C\u4E0E\u76F8\u5BF9\u4E8E<code>GasPremium</code>\u5E94\u7528\u4E8E<code>GasLimit</code>\uFF0C<code>GasUsed</code>\u4EE5\u4F7F\u77FF\u5DE5\u7684\u6D88\u606F\u9009\u62E9\u66F4\u52A0\u76F4\u63A5\u3002</li></ul>",1),io={href:"https://spec.filecoin.io/#example-computegasoverestimationburn",target:"_blank",rel:"noopener noreferrer"},co=t(`<p>ComputeGasOverestimationBurn\u8BA1\u7B97\u8981\u9000\u6B3E\u7684\u71C3\u6C14\u91CF\u548C\u8981\u71C3\u70E7\u7684\u71C3\u6C14\u91CF\u7ED3\u679C\u662F\uFF08\u9000\u6B3E\uFF0C\u71C3\u70E7\uFF09</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">ComputeGasOverestimationBurn</span><span class="token punctuation">(</span>gasUsed<span class="token punctuation">,</span> gasLimit <span class="token builtin">int64</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int64</span><span class="token punctuation">,</span> <span class="token builtin">int64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">if</span> gasUsed <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> gasLimit
 <span class="token punctuation">}</span>

 <span class="token comment">// over = gasLimit/gasUsed - 1 - 0.1</span>
 <span class="token comment">// over = min(over, 1)</span>
 <span class="token comment">// gasToBurn = (gasLimit - gasUsed) * over</span>

 <span class="token comment">// so to factor out division from \`over\`</span>
 <span class="token comment">// over*gasUsed = min(gasLimit - (11*gasUsed)/10, gasUsed)</span>
 <span class="token comment">// gasToBurn = ((gasLimit - gasUsed)*over*gasUsed) / gasUsed</span>
 over <span class="token operator">:=</span> gasLimit <span class="token operator">-</span> <span class="token punctuation">(</span>gasOveruseNum<span class="token operator">*</span>gasUsed<span class="token punctuation">)</span><span class="token operator">/</span>gasOveruseDenom
 <span class="token keyword">if</span> over <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> gasLimit <span class="token operator">-</span> gasUsed<span class="token punctuation">,</span> <span class="token number">0</span>
 <span class="token punctuation">}</span>

 <span class="token comment">// if we want sharper scaling it goes here:</span>
 <span class="token comment">// over *= 2</span>

 <span class="token keyword">if</span> over <span class="token operator">&gt;</span> gasUsed <span class="token punctuation">{</span>
  over <span class="token operator">=</span> gasUsed
 <span class="token punctuation">}</span>

 <span class="token comment">// needs bigint, as it overflows in pathological case gasLimit &gt; 2^32 gasUsed = gasLimit / 2</span>
 gasToBurn <span class="token operator">:=</span> big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span>gasLimit <span class="token operator">-</span> gasUsed<span class="token punctuation">)</span>
 gasToBurn <span class="token operator">=</span> big<span class="token punctuation">.</span><span class="token function">Mul</span><span class="token punctuation">(</span>gasToBurn<span class="token punctuation">,</span> big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span>over<span class="token punctuation">)</span><span class="token punctuation">)</span>
 gasToBurn <span class="token operator">=</span> big<span class="token punctuation">.</span><span class="token function">Div</span><span class="token punctuation">(</span>gasToBurn<span class="token punctuation">,</span> big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span>gasUsed<span class="token punctuation">)</span><span class="token punctuation">)</span>

 <span class="token keyword">return</span> gasLimit <span class="token operator">-</span> gasUsed <span class="token operator">-</span> gasToBurn<span class="token punctuation">.</span><span class="token function">Int64</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> gasToBurn<span class="token punctuation">.</span><span class="token function">Int64</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),lo={href:"https://spec.filecoin.io/#example-computenextbasefee",target:"_blank",rel:"noopener noreferrer"},uo=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">ComputeNextBaseFee</span><span class="token punctuation">(</span>baseFee types<span class="token punctuation">.</span>BigInt<span class="token punctuation">,</span> gasLimitUsed <span class="token builtin">int64</span><span class="token punctuation">,</span> noOfBlocks <span class="token builtin">int</span><span class="token punctuation">,</span> epoch abi<span class="token punctuation">.</span>ChainEpoch<span class="token punctuation">)</span> types<span class="token punctuation">.</span>BigInt <span class="token punctuation">{</span>
 <span class="token comment">// deta := gasLimitUsed/noOfBlocks - build.BlockGasTarget</span>
 <span class="token comment">// change := baseFee * deta / BlockGasTarget</span>
 <span class="token comment">// nextBaseFee = baseFee + change</span>
 <span class="token comment">// nextBaseFee = max(nextBaseFee, build.MinimumBaseFee)</span>

 <span class="token keyword">var</span> delta <span class="token builtin">int64</span>
 <span class="token keyword">if</span> epoch <span class="token operator">&gt;</span> build<span class="token punctuation">.</span>UpgradeSmokeHeight <span class="token punctuation">{</span>
  delta <span class="token operator">=</span> gasLimitUsed <span class="token operator">/</span> <span class="token function">int64</span><span class="token punctuation">(</span>noOfBlocks<span class="token punctuation">)</span>
  delta <span class="token operator">-=</span> build<span class="token punctuation">.</span>BlockGasTarget
 <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  delta <span class="token operator">=</span> build<span class="token punctuation">.</span>PackingEfficiencyDenom <span class="token operator">*</span> gasLimitUsed <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token function">int64</span><span class="token punctuation">(</span>noOfBlocks<span class="token punctuation">)</span> <span class="token operator">*</span> build<span class="token punctuation">.</span>PackingEfficiencyNum<span class="token punctuation">)</span>
  delta <span class="token operator">-=</span> build<span class="token punctuation">.</span>BlockGasTarget
 <span class="token punctuation">}</span>

 <span class="token comment">// cap change at 12.5% (BaseFeeMaxChangeDenom) by capping delta</span>
 <span class="token keyword">if</span> delta <span class="token operator">&gt;</span> build<span class="token punctuation">.</span>BlockGasTarget <span class="token punctuation">{</span>
  delta <span class="token operator">=</span> build<span class="token punctuation">.</span>BlockGasTarget
 <span class="token punctuation">}</span>
 <span class="token keyword">if</span> delta <span class="token operator">&lt;</span> <span class="token operator">-</span>build<span class="token punctuation">.</span>BlockGasTarget <span class="token punctuation">{</span>
  delta <span class="token operator">=</span> <span class="token operator">-</span>build<span class="token punctuation">.</span>BlockGasTarget
 <span class="token punctuation">}</span>

 change <span class="token operator">:=</span> big<span class="token punctuation">.</span><span class="token function">Mul</span><span class="token punctuation">(</span>baseFee<span class="token punctuation">,</span> big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span>delta<span class="token punctuation">)</span><span class="token punctuation">)</span>
 change <span class="token operator">=</span> big<span class="token punctuation">.</span><span class="token function">Div</span><span class="token punctuation">(</span>change<span class="token punctuation">,</span> big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span>build<span class="token punctuation">.</span>BlockGasTarget<span class="token punctuation">)</span><span class="token punctuation">)</span>
 change <span class="token operator">=</span> big<span class="token punctuation">.</span><span class="token function">Div</span><span class="token punctuation">(</span>change<span class="token punctuation">,</span> big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span>build<span class="token punctuation">.</span>BaseFeeMaxChangeDenom<span class="token punctuation">)</span><span class="token punctuation">)</span>

 nextBaseFee <span class="token operator">:=</span> big<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>baseFee<span class="token punctuation">,</span> change<span class="token punctuation">)</span>
 <span class="token keyword">if</span> big<span class="token punctuation">.</span><span class="token function">Cmp</span><span class="token punctuation">(</span>nextBaseFee<span class="token punctuation">,</span> big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span>build<span class="token punctuation">.</span>MinimumBaseFee<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
  nextBaseFee <span class="token operator">=</span> big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span>build<span class="token punctuation">.</span>MinimumBaseFee<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">return</span> nextBaseFee
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),ro={id:"_2-3-5-3\u6CE8\u91CA\u4E0E\u542B\u4E49",tabindex:"-1"},ko=n("a",{class:"header-anchor",href:"#_2-3-5-3\u6CE8\u91CA\u4E0E\u542B\u4E49","aria-hidden":"true"},"#",-1),vo={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.gas_fee.notes--implications",target:"_blank",rel:"noopener noreferrer"},mo=t("<ul><li>\u7684\u503C<code>GasFeeCap</code>\u5E94\u59CB\u7EC8\u9AD8\u4E8E\u7F51\u7EDC\u7684<code>BaseFee</code>\u3002\u5982\u679C\u6D88\u606F\u7684<code>GasFeeCap</code>\u4F4E\u4E8E<code>BaseFee</code>\uFF0C\u5219\u5176\u4F59\u90E8\u5206\u6765\u81EA\u77FF\u5DE5\uFF08\u4F5C\u4E3A\u7F5A\u6B3E\uFF09\u3002\u7531\u4E8E\u77FF\u5DE5\u9009\u62E9\u7684\u6D88\u606F\u7684\u4EF7\u683C\u4F4E\u4E8E<code>BaseFee</code>\u7F51\u7EDC\u8D39\u7528\uFF08\u5373\uFF0C\u4E0D\u5305\u62EC\u7F51\u7EDC\u8D39\u7528\uFF09\uFF0C\u56E0\u6B64\u5BF9\u77FF\u5DE5\u65BD\u52A0\u6B64\u7F5A\u6B3E\u3002\u7136\u800C\uFF0C\u77FF\u5DE5\u53EF\u80FD\u8981\u9009\u62E9\u4E00\u4E2A\u6D88\u606F\uFF0C\u5176<code>GasFeeCap</code>\u6BD4\u5C0F<code>BaseFee</code>\uFF0C\u5982\u679C\u540C\u4E00\u4E2A\u53D1\u4EF6\u4EBA\u5728\u90AE\u4EF6\u6C60\uFF0C\u5176\u53E6\u4E00\u6761\u6D88\u606F<code>GasFeeCap</code>\u6BD4\u8981\u5927\u5F97\u591A<code>BaseFee</code>\u3002\u56DE\u60F3\u4E00\u4E0B\uFF0C\u5982\u679C\u5B58\u5728\u591A\u4E2A\u77FF\u5DE5\uFF0C\u5219\u77FF\u5DE5\u5E94\u8BE5\u4ECE\u6D88\u606F\u6C60\u4E2D\u9009\u62E9\u53D1\u4EF6\u4EBA\u7684\u6240\u6709\u6D88\u606F\u3002\u7406\u7531\u662F\u589E\u52A0\u7B2C\u4E8C\u6761\u6D88\u606F\u7684\u8D39\u7528\u5C06\u5F25\u8865\u7B2C\u4E00\u6761\u6D88\u606F\u7684\u635F\u5931\u3002</li><li>\u5982\u679C<code>BaseFee + GasPremium</code>&gt; <code>GasFeeCap</code>\uFF0C\u5219\u77FF\u5DE5\u53EF\u80FD\u4E0D\u4F1A\u83B7\u5F97\u5168\u90E8<code>GasLimit * GasPremium</code>\u4F5C\u4E3A\u5956\u52B1\u3002</li><li>\u4E00\u6761\u6D88\u606F\u7684\u82B1\u8D39\u4E0D\u5F97\u8D85\u8FC7<code>GasFeeCap * GasLimit</code>\u3002\u4ECE\u8BE5\u91D1\u989D\u4E2D\uFF0C\u7F51\u7EDC\u9996\u5148<code>BaseFee</code>\u88AB\u652F\u4ED8\uFF08\u70E7\u6389\uFF09\u3002\u4E4B\u540E\uFF0C\u6700\u591A<code>GasLimit * GasPremium</code>\u5C06\u7ED9\u4E88\u77FF\u5DE5\u4F5C\u4E3A\u5956\u52B1\u3002</li><li>\u8017\u5C3D\u6C14\u4F53\u7684\u6D88\u606F\u5931\u8D25\uFF0C\u5E76\u663E\u793A\u201C\u8017\u5C3D\u6C14\u4F53\u201D\u9000\u51FA\u4EE3\u7801\u3002<code>GasUsed * BaseFee</code>\u4ECD\u5C06\u88AB\u70E7\u6BC1\uFF08\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B<code>GasUsed = GasLimit</code>\uFF09\uFF0C\u800C\u77FF\u5DE5\u4ECD\u5C06\u5F97\u5230\u5956\u52B1<code>GasLimit * GasPremium</code>\u3002\u8FD9\u662F\u5047\u5B9A<code>GasFeeCap &gt; BaseFee + GasPremium</code>\u3002</li><li>\u8F83\u4F4E\u7684\u4EF7\u683C<code>GasFeeCap</code>\u53EF\u80FD\u4F1A\u5BFC\u81F4\u6D88\u606F\u6EDE\u7559\u5728\u6D88\u606F\u6C60\u4E2D\uFF0C\u56E0\u4E3A\u5BF9\u4E8E\u4EFB\u4F55\u77FF\u5DE5\u6765\u8BF4\uFF0C\u9009\u62E9\u5B83\u5E76\u5C06\u5176\u5305\u542B\u5728\u4E00\u4E2A\u5757\u4E2D\uFF0C\u5728\u5229\u6DA6\u65B9\u9762\u90FD\u4E0D\u591F\u5438\u5F15\u4EBA\u3002\u53D1\u751F\u8FD9\u79CD\u60C5\u51B5\u65F6\uFF0C\u5C06\u6709\u4E00\u4E2A\u66F4\u65B0\u7A0B\u5E8F\uFF0C\u4EE5<code>GasFeeCap</code>\u4F7F\u6D88\u606F\u5BF9\u77FF\u5DE5\u66F4\u5177\u5438\u5F15\u529B\u3002\u53D1\u9001\u8005\u53EF\u4EE5\u5C06\u65B0\u6D88\u606F\u63A8\u9001\u5230\u6D88\u606F\u6C60\uFF08\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u8BE5\u6D88\u606F\u6C60\u5C06\u4F20\u64AD\u5230\u5176\u4ED6\u77FF\u5DE5\u7684\u6D88\u606F\u6C60\uFF09\uFF0C\u5176\u4E2D\uFF1Ai\uFF09\u65E7\u6D88\u606F\u548C\u65B0\u6D88\u606F\u7684\u6807\u8BC6\u7B26\u76F8\u540C\uFF08\u4F8B\u5982\uFF0C\u76F8\u540C<code>Nonce</code>\uFF09\uFF0C\u5E76\u4E14ii\uFF09<code>GasPremium</code>\u66F4\u65B0\u5E76\u589E\u52A0\u81F3\u5C1125\uFF05\u7684\u5148\u524D\u503C\u3002</li></ul>",1),bo={id:"_2-3-6\u7CFB\u7EDF\u89D2\u8272",tabindex:"-1"},ho=n("a",{class:"header-anchor",href:"#_2-3-6\u7CFB\u7EDF\u89D2\u8272","aria-hidden":"true"},"#",-1),fo={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.sysactors",target:"_blank",rel:"noopener noreferrer"},_o=n("p",null,[s("\u603B\u5171\u6709\u5341\u4E00\uFF0811\uFF09\u4E2A\u5185\u7F6E\u7684System Actor\uFF0C\u4F46\u662F\u5E76\u4E0D\u662F\u6240\u6709\u7684Actor\u90FD\u4E0EVM\u4EA4\u4E92\u3002\u6BCF\u4E2A\u6F14\u5458\u90FD\u7531"),n("em",null,"\u4EE3\u7801ID"),s("\uFF08\u6216CID\uFF09"),n("em",null,"\u6807\u8BC6"),s("\u3002")],-1),go=n("p",null,"VM\u5904\u7406\u9700\u8981\u4E24\u4E2A\u7CFB\u7EDF\u53C2\u4E0E\u8005\uFF1A",-1),yo={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.sysactors.initactor",target:"_blank",rel:"noopener noreferrer"},wo={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.sysactors.cronactor",target:"_blank",rel:"noopener noreferrer"},xo={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.sysactors.accountactor",target:"_blank",rel:"noopener noreferrer"},Co={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.sysactors.rewardactor",target:"_blank",rel:"noopener noreferrer"},So=n("p",null,"\u4E0D\u76F4\u63A5\u4E0EVM\u4EA4\u4E92\u7684\u5176\u4F59\u4E03\uFF087\uFF09\u4E2A\u5185\u7F6E\u7CFB\u7EDF\u89D2\u8272\u662F\uFF1A",-1),Fo=n("code",null,"StorageMarketActor",-1),qo={href:"https://github.com/filecoin-project/specs-actors/blob/master/actors/builtin/market/market_actor.go",target:"_blank",rel:"noopener noreferrer"},Po=n("code",null,"StorageMinerActor",-1),Ao={href:"https://github.com/filecoin-project/specs-actors/blob/master/actors/builtin/miner/miner_actor.go",target:"_blank",rel:"noopener noreferrer"},Bo={href:"https://github.com/filecoin-project/specs-actors/blob/master/actors/builtin/miner/miner_actor.go",target:"_blank",rel:"noopener noreferrer"},Eo=n("code",null,"MultisigActor",-1),To={href:"https://github.com/filecoin-project/specs-actors/blob/master/actors/builtin/multisig/multisig_actor.go",target:"_blank",rel:"noopener noreferrer"},Io=n("code",null,"PaymentChannelActor",-1),Ro={href:"https://github.com/filecoin-project/specs-actors/blob/master/actors/builtin/paych/paych_actor.go",target:"_blank",rel:"noopener noreferrer"},Mo=n("code",null,"StoragePowerActor",-1),Do={href:"https://github.com/filecoin-project/specs-actors/blob/master/actors/builtin/power/power_actor.go",target:"_blank",rel:"noopener noreferrer"},Go=n("code",null,"VerifiedRegistryActor",-1),Vo={href:"https://github.com/filecoin-project/specs-actors/blob/master/actors/builtin/verifreg/verified_registry_actor.go",target:"_blank",rel:"noopener noreferrer"},Lo=n("code",null,"SystemActor",-1),No={href:"https://github.com/filecoin-project/specs-actors/blob/master/actors/builtin/system/system_actor.go",target:"_blank",rel:"noopener noreferrer"},jo={id:"_2-3-6-1cronactor",tabindex:"-1"},Ho=n("a",{class:"header-anchor",href:"#_2-3-6-1cronactor","aria-hidden":"true"},"#",-1),Oo={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.sysactors.cronactor",target:"_blank",rel:"noopener noreferrer"},Uo=n("p",null,[s("\u5185\u7F6E\u5728\u521B\u4E16\u72B6\u6001\u4E2D\uFF0C"),n("code",null,"CronActor"),s("\u7684\u5206\u6D3E\u8868\u8C03\u7528"),n("code",null,"StoragePowerActor"),s("\u548C"),n("code",null,"StorageMarketActor"),s("\uFF0C\u4EE5\u7EF4\u62A4\u5185\u90E8\u72B6\u6001\u5E76\u5904\u7406\u5EF6\u8FDF\u7684\u4E8B\u4EF6\u3002\u5728\u7F51\u7EDC\u5347\u7EA7\u540E\uFF0C\u5B83\u539F\u5219\u4E0A\u53EF\u4EE5\u8C03\u7528\u5176\u4ED6\u53C2\u4E0E\u8005\u3002")],-1),zo={href:"https://spec.filecoin.io/#example-",target:"_blank",rel:"noopener noreferrer"},Wo=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> cron

<span class="token keyword">import</span> <span class="token punctuation">(</span>
 <span class="token string">&quot;github.com/filecoin-project/go-state-types/abi&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/go-state-types/cbor&quot;</span>
 cron0 <span class="token string">&quot;github.com/filecoin-project/specs-actors/actors/builtin/cron&quot;</span>
 <span class="token string">&quot;github.com/ipfs/go-cid&quot;</span>

 <span class="token string">&quot;github.com/filecoin-project/specs-actors/v2/actors/builtin&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/specs-actors/v2/actors/runtime&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// The cron actor is a built-in singleton that sends messages to other registered actors at the end of each epoch.</span>
<span class="token keyword">type</span> Actor <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">Exports</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span>
  builtin<span class="token punctuation">.</span>MethodConstructor<span class="token punctuation">:</span> a<span class="token punctuation">.</span>Constructor<span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token punctuation">:</span>                         a<span class="token punctuation">.</span>EpochTick<span class="token punctuation">,</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">Code</span><span class="token punctuation">(</span><span class="token punctuation">)</span> cid<span class="token punctuation">.</span>Cid <span class="token punctuation">{</span>
 <span class="token keyword">return</span> builtin<span class="token punctuation">.</span>CronActorCodeID
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">IsSingleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">State</span><span class="token punctuation">(</span><span class="token punctuation">)</span> cbor<span class="token punctuation">.</span>Er <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token function">new</span><span class="token punctuation">(</span>State<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token boolean">_</span> runtime<span class="token punctuation">.</span>VMActor <span class="token operator">=</span> Actor<span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">//type ConstructorParams struct {</span>
<span class="token comment">// Entries []Entry</span>
<span class="token comment">//}</span>
<span class="token keyword">type</span> ConstructorParams <span class="token operator">=</span> cron0<span class="token punctuation">.</span>ConstructorParams

<span class="token keyword">type</span> EntryParam <span class="token operator">=</span> cron0<span class="token punctuation">.</span>Entry

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">Constructor</span><span class="token punctuation">(</span>rt runtime<span class="token punctuation">.</span>Runtime<span class="token punctuation">,</span> params <span class="token operator">*</span>ConstructorParams<span class="token punctuation">)</span> <span class="token operator">*</span>abi<span class="token punctuation">.</span>EmptyValue <span class="token punctuation">{</span>
 rt<span class="token punctuation">.</span><span class="token function">ValidateImmediateCallerIs</span><span class="token punctuation">(</span>builtin<span class="token punctuation">.</span>SystemActorAddr<span class="token punctuation">)</span>
 entries <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>Entry<span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span>Entries<span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token keyword">for</span> i<span class="token punctuation">,</span> e <span class="token operator">:=</span> <span class="token keyword">range</span> params<span class="token punctuation">.</span>Entries <span class="token punctuation">{</span>
  entries<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Entry</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token comment">// Identical</span>
 <span class="token punctuation">}</span>
 rt<span class="token punctuation">.</span><span class="token function">StateCreate</span><span class="token punctuation">(</span><span class="token function">ConstructState</span><span class="token punctuation">(</span>entries<span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">// Invoked by the system after all other messages in the epoch have been processed.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">EpochTick</span><span class="token punctuation">(</span>rt runtime<span class="token punctuation">.</span>Runtime<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">*</span>abi<span class="token punctuation">.</span>EmptyValue<span class="token punctuation">)</span> <span class="token operator">*</span>abi<span class="token punctuation">.</span>EmptyValue <span class="token punctuation">{</span>
 rt<span class="token punctuation">.</span><span class="token function">ValidateImmediateCallerIs</span><span class="token punctuation">(</span>builtin<span class="token punctuation">.</span>SystemActorAddr<span class="token punctuation">)</span>

 <span class="token keyword">var</span> st State
 rt<span class="token punctuation">.</span><span class="token function">StateReadonly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>st<span class="token punctuation">)</span>
 <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> entry <span class="token operator">:=</span> <span class="token keyword">range</span> st<span class="token punctuation">.</span>Entries <span class="token punctuation">{</span>
  <span class="token boolean">_</span> <span class="token operator">=</span> rt<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span>Receiver<span class="token punctuation">,</span> entry<span class="token punctuation">.</span>MethodNum<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> abi<span class="token punctuation">.</span><span class="token function">NewTokenAmount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>builtin<span class="token punctuation">.</span>Discard<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// Any error and return value are ignored.</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Zo={id:"_2-3-6-2\u521D\u59CB\u5316\u6F14\u5458",tabindex:"-1"},Ko=n("a",{class:"header-anchor",href:"#_2-3-6-2\u521D\u59CB\u5316\u6F14\u5458","aria-hidden":"true"},"#",-1),Qo={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.sysactors.initactor",target:"_blank",rel:"noopener noreferrer"},Jo=n("p",null,[s("\u5C06"),n("code",null,"InitActor"),s("\u6709\u53EF\u80FD\u521B\u9020\u65B0\u7684\u89D2\u8272\uFF0C\u4F8B\u5982\uFF0C\u90A3\u4E9B\u8FDB\u5165\u7CFB\u7EDF\u7684\u7535\u6E90\u3002\u5B83\u7EF4\u62A4\u7740\u4E00\u4E2A\u8868\uFF0C\u7528\u4E8E\u5C06\u516C\u5171\u5BC6\u94A5\u548C\u4E34\u65F6\u53C2\u4E0E\u8005\u5730\u5740\u89E3\u6790\u4E3A\u5176\u89C4\u8303\u7684ID\u5730\u5740\u3002\u65E0\u6548\u7684CID\u4E0D\u5E94\u63D0\u4EA4\u7ED9\u72B6\u6001\u6811\u3002")],-1),Xo=n("p",null,"\u8BF7\u6CE8\u610F\uFF0C\u5728\u8FDB\u884C\u94FE\u91CD\u7EC4\u65F6\uFF0C\u89C4\u8303ID\u5730\u5740\u4E0D\u4F1A\u4FDD\u7559\u3002\u6F14\u5458\u5730\u5740\u6216\u516C\u94A5\u5728\u94FE\u91CD\u7EC4\u540E\u4ECD\u7136\u6709\u6548\u3002",-1),Yo={href:"https://spec.filecoin.io/#example-",target:"_blank",rel:"noopener noreferrer"},$o=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> init

<span class="token keyword">import</span> <span class="token punctuation">(</span>
 addr <span class="token string">&quot;github.com/filecoin-project/go-address&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/go-state-types/abi&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/go-state-types/cbor&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/go-state-types/exitcode&quot;</span>
 init0 <span class="token string">&quot;github.com/filecoin-project/specs-actors/actors/builtin/init&quot;</span>
 cid <span class="token string">&quot;github.com/ipfs/go-cid&quot;</span>

 <span class="token string">&quot;github.com/filecoin-project/specs-actors/v2/actors/builtin&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/specs-actors/v2/actors/runtime&quot;</span>
 autil <span class="token string">&quot;github.com/filecoin-project/specs-actors/v2/actors/util&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/specs-actors/v2/actors/util/adt&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// The init actor uniquely has the power to create new actors.</span>
<span class="token comment">// It maintains a table resolving pubkey and temporary actor addresses to the canonical ID-addresses.</span>
<span class="token keyword">type</span> Actor <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">Exports</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span>
  builtin<span class="token punctuation">.</span>MethodConstructor<span class="token punctuation">:</span> a<span class="token punctuation">.</span>Constructor<span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token punctuation">:</span>                         a<span class="token punctuation">.</span>Exec<span class="token punctuation">,</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">Code</span><span class="token punctuation">(</span><span class="token punctuation">)</span> cid<span class="token punctuation">.</span>Cid <span class="token punctuation">{</span>
 <span class="token keyword">return</span> builtin<span class="token punctuation">.</span>InitActorCodeID
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">IsSingleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">State</span><span class="token punctuation">(</span><span class="token punctuation">)</span> cbor<span class="token punctuation">.</span>Er <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">new</span><span class="token punctuation">(</span>State<span class="token punctuation">)</span> <span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token boolean">_</span> runtime<span class="token punctuation">.</span>VMActor <span class="token operator">=</span> Actor<span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">//type ConstructorParams struct {</span>
<span class="token comment">// NetworkName string</span>
<span class="token comment">//}</span>
<span class="token keyword">type</span> ConstructorParams <span class="token operator">=</span> init0<span class="token punctuation">.</span>ConstructorParams

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">Constructor</span><span class="token punctuation">(</span>rt runtime<span class="token punctuation">.</span>Runtime<span class="token punctuation">,</span> params <span class="token operator">*</span>ConstructorParams<span class="token punctuation">)</span> <span class="token operator">*</span>abi<span class="token punctuation">.</span>EmptyValue <span class="token punctuation">{</span>
 rt<span class="token punctuation">.</span><span class="token function">ValidateImmediateCallerIs</span><span class="token punctuation">(</span>builtin<span class="token punctuation">.</span>SystemActorAddr<span class="token punctuation">)</span>
 emptyMap<span class="token punctuation">,</span> err <span class="token operator">:=</span> adt<span class="token punctuation">.</span><span class="token function">MakeEmptyMap</span><span class="token punctuation">(</span>adt<span class="token punctuation">.</span><span class="token function">AsStore</span><span class="token punctuation">(</span>rt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Root</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 builtin<span class="token punctuation">.</span><span class="token function">RequireNoErr</span><span class="token punctuation">(</span>rt<span class="token punctuation">,</span> err<span class="token punctuation">,</span> exitcode<span class="token punctuation">.</span>ErrIllegalState<span class="token punctuation">,</span> <span class="token string">&quot;failed to construct state&quot;</span><span class="token punctuation">)</span>

 st <span class="token operator">:=</span> <span class="token function">ConstructState</span><span class="token punctuation">(</span>emptyMap<span class="token punctuation">,</span> params<span class="token punctuation">.</span>NetworkName<span class="token punctuation">)</span>
 rt<span class="token punctuation">.</span><span class="token function">StateCreate</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span>
 <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">//type ExecParams struct {</span>
<span class="token comment">// CodeCID           cid.Cid \`checked:&quot;true&quot;\` // invalid CIDs won&#39;t get committed to the state tree</span>
<span class="token comment">// ConstructorParams []byte</span>
<span class="token comment">//}</span>
<span class="token keyword">type</span> ExecParams <span class="token operator">=</span> init0<span class="token punctuation">.</span>ExecParams

<span class="token comment">//type ExecReturn struct {</span>
<span class="token comment">// IDAddress     addr.Address // The canonical ID-based address for the actor.</span>
<span class="token comment">// RobustAddress addr.Address // A more expensive but re-org-safe address for the newly created actor.</span>
<span class="token comment">//}</span>
<span class="token keyword">type</span> ExecReturn <span class="token operator">=</span> init0<span class="token punctuation">.</span>ExecReturn

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">Exec</span><span class="token punctuation">(</span>rt runtime<span class="token punctuation">.</span>Runtime<span class="token punctuation">,</span> params <span class="token operator">*</span>ExecParams<span class="token punctuation">)</span> <span class="token operator">*</span>ExecReturn <span class="token punctuation">{</span>
 rt<span class="token punctuation">.</span><span class="token function">ValidateImmediateCallerAcceptAny</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 callerCodeCID<span class="token punctuation">,</span> ok <span class="token operator">:=</span> rt<span class="token punctuation">.</span><span class="token function">GetActorCodeCID</span><span class="token punctuation">(</span>rt<span class="token punctuation">.</span><span class="token function">Caller</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 autil<span class="token punctuation">.</span><span class="token function">AssertMsg</span><span class="token punctuation">(</span>ok<span class="token punctuation">,</span> <span class="token string">&quot;no code for actor at %s&quot;</span><span class="token punctuation">,</span> rt<span class="token punctuation">.</span><span class="token function">Caller</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token keyword">if</span> <span class="token operator">!</span><span class="token function">canExec</span><span class="token punctuation">(</span>callerCodeCID<span class="token punctuation">,</span> params<span class="token punctuation">.</span>CodeCID<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  rt<span class="token punctuation">.</span><span class="token function">Abortf</span><span class="token punctuation">(</span>exitcode<span class="token punctuation">.</span>ErrForbidden<span class="token punctuation">,</span> <span class="token string">&quot;caller type %v cannot exec actor type %v&quot;</span><span class="token punctuation">,</span> callerCodeCID<span class="token punctuation">,</span> params<span class="token punctuation">.</span>CodeCID<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token comment">// Compute a re-org-stable address.</span>
 <span class="token comment">// This address exists for use by messages coming from outside the system, in order to</span>
 <span class="token comment">// stably address the newly created actor even if a chain re-org causes it to end up with</span>
 <span class="token comment">// a different ID.</span>
 uniqueAddress <span class="token operator">:=</span> rt<span class="token punctuation">.</span><span class="token function">NewActorAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

 <span class="token comment">// Allocate an ID for this actor.</span>
 <span class="token comment">// Store mapping of pubkey or actor address to actor ID</span>
 <span class="token keyword">var</span> st State
 <span class="token keyword">var</span> idAddr addr<span class="token punctuation">.</span>Address
 rt<span class="token punctuation">.</span><span class="token function">StateTransaction</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>st<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> err <span class="token builtin">error</span>
  idAddr<span class="token punctuation">,</span> err <span class="token operator">=</span> st<span class="token punctuation">.</span><span class="token function">MapAddressToNewID</span><span class="token punctuation">(</span>adt<span class="token punctuation">.</span><span class="token function">AsStore</span><span class="token punctuation">(</span>rt<span class="token punctuation">)</span><span class="token punctuation">,</span> uniqueAddress<span class="token punctuation">)</span>
  builtin<span class="token punctuation">.</span><span class="token function">RequireNoErr</span><span class="token punctuation">(</span>rt<span class="token punctuation">,</span> err<span class="token punctuation">,</span> exitcode<span class="token punctuation">.</span>ErrIllegalState<span class="token punctuation">,</span> <span class="token string">&quot;failed to allocate ID address&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>

 <span class="token comment">// Create an empty actor.</span>
 rt<span class="token punctuation">.</span><span class="token function">CreateActor</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span>CodeCID<span class="token punctuation">,</span> idAddr<span class="token punctuation">)</span>

 <span class="token comment">// Invoke constructor.</span>
 code <span class="token operator">:=</span> rt<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>idAddr<span class="token punctuation">,</span> builtin<span class="token punctuation">.</span>MethodConstructor<span class="token punctuation">,</span> builtin<span class="token punctuation">.</span><span class="token function">CBORBytes</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span>ConstructorParams<span class="token punctuation">)</span><span class="token punctuation">,</span> rt<span class="token punctuation">.</span><span class="token function">ValueReceived</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>builtin<span class="token punctuation">.</span>Discard<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
 builtin<span class="token punctuation">.</span><span class="token function">RequireSuccess</span><span class="token punctuation">(</span>rt<span class="token punctuation">,</span> code<span class="token punctuation">,</span> <span class="token string">&quot;constructor failed&quot;</span><span class="token punctuation">)</span>

 <span class="token keyword">return</span> <span class="token operator">&amp;</span>ExecReturn<span class="token punctuation">{</span>IDAddress<span class="token punctuation">:</span> idAddr<span class="token punctuation">,</span> RobustAddress<span class="token punctuation">:</span> uniqueAddress<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">canExec</span><span class="token punctuation">(</span>callerCodeID cid<span class="token punctuation">.</span>Cid<span class="token punctuation">,</span> execCodeID cid<span class="token punctuation">.</span>Cid<span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
 <span class="token keyword">switch</span> execCodeID <span class="token punctuation">{</span>
 <span class="token keyword">case</span> builtin<span class="token punctuation">.</span>StorageMinerActorCodeID<span class="token punctuation">:</span>
  <span class="token keyword">if</span> callerCodeID <span class="token operator">==</span> builtin<span class="token punctuation">.</span>StoragePowerActorCodeID <span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span>
 <span class="token keyword">case</span> builtin<span class="token punctuation">.</span>PaymentChannelActorCodeID<span class="token punctuation">,</span> builtin<span class="token punctuation">.</span>MultisigActorCodeID<span class="token punctuation">:</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span>
 <span class="token keyword">default</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),np={id:"_2-3-6-3\u5956\u52B1\u6F14\u5458",tabindex:"-1"},sp=n("a",{class:"header-anchor",href:"#_2-3-6-3\u5956\u52B1\u6F14\u5458","aria-hidden":"true"},"#",-1),ap={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.sysactors.rewardactor",target:"_blank",rel:"noopener noreferrer"},ep=n("p",null,[s("\u7684"),n("code",null,"RewardActor"),s("\u5C31\u662Funminted Filecoin\u4EE4\u724C\u5C06\u88AB\u4FDD\u7559\u3002\u6F14\u5458\u76F4\u63A5\u5C06\u5956\u52B1\u5206\u914D\u7ED9\u77FF\u5DE5\u6F14\u5458\uFF0C\u4ED6\u4EEC\u88AB\u9501\u5B9A\u4EE5\u5F52\u5C5E\u3002\u5F53\u524D\u7EAA\u5143\u7684\u5956\u52B1\u503C\u5728\u7EAA\u5143\u672B\u901A\u8FC7cron tick\u66F4\u65B0\u3002")],-1),tp={href:"https://spec.filecoin.io/#example-",target:"_blank",rel:"noopener noreferrer"},op=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> reward

<span class="token keyword">import</span> <span class="token punctuation">(</span>
 <span class="token string">&quot;github.com/filecoin-project/go-state-types/abi&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/go-state-types/big&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/go-state-types/cbor&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/go-state-types/exitcode&quot;</span>
 rtt <span class="token string">&quot;github.com/filecoin-project/go-state-types/rt&quot;</span>
 reward0 <span class="token string">&quot;github.com/filecoin-project/specs-actors/actors/builtin/reward&quot;</span>
 <span class="token string">&quot;github.com/ipfs/go-cid&quot;</span>

 <span class="token string">&quot;github.com/filecoin-project/specs-actors/v2/actors/builtin&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/specs-actors/v2/actors/runtime&quot;</span>
 <span class="token punctuation">.</span> <span class="token string">&quot;github.com/filecoin-project/specs-actors/v2/actors/util&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/specs-actors/v2/actors/util/smoothing&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// PenaltyMultiplier is the factor miner penaltys are scaled up by</span>
<span class="token keyword">const</span> PenaltyMultiplier <span class="token operator">=</span> <span class="token number">3</span>

<span class="token keyword">type</span> Actor <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">Exports</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span>
  builtin<span class="token punctuation">.</span>MethodConstructor<span class="token punctuation">:</span> a<span class="token punctuation">.</span>Constructor<span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token punctuation">:</span>                         a<span class="token punctuation">.</span>AwardBlockReward<span class="token punctuation">,</span>
  <span class="token number">3</span><span class="token punctuation">:</span>                         a<span class="token punctuation">.</span>ThisEpochReward<span class="token punctuation">,</span>
  <span class="token number">4</span><span class="token punctuation">:</span>                         a<span class="token punctuation">.</span>UpdateNetworkKPI<span class="token punctuation">,</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">Code</span><span class="token punctuation">(</span><span class="token punctuation">)</span> cid<span class="token punctuation">.</span>Cid <span class="token punctuation">{</span>
 <span class="token keyword">return</span> builtin<span class="token punctuation">.</span>RewardActorCodeID
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">IsSingleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">State</span><span class="token punctuation">(</span><span class="token punctuation">)</span> cbor<span class="token punctuation">.</span>Er <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token function">new</span><span class="token punctuation">(</span>State<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token boolean">_</span> runtime<span class="token punctuation">.</span>VMActor <span class="token operator">=</span> Actor<span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">Constructor</span><span class="token punctuation">(</span>rt runtime<span class="token punctuation">.</span>Runtime<span class="token punctuation">,</span> currRealizedPower <span class="token operator">*</span>abi<span class="token punctuation">.</span>StoragePower<span class="token punctuation">)</span> <span class="token operator">*</span>abi<span class="token punctuation">.</span>EmptyValue <span class="token punctuation">{</span>
 rt<span class="token punctuation">.</span><span class="token function">ValidateImmediateCallerIs</span><span class="token punctuation">(</span>builtin<span class="token punctuation">.</span>SystemActorAddr<span class="token punctuation">)</span>

 <span class="token keyword">if</span> currRealizedPower <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  rt<span class="token punctuation">.</span><span class="token function">Abortf</span><span class="token punctuation">(</span>exitcode<span class="token punctuation">.</span>ErrIllegalArgument<span class="token punctuation">,</span> <span class="token string">&quot;argument should not be nil&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span> <span class="token comment">// linter does not understand abort exiting</span>
 <span class="token punctuation">}</span>
 st <span class="token operator">:=</span> <span class="token function">ConstructState</span><span class="token punctuation">(</span><span class="token operator">*</span>currRealizedPower<span class="token punctuation">)</span>
 rt<span class="token punctuation">.</span><span class="token function">StateCreate</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span>
 <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">//type AwardBlockRewardParams struct {</span>
<span class="token comment">// Miner     address.Address</span>
<span class="token comment">// Penalty   abi.TokenAmount // penalty for including bad messages in a block, &gt;= 0</span>
<span class="token comment">// GasReward abi.TokenAmount // gas reward from all gas fees in a block, &gt;= 0</span>
<span class="token comment">// WinCount  int64           // number of reward units won, &gt; 0</span>
<span class="token comment">//}</span>
<span class="token keyword">type</span> AwardBlockRewardParams <span class="token operator">=</span> reward0<span class="token punctuation">.</span>AwardBlockRewardParams

<span class="token comment">// Awards a reward to a block producer.</span>
<span class="token comment">// This method is called only by the system actor, implicitly, as the last message in the evaluation of a block.</span>
<span class="token comment">// The system actor thus computes the parameters and attached value.</span>
<span class="token comment">//</span>
<span class="token comment">// The reward includes two components:</span>
<span class="token comment">// - the epoch block reward, computed and paid from the reward actor&#39;s balance,</span>
<span class="token comment">// - the block gas reward, expected to be transferred to the reward actor with this invocation.</span>
<span class="token comment">//</span>
<span class="token comment">// The reward is reduced before the residual is credited to the block producer, by:</span>
<span class="token comment">// - a penalty amount, provided as a parameter, which is burnt,</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">AwardBlockReward</span><span class="token punctuation">(</span>rt runtime<span class="token punctuation">.</span>Runtime<span class="token punctuation">,</span> params <span class="token operator">*</span>AwardBlockRewardParams<span class="token punctuation">)</span> <span class="token operator">*</span>abi<span class="token punctuation">.</span>EmptyValue <span class="token punctuation">{</span>
 rt<span class="token punctuation">.</span><span class="token function">ValidateImmediateCallerIs</span><span class="token punctuation">(</span>builtin<span class="token punctuation">.</span>SystemActorAddr<span class="token punctuation">)</span>
 priorBalance <span class="token operator">:=</span> rt<span class="token punctuation">.</span><span class="token function">CurrentBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token keyword">if</span> params<span class="token punctuation">.</span>Penalty<span class="token punctuation">.</span><span class="token function">LessThan</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span><span class="token function">Zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  rt<span class="token punctuation">.</span><span class="token function">Abortf</span><span class="token punctuation">(</span>exitcode<span class="token punctuation">.</span>ErrIllegalArgument<span class="token punctuation">,</span> <span class="token string">&quot;negative penalty %v&quot;</span><span class="token punctuation">,</span> params<span class="token punctuation">.</span>Penalty<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">if</span> params<span class="token punctuation">.</span>GasReward<span class="token punctuation">.</span><span class="token function">LessThan</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span><span class="token function">Zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  rt<span class="token punctuation">.</span><span class="token function">Abortf</span><span class="token punctuation">(</span>exitcode<span class="token punctuation">.</span>ErrIllegalArgument<span class="token punctuation">,</span> <span class="token string">&quot;negative gas reward %v&quot;</span><span class="token punctuation">,</span> params<span class="token punctuation">.</span>GasReward<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">if</span> priorBalance<span class="token punctuation">.</span><span class="token function">LessThan</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span>GasReward<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  rt<span class="token punctuation">.</span><span class="token function">Abortf</span><span class="token punctuation">(</span>exitcode<span class="token punctuation">.</span>ErrIllegalState<span class="token punctuation">,</span> <span class="token string">&quot;actor current balance %v insufficient to pay gas reward %v&quot;</span><span class="token punctuation">,</span>
   priorBalance<span class="token punctuation">,</span> params<span class="token punctuation">.</span>GasReward<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">if</span> params<span class="token punctuation">.</span>WinCount <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
  rt<span class="token punctuation">.</span><span class="token function">Abortf</span><span class="token punctuation">(</span>exitcode<span class="token punctuation">.</span>ErrIllegalArgument<span class="token punctuation">,</span> <span class="token string">&quot;invalid win count %d&quot;</span><span class="token punctuation">,</span> params<span class="token punctuation">.</span>WinCount<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 minerAddr<span class="token punctuation">,</span> ok <span class="token operator">:=</span> rt<span class="token punctuation">.</span><span class="token function">ResolveAddress</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span>Miner<span class="token punctuation">)</span>
 <span class="token keyword">if</span> <span class="token operator">!</span>ok <span class="token punctuation">{</span>
  rt<span class="token punctuation">.</span><span class="token function">Abortf</span><span class="token punctuation">(</span>exitcode<span class="token punctuation">.</span>ErrNotFound<span class="token punctuation">,</span> <span class="token string">&quot;failed to resolve given owner address&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
 <span class="token comment">// The miner penalty is scaled up by a factor of PenaltyMultiplier</span>
 penalty <span class="token operator">:=</span> big<span class="token punctuation">.</span><span class="token function">Mul</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span>PenaltyMultiplier<span class="token punctuation">)</span><span class="token punctuation">,</span> params<span class="token punctuation">.</span>Penalty<span class="token punctuation">)</span>
 totalReward <span class="token operator">:=</span> big<span class="token punctuation">.</span><span class="token function">Zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token keyword">var</span> st State
 rt<span class="token punctuation">.</span><span class="token function">StateTransaction</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>st<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  blockReward <span class="token operator">:=</span> big<span class="token punctuation">.</span><span class="token function">Mul</span><span class="token punctuation">(</span>st<span class="token punctuation">.</span>ThisEpochReward<span class="token punctuation">,</span> big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span>WinCount<span class="token punctuation">)</span><span class="token punctuation">)</span>
  blockReward <span class="token operator">=</span> big<span class="token punctuation">.</span><span class="token function">Div</span><span class="token punctuation">(</span>blockReward<span class="token punctuation">,</span> big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span>builtin<span class="token punctuation">.</span>ExpectedLeadersPerEpoch<span class="token punctuation">)</span><span class="token punctuation">)</span>
  totalReward <span class="token operator">=</span> big<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>blockReward<span class="token punctuation">,</span> params<span class="token punctuation">.</span>GasReward<span class="token punctuation">)</span>
  currBalance <span class="token operator">:=</span> rt<span class="token punctuation">.</span><span class="token function">CurrentBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> totalReward<span class="token punctuation">.</span><span class="token function">GreaterThan</span><span class="token punctuation">(</span>currBalance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   rt<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>rtt<span class="token punctuation">.</span>WARN<span class="token punctuation">,</span> <span class="token string">&quot;reward actor balance %d below totalReward expected %d, paying out rest of balance&quot;</span><span class="token punctuation">,</span> currBalance<span class="token punctuation">,</span> totalReward<span class="token punctuation">)</span>
   totalReward <span class="token operator">=</span> currBalance

   blockReward <span class="token operator">=</span> big<span class="token punctuation">.</span><span class="token function">Sub</span><span class="token punctuation">(</span>totalReward<span class="token punctuation">,</span> params<span class="token punctuation">.</span>GasReward<span class="token punctuation">)</span>
   <span class="token comment">// Since we have already asserted the balance is greater than gas reward blockReward is &gt;= 0</span>
   <span class="token function">AssertMsg</span><span class="token punctuation">(</span>blockReward<span class="token punctuation">.</span><span class="token function">GreaterThanEqual</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span><span class="token function">Zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;programming error, block reward is %v below zero&quot;</span><span class="token punctuation">,</span> blockReward<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  st<span class="token punctuation">.</span>TotalStoragePowerReward <span class="token operator">=</span> big<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>st<span class="token punctuation">.</span>TotalStoragePowerReward<span class="token punctuation">,</span> blockReward<span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>

 <span class="token function">AssertMsg</span><span class="token punctuation">(</span>totalReward<span class="token punctuation">.</span><span class="token function">LessThanEqual</span><span class="token punctuation">(</span>priorBalance<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;reward %v exceeds balance %v&quot;</span><span class="token punctuation">,</span> totalReward<span class="token punctuation">,</span> priorBalance<span class="token punctuation">)</span>

 <span class="token comment">// if this fails, we can assume the miner is responsible and avoid failing here.</span>
 rewardParams <span class="token operator">:=</span> builtin<span class="token punctuation">.</span>ApplyRewardParams<span class="token punctuation">{</span>
  Reward<span class="token punctuation">:</span>  totalReward<span class="token punctuation">,</span>
  Penalty<span class="token punctuation">:</span> penalty<span class="token punctuation">,</span>
 <span class="token punctuation">}</span>
 code <span class="token operator">:=</span> rt<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>minerAddr<span class="token punctuation">,</span> builtin<span class="token punctuation">.</span>MethodsMiner<span class="token punctuation">.</span>ApplyRewards<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rewardParams<span class="token punctuation">,</span> totalReward<span class="token punctuation">,</span> <span class="token operator">&amp;</span>builtin<span class="token punctuation">.</span>Discard<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token keyword">if</span> <span class="token operator">!</span>code<span class="token punctuation">.</span><span class="token function">IsSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  rt<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>rtt<span class="token punctuation">.</span>ERROR<span class="token punctuation">,</span> <span class="token string">&quot;failed to send ApplyRewards call to the miner actor with funds: %v, code: %v&quot;</span><span class="token punctuation">,</span> totalReward<span class="token punctuation">,</span> code<span class="token punctuation">)</span>
  code <span class="token operator">:=</span> rt<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>builtin<span class="token punctuation">.</span>BurntFundsActorAddr<span class="token punctuation">,</span> builtin<span class="token punctuation">.</span>MethodSend<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> totalReward<span class="token punctuation">,</span> <span class="token operator">&amp;</span>builtin<span class="token punctuation">.</span>Discard<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token operator">!</span>code<span class="token punctuation">.</span><span class="token function">IsSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   rt<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>rtt<span class="token punctuation">.</span>ERROR<span class="token punctuation">,</span> <span class="token string">&quot;failed to send unsent reward to the burnt funds actor, code: %v&quot;</span><span class="token punctuation">,</span> code<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">// Changed since v0:</span>
<span class="token comment">// - removed ThisEpochReward (unsmoothed)</span>
<span class="token keyword">type</span> ThisEpochRewardReturn <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 ThisEpochRewardSmoothed smoothing<span class="token punctuation">.</span>FilterEstimate
 ThisEpochBaselinePower  abi<span class="token punctuation">.</span>StoragePower
<span class="token punctuation">}</span>

<span class="token comment">// The award value used for the current epoch, updated at the end of an epoch</span>
<span class="token comment">// through cron tick.  In the case previous epochs were null blocks this</span>
<span class="token comment">// is the reward value as calculated at the last non-null epoch.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">ThisEpochReward</span><span class="token punctuation">(</span>rt runtime<span class="token punctuation">.</span>Runtime<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">*</span>abi<span class="token punctuation">.</span>EmptyValue<span class="token punctuation">)</span> <span class="token operator">*</span>ThisEpochRewardReturn <span class="token punctuation">{</span>
 rt<span class="token punctuation">.</span><span class="token function">ValidateImmediateCallerAcceptAny</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

 <span class="token keyword">var</span> st State
 rt<span class="token punctuation">.</span><span class="token function">StateReadonly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>st<span class="token punctuation">)</span>
 <span class="token keyword">return</span> <span class="token operator">&amp;</span>ThisEpochRewardReturn<span class="token punctuation">{</span>
  ThisEpochRewardSmoothed<span class="token punctuation">:</span> st<span class="token punctuation">.</span>ThisEpochRewardSmoothed<span class="token punctuation">,</span>
  ThisEpochBaselinePower<span class="token punctuation">:</span>  st<span class="token punctuation">.</span>ThisEpochBaselinePower<span class="token punctuation">,</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Called at the end of each epoch by the power actor (in turn by its cron hook).</span>
<span class="token comment">// This is only invoked for non-empty tipsets, but catches up any number of null</span>
<span class="token comment">// epochs to compute the next epoch reward.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">UpdateNetworkKPI</span><span class="token punctuation">(</span>rt runtime<span class="token punctuation">.</span>Runtime<span class="token punctuation">,</span> currRealizedPower <span class="token operator">*</span>abi<span class="token punctuation">.</span>StoragePower<span class="token punctuation">)</span> <span class="token operator">*</span>abi<span class="token punctuation">.</span>EmptyValue <span class="token punctuation">{</span>
 rt<span class="token punctuation">.</span><span class="token function">ValidateImmediateCallerIs</span><span class="token punctuation">(</span>builtin<span class="token punctuation">.</span>StoragePowerActorAddr<span class="token punctuation">)</span>
 <span class="token keyword">if</span> currRealizedPower <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  rt<span class="token punctuation">.</span><span class="token function">Abortf</span><span class="token punctuation">(</span>exitcode<span class="token punctuation">.</span>ErrIllegalArgument<span class="token punctuation">,</span> <span class="token string">&quot;arugment should not be nil&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">var</span> st State
 rt<span class="token punctuation">.</span><span class="token function">StateTransaction</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>st<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  prev <span class="token operator">:=</span> st<span class="token punctuation">.</span>Epoch
  <span class="token comment">// if there were null runs catch up the computation until</span>
  <span class="token comment">// st.Epoch == rt.CurrEpoch()</span>
  <span class="token keyword">for</span> st<span class="token punctuation">.</span>Epoch <span class="token operator">&lt;</span> rt<span class="token punctuation">.</span><span class="token function">CurrEpoch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// Update to next epoch to process null rounds</span>
   st<span class="token punctuation">.</span><span class="token function">updateToNextEpoch</span><span class="token punctuation">(</span><span class="token operator">*</span>currRealizedPower<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  st<span class="token punctuation">.</span><span class="token function">updateToNextEpochWithReward</span><span class="token punctuation">(</span><span class="token operator">*</span>currRealizedPower<span class="token punctuation">)</span>
  <span class="token comment">// only update smoothed estimates after updating reward and epoch</span>
  st<span class="token punctuation">.</span><span class="token function">updateSmoothedEstimates</span><span class="token punctuation">(</span>st<span class="token punctuation">.</span>Epoch <span class="token operator">-</span> prev<span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),pp={id:"_2-3-6-4accountactor",tabindex:"-1"},ip=n("a",{class:"header-anchor",href:"#_2-3-6-4accountactor","aria-hidden":"true"},"#",-1),cp={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.sysactors.accountactor",target:"_blank",rel:"noopener noreferrer"},lp=n("p",null,[s("\u8BE5"),n("code",null,"AccountActor"),s("\u8D1F\u8D23\u7528\u6237\u5E10\u6237\u3002\u5E10\u6237\u53C2\u4E0E\u8005\u4E0D\u662F\u7531\u521B\u5EFA\u7684"),n("code",null,"InitActor"),s("\uFF0C\u4F46\u7CFB\u7EDF\u4F1A\u8C03\u7528\u5176\u6784\u9020\u51FD\u6570\u3002\u901A\u8FC7\u5411\u516C\u5171\u5BC6\u94A5\u6837\u5F0F\u7684\u5730\u5740\u53D1\u9001\u6D88\u606F\u6765\u521B\u5EFA\u5E10\u6237\u53C2\u4E0E\u8005\u3002\u5730\u5740\u5FC5\u987B\u4E3A"),n("code",null,"BLS"),s("\u6216"),n("code",null,"SECP"),s("\uFF0C\u5426\u5219\u5E94\u8BE5\u5B58\u5728\u9000\u51FA\u9519\u8BEF\u3002\u5E10\u6237\u53C2\u4E0E\u8005\u6B63\u5728\u4F7F\u7528\u65B0\u7684\u53C2\u4E0E\u8005\u5730\u5740\u66F4\u65B0\u72B6\u6001\u6811\u3002")],-1),up={href:"https://spec.filecoin.io/#example-",target:"_blank",rel:"noopener noreferrer"},rp=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> account

<span class="token keyword">import</span> <span class="token punctuation">(</span>
 addr <span class="token string">&quot;github.com/filecoin-project/go-address&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/go-state-types/abi&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/go-state-types/cbor&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/go-state-types/exitcode&quot;</span>
 <span class="token string">&quot;github.com/ipfs/go-cid&quot;</span>

 <span class="token string">&quot;github.com/filecoin-project/specs-actors/v2/actors/builtin&quot;</span>
 <span class="token string">&quot;github.com/filecoin-project/specs-actors/v2/actors/runtime&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Actor <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">Exports</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span>
  <span class="token number">1</span><span class="token punctuation">:</span> a<span class="token punctuation">.</span>Constructor<span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token punctuation">:</span> a<span class="token punctuation">.</span>PubkeyAddress<span class="token punctuation">,</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">Code</span><span class="token punctuation">(</span><span class="token punctuation">)</span> cid<span class="token punctuation">.</span>Cid <span class="token punctuation">{</span>
 <span class="token keyword">return</span> builtin<span class="token punctuation">.</span>AccountActorCodeID
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">State</span><span class="token punctuation">(</span><span class="token punctuation">)</span> cbor<span class="token punctuation">.</span>Er <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token function">new</span><span class="token punctuation">(</span>State<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token boolean">_</span> runtime<span class="token punctuation">.</span>VMActor <span class="token operator">=</span> Actor<span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">type</span> State <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 Address addr<span class="token punctuation">.</span>Address
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">Constructor</span><span class="token punctuation">(</span>rt runtime<span class="token punctuation">.</span>Runtime<span class="token punctuation">,</span> address <span class="token operator">*</span>addr<span class="token punctuation">.</span>Address<span class="token punctuation">)</span> <span class="token operator">*</span>abi<span class="token punctuation">.</span>EmptyValue <span class="token punctuation">{</span>
 <span class="token comment">// Account actors are created implicitly by sending a message to a pubkey-style address.</span>
 <span class="token comment">// This constructor is not invoked by the InitActor, but by the system.</span>
 rt<span class="token punctuation">.</span><span class="token function">ValidateImmediateCallerIs</span><span class="token punctuation">(</span>builtin<span class="token punctuation">.</span>SystemActorAddr<span class="token punctuation">)</span>
 <span class="token keyword">switch</span> address<span class="token punctuation">.</span><span class="token function">Protocol</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">case</span> addr<span class="token punctuation">.</span>SECP256K1<span class="token punctuation">:</span>
 <span class="token keyword">case</span> addr<span class="token punctuation">.</span>BLS<span class="token punctuation">:</span>
  <span class="token keyword">break</span> <span class="token comment">// ok</span>
 <span class="token keyword">default</span><span class="token punctuation">:</span>
  rt<span class="token punctuation">.</span><span class="token function">Abortf</span><span class="token punctuation">(</span>exitcode<span class="token punctuation">.</span>ErrIllegalArgument<span class="token punctuation">,</span> <span class="token string">&quot;address must use BLS or SECP protocol, got %v&quot;</span><span class="token punctuation">,</span> address<span class="token punctuation">.</span><span class="token function">Protocol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
 st <span class="token operator">:=</span> State<span class="token punctuation">{</span>Address<span class="token punctuation">:</span> <span class="token operator">*</span>address<span class="token punctuation">}</span>
 rt<span class="token punctuation">.</span><span class="token function">StateCreate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>st<span class="token punctuation">)</span>
 <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">// Fetches the pubkey-type address from this actor.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">PubkeyAddress</span><span class="token punctuation">(</span>rt runtime<span class="token punctuation">.</span>Runtime<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">*</span>abi<span class="token punctuation">.</span>EmptyValue<span class="token punctuation">)</span> <span class="token operator">*</span>addr<span class="token punctuation">.</span>Address <span class="token punctuation">{</span>
 rt<span class="token punctuation">.</span><span class="token function">ValidateImmediateCallerAcceptAny</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token keyword">var</span> st State
 rt<span class="token punctuation">.</span><span class="token function">StateReadonly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>st<span class="token punctuation">)</span>
 <span class="token keyword">return</span> <span class="token operator">&amp;</span>st<span class="token punctuation">.</span>Address
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),dp={id:"_2-3-7vm\u89E3\u91CA\u5668-\u6D88\u606F\u8C03\u7528-\u5916\u90E8vm",tabindex:"-1"},kp=n("a",{class:"header-anchor",href:"#_2-3-7vm\u89E3\u91CA\u5668-\u6D88\u606F\u8C03\u7528-\u5916\u90E8vm","aria-hidden":"true"},"#",-1),vp={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.interpreter",target:"_blank",rel:"noopener noreferrer"},mp=n("p",null,"VM\u89E3\u91CA\u5668\u6839\u636E\u63D0\u793A\u96C6\u5728\u5176\u7236\u72B6\u6001\u4E0A\u7684\u63D0\u793A\u96C6\u534F\u8C03\u6D88\u606F\u7684\u6267\u884C\uFF0C\u4ECE\u800C\u4EA7\u751F\u65B0\u72B6\u6001\u548C\u4E00\u7CFB\u5217\u6D88\u606F\u56DE\u6267\u3002\u6B64\u65B0\u72B6\u6001\u7684CID\u548C\u6536\u636E\u96C6\u5408\u7684CID\u5305\u542B\u5728\u540E\u7EED\u7EAA\u5143\u7684\u5757\u4E2D\uFF0C\u8FD9\u4E9B\u7EAA\u5143\u5FC5\u987B\u540C\u610F\u8FD9\u4E9BCID\u624D\u80FD\u5F62\u6210\u65B0\u7684\u63D0\u793A\u96C6\u3002",-1),bp=n("p",null,"\u6BCF\u4E2A\u72B6\u6001\u66F4\u6539\u90FD\u7531\u6D88\u606F\u7684\u6267\u884C\u6765\u9A71\u52A8\u3002\u63D0\u793A\u96C6\u4E2D\u6240\u6709\u5757\u4E2D\u7684\u6D88\u606F\u5FC5\u987B\u6267\u884C\u624D\u80FD\u4EA7\u751F\u4E0B\u4E00\u4E2A\u72B6\u6001\u3002\u6765\u81EA\u7B2C\u4E00\u4E2A\u5757\u7684\u6240\u6709\u6D88\u606F\u5747\u5728\u6280\u5DE7\u96C6\u4E2D\u7684\u7B2C\u4E8C\u4E2A\u548C\u540E\u7EED\u5757\u7684\u6D88\u606F\u4E4B\u524D\u6267\u884C\u3002\u5BF9\u4E8E\u6BCF\u4E2A\u5757\uFF0C\u9996\u5148\u6267\u884CBLS\u805A\u5408\u7684\u6D88\u606F\uFF0C\u7136\u540E\u6267\u884CSECP\u7B7E\u540D\u7684\u6D88\u606F\u3002",-1),hp={id:"_2-3-7-1\u9690\u5F0F\u6D88\u606F",tabindex:"-1"},fp=n("a",{class:"header-anchor",href:"#_2-3-7-1\u9690\u5F0F\u6D88\u606F","aria-hidden":"true"},"#",-1),_p={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.interpreter.implicit-messages",target:"_blank",rel:"noopener noreferrer"},gp=n("p",null,"\u9664\u4E86\u663E\u5F0F\u5305\u542B\u5728\u6BCF\u4E2A\u5757\u4E2D\u7684\u6D88\u606F\u4E4B\u5916\uFF0C\u9690\u542B\u6D88\u606F\u8FD8\u4F1A\u5728\u6BCF\u4E2A\u65F6\u671F\u5BF9\u72B6\u6001\u8FDB\u884C\u4E00\u4E9B\u66F4\u6539\u3002\u9690\u5F0F\u6D88\u606F\u4E0D\u5728\u8282\u70B9\u4E4B\u95F4\u4F20\u8F93\uFF0C\u800C\u662F\u7531\u89E3\u91CA\u5668\u5728\u8BC4\u4F30\u65F6\u6784\u9020\u7684\u3002",-1),yp=n("p",null,"\u5BF9\u4E8E\u63D0\u793A\u96C6\u4E2D\u7684\u6BCF\u4E2A\u5757\uFF0C\u9690\u5F0F\u6D88\u606F\uFF1A",-1),wp=n("ul",null,[n("li",null,"\u8C03\u7528\u533A\u5757\u751F\u4EA7\u8005\u7684\u77FF\u5DE5\u6F14\u5458\u6765\u5904\u7406\uFF08\u5DF2\u9A8C\u8BC1\u7684\uFF09\u9009\u4E3EPoSt\u63D0\u4EA4\uFF0C\u4F5C\u4E3A\u533A\u5757\u4E2D\u7684\u7B2C\u4E00\u6761\u6D88\u606F\uFF1B"),n("li",null,"\u8C03\u7528\u5956\u52B1\u53C2\u4E0E\u8005\u5C06\u533A\u5757\u5956\u52B1\u652F\u4ED8\u7ED9\u77FF\u5DE5\u7684\u6240\u6709\u8005\u5E10\u6237\uFF0C\u4F5C\u4E3A\u533A\u5757\u4E2D\u7684\u6700\u7EC8\u6D88\u606F\uFF1B")],-1),xp=n("p",null,"\u5BF9\u4E8E\u6BCF\u4E2A\u63D0\u793A\u96C6\uFF0C\u4E00\u4E2A\u9690\u5F0F\u6D88\u606F\uFF1A",-1),Cp=n("ul",null,[n("li",null,"\u8C03\u7528cron actor\u6765\u5904\u7406\u81EA\u52A8\u652F\u7968\u548C\u4ED8\u6B3E\uFF0C\u4F5C\u4E3A\u63D0\u793A\u96C6\u4E2D\u7684\u6700\u540E\u4E00\u6761\u6D88\u606F\u3002")],-1),Sp=n("p",null,[s("\u6240\u6709\u9690\u5F0F\u6D88\u606F\u7684\u6784\u9020"),n("code",null,"From"),s("\u5730\u5740\u90FD\u662F\u6770\u51FA\u7684\u7CFB\u7EDF\u5E10\u6237\u53C2\u4E0E\u8005\u3002\u4ED6\u4EEC\u5C06\u6C7D\u6CB9\u4EF7\u683C\u6307\u5B9A\u4E3A\u96F6\uFF0C\u4F46\u5FC5\u987B\u5305\u542B\u5728\u8BA1\u7B97\u4E2D\u3002\u4E3A\u4E86\u8BA1\u7B97\u65B0\u72B6\u6001\uFF0C\u5B83\u4EEC\u5FC5\u987B\u6210\u529F\uFF08\u9000\u51FA\u4EE3\u7801\u4E3A\u96F6\uFF09\u3002\u9690\u5F0F\u90AE\u4EF6\u7684\u6536\u636E\u4E0D\u5305\u62EC\u5728\u6536\u636E\u5217\u8868\u4E2D\uFF1B\u53EA\u6709\u660E\u786E\u7684\u6D88\u606F\u624D\u6709\u660E\u786E\u7684\u56DE\u6267\u3002")],-1),Fp={id:"_2-3-7-2\u7164\u6C14\u8D39",tabindex:"-1"},qp=n("a",{class:"header-anchor",href:"#_2-3-7-2\u7164\u6C14\u8D39","aria-hidden":"true"},"#",-1),Pp={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.interpreter.gas-payments",target:"_blank",rel:"noopener noreferrer"},Ap=n("p",null,"\u5728\u5927\u591A\u6570\u60C5\u51B5\u4E0B\uFF0C\u6D88\u606F\u7684\u53D1\u9001\u8005\u5411\u4EA7\u751F\u5305\u542B\u8BE5\u6D88\u606F\u7684\u5757\u7684\u77FF\u5DE5\u652F\u4ED8\u6267\u884C\u8BE5\u6D88\u606F\u6240\u9700\u7684\u6C7D\u6CB9\u8D39\u3002",-1),Bp=n("p",null,"\u6267\u884C\u8BE5\u6D88\u606F\u540E\uFF0C\u6BCF\u6B21\u6267\u884C\u8BE5\u6D88\u606F\u6240\u4EA7\u751F\u7684\u6C7D\u6CB9\u8D39\u5C06\u7ACB\u5373\u652F\u4ED8\u7ED9\u77FF\u5DE5\u6240\u6709\u8005\u5E10\u6237\u3002\u6240\u83B7\u5F97\u7684\u96C6\u4F53\u5956\u52B1\u6216\u6C7D\u6CB9\u8D39\u6CA1\u6709\u4EFB\u4F55\u8D1F\u62C5\uFF1A\u4E24\u8005\u90FD\u53EF\u4EE5\u7ACB\u5373\u82B1\u8D39\u3002",-1),Ep={id:"_2-3-7-3\u90AE\u4EF6\u91CD\u590D",tabindex:"-1"},Tp=n("a",{class:"header-anchor",href:"#_2-3-7-3\u90AE\u4EF6\u91CD\u590D","aria-hidden":"true"},"#",-1),Ip={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.interpreter.duplicate-messages",target:"_blank",rel:"noopener noreferrer"},Rp=t("<p>\u7531\u4E8E\u4E0D\u540C\u7684\u77FF\u5DE5\u5728\u540C\u4E00\u65F6\u671F\u4EA7\u751F\u533A\u5757\uFF0C\u56E0\u6B64\u5355\u4E2A\u63D0\u793A\u96C6\u4E2D\u7684\u591A\u4E2A\u533A\u5757\u53EF\u80FD\u5305\u542B\u76F8\u540C\u7684\u6D88\u606F\uFF08\u7531\u76F8\u540C\u7684CID\u6807\u8BC6\uFF09\u3002\u53D1\u751F\u8FD9\u79CD\u60C5\u51B5\u65F6\uFF0C\u4EC5\u5728\u7B2C\u4E00\u6B21\u6309\u63D0\u793A\u96C6\u7684\u89C4\u8303\u987A\u5E8F\u9047\u5230\u8BE5\u6D88\u606F\u65F6\u624D\u5BF9\u5176\u8FDB\u884C\u5904\u7406\u3002\u6D88\u606F\u7684\u540E\u7EED\u5B9E\u4F8B\u5C06\u88AB\u5FFD\u7565\uFF0C\u4E0D\u4F1A\u5BFC\u81F4\u4EFB\u4F55\u72B6\u6001\u7A81\u53D8\uFF0C\u4EA7\u751F\u6536\u636E\u6216\u5411\u533A\u5757\u751F\u4EA7\u8005\u652F\u4ED8\u8D39\u7528\u3002</p><p>\u56E0\u6B64\uFF0C\u603B\u7ED3\u4E86\u63D0\u793A\u96C6\u7684\u6267\u884C\u987A\u5E8F\uFF1A</p><ul><li>\u4E3A\u7B2C\u4E00\u5757\u652F\u4ED8\u5956\u52B1</li><li>\u5904\u7406\u7B2C\u4E00\u5757\u7684\u9009\u4E3E\u804C\u4F4D</li><li>\u7B2C\u4E00\u4E2A\u5757\u7684\u6D88\u606F\uFF08SECP\u4E4B\u524D\u7684BLS\uFF09</li><li>\u652F\u4ED8\u7B2C\u4E8C\u5757\u5956\u52B1</li><li>\u5904\u7406\u7B2C\u4E8C\u4E2A\u533A\u5757\u7684\u9009\u4E3E\u804C\u4F4D</li><li>\u7B2C\u4E8C\u4E2A\u5757\u7684\u6D88\u606F\uFF08SECP\u4E4B\u524D\u7684BLS\uFF0C\u8DF3\u8FC7\u4EFB\u4F55\u5DF2\u7ECF\u9047\u5230\u7684\u6D88\u606F\uFF09</li><li><code>[... subsequent blocks ...]</code></li><li>\u5B9A\u65F6\u523B\u5EA6</li></ul>",3),Mp={id:"_2-3-7-4\u6D88\u606F\u6709\u6548\u6027\u548C\u5931\u8D25",tabindex:"-1"},Dp=n("a",{class:"header-anchor",href:"#_2-3-7-4\u6D88\u606F\u6709\u6548\u6027\u548C\u5931\u8D25","aria-hidden":"true"},"#",-1),Gp={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.interpreter.message-validity-and-failure",target:"_blank",rel:"noopener noreferrer"},Vp={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.message.message-syntax-validation",target:"_blank",rel:"noopener noreferrer"},Lp=t("<p>\u5982\u679C\u6D88\u606F\u7531\u4E8E\u53EF\u4EE5\u5408\u7406\u5730\u5F52\u56E0\u4E8E\u77FF\u5DE5\u7684\u539F\u56E0\u800C\u5931\u8D25\uFF0C\u5305\u62EC\u5728\u7236\u72B6\u6001\u4E2D\u6C38\u8FDC\u4E0D\u53EF\u80FD\u6210\u529F\u7684\u6D88\u606F\uFF0C\u6216\u8005\u7531\u4E8E\u53D1\u4EF6\u4EBA\u7F3A\u4E4F\u8D44\u91D1\u6765\u652F\u4ED8\u6700\u5927\u6D88\u606F\u6210\u672C\uFF0C\u5219\u77FF\u5DE5\u5C06\u901A\u8FC7\u70E7\u94B1\u6765\u652F\u4ED8\u7F5A\u6B3E\u7164\u6C14\u8D39\uFF08\u800C\u4E0D\u662F\u53D1\u9001\u65B9\u5411\u5927\u5B97\u77FF\u5DE5\u652F\u4ED8\u7684\u8D39\u7528\uFF09\u3002</p><p>\u6D88\u606F\u5931\u8D25\u5BFC\u81F4\u7684\u552F\u4E00\u72B6\u6001\u66F4\u6539\u662F\uFF1A</p><ul><li>\u53D1\u9001\u65B9\u7684\u589E\u91CF<code>CallSeqNum</code>\uFF0C\u5E76\u4ECE\u53D1\u9001\u65B9\u5411\u5305\u542B\u6D88\u606F\u7684\u533A\u5757\u77FF\u4E3B\u652F\u4ED8\u6C7D\u6CB9\u8D39\uFF1B\u8981\u4E48</li><li>\u7F5A\u6B3E\u7B49\u4E8E\u5931\u8D25\u6D88\u606F\u7684\u6C7D\u6CB9\u8D39\uFF0C\u7531\u77FF\u5DE5\u70E7\u6389\uFF08\u53D1\u4EF6\u4EBA\u672A<code>CallSeqNum</code>\u66F4\u6539\uFF09\u3002</li></ul><p>\u5982\u679C\u5904\u4E8E\u7D27\u63A5\u7684\u5148\u524D\u72B6\u6001\uFF0C\u5219\u6D88\u606F\u6267\u884C\u5C06\u5931\u8D25\uFF1A</p><ul><li>\u8BE5<code>From</code>\u6F14\u5458\u4E0D\u5B58\u5728\u4E8E\u8BE5\u5DDE\uFF08\u53D7\u5230\u77FF\u5DE5\u5904\u7F5A\uFF09\uFF0C</li><li>\u8BE5<code>From</code>\u6F14\u5458\u662F\u4E0D\u662F\u5E10\u53F7\u6F14\u5458\uFF08\u7684\u77FF\u5DE5\u5904\u7F5A\uFF09\uFF0C</li><li>\u8BE5<code>CallSeqNum</code>\u6D88\u606F\u4E0D\u5339\u914D<code>CallSeqNum</code>\u7684\u7684<code>From</code>\u6F14\u5458\uFF08\u7684\u77FF\u5DE5\u5904\u7F5A\uFF09\uFF0C</li><li>\u7684<code>From</code>\u6F14\u5458\u4E0D\u5177\u6709\u8DB3\u591F\u7684\u5E73\u8861\uFF0C\u4EE5\u8986\u76D6\u6D88\u606F\u7684\u603B\u548C<code>Value</code>\u52A0\u4E0A\u6700\u5927\u6C14\u4F53\u6210\u672C\uFF0C<code>GasLimit * GasPrice</code>\uFF08\u77FF\u5DE5\u5904\u7F5A\uFF09\uFF0C</li><li>\u8BE5\u53C2\u4E0E\u8005\u4E0D\u5728<code>To</code>\u72B6\u6001\u4E2D\uFF0C\u5E76\u4E14\u8BE5<code>To</code>\u5730\u5740\u4E0D\u662Fpubkey\u6837\u5F0F\u7684\u5730\u5740\uFF0C</li><li>\u8BE5<code>To</code>actor\u5B58\u5728\uFF08\u6216\u4F5C\u4E3A\u5E10\u6237\u9690\u5F0F\u521B\u5EFA\uFF09\uFF0C\u4F46\u662F\u6CA1\u6709\u5BF9\u5E94\u4E8E\u975E\u96F6\u7684\u65B9\u6CD5<code>MethodNum</code>\uFF0C</li><li>\u53CD\u5E8F\u5217\u5316<code>Params</code>\u4E0D\u662F\u957F\u5EA6\u5339\u914D\u6570\u7EC4<code>To</code>actor\u7684<code>MethodNum</code>\u65B9\u6CD5\u7684\u6570\u7EC4\uFF0C</li><li>\u53CD\u5E8F\u5217\u5316<code>Params</code>\u5BF9\u4E8E<code>To</code>actor\u7684<code>MethodNum</code>\u65B9\u6CD5\u6307\u5B9A\u7684\u7C7B\u578B\u65E0\u6548\uFF0C</li><li>\u88AB\u8C03\u7528\u7684\u65B9\u6CD5\u6D88\u8017\u7684\u6C14\u4F53\u591A\u4E8E<code>GasLimit</code>\u5141\u8BB8\u7684\u91CF\uFF0C</li><li>\u8C03\u7528\u7684\u65B9\u6CD5\u4EE5\u975E\u96F6\u4EE3\u7801\uFF08\u901A\u8FC7<code>Runtime.Abort()</code>\uFF09\u9000\u51FA\uFF0C\u6216\u8005</li><li>\u7531\u4E8E\u4E0A\u8FF0\u4EFB\u4F55\u539F\u56E0\uFF0C\u63A5\u6536\u65B9\u53D1\u9001\u7684\u4EFB\u4F55\u5185\u90E8\u6D88\u606F\u90FD\u4F1A\u5931\u8D25\u3002</li></ul><p>\u8BF7\u6CE8\u610F\uFF0C\u5982\u679C<code>To</code>\u53C2\u4E0E\u8005\u4E0D\u5728\u72B6\u6001\u4E2D\u5E76\u4E14\u8BE5\u5730\u5740\u662F\u6709\u6548<code>H(pubkey)</code>\u5730\u5740\uFF0C\u5219\u5B83\u5C06\u88AB\u521B\u5EFA\u4E3A\u5E10\u6237\u53C2\u4E0E\u8005\u3002</p>",6),Np={id:"_2-4\u533A\u5757\u94FE",tabindex:"-1"},jp=n("a",{class:"header-anchor",href:"#_2-4\u533A\u5757\u94FE","aria-hidden":"true"},"#",-1),Hp={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain",target:"_blank",rel:"noopener noreferrer"},Op=n("p",null,"Filecoin\u533A\u5757\u94FE\u662F\u4E00\u79CD\u5206\u5E03\u5F0F\u865A\u62DF\u673A\uFF0C\u53EF\u4EE5\u8FBE\u6210\u5171\u8BC6\uFF0C\u5904\u7406\u6D88\u606F\uFF0C\u8FDB\u884C\u5B58\u50A8\u5E10\u6237\u5E76\u7EF4\u62A4Filecoin\u534F\u8BAE\u4E2D\u7684\u5B89\u5168\u6027\u3002\u5B83\u662F\u94FE\u63A5Filecoin\u7CFB\u7EDF\u4E2D\u5404\u79CD\u53C2\u4E0E\u8005\u7684\u4E3B\u8981\u754C\u9762\u3002",-1),Up=n("p",null,"Filecoin\u533A\u5757\u94FE\u7CFB\u7EDF\u5305\u62EC\uFF1A",-1),zp={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.message_pool",target:"_blank",rel:"noopener noreferrer"},Wp={href:"https://spec.filecoin.io/#section-systems.filecoin_vm",target:"_blank",rel:"noopener noreferrer"},Zp={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.state_tree",target:"_blank",rel:"noopener noreferrer"},Kp={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.chainsync",target:"_blank",rel:"noopener noreferrer"},Qp={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus",target:"_blank",rel:"noopener noreferrer"},Jp={href:"https://spec.filecoin.io/#section-systems.filecoin_mining.storage_mining",target:"_blank",rel:"noopener noreferrer"},Xp=n("p",null,"\u533A\u5757\u94FE\u7CFB\u7EDF\u8FD8\u5305\u62EC\uFF1A",-1),Yp={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.chain_manager",target:"_blank",rel:"noopener noreferrer"},$p={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.block_producer",target:"_blank",rel:"noopener noreferrer"},ni={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus",target:"_blank",rel:"noopener noreferrer"},si=n("em",null,"\u529F\u7387\u8868",-1),ai=n("em",null,"\u8868",-1),ei={href:"https://spec.filecoin.io/#section-systems.filecoin_mining.storage_mining",target:"_blank",rel:"noopener noreferrer"},ti=n("em",null,"\u90E8\u95E8\u627F\u8BFA",-1),oi=n("em",null,"\u65F6\u7A7A\u8BC1\u660E\u4E3A",-1),pi={id:"_2-4-1\u79EF\u6728",tabindex:"-1"},ii=n("a",{class:"header-anchor",href:"#_2-4-1\u79EF\u6728","aria-hidden":"true"},"#",-1),ci={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct",target:"_blank",rel:"noopener noreferrer"},li=n("p",null,"\u533A\u5757\u662FFilecoin\u533A\u5757\u94FE\u7684\u4E3B\u8981\u5355\u5143\uFF0C\u5927\u591A\u6570\u5176\u4ED6\u533A\u5757\u94FE\u4E5F\u662F\u5982\u6B64\u3002\u963B\u6B62\u6D88\u606F\u4E0E\u63D0\u793A\u96C6\u76F4\u63A5\u94FE\u63A5\uFF0C\u63D0\u793A\u96C6\u662F\u963B\u6B62\u6D88\u606F\u7684\u7EC4\uFF0C\u672C\u8282\u7A0D\u540E\u5C06\u5BF9\u6B64\u8FDB\u884C\u8BE6\u7EC6\u4ECB\u7ECD\u3002\u5728\u4E0B\u6587\u4E2D\uFF0C\u6211\u4EEC\u8BA8\u8BBABlock\u6D88\u606F\u7684\u4E3B\u8981\u7ED3\u6784\u4EE5\u53CAFilecoin\u533A\u5757\u94FE\u4E2D\u9A8C\u8BC1Block\u6D88\u606F\u7684\u8FC7\u7A0B\u3002",-1),ui={id:"_2-4-1-1\u5757",tabindex:"-1"},ri=n("a",{class:"header-anchor",href:"#_2-4-1-1\u5757","aria-hidden":"true"},"#",-1),di={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.block",target:"_blank",rel:"noopener noreferrer"},ki=n("p",null,"\u533A\u5757\u662FFilecoin\u533A\u5757\u94FE\u7684\u4E3B\u8981\u5355\u5143\u3002",-1),vi=n("p",null,[s("Filecoin\u533A\u5757\u94FE\u4E2D\u7684Block\u7ED3\u6784\u5305\u62EC\uFF1Ai\uFF09Block Header\uFF0Cii\uFF09Block\u5185\u7684\u6D88\u606F\u5217\u8868\uFF0C\u4EE5\u53CAiii\uFF09Signed\u6D88\u606F\u3002\u8FD9\u5728"),n("code",null,"FullBlock"),s("\u62BD\u8C61\u5185\u90E8\u8868\u793A\u3002\u8BE5\u6D88\u606F\u6307\u793A\u8981\u5E94\u7528\u7684\u5FC5\u9700\u7684\u4E00\u7EC4\u66F4\u6539\uFF0C\u4EE5\u8FBE\u5230\u94FE\u7684\u786E\u5B9A\u6027\u72B6\u6001\u3002")],-1),mi=n("p",null,[s("\u8BE5\u5757\u7684Lotus\u5B9E\u73B0\u5177\u6709\u4EE5\u4E0B\u5185\u5BB9"),n("code",null,"struct"),s("\uFF1A")],-1),bi={href:"https://spec.filecoin.io/#example-fullblock",target:"_blank",rel:"noopener noreferrer"},hi=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> FullBlock <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 Header        <span class="token operator">*</span>BlockHeader
 BlsMessages   <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>Message
 SecpkMessages <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>SignedMessage
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>\u6CE8\u610F</strong> \u5757\u5728\u529F\u80FD\u4E0A\u4E0EFilecoin\u534F\u8BAE\u4E2D\u7684\u5757\u5934\u76F8\u540C\u3002\u867D\u7136\u5757\u6807\u9898\u5305\u542B\u6307\u5411\u5B8C\u6574\u7CFB\u7EDF\u72B6\u6001\uFF0C\u6D88\u606F\u548C\u6D88\u606F\u56DE\u6267\u7684Merkle\u94FE\u63A5\uFF0C\u4F46\u53EF\u4EE5\u5C06\u5757\u89C6\u4E3A\u8BE5\u4FE1\u606F\u7684\u5B8C\u6574\u96C6\u5408\uFF08\u4E0D\u4EC5\u662FMerkle\u6839\uFF0C\u8FD8\u5305\u62EC\u72B6\u6001\u6811\u7684\u5B8C\u6574\u6570\u636E\uFF0C\u6D88\u606F\u6811\uFF0C\u6536\u636E\u6811\u7B49\uFF09\u3002\u7531\u4E8E\u5B8C\u6574\u5757\u7684\u5927\u5C0F\u5F88\u5927\uFF0C\u56E0\u6B64Filecoin\u533A\u5757\u94FE\u7531\u5757\u5934\u800C\u4E0D\u662F\u5B8C\u6574\u5757\u7EC4\u6210\u3002\u6211\u4EEC\u7ECF\u5E38\u4F7F\u7528\u8FD9\u4E9B\u672F\u8BED\uFF0C<code>block</code>\u5E76\u4E14<code>block header</code>\u53EF\u4EE5\u4E92\u6362\u4F7F\u7528\u3002</p></blockquote>`,2),fi=n("code",null,"BlockHeader",-1),_i=n("code",null,"FullBlock",-1),gi=n("code",null,"BlockHeader",-1),yi={href:"https://spec.filecoin.io/#section-algorithms.pos.post",target:"_blank",rel:"noopener noreferrer"},wi=n("p",null,[s("\u5757\u6807\u5934\u7684Lotus\u5B9E\u73B0\u5177\u6709\u4EE5\u4E0B"),n("code",null,"struct"),s("\uFF1A")],-1),xi={href:"https://spec.filecoin.io/#example-blockheader",target:"_blank",rel:"noopener noreferrer"},Ci=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> BlockHeader <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 Miner address<span class="token punctuation">.</span>Address <span class="token comment">// 0</span>

 Ticket <span class="token operator">*</span>Ticket <span class="token comment">// 1</span>

 ElectionProof <span class="token operator">*</span>ElectionProof <span class="token comment">// 2</span>

 BeaconEntries <span class="token punctuation">[</span><span class="token punctuation">]</span>BeaconEntry <span class="token comment">// 3</span>

 WinPoStProof <span class="token punctuation">[</span><span class="token punctuation">]</span>proof2<span class="token punctuation">.</span>PoStProof <span class="token comment">// 4</span>

 Parents <span class="token punctuation">[</span><span class="token punctuation">]</span>cid<span class="token punctuation">.</span>Cid <span class="token comment">// 5</span>

 ParentWeight BigInt <span class="token comment">// 6</span>

 Height abi<span class="token punctuation">.</span>ChainEpoch <span class="token comment">// 7</span>

 ParentStateRoot cid<span class="token punctuation">.</span>Cid <span class="token comment">// 8</span>

 ParentMessageReceipts cid<span class="token punctuation">.</span>Cid <span class="token comment">// 8</span>

 Messages cid<span class="token punctuation">.</span>Cid <span class="token comment">// 10</span>

 BLSAggregate <span class="token operator">*</span>crypto<span class="token punctuation">.</span>Signature <span class="token comment">// 11</span>

 Timestamp <span class="token builtin">uint64</span> <span class="token comment">// 12</span>

 BlockSig <span class="token operator">*</span>crypto<span class="token punctuation">.</span>Signature <span class="token comment">// 13</span>

 ForkSignaling <span class="token builtin">uint64</span> <span class="token comment">// 14</span>

 <span class="token comment">// ParentBaseFee is the base fee after executing parent tipset</span>
 ParentBaseFee abi<span class="token punctuation">.</span>TokenAmount <span class="token comment">// 15</span>

 <span class="token comment">// internal</span>
 validated <span class="token builtin">bool</span> <span class="token comment">// true if the signature has been validated</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Si={href:"https://spec.filecoin.io/#example-ticket",target:"_blank",rel:"noopener noreferrer"},Fi=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Ticket <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 VRFProof <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),qi={href:"https://spec.filecoin.io/#example-electionproof",target:"_blank",rel:"noopener noreferrer"},Pi=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> ElectionProof <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 WinCount <span class="token builtin">int64</span>
 VRFProof <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Ai={href:"https://spec.filecoin.io/#example-beaconentry",target:"_blank",rel:"noopener noreferrer"},Bi=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> BeaconEntry <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 Round <span class="token builtin">uint64</span>
 Data  <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Ei=n("code",null,"BlockHeader",-1),Ti={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.chainsync",target:"_blank",rel:"noopener noreferrer"},Ii=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">IsTicketWinner</span><span class="token punctuation">(</span>vrfTicket <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> mypow BigInt<span class="token punctuation">,</span> totpow BigInt<span class="token punctuation">)</span> <span class="token builtin">bool</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8BE5<code>Message</code>\u7ED3\u6784\u5FC5\u987B\u5305\u62EC\u6E90\uFF08<code>From</code>\uFF09\u548C\u76EE\u6807\uFF08<code>To</code>\uFF09\u5730\u5740\uFF0Ca<code>Nonce</code>\u548C<code>GasPrice</code>\u3002</p><p>\u6D88\u606F\u7684Lotus\u5B9E\u73B0\u5177\u6709\u4EE5\u4E0B\u7ED3\u6784\uFF1A</p>`,3),Ri={href:"https://spec.filecoin.io/#example-message",target:"_blank",rel:"noopener noreferrer"},Mi=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Message <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 Version <span class="token builtin">uint64</span>

 To   address<span class="token punctuation">.</span>Address
 From address<span class="token punctuation">.</span>Address

 Nonce <span class="token builtin">uint64</span>

 Value abi<span class="token punctuation">.</span>TokenAmount

 GasLimit   <span class="token builtin">int64</span>
 GasFeeCap  abi<span class="token punctuation">.</span>TokenAmount
 GasPremium abi<span class="token punctuation">.</span>TokenAmount

 Method abi<span class="token punctuation">.</span>MethodNum
 Params <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Di={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.chainsync",target:"_blank",rel:"noopener noreferrer"},Gi={href:"https://spec.filecoin.io/#example-validforblockinclusion",target:"_blank",rel:"noopener noreferrer"},Vi=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Message<span class="token punctuation">)</span> <span class="token function">ValidForBlockInclusion</span><span class="token punctuation">(</span>minGas <span class="token builtin">int64</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
 <span class="token keyword">if</span> m<span class="token punctuation">.</span>Version <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;Version&#39; unsupported&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>To <span class="token operator">==</span> address<span class="token punctuation">.</span>Undef <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;To&#39; address cannot be empty&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>From <span class="token operator">==</span> address<span class="token punctuation">.</span>Undef <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;From&#39; address cannot be empty&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>Value<span class="token punctuation">.</span>Int <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;Value&#39; cannot be nil&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>Value<span class="token punctuation">.</span><span class="token function">LessThan</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span><span class="token function">Zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;Value&#39; field cannot be negative&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>Value<span class="token punctuation">.</span><span class="token function">GreaterThan</span><span class="token punctuation">(</span>TotalFilecoinInt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;Value&#39; field cannot be greater than total filecoin supply&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>GasFeeCap<span class="token punctuation">.</span>Int <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;GasFeeCap&#39; cannot be nil&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>GasFeeCap<span class="token punctuation">.</span><span class="token function">LessThan</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span><span class="token function">Zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;GasFeeCap&#39; field cannot be negative&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>GasPremium<span class="token punctuation">.</span>Int <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;GasPremium&#39; cannot be nil&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>GasPremium<span class="token punctuation">.</span><span class="token function">LessThan</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span><span class="token function">Zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;GasPremium&#39; field cannot be negative&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>GasPremium<span class="token punctuation">.</span><span class="token function">GreaterThan</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>GasFeeCap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;GasFeeCap&#39; less than &#39;GasPremium&#39;&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> m<span class="token punctuation">.</span>GasLimit <span class="token operator">&gt;</span> build<span class="token punctuation">.</span>BlockGasLimit <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;GasLimit&#39; field cannot be greater than a block&#39;s gas limit&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token comment">// since prices might vary with time, this is technically semantic validation</span>
 <span class="token keyword">if</span> m<span class="token punctuation">.</span>GasLimit <span class="token operator">&lt;</span> minGas <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;GasLimit&#39; field cannot be less than the cost of storing a message on chain %d &lt; %d&quot;</span><span class="token punctuation">,</span> m<span class="token punctuation">.</span>GasLimit<span class="token punctuation">,</span> minGas<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Li={id:"_2-4-1-1-1\u5757\u8BED\u6CD5\u9A8C\u8BC1",tabindex:"-1"},Ni=n("a",{class:"header-anchor",href:"#_2-4-1-1-1\u5757\u8BED\u6CD5\u9A8C\u8BC1","aria-hidden":"true"},"#",-1),ji={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.block.block-syntax-validation",target:"_blank",rel:"noopener noreferrer"},Hi=t(`<p>\u8BED\u6CD5\u9A8C\u8BC1\u662F\u6307\u5E94\u5728<em>\u4E0D</em>\u53C2\u8003\u5916\u90E8\u4FE1\u606F\uFF08\u4F8B\u5982\u7236\u72B6\u6001\u6811\uFF09\u7684<em>\u60C5\u51B5\u4E0B</em>\u5BF9\u5757\u53CA\u5176\u6D88\u606F\u6267\u884C\u7684\u9A8C\u8BC1\u3002\u8FD9\u79CD\u9A8C\u8BC1\u7C7B\u578B\u6709\u65F6\u79F0\u4E3A<em>\u9759\u6001\u9A8C\u8BC1</em>\u3002</p><p>\u65E0\u6548\u7684\u5757\u4E0D\u5F97\u4F5C\u4E3A\u7236\u5BF9\u8C61\u4F20\u8F93\u6216\u5F15\u7528\u3002</p><p>\u8BED\u6CD5\u4E0A\u6709\u6548\u7684\u5757\u5934\u5FC5\u987B\u89E3\u7801\u4E3A\u4E0E\u4EE5\u4E0B\u5B9A\u4E49\u5339\u914D\u7684\u5B57\u6BB5\uFF0C\u5FC5\u987B\u662F\u6709\u6548\u7684CBOR PubSub<code>BlockMsg</code>\u6D88\u606F\uFF0C\u5E76\u4E14\u5FC5\u987B\u5177\u6709\uFF1A</p><ul><li><p>\u57281\u548C<code>5*ec.ExpectedLeaders</code> <code>Parents</code>CID\u4E4B\u95F4\uFF0C\u5982\u679C<code>Epoch</code>\u5927\u4E8E\u96F6\uFF08\u5426\u5219\u4E3A\u7A7A<code>Parents</code>\uFF09\uFF0C</p></li><li><p>\u4E00\u4E2A\u975E\u8D1F<code>ParentWeight</code>\uFF0C</p></li><li><p>\u5C11\u4E8E\u6216\u7B49\u4E8E<code>BlockMessageLimit</code>\u6D88\u606F\u6570\uFF0C</p></li><li><p>\u5C01\u88C5\u5728<code>MsgMeta</code>\u7ED3\u6784\u4E2D\u7684\u805A\u5408\u6D88\u606FCID\uFF0C\u5E8F\u5217\u5316\u4E3A<code>Messages</code>\u5757\u5934\u4E2D\u7684CID\uFF0C</p></li><li><p>\u4E00\u4E2A<code>Miner</code>\u662FID\u5730\u5740\u7684\u5730\u5740\u3002<code>Address</code>\u5757\u5934\u4E2D\u7684Miner\u5E94\u8BE5\u5B58\u5728\uFF0C\u5E76\u4E0E\u5F53\u524D\u94FE\u72B6\u6001\u4E0B\u7684\u516C\u5171\u5BC6\u94A5\u5730\u5740\u76F8\u5BF9\u5E94\u3002</p></li><li><p><code>BlockSig</code>\u5C5E\u4E8E\u77FF\u5DE5\u68C0\u7D22\u5230\u7684\u516C\u94A5\u5730\u5740\u7684\u5757\u7B7E\u540D\uFF08\uFF09</p></li><li><p>\u4E00\u4E2A\u975E\u8D1F<code>Epoch</code>\uFF0C</p></li><li><p>\u4E00\u4E2A\u79EF\u6781\u7684<code>Timestamp</code>\uFF0C</p></li><li><p>\u4E00\u4E2A<code>Ticket</code>\u975E\u7A7A<code>VRFResult</code>\uFF0C</p></li><li><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>ElectionPoStOutput
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5305\u542B\uFF1A</p><ul><li>\u4E00\u4E2A<code>Candidates</code>\u4ECB\u4E8E1\u548C<code>EC.ExpectedLeaders</code>\u503C\u4E4B\u95F4\uFF08\u542B\uFF09\u7684\u6570\u7EC4\uFF0C</li><li>\u4E00\u4E2A\u975E\u7A7A<code>PoStRandomness</code>\u5B57\u6BB5\uFF0C</li><li>\u4E00\u4E2A\u975E\u7A7A<code>Proof</code>\u5B57\u6BB5\uFF0C</li></ul></li><li><p>\u4E00\u4E2A\u975E\u7A7A<code>ForkSignal</code>\u5B57\u6BB5\u3002</p></li></ul><p>\u53E5\u6CD5\u6709\u6548\u7684\u5B8C\u6574\u5757\u5FC5\u987B\u5177\u6709\uFF1A</p><ul><li>\u6240\u6709\u5F15\u7528\u7684\u6D88\u606F\u5728\u8BED\u6CD5\u4E0A\u5747\u6709\u6548\uFF0C</li><li>\u6240\u6709\u5F15\u7528\u7684\u7236\u6BCD\u6536\u636E\u5728\u8BED\u6CD5\u4E0A\u5747\u6709\u6548\uFF0C</li><li>\u5757\u5934\u548C\u5305\u542B\u7684\u6D88\u606F\u7684\u5E8F\u5217\u5316\u5927\u5C0F\u4E4B\u548C\u4E0D\u5927\u4E8E<code>block.BlockMaxSize</code>\uFF0C</li><li>\u6240\u6709\u663E\u5F0F\u6D88\u606F\u7684\u6C14\u4F53\u9650\u5236\u603B\u548C\u4E0D\u5927\u4E8E<code>block.BlockGasLimit</code>\u3002</li></ul><p>\u8BF7\u6CE8\u610F\uFF0C\u5757\u7B7E\u540D\u7684\u9A8C\u8BC1\u9700\u8981\u4ECE\u7236\u63D0\u793A\u96C6\u72B6\u6001\u8BBF\u95EE\u77FF\u5DE5\u7684\u5730\u5740\u548C\u516C\u94A5\uFF0C\u56E0\u6B64\u7B7E\u540D\u9A8C\u8BC1\u662F\u8BED\u4E49\u9A8C\u8BC1\u7684\u4E00\u90E8\u5206\u3002\u540C\u6837\uFF0C\u6D88\u606F\u7B7E\u540D\u9A8C\u8BC1\u8981\u6C42\u67E5\u627E\u4E0E<code>From</code>\u5904\u4E8E\u5757\u7684\u7236\u72B6\u6001\u7684\u6BCF\u4E2A\u6D88\u606F\u7684\u5E10\u6237\u6267\u884C\u8005\u76F8\u5173\u8054\u7684\u516C\u94A5\u3002</p>`,7),Oi={id:"_2-4-1-1-2\u963B\u6B62\u8BED\u4E49\u9A8C\u8BC1",tabindex:"-1"},Ui=n("a",{class:"header-anchor",href:"#_2-4-1-1-2\u963B\u6B62\u8BED\u4E49\u9A8C\u8BC1","aria-hidden":"true"},"#",-1),zi={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.block.block-semantic-validation",target:"_blank",rel:"noopener noreferrer"},Wi=n("p",null,"\u8BED\u4E49\u9A8C\u8BC1\u662F\u6307\u9700\u8981\u5F15\u7528\u5757\u5934\u548C\u6D88\u606F\u672C\u8EAB\u4E4B\u5916\u7684\u4FE1\u606F\u7684\u9A8C\u8BC1\u3002\u8BED\u4E49\u9A8C\u8BC1\u4E0E\u6784\u5EFA\u5757\u7684\u7236\u63D0\u793A\u96C6\u548C\u72B6\u6001\u6709\u5173\u3002",-1),Zi=n("p",null,[s("\u4E3A\u4E86\u8FDB\u884C\u8BED\u4E49\u9A8C\u8BC1\uFF0C"),n("code",null,"FullBlock"),s("\u5FC5\u987B\u4ECE\u63A5\u6536\u5230\u7684\u5757\u5934\u4E2D\u63D0\u53D6\u5176Filecoin\u6D88\u606F\u8FDB\u884C\u7EC4\u88C5\u3002\u53EF\u4EE5\u4ECE\u7F51\u7EDC\u4E2D\u68C0\u7D22\u963B\u6B62\u6D88\u606FCID\uFF0C\u5E76\u5C06\u5176\u89E3\u7801\u4E3A\u6709\u6548\u7684CBOR "),n("code",null,"Message"),s("/ "),n("code",null,"SignedMessage"),s("\u3002")],-1),Ki=n("p",null,[s("\u5728Lotus\u5B9E\u73B0\u4E2D\uFF0C\u6A21\u5757\u7684\u8BED\u4E49\u9A8C\u8BC1\u7531"),n("code",null,"Syncer"),s("\u6A21\u5757\u6267\u884C\uFF1A")],-1),Qi={href:"https://spec.filecoin.io/#example-validateblock",target:"_blank",rel:"noopener noreferrer"},Ji=t(`<p>ValidateBlock\u5E94\u8BE5\u4E0Espec.validation.md\u4E2D\u7684\u201C\u8BED\u4E49\u9A8C\u8BC1\u201D\u5339\u914D</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>syncer <span class="token operator">*</span>Syncer<span class="token punctuation">)</span> <span class="token function">ValidateBlock</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> b <span class="token operator">*</span>types<span class="token punctuation">.</span>FullBlock<span class="token punctuation">,</span> useCache <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// b.Cid() could panic for empty blocks that are used in tests.</span>
  <span class="token keyword">if</span> rerr <span class="token operator">:=</span> <span class="token function">recover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> rerr <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   err <span class="token operator">=</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;validate block panic: %w&quot;</span><span class="token punctuation">,</span> rerr<span class="token punctuation">)</span>
   <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

 <span class="token keyword">if</span> useCache <span class="token punctuation">{</span>
  isValidated<span class="token punctuation">,</span> err <span class="token operator">:=</span> syncer<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">IsBlockValidated</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">Cid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;check block validation cache %s: %w&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">Cid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> isValidated <span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token boolean">nil</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>

 validationStart <span class="token operator">:=</span> build<span class="token punctuation">.</span>Clock<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  stats<span class="token punctuation">.</span><span class="token function">Record</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> metrics<span class="token punctuation">.</span>BlockValidationDurationMilliseconds<span class="token punctuation">.</span><span class="token function">M</span><span class="token punctuation">(</span>metrics<span class="token punctuation">.</span><span class="token function">SinceInMilliseconds</span><span class="token punctuation">(</span>validationStart<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  log<span class="token punctuation">.</span><span class="token function">Infow</span><span class="token punctuation">(</span><span class="token string">&quot;block validation&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;took&quot;</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span><span class="token function">Since</span><span class="token punctuation">(</span>validationStart<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;height&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span>Header<span class="token punctuation">.</span>Height<span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span><span class="token function">Since</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Unix</span><span class="token punctuation">(</span><span class="token function">int64</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>Header<span class="token punctuation">.</span>Timestamp<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

 ctx<span class="token punctuation">,</span> span <span class="token operator">:=</span> trace<span class="token punctuation">.</span><span class="token function">StartSpan</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">&quot;validateBlock&quot;</span><span class="token punctuation">)</span>
 <span class="token keyword">defer</span> span<span class="token punctuation">.</span><span class="token function">End</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

 <span class="token keyword">if</span> err <span class="token operator">:=</span> <span class="token function">blockSanityChecks</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>Header<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;incoming header failed basic sanity checks: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 h <span class="token operator">:=</span> b<span class="token punctuation">.</span>Header

 baseTs<span class="token punctuation">,</span> err <span class="token operator">:=</span> syncer<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">LoadTipSet</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token function">NewTipSetKey</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>Parents<span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;load parent tipset failed (%s): %w&quot;</span><span class="token punctuation">,</span> h<span class="token punctuation">.</span>Parents<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 lbts<span class="token punctuation">,</span> lbst<span class="token punctuation">,</span> err <span class="token operator">:=</span> stmgr<span class="token punctuation">.</span><span class="token function">GetLookbackTipSetForRound</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> syncer<span class="token punctuation">.</span>sm<span class="token punctuation">,</span> baseTs<span class="token punctuation">,</span> h<span class="token punctuation">.</span>Height<span class="token punctuation">)</span>
 <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to get lookback tipset for block: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 prevBeacon<span class="token punctuation">,</span> err <span class="token operator">:=</span> syncer<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">GetLatestBeaconEntry</span><span class="token punctuation">(</span>baseTs<span class="token punctuation">)</span>
 <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to get latest beacon entry: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token comment">// fast checks first</span>
 nulls <span class="token operator">:=</span> h<span class="token punctuation">.</span>Height <span class="token operator">-</span> <span class="token punctuation">(</span>baseTs<span class="token punctuation">.</span><span class="token function">Height</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
 <span class="token keyword">if</span> tgtTs <span class="token operator">:=</span> baseTs<span class="token punctuation">.</span><span class="token function">MinTimestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> build<span class="token punctuation">.</span>BlockDelaySecs<span class="token operator">*</span><span class="token function">uint64</span><span class="token punctuation">(</span>nulls<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> h<span class="token punctuation">.</span>Timestamp <span class="token operator">!=</span> tgtTs <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;block has wrong timestamp: %d != %d&quot;</span><span class="token punctuation">,</span> h<span class="token punctuation">.</span>Timestamp<span class="token punctuation">,</span> tgtTs<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 now <span class="token operator">:=</span> <span class="token function">uint64</span><span class="token punctuation">(</span>build<span class="token punctuation">.</span>Clock<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Unix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token keyword">if</span> h<span class="token punctuation">.</span>Timestamp <span class="token operator">&gt;</span> now<span class="token operator">+</span>build<span class="token punctuation">.</span>AllowableClockDriftSecs <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;block was from the future (now=%d, blk=%d): %w&quot;</span><span class="token punctuation">,</span> now<span class="token punctuation">,</span> h<span class="token punctuation">.</span>Timestamp<span class="token punctuation">,</span> ErrTemporal<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">if</span> h<span class="token punctuation">.</span>Timestamp <span class="token operator">&gt;</span> now <span class="token punctuation">{</span>
  log<span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">&quot;Got block from the future, but within threshold&quot;</span><span class="token punctuation">,</span> h<span class="token punctuation">.</span>Timestamp<span class="token punctuation">,</span> build<span class="token punctuation">.</span>Clock<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Unix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 msgsCheck <span class="token operator">:=</span> async<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> err <span class="token operator">:=</span> syncer<span class="token punctuation">.</span><span class="token function">checkBlockMessages</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> b<span class="token punctuation">,</span> baseTs<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;block had invalid messages: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>

 minerCheck <span class="token operator">:=</span> async<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> err <span class="token operator">:=</span> syncer<span class="token punctuation">.</span><span class="token function">minerIsValid</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> h<span class="token punctuation">.</span>Miner<span class="token punctuation">,</span> baseTs<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;minerIsValid failed: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>

 baseFeeCheck <span class="token operator">:=</span> async<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
  baseFee<span class="token punctuation">,</span> err <span class="token operator">:=</span> syncer<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">ComputeBaseFee</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> baseTs<span class="token punctuation">)</span>
  <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;computing base fee: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> types<span class="token punctuation">.</span><span class="token function">BigCmp</span><span class="token punctuation">(</span>baseFee<span class="token punctuation">,</span> b<span class="token punctuation">.</span>Header<span class="token punctuation">.</span>ParentBaseFee<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;base fee doesn&#39;t match: %s (header) != %s (computed)&quot;</span><span class="token punctuation">,</span>
    b<span class="token punctuation">.</span>Header<span class="token punctuation">.</span>ParentBaseFee<span class="token punctuation">,</span> baseFee<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
 pweight<span class="token punctuation">,</span> err <span class="token operator">:=</span> syncer<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">Weight</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> baseTs<span class="token punctuation">)</span>
 <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;getting parent weight: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> types<span class="token punctuation">.</span><span class="token function">BigCmp</span><span class="token punctuation">(</span>pweight<span class="token punctuation">,</span> b<span class="token punctuation">.</span>Header<span class="token punctuation">.</span>ParentWeight<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;parrent weight different: %s (header) != %s (computed)&quot;</span><span class="token punctuation">,</span>
   b<span class="token punctuation">.</span>Header<span class="token punctuation">.</span>ParentWeight<span class="token punctuation">,</span> pweight<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 stateRootCheck <span class="token operator">:=</span> async<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
  stateroot<span class="token punctuation">,</span> precp<span class="token punctuation">,</span> err <span class="token operator">:=</span> syncer<span class="token punctuation">.</span>sm<span class="token punctuation">.</span><span class="token function">TipSetState</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> baseTs<span class="token punctuation">)</span>
  <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;get tipsetstate(%d, %s) failed: %w&quot;</span><span class="token punctuation">,</span> h<span class="token punctuation">.</span>Height<span class="token punctuation">,</span> h<span class="token punctuation">.</span>Parents<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> stateroot <span class="token operator">!=</span> h<span class="token punctuation">.</span>ParentStateRoot <span class="token punctuation">{</span>
   msgs<span class="token punctuation">,</span> err <span class="token operator">:=</span> syncer<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">MessagesForTipset</span><span class="token punctuation">(</span>baseTs<span class="token punctuation">)</span>
   <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;failed to load messages for tipset during tipset state mismatch error: &quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">&quot;Messages for tipset with mismatching state:&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span> m <span class="token operator">:=</span> <span class="token keyword">range</span> msgs <span class="token punctuation">{</span>
     mm <span class="token operator">:=</span> m<span class="token punctuation">.</span><span class="token function">VMMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
     log<span class="token punctuation">.</span><span class="token function">Warnf</span><span class="token punctuation">(</span><span class="token string">&quot;Message[%d]: from=%s to=%s method=%d params=%x&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> mm<span class="token punctuation">.</span>From<span class="token punctuation">,</span> mm<span class="token punctuation">.</span>To<span class="token punctuation">,</span> mm<span class="token punctuation">.</span>Method<span class="token punctuation">,</span> mm<span class="token punctuation">.</span>Params<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;parent state root did not match computed state (%s != %s)&quot;</span><span class="token punctuation">,</span> stateroot<span class="token punctuation">,</span> h<span class="token punctuation">.</span>ParentStateRoot<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> precp <span class="token operator">!=</span> h<span class="token punctuation">.</span>ParentMessageReceipts <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;parent receipts root did not match computed value (%s != %s)&quot;</span><span class="token punctuation">,</span> precp<span class="token punctuation">,</span> h<span class="token punctuation">.</span>ParentMessageReceipts<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token boolean">nil</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>

 <span class="token comment">// Stuff that needs worker address</span>
 waddr<span class="token punctuation">,</span> err <span class="token operator">:=</span> stmgr<span class="token punctuation">.</span><span class="token function">GetMinerWorkerRaw</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> syncer<span class="token punctuation">.</span>sm<span class="token punctuation">,</span> lbst<span class="token punctuation">,</span> h<span class="token punctuation">.</span>Miner<span class="token punctuation">)</span>
 <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;GetMinerWorkerRaw failed: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 winnerCheck <span class="token operator">:=</span> async<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> h<span class="token punctuation">.</span>ElectionProof<span class="token punctuation">.</span>WinCount <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;block is not claiming to be a winner&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  eligible<span class="token punctuation">,</span> err <span class="token operator">:=</span> stmgr<span class="token punctuation">.</span><span class="token function">MinerEligibleToMine</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> syncer<span class="token punctuation">.</span>sm<span class="token punctuation">,</span> h<span class="token punctuation">.</span>Miner<span class="token punctuation">,</span> baseTs<span class="token punctuation">,</span> lbts<span class="token punctuation">)</span>
  <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;determining if miner has min power failed: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token operator">!</span>eligible <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;block&#39;s miner is ineligible to mine&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  rBeacon <span class="token operator">:=</span> <span class="token operator">*</span>prevBeacon
  <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>BeaconEntries<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
   rBeacon <span class="token operator">=</span> h<span class="token punctuation">.</span>BeaconEntries<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>BeaconEntries<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  buf <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>bytes<span class="token punctuation">.</span>Buffer<span class="token punctuation">)</span>
  <span class="token keyword">if</span> err <span class="token operator">:=</span> h<span class="token punctuation">.</span>Miner<span class="token punctuation">.</span><span class="token function">MarshalCBOR</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to marshal miner address to cbor: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  vrfBase<span class="token punctuation">,</span> err <span class="token operator">:=</span> store<span class="token punctuation">.</span><span class="token function">DrawRandomness</span><span class="token punctuation">(</span>rBeacon<span class="token punctuation">.</span>Data<span class="token punctuation">,</span> crypto<span class="token punctuation">.</span>DomainSeparationTag_ElectionProofProduction<span class="token punctuation">,</span> h<span class="token punctuation">.</span>Height<span class="token punctuation">,</span> buf<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;could not draw randomness: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> err <span class="token operator">:=</span> <span class="token function">VerifyElectionPoStVRF</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> waddr<span class="token punctuation">,</span> vrfBase<span class="token punctuation">,</span> h<span class="token punctuation">.</span>ElectionProof<span class="token punctuation">.</span>VRFProof<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;validating block election proof failed: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  slashed<span class="token punctuation">,</span> err <span class="token operator">:=</span> stmgr<span class="token punctuation">.</span><span class="token function">GetMinerSlashed</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> syncer<span class="token punctuation">.</span>sm<span class="token punctuation">,</span> baseTs<span class="token punctuation">,</span> h<span class="token punctuation">.</span>Miner<span class="token punctuation">)</span>
  <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to check if block miner was slashed: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> slashed <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;received block was from slashed or invalid miner&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  mpow<span class="token punctuation">,</span> tpow<span class="token punctuation">,</span> <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> stmgr<span class="token punctuation">.</span><span class="token function">GetPowerRaw</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> syncer<span class="token punctuation">.</span>sm<span class="token punctuation">,</span> lbst<span class="token punctuation">,</span> h<span class="token punctuation">.</span>Miner<span class="token punctuation">)</span>
  <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed getting power: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  j <span class="token operator">:=</span> h<span class="token punctuation">.</span>ElectionProof<span class="token punctuation">.</span><span class="token function">ComputeWinCount</span><span class="token punctuation">(</span>mpow<span class="token punctuation">.</span>QualityAdjPower<span class="token punctuation">,</span> tpow<span class="token punctuation">.</span>QualityAdjPower<span class="token punctuation">)</span>
  <span class="token keyword">if</span> h<span class="token punctuation">.</span>ElectionProof<span class="token punctuation">.</span>WinCount <span class="token operator">!=</span> j <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;miner claims wrong number of wins: miner: %d, computed: %d&quot;</span><span class="token punctuation">,</span> h<span class="token punctuation">.</span>ElectionProof<span class="token punctuation">.</span>WinCount<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token boolean">nil</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>

 blockSigCheck <span class="token operator">:=</span> async<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> err <span class="token operator">:=</span> sigs<span class="token punctuation">.</span><span class="token function">CheckBlockSignature</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> h<span class="token punctuation">,</span> waddr<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;check block signature failed: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>

 beaconValuesCheck <span class="token operator">:=</span> async<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> os<span class="token punctuation">.</span><span class="token function">Getenv</span><span class="token punctuation">(</span><span class="token string">&quot;LOTUS_IGNORE_DRAND&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;_yes_&quot;</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token boolean">nil</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> err <span class="token operator">:=</span> beacon<span class="token punctuation">.</span><span class="token function">ValidateBlockValues</span><span class="token punctuation">(</span>syncer<span class="token punctuation">.</span>beacon<span class="token punctuation">,</span> h<span class="token punctuation">,</span> baseTs<span class="token punctuation">.</span><span class="token function">Height</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">*</span>prevBeacon<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to validate blocks random beacon values: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>

 tktsCheck <span class="token operator">:=</span> async<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
  buf <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>bytes<span class="token punctuation">.</span>Buffer<span class="token punctuation">)</span>
  <span class="token keyword">if</span> err <span class="token operator">:=</span> h<span class="token punctuation">.</span>Miner<span class="token punctuation">.</span><span class="token function">MarshalCBOR</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to marshal miner address to cbor: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> h<span class="token punctuation">.</span>Height <span class="token operator">&gt;</span> build<span class="token punctuation">.</span>UpgradeSmokeHeight <span class="token punctuation">{</span>
   buf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>baseTs<span class="token punctuation">.</span><span class="token function">MinTicket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>VRFProof<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  beaconBase <span class="token operator">:=</span> <span class="token operator">*</span>prevBeacon
  <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>BeaconEntries<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
   beaconBase <span class="token operator">=</span> h<span class="token punctuation">.</span>BeaconEntries<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>BeaconEntries<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>

  vrfBase<span class="token punctuation">,</span> err <span class="token operator">:=</span> store<span class="token punctuation">.</span><span class="token function">DrawRandomness</span><span class="token punctuation">(</span>beaconBase<span class="token punctuation">.</span>Data<span class="token punctuation">,</span> crypto<span class="token punctuation">.</span>DomainSeparationTag_TicketProduction<span class="token punctuation">,</span> h<span class="token punctuation">.</span>Height<span class="token operator">-</span>build<span class="token punctuation">.</span>TicketRandomnessLookback<span class="token punctuation">,</span> buf<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to compute vrf base for ticket: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  err <span class="token operator">=</span> <span class="token function">VerifyElectionPoStVRF</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> waddr<span class="token punctuation">,</span> vrfBase<span class="token punctuation">,</span> h<span class="token punctuation">.</span>Ticket<span class="token punctuation">.</span>VRFProof<span class="token punctuation">)</span>
  <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;validating block tickets failed: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>

 wproofCheck <span class="token operator">:=</span> async<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> err <span class="token operator">:=</span> syncer<span class="token punctuation">.</span><span class="token function">VerifyWinningPoStProof</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> h<span class="token punctuation">,</span> <span class="token operator">*</span>prevBeacon<span class="token punctuation">,</span> lbst<span class="token punctuation">,</span> waddr<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;invalid election post: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>

 await <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>async<span class="token punctuation">.</span>ErrorFuture<span class="token punctuation">{</span>
  minerCheck<span class="token punctuation">,</span>
  tktsCheck<span class="token punctuation">,</span>
  blockSigCheck<span class="token punctuation">,</span>
  beaconValuesCheck<span class="token punctuation">,</span>
  wproofCheck<span class="token punctuation">,</span>
  winnerCheck<span class="token punctuation">,</span>
  msgsCheck<span class="token punctuation">,</span>
  baseFeeCheck<span class="token punctuation">,</span>
  stateRootCheck<span class="token punctuation">,</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">var</span> merr <span class="token builtin">error</span>
 <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> fut <span class="token operator">:=</span> <span class="token keyword">range</span> await <span class="token punctuation">{</span>
  <span class="token keyword">if</span> err <span class="token operator">:=</span> fut<span class="token punctuation">.</span><span class="token function">AwaitContext</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   merr <span class="token operator">=</span> multierror<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>merr<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">if</span> merr <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  mulErr <span class="token operator">:=</span> merr<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>multierror<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
  mulErr<span class="token punctuation">.</span>ErrorFormat <span class="token operator">=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>es <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>es<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;1 error occurred:\\n\\t* %+v\\n\\n&quot;</span><span class="token punctuation">,</span> es<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>

   points <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>es<span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token keyword">for</span> i<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token keyword">range</span> es <span class="token punctuation">{</span>
    points<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;* %+v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span>
    <span class="token string">&quot;%d errors occurred:\\n\\t%s\\n\\n&quot;</span><span class="token punctuation">,</span>
    <span class="token function">len</span><span class="token punctuation">(</span>es<span class="token punctuation">)</span><span class="token punctuation">,</span> strings<span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span>points<span class="token punctuation">,</span> <span class="token string">&quot;\\n\\t&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> mulErr
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> useCache <span class="token punctuation">{</span>
  <span class="token keyword">if</span> err <span class="token operator">:=</span> syncer<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">MarkBlockAsValidated</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">Cid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;caching block validation %s: %w&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">Cid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u90AE\u4EF6\u662F\u901A\u8FC7\u68C0\u7D22\u7684<code>Syncer</code>\u3002\u9075\u5FAA\u4EE5\u4E0B\u4E24\u4E2A\u6B65\u9AA4<code>Syncer</code>\uFF1A1-<code>FullTipSet</code>\u7528\u5148\u524D\u6536\u5230\u7684\u5355\u4E2A\u5757\u7EC4\u88C5\u4E00\u4E2A\u586B\u5145\u5757\u3002\u8BE5\u6570\u636E\u5757<code>ParentWeight</code>\u5927\u4E8E\u6700\u91CD\u7684\u63D0\u793A\u96C6\uFF08\u7B2C\u4E00\u4E2A\u6570\u636E\u5757\uFF09\u4E2D\u7684\u6570\u636E\u5757\u30022-\u4ECE\u6536\u5230\u7684\u5757\u4E2D\u68C0\u7D22\u6240\u6709\u63D0\u793A\u96C6\uFF0C\u76F4\u5230\u6211\u4EEC\u7684\u94FE\u3002\u9A8C\u8BC1\u6269\u5C55\u5230\u8FD9\u4E9B\u63D0\u793A\u96C6\u4E2D\u7684\u6BCF\u4E2A\u5757\u3002\u9A8C\u8BC1\u5E94\u786E\u4FDD\uFF1A-\u4FE1\u6807\u6574\u4F53\u6309\u5176\u8F6E\u6B21\u6392\u5E8F\u3002-\u63D0\u793A\u96C6<code>Parents</code>CID\u4E0E\u901A\u8FC7BlockSync\u83B7\u53D6\u7684\u7236\u63D0\u793A\u96C6\u5339\u914D\u3002</p><p>\u8BED\u4E49\u4E0A\u6709\u6548\u7684\u5757\u5FC5\u987B\u6EE1\u8DB3\u4EE5\u4E0B\u6240\u6709\u8981\u6C42\u3002</p><p><strong><code>Parents</code>-\u6709\u5173</strong></p>`,5),Xi=n("li",null,[n("code",null,"Parents"),s("\u6309\u5176\u6807\u9898\u7684\u5B57\u5178\u987A\u5E8F\u5217\u51FA"),n("code",null,"Ticket"),s("\u3002")],-1),Yi=n("code",null,"ParentStateRoot",-1),$i={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.tipset",target:"_blank",rel:"noopener noreferrer"},nc=n("li",null,[n("code",null,"ParentState"),s(" \u5C06\u901A\u8FC7\u6267\u884C\u7236\u63D0\u793A\u96C6\u7684\u6D88\u606F\uFF08\u7531VM\u89E3\u91CA\u5668\u5B9A\u4E49\uFF09\u4EA7\u751F\u7684\u72B6\u6001\u6811\u4E0E\u8BE5\u63D0\u793A\u96C6\u7684\u7236\u72B6\u6001\u76F8\u5339\u914D\u3002")],-1),sc=n("li",null,[n("code",null,"ParentMessageReceipts"),s("\u6807\u8BC6\u7236\u63D0\u793A\u96C6\u6267\u884C\u4EA7\u751F\u7684\u6536\u636E\u5217\u8868\uFF0C\u5E76\u4E3A\u7236\u63D0\u793A\u96C6\u7684\u6BCF\u6761\u552F\u4E00\u6D88\u606F\u63D0\u4F9B\u4E00\u5F20\u6536\u636E\u3002\u6362\u53E5\u8BDD\u8BF4\uFF0C\u5757\u7684"),n("code",null,"ParentMessageReceipts"),s("CID\u4E0E\u4ECE\u7236\u63D0\u793A\u96C6\u8BA1\u7B97\u7684\u6536\u636ECID\u5339\u914D\u3002")],-1),ac=n("li",null,[n("code",null,"ParentWeight"),s(" \u5339\u914D\u94FE\u7684\u6743\u91CD\uFF0C\u76F4\u5230\u5E76\u5305\u62EC\u7236\u63D0\u793A\u96C6\u3002")],-1),ec=t(`<p><strong>\u4E0E\u65F6\u95F4\u6709\u5173</strong></p><ul><li><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Epoch
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5927\u4E8E\u5176</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Parents
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\uFF0C\u5E76\u4E14</p><ul><li><p>\u5C06\u6765\u4E0D\u4F1A\u6839\u636E\u8282\u70B9\u5F53\u524D\u65F6\u95F4\u7684\u672C\u5730\u65F6\u949F\u8BFB\u6570\uFF0C</p><ul><li>\u5728\u9002\u5F53\u7684\u65F6\u671F\u4E4B\u524D\uFF0C\u4E0D\u5E94\u62D2\u7EDD\u5177\u6709\u672A\u6765\u65F6\u671F\u7684\u6A21\u5757\uFF0C\u4F46\u4E0D\u5E94\u5BF9\u5176\u8FDB\u884C\u8BC4\u4F30\uFF08\u9A8C\u8BC1\u6216\u5305\u542B\u5728\u63D0\u793A\u96C6\u4E2D\uFF09</li></ul></li><li><p>\u4E0D\u8FC7\u53BB\u6BD4\u8F6F\u7EC8\u7ED3\u66F4\u8FDC\u901A\u8FC7SPC\u5B9A\u4E49\u7684</p><p>\u7EC8\u5C40\u6027</p><p>\uFF0C</p><ul><li>\u8BE5\u89C4\u5219\u4EC5\u5728\u63A5\u6536\u5230\u65B0\u7684\u516B\u5366\u5757\uFF08\u5373\u4ECE\u5F53\u524D\u94FE\u5934\uFF09\u63A5\u6536\u65F6\u624D\u9002\u7528\uFF0C\u800C\u4E0D\u662F\u5728\u9996\u6B21\u540C\u6B65\u5230\u94FE\u65F6\u3002</li></ul></li></ul></li><li><p>\u5728</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Timestamp
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5305\u62EC\u4EE5\u79D2\u4E3A\u5355\u4F4D\u7684\u662F\uFF1A</p><ul><li>\u4E0D\u5F97\u5927\u4E8E\u5F53\u524D\u65F6\u95F4\u52A0\u4E0A <code>\u0391llowableClockDriftSecs</code></li><li>\u4E0D\u5F97\u5C0F\u4E8E\u524D\u4E00\u4E2A\u5757\u7684<code>Timestamp</code>\u52A0\u53F7<code>BlockDelay</code>\uFF08\u5305\u62EC\u7A7A\u5757\uFF09</li><li>\u5177\u6709\u521B\u4E16\u5757\u7684\u65F6\u95F4\u6233\uFF0C\u7F51\u7EDC\u7684\u9501\u5B9A\u65F6\u95F4\u548C\u9501\u5B9A\u7684\u6240\u9690\u542B\u7684\u7CBE\u786E\u503C<code>Epoch</code>\u3002</li></ul></li></ul><p><strong><code>Miner</code>-\u6709\u5173</strong></p><ul><li><p>\u7684<code>Miner</code>\u662F\u5728\u7236tipset\u72B6\u6001\u5B58\u50A8\u529F\u7387\u8868\u6D3B\u6027\u3002\u77FF\u5DE5\u7684\u5730\u5740\u5DF2\u6CE8\u518C\u5728<code>Claims</code>Power Actor\u7684HAMT\u4E2D</p></li><li><p>\u5BF9\u4E8E</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>TipSetState
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8981\u9A8C\u8BC1\u7684\u6BCF\u4E2A\u63D0\u793A\u96C6\uFF0C\u90FD\u5E94\u5305\u542B\u3002</p><ul><li>\u63D0\u793A\u96C6\u4E2D\u7684\u6BCF\u4E2A\u533A\u5757\u90FD\u5E94\u5C5E\u4E8E\u4E0D\u540C\u7684\u77FF\u5DE5\u3002</li></ul></li><li><p>\u4E0E\u6D88\u606F\u7684<code>From</code>\u5730\u5740\u5173\u8054\u7684Actor\u5B58\u5728\uFF0C\u662F\u5E10\u6237actor\uFF0C\u5176Nonce\u4E0E\u6D88\u606FNonce\u5339\u914D\u3002</p></li><li><p>\u5305\u62EC\u6709\u6548\u7684\u8BC1\u636E\uFF0C\u8BC1\u660E\u8BE5\u77FF\u5DE5\u8BC1\u660E\u53EF\u4EE5\u8BBF\u95EE\u5176\u9762\u4E34\u6311\u6218\u7684\u90E8\u95E8\u7684\u5BC6\u5C01\u7248\u672C\u3002\u4E3A\u4E86\u5B9E\u73B0\u8FD9\u4E00\u76EE\u6807\uFF1A</p><ul><li>\u4F7F\u7528<code>WinningPoSt</code>\u57DF\u5206\u9694\u6807\u7B7E\u4E3A\u5F53\u524D\u65F6\u671F\u7ED8\u5236\u968F\u673A\u6027\u3002</li><li>\u6839\u636E\u7ED8\u5236\u7684\u968F\u673A\u6027\uFF0C\u83B7\u53D6\u6B64\u77FF\u5DE5\u5728\u6B64\u65F6\u671F\u9762\u4E34\u6311\u6218\u7684\u6247\u533A\u5217\u8868\u3002</li></ul></li><li><p>\u77FF\u5DE5\u4E0D\u88AB\u524A\u51CF<code>StoragePowerActor</code>\u3002</p></li></ul><p><strong><code>Beacon</code>- \uFF06<code>Ticket</code>-\u76F8\u5173</strong></p><ul><li><p>\u6709\u6548\u671F</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>BeaconEntries
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5E94\u5305\u62EC\uFF1A</p><ul><li>\u68C0\u67E5\u4E2D\u7684\u6BCF\u4E00\u4E2A<code>BeaconEntries</code>\u90FD\u662F\u6D88\u606F\u7684\u7B7E\u540D\uFF1A<code>previousSignature || round</code>\u4F7F\u7528DRAND\u7684\u516C\u94A5\u7B7E\u540D\u3002</li><li>\u5305\u62EC\u4ECE<code>MaxBeaconRoundForEpoch</code>\u4F4E\u5230\u9AD8<code>prevEntry</code>\uFF08\u4ECE\u4E0A\u4E00\u4E2A\u6280\u5DE7\u96C6\u5F00\u59CB\uFF09\u4E4B\u95F4\u7684\u6240\u6709\u6761\u76EE\u3002</li></ul></li><li><p>\u4E00\u4E2A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Ticket
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6765\u81EA\u7236tipset\u7684\u5757\u5934\u6700\u5C0F\u7968\u83B7\u5F97\uFF0C</p><ul><li><code>Ticket.VRFResult</code>\u7531<code>Miner</code>\u6F14\u5458\u7684\u5DE5\u4EBA\u5E10\u6237\u516C\u94A5\u6709\u6548\u7B7E\u7F72\uFF0C</li></ul></li><li><p><code>ElectionProof Ticket</code>\u901A\u8FC7\u4F7F\u7528\u77FF\u5DE5\u7684\u5BC6\u94A5\u68C0\u67E5BLS\u7B7E\u540D\u6765\u6B63\u786E\u8BA1\u7B97\u5F97\u51FA\u3002\u8BE5<code>ElectionProof</code>\u7968\u5E94\u8BE5\u662F\u4E2D\u5956\u7968\u3002</p></li></ul><p><strong>\u6D88\u606F\u548C\u7B7E\u540D\u76F8\u5173</strong></p><ul><li><p><code>secp256k1</code>\u90AE\u4EF6\u5DF2\u901A\u8FC7\u5176\u53D1\u9001\u65B9\uFF08<code>From</code>\uFF09\u5DE5\u4F5C\u8005\u5E10\u6237\u5BC6\u94A5\u6B63\u786E\u7B7E\u540D\uFF0C</p></li><li><p><code>BLSAggregate</code>\u5305\u62EC\u4E00\u4E2A\u7B7E\u540D\uFF0C\u8BE5\u7B7E\u540D\u4F7F\u7528\u8BE5\u5757\u7684\u53D1\u9001\u53C2\u4E0E\u8005\u7684\u5BC6\u94A5\u6765\u7B7E\u540D\u8BE5\u5757\u5F15\u7528\u7684\u6240\u6709BLS\u6D88\u606F\u7684CID\u6570\u7EC4\u3002</p></li><li><p><code>Signature</code>\u5305\u542B\u6765\u81EA\u5757\u7684<code>Miner</code>\u53C2\u4E0E\u8005\u7684\u5DE5\u4F5C\u4EBA\u5458\u5E10\u6237\u516C\u5171\u5BC6\u94A5\u7684\u5757\u5934\u7684\u6709\u6548\u5B57\u6BB5\u3002</p></li><li><p>\u5BF9\u4E8E</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>ValidForBlockInclusion()
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4EE5\u4E0B\u4FDD\u6301\u7684\u6BCF\u6761\u6D88\u606F\uFF1A</p><ul><li>\u6D88\u606F\u5B57\u6BB5<code>Version</code>\uFF0C<code>To</code>\uFF0C<code>From</code>\uFF0C<code>Value</code>\uFF0C<code>GasPrice</code>\uFF0C\u548C<code>GasLimit</code>\u6B63\u786E\u5B9A\u4E49\u3002</li><li>\u6D88\u606F<code>GasLimit</code>\u4F4E\u4E8E\u6D88\u606F\u7684\u6700\u4F4E\u6C14\u4F53\u6210\u672C\uFF08\u6765\u81EA\u94FE\u9AD8\u5EA6\u548C\u6D88\u606F\u957F\u5EA6\uFF09\u3002</li></ul></li><li><p>\u5BF9\u4E8E\u5176\u4E2D\u7684\u6BCF\u4E2A\u6D88\u606F</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>ApplyMessage
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\uFF08\u5373\u5728\u6267\u884C\u6D88\u606F\u4E4B\u524D\uFF09\uFF0C\u4EE5\u4E0B\u4FDD\u6301\uFF1A</p><ul><li><p>\u57FA\u672C\u6C14\u4F53\u548C\u4EF7\u503C\u68C0\u67E5\u5728</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>checkMessage()
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\uFF1A</p><ul><li>\u6D88\u606F<code>GasLimit</code>\u5927\u4E8E\u96F6\u3002</li><li>\u6D88\u606F<code>GasPrice</code>\u548C<code>Value</code>\u5DF2\u8BBE\u7F6E\u3002</li></ul></li><li><p>\u6D88\u606F\u7684\u5B58\u50A8\u6C14\u4F53\u6210\u672C\u4F4E\u4E8E\u6D88\u606F\u7684<code>GasLimit</code>\u3002</p></li><li><p>\u6D88\u606F<code>Nonce</code>\u4E0E\u4ECE\u6D88\u606F<code>From</code>\u5730\u5740\u4E2D\u68C0\u7D22\u5230\u7684Actor\u4E2D\u7684\u968F\u673A\u6570\u5339\u914D\u3002</p></li><li><p>\u6D88\u606F\u7684\u6700\u5927\u7528\u6C14\u6210\u672C\uFF08\u4ECE\u5176<code>GasLimit</code>\uFF0C<code>GasPrice</code>\u548C\u6D3E\u751F<code>Value</code>\uFF09\u4F4E\u4E8E\u4ECE\u6D88\u606F<code>From</code>\u5730\u5740\u68C0\u7D22\u7684Actor\u7684\u4F59\u989D\u3002</p></li><li><p>\u6D88\u606F\u7684\u4F20\u8F93<code>Value</code>\u5904\u4E8E\u4ECE\u6D88\u606F<code>From</code>\u5730\u5740\u4E2D\u68C0\u7D22\u5230\u7684Actor\u7684\u4F59\u989D\u4E4B\u4E0B\u3002</p></li></ul></li></ul><p>\u9664\u4E86\u9A8C\u8BC1\u7B7E\u540D\u4E4B\u5916\uFF0C\u6CA1\u6709\u5BF9\u5757\u4E2D\u5305\u542B\u7684\u6D88\u606F\u8FDB\u884C\u8BED\u4E49\u9A8C\u8BC1\u7684\u65B9\u6CD5\u3002\u5982\u679C\u5757\u4E2D\u5305\u542B\u7684\u6240\u6709\u6D88\u606F\u5728\u8BED\u6CD5\u4E0A\u5747\u6709\u6548\uFF0C\u5219\u53EF\u4EE5\u6267\u884C\u5B83\u4EEC\u5E76\u4EA7\u751F\u6536\u636E\u3002</p><p>\u94FE\u540C\u6B65\u7CFB\u7EDF\u53EF\u4EE5\u5206\u9636\u6BB5\u6267\u884C\u8BED\u6CD5\u548C\u8BED\u4E49\u9A8C\u8BC1\uFF0C\u4EE5\u6700\u5927\u7A0B\u5EA6\u5730\u51CF\u5C11\u4E0D\u5FC5\u8981\u7684\u8D44\u6E90\u6D88\u8017\u3002</p><p>\u5982\u679C\u4EE5\u4E0A\u6240\u6709\u6D4B\u8BD5\u5747\u6210\u529F\uFF0C\u5219\u5C06\u8BE5\u5757\u6807\u8BB0\u4E3A\u5DF2\u9A8C\u8BC1\u3002\u6700\u7EC8\uFF0C\u65E0\u6548\u5757\u4E0D\u5F97\u8FDB\u4E00\u6B65\u4F20\u64AD\u6216\u9A8C\u8BC1\u4E3A\u7236\u8282\u70B9\u3002</p>`,11),tc={id:"_2-4-1-2\u5C0F\u8D39",tabindex:"-1"},oc=n("a",{class:"header-anchor",href:"#_2-4-1-2\u5C0F\u8D39","aria-hidden":"true"},"#",-1),pc={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.tipset",target:"_blank",rel:"noopener noreferrer"},ic={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.interpreter",target:"_blank",rel:"noopener noreferrer"},cc=t("<p>\u6BCF\u4E2A\u5757\u90FD\u5F15\u7528\u4E00\u4E2A\u7236\u63D0\u793A\u96C6\uFF0C\u5E76\u9A8C\u8BC1<em>\u8BE5\u63D0\u793A\u96C6\u7684state</em>\uFF0C\u540C\u65F6\u63D0\u51FA\u8981\u5305\u542B\u5728\u5F53\u524D\u65F6\u4EE3\u7684\u6D88\u606F\u3002\u9664\u975E\u5C06\u8BE5\u5757\u5408\u5E76\u5230\u63D0\u793A\u96C6\u4E2D\uFF0C\u5426\u5219\u65E0\u6CD5\u77E5\u9053\u65B0\u5757\u7684\u6D88\u606F\u6240\u5E94\u7528\u7684\u72B6\u6001\u3002\u56E0\u6B64\uFF0C\u5B64\u7ACB\u5730\u4ECE\u5355\u4E2A\u5757\u4E2D\u6267\u884C\u6D88\u606F\u662F\u6CA1\u6709\u610F\u4E49\u7684\uFF1A\u53EA\u6709\u6267\u884C\u4E86\u8BE5\u5757\u7684\u6280\u5DE7\u96C6\u4E2D\u7684\u6240\u6709\u6D88\u606F\u540E\uFF0C\u624D\u77E5\u9053\u65B0\u7684\u72B6\u6001\u6811\u3002</p><p>\u4E00\u4E2A\u6709\u6548\u7684\u63D0\u793A\u96C6\u5305\u542B\u4E00\u4E2A\u975E\u7A7A\u7684\u5757\u96C6\u5408\uFF0C\u8FD9\u4E9B\u5757\u5177\u6709\u4E0D\u540C\u7684\u77FF\u5DE5\uFF0C\u5E76\u4E14\u5168\u90E8\u6307\u5B9A\u76F8\u540C\uFF1A</p><ul><li><code>Epoch</code></li><li><code>Parents</code></li><li><code>ParentWeight</code></li><li><code>StateRoot</code></li><li><code>ReceiptsRoot</code></li></ul><p>\u63D0\u793A\u96C6\u4E2D\u7684\u5404\u4E2A\u5757\u6309\u6BCF\u4E2A\u5757\u7968\u8BC1\u4E2D\u5B57\u8282\u7684\u5B57\u5178\u987A\u5E8F\u8FDB\u884C\u89C4\u8303\u6392\u5E8F\uFF0C\u4ECE\u800C\u4E0E\u8BE5\u5757\u672C\u8EAB\u7684CID\u5B57\u8282\u65AD\u5F00\u8054\u7CFB\u3002</p>",4),lc={href:"https://spec.filecoin.io/#section-algorithms.expected_consensus.chain-selection",target:"_blank",rel:"noopener noreferrer"},uc={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.message_pool",target:"_blank",rel:"noopener noreferrer"},rc=n("p",null,"Lotus\u5B9E\u73B0\u4E2D\u7684\u4E3B\u8981Tipset\u7ED3\u6784\u5305\u62EC\u4EE5\u4E0B\u5185\u5BB9\uFF1A",-1),dc={href:"https://spec.filecoin.io/#example-tipset",target:"_blank",rel:"noopener noreferrer"},kc=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> TipSet <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 cids   <span class="token punctuation">[</span><span class="token punctuation">]</span>cid<span class="token punctuation">.</span>Cid
 blks   <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>BlockHeader
 height abi<span class="token punctuation">.</span>ChainEpoch
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Tipset\u7684\u8BED\u4E49\u9A8C\u8BC1\u5305\u62EC\u4EE5\u4E0B\u68C0\u67E5\u3002</p>`,2),vc={href:"https://spec.filecoin.io/#example-newtipset",target:"_blank",rel:"noopener noreferrer"},mc=t(`<p>\u68C0\u67E5\uFF1A</p><ul><li>\u63D0\u793A\u96C6\u7531\u81F3\u5C11\u4E00\u4E2A\u5757\u7EC4\u6210\u3002\uFF08\u7531\u4E8E\u6BCF\u4E2A\u63D0\u793A\u96C6\u7684\u53EF\u53D8\u5757\u6570\u7531\u968F\u673A\u6027\u51B3\u5B9A\uFF0C\u56E0\u6B64\u6211\u4EEC\u4E0D\u65BD\u52A0\u4E0A\u9650\u3002\uFF09</li><li>\u6240\u6709\u5757\u90FD\u5177\u6709\u76F8\u540C\u7684\u9AD8\u5EA6\u3002</li><li>\u6240\u6709\u5757\u90FD\u5177\u6709\u76F8\u540C\u7684\u7236\u4EE3\uFF08\u5B83\u4EEC\u5177\u6709\u76F8\u540C\u7684\u6570\u91CF\u548C\u5339\u914D\u7684CID\uFF09\u3002</li></ul><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">NewTipSet</span><span class="token punctuation">(</span>blks <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>BlockHeader<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>TipSet<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>blks<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;NewTipSet called with zero length array of blocks&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 sort<span class="token punctuation">.</span><span class="token function">Slice</span><span class="token punctuation">(</span>blks<span class="token punctuation">,</span> <span class="token function">tipsetSortFunc</span><span class="token punctuation">(</span>blks<span class="token punctuation">)</span><span class="token punctuation">)</span>

 <span class="token keyword">var</span> ts TipSet
 ts<span class="token punctuation">.</span>cids <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>cid<span class="token punctuation">.</span>Cid<span class="token punctuation">{</span>blks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">Cid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
 ts<span class="token punctuation">.</span>blks <span class="token operator">=</span> blks
 <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> b <span class="token operator">:=</span> <span class="token keyword">range</span> blks<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> b<span class="token punctuation">.</span>Height <span class="token operator">!=</span> blks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Height <span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;cannot create tipset with mismatching heights&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>blks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Parents<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token function">len</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>Parents<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;cannot create tipset with mismatching number of parents&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">for</span> i<span class="token punctuation">,</span> cid <span class="token operator">:=</span> <span class="token keyword">range</span> b<span class="token punctuation">.</span>Parents <span class="token punctuation">{</span>
   <span class="token keyword">if</span> cid <span class="token operator">!=</span> blks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Parents<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;cannot create tipset with mismatching parents&quot;</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  ts<span class="token punctuation">.</span>cids <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>ts<span class="token punctuation">.</span>cids<span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">Cid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

 <span class="token punctuation">}</span>
 ts<span class="token punctuation">.</span>height <span class="token operator">=</span> blks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Height

 <span class="token keyword">return</span> <span class="token operator">&amp;</span>ts<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),bc={id:"_2-4-1-3\u8FDE\u9501\u5E97\u7ECF\u7406",tabindex:"-1"},hc=n("a",{class:"header-anchor",href:"#_2-4-1-3\u8FDE\u9501\u5E97\u7ECF\u7406","aria-hidden":"true"},"#",-1),fc={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.chain_manager",target:"_blank",rel:"noopener noreferrer"},_c=n("p",null,[s("\u6240\u8FF0"),n("em",null,"\u94FE\u7ECF\u7406"),s("\u662F\u5728blockchain\u7CFB\u7EDF\u4E2D\u7684\u4E2D\u5FC3\u7EC4\u4EF6\u3002\u5B83\u8DDF\u8E2A\u5E76\u66F4\u65B0\u7ED9\u5B9A\u8282\u70B9\u63A5\u6536\u5230\u7684\u7ADE\u4E89\u5B50\u94FE\uFF0C\u4EE5\u9009\u62E9\u9002\u5F53\u7684\u533A\u5757\u94FE\u5934\uFF1A\u5B83\u5728\u7CFB\u7EDF\u4E2D\u77E5\u9053\u7684\u6700\u91CD\u5B50\u94FE\u7684\u6700\u65B0\u5757\u3002")],-1),gc=n("p",null,[s("\u8FD9\u6837\u505A\uFF0C"),n("em",null,"\u94FE\u7BA1\u7406\u5668"),s("\u662F\u4E2D\u592E\u5B50\u7CFB\u7EDF\uFF0C\u5B83\u5904\u7406Filecoin\u8282\u70B9\u4E2D\u8BB8\u591A\u5176\u4ED6\u7CFB\u7EDF\u7684\u7C3F\u8BB0\u5DE5\u4F5C\uFF0C\u5E76\u516C\u5F00\u4E86\u4F9B\u90A3\u4E9B\u7CFB\u7EDF\u4F7F\u7528\u7684\u4FBF\u6377\u65B9\u6CD5\uFF0C\u4ECE\u800C\u4F7F\u7CFB\u7EDF\u80FD\u591F\u4ECE\u94FE\u4E2D\u62BD\u6837\u968F\u673A\u6027\uFF0C\u6216\u67E5\u770B\u54EA\u4E2A\u5757\u5DF2\u88AB\u5360\u7528\u3002\u6700\u8FD1\u5B8C\u6210\u3002")],-1),yc={id:"_2-4-1-3-1\u5EF6\u4F38\u94FE",tabindex:"-1"},wc=n("a",{class:"header-anchor",href:"#_2-4-1-3-1\u5EF6\u4F38\u94FE","aria-hidden":"true"},"#",-1),xc={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.chain_manager.chain-extension",target:"_blank",rel:"noopener noreferrer"},Cc={id:"_2-4-1-3-1-1\u63A5\u6536\u5757\u63A5\u6536",tabindex:"-1"},Sc=n("a",{class:"header-anchor",href:"#_2-4-1-3-1-1\u63A5\u6536\u5757\u63A5\u6536","aria-hidden":"true"},"#",-1),Fc={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.chain_manager.incoming-block-reception",target:"_blank",rel:"noopener noreferrer"},qc=n("p",null,"\u5BF9\u4E8E\u6BCF\u4E2A\u4F20\u5165\u7684\u5757\uFF0C\u5373\u4F7F\u672A\u5C06\u4F20\u5165\u7684\u5757\u6DFB\u52A0\u5230\u5F53\u524D\u6700\u91CD\u7684\u63D0\u793A\u96C6\u4E2D\uFF0C\u94FE\u7BA1\u7406\u5668\u4E5F\u5E94\u5C06\u5176\u6DFB\u52A0\u5230\u5B83\u6B63\u5728\u8DDF\u8E2A\u7684\u9002\u5F53\u5B50\u94FE\u4E2D\uFF0C\u6216\u72EC\u7ACB\u5730\u5BF9\u5176\u8FDB\u884C\u8DDF\u8E2A\uFF0C\u76F4\u5230\uFF1A",-1),Pc=n("ul",null,[n("li",null,"\u5B83\u80FD\u591F\u901A\u8FC7\u63A5\u6536\u8BE5\u5B50\u94FE\u4E2D\u7684\u53E6\u4E00\u4E2A\u5757\u6765\u6DFB\u52A0\u5230\u5F53\u524D\u6700\u91CD\u7684\u5B50\u94FE\u4E2D\uFF0C\u6216\u8005"),n("li",null,"\u5B83\u53EF\u4EE5\u4E22\u5F03\u5B83\uFF0C\u56E0\u4E3A\u8BE5\u5757\u662F\u5728\u6700\u7EC8\u786E\u5B9A\u4E4B\u524D\u5F00\u91C7\u7684\u3002")],-1),Ac=n("p",null,"\u91CD\u8981\u7684\u662F\u8981\u6CE8\u610F\uFF0C\u5728\u6700\u7EC8\u786E\u5B9A\u4E4B\u524D\uFF0C\u7ED9\u5B9A\u7684\u5B50\u94FE\u53EF\u80FD\u4F1A\u88AB\u66FF\u6362\u4E3A\u5728\u7ED9\u5B9A\u56DE\u5408\u4E2D\u5F00\u91C7\u7684\u53E6\u4E00\u4E2A\u8F83\u91CD\u7684\u5B50\u94FE\u3002\u4E3A\u4E86\u5FEB\u901F\u9002\u5E94\u8FD9\u79CD\u60C5\u51B5\uFF0C\u94FE\u7BA1\u7406\u8005\u5FC5\u987B\u7EF4\u62A4\u548C\u66F4\u65B0\u6240\u6709\u8003\u8651\u5230\u6700\u7EC8\u7684\u5B50\u94FE\u3002",-1),Bc={href:"https://spec.filecoin.io/#section-algorithms.expected_consensus.chain-selection",target:"_blank",rel:"noopener noreferrer"},Ec=n("p",null,[n("strong",null,"\u6CE8\u91CA/\u5EFA\u8BAE\uFF1A")],-1),Tc=n("ol",null,[n("li",null,"\u4E3A\u4E86\u7B80\u5316\u67D0\u4E9B\u9A8C\u8BC1\u68C0\u67E5\uFF0C\u5E94\u8BE5\u6309\u9AD8\u5EA6\u548C\u7236\u96C6\u5BF9\u5757\u8FDB\u884C\u7D22\u5F15\u3002\u8FD9\u6837\uFF0C\u53EF\u4EE5\u5FEB\u901F\u67E5\u8BE2\u5177\u6709\u7ED9\u5B9A\u9AD8\u5EA6\u548C\u666E\u901A\u7236\u6BCD\u7684\u51E0\u7EC4\u79EF\u6728\u3002"),n("li",null,"\u5728\u8FD9\u4E9B\u96C6\u4E2D\u8BA1\u7B97\u548C\u7F13\u5B58\u5757\u7684\u7ED3\u679C\u805A\u5408\u72B6\u6001\u53EF\u80FD\u4E5F\u5F88\u6709\u7528\uFF0C\u5F53\u68C0\u67E5\u6709\u591A\u4E2A\u7236\u7EA7\u7684\u5757\u4ECE\u54EA\u4E2A\u72B6\u6001\u6839\u5F00\u59CB\u65F6\uFF0C\u8FD9\u6837\u53EF\u4EE5\u8282\u7701\u989D\u5916\u7684\u72B6\u6001\u8BA1\u7B97\u3002"),n("li",null,"\u5EFA\u8BAE\u5C06\u5757\u4FDD\u7559\u5728\u672C\u5730\u6570\u636E\u5B58\u50A8\u4E2D\uFF0C\u65E0\u8BBA\u6B64\u65F6\u662F\u5426\u5C06\u5176\u7406\u89E3\u4E3A\u6700\u4F73\u6280\u5DE7-\u8FD9\u662F\u4E3A\u4E86\u907F\u514D\u5C06\u6765\u4E0D\u5F97\u4E0D\u91CD\u65B0\u63D0\u53D6\u76F8\u540C\u7684\u5757\u3002")],-1),Ic={id:"_2-4-1-3-1-2chaintipsmanager",tabindex:"-1"},Rc=n("a",{class:"header-anchor",href:"#_2-4-1-3-1-2chaintipsmanager","aria-hidden":"true"},"#",-1),Mc={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.chain_manager.chaintipsmanager",target:"_blank",rel:"noopener noreferrer"},Dc=t(`<p>\u94FE\u6280\u5DE7\u7BA1\u7406\u5668\u662FFilecoin\u5171\u8BC6\u7684\u5B50\u7EC4\u4EF6\uFF0C\u8D1F\u8D23\u8DDF\u8E2AFilecoin\u533A\u5757\u94FE\u7684\u6240\u6709\u5B9E\u65F6\u6280\u5DE7\uFF0C\u5E76\u8DDF\u8E2A\u5F53\u524D\u7684\u201C\u6700\u4F73\u201D\u6280\u5DE7\u96C6\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// Returns the ticket that is at round &#39;r&#39; in the chain behind &#39;head&#39;</span>
<span class="token keyword">func</span> <span class="token function">TicketFromRound</span><span class="token punctuation">(</span>head Tipset<span class="token punctuation">,</span> r Round<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// Returns the tipset that contains round r (Note: multiple rounds&#39; worth of tickets may exist within a single block due to losing tickets being added to the eventually successfully generated block)</span>
<span class="token keyword">func</span> <span class="token function">TipsetFromRound</span><span class="token punctuation">(</span>head Tipset<span class="token punctuation">,</span> r Round<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// GetBestTipset returns the best known tipset. If the &#39;best&#39; tipset hasn&#39;t changed, then this</span>
<span class="token comment">// will return the previous best tipset.</span>
<span class="token keyword">func</span> <span class="token function">GetBestTipset</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// Adds the losing ticket to the chaintips manager so that blocks can be mined on top of it</span>
<span class="token keyword">func</span> <span class="token function">AddLosingTicket</span><span class="token punctuation">(</span>parent Tipset<span class="token punctuation">,</span> t Ticket<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),Gc={id:"_2-4-1-4\u5236\u7247\u4EBA",tabindex:"-1"},Vc=n("a",{class:"header-anchor",href:"#_2-4-1-4\u5236\u7247\u4EBA","aria-hidden":"true"},"#",-1),Lc={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.block_producer",target:"_blank",rel:"noopener noreferrer"},Nc={id:"_2-4-1-4-1\u91C7\u77FF\u5757",tabindex:"-1"},jc=n("a",{class:"header-anchor",href:"#_2-4-1-4-1\u91C7\u77FF\u5757","aria-hidden":"true"},"#",-1),Hc={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.block_producer.mining-blocks",target:"_blank",rel:"noopener noreferrer"},Oc={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.minimum-miner-size",target:"_blank",rel:"noopener noreferrer"},Uc=n("p",null,"\u4E3A\u4E86\u505A\u5230\u8FD9\u4E00\u70B9\uFF0C\u77FF\u5DE5\u5FC5\u987B\u8FDB\u884C\u8FDE\u9501\u9A8C\u8BC1\uFF0C\u5E76\u8DDF\u8E2A\u6536\u5230\u7684\u6700\u65B0\u533A\u5757\u3002\u77FF\u5DE5\u7684\u65B0\u533A\u5757\u5C06\u57FA\u4E8E\u524D\u4E00\u4E2A\u65F6\u671F\u7684\u7236\u6BCD\u3002",-1),zc={id:"_2-4-1-4-1-1\u5757\u521B\u5EFA",tabindex:"-1"},Wc=n("a",{class:"header-anchor",href:"#_2-4-1-4-1-1\u5757\u521B\u5EFA","aria-hidden":"true"},"#",-1),Zc={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.block_producer.block-creation",target:"_blank",rel:"noopener noreferrer"},Kc=t("<p>\u4E3A\u4E00\u4E2A\u65F6\u671F\u751F\u6210\u4E00\u4E2A\u5757<code>H</code>\u9700\u8981\u7B49\u5F85\u8BE5\u65F6\u671F\u7684\u4FE1\u6807\u8F93\u5165\u5E76\u4F7F\u7528\u5B83\u6765\u8FD0\u884C<code>GenerateElectionProof</code>\u3002\u5982\u679C<code>WinCount</code>\u22651\uFF08\u5373\uFF0C\u5F53\u77FF\u5DE5\u5F53\u9009\uFF09\uFF0C\u76F8\u540C\u7684\u4FE1\u6807\u6761\u76EE\u7528\u4E8E\u8FD0\u884C<code>WinningPoSt</code>\u3002\u6709\u4E86<code>ElectionProof</code>\u7968\u8BC1\uFF08\u7684\u8F93\u51FA<code>GenerateElectionProof</code>\uFF09\u548C<code>WinningPoSt</code>\u8BC1\u660E\uFF0C\u77FF\u5DE5\u53EF\u4EE5\u751F\u4EA7\u4E00\u4E2A\u65B0\u7684\u533A\u5757\u3002</p>",1),Qc={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.interpreter",target:"_blank",rel:"noopener noreferrer"},Jc={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.block",target:"_blank",rel:"noopener noreferrer"},Xc=n("p",null,"\u8981\u521B\u5EFA\u4E00\u4E2A\u533A\u5757\uFF0C\u5408\u683C\u7684\u77FF\u5DE5\u5FC5\u987B\u8BA1\u7B97\u4E00\u4E9B\u5B57\u6BB5\uFF1A",-1),Yc=n("li",null,[n("p",null,[n("code",null,"Parents"),s(" -\u7236\u63D0\u793A\u96C6\u5757\u7684CID\u3002")])],-1),$c=n("code",null,"ParentWeight",-1),nl={href:"https://spec.filecoin.io/#section-algorithms.expected_consensus.chain-selection",target:"_blank",rel:"noopener noreferrer"},sl=n("code",null,"ParentState",-1),al={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.interpreter",target:"_blank",rel:"noopener noreferrer"},el=t("<li><p><code>ParentMessageReceipts</code>-AMT\u6839\u76EE\u5F55\u7684CID\uFF0C\u5176\u4E2D\u5305\u542B\u8BA1\u7B97\u65F6\u4EA7\u751F\u7684\u6536\u636E<code>ParentState</code>\u3002</p></li><li><p><code>Epoch</code>-\u5757\u7684\u7EAA\u5143\uFF0C\u4ECE\u8BE5<code>Parents</code>\u7EAA\u5143\u548C\u751F\u6210\u8BE5\u5757\u6240\u82B1\u8D39\u7684\u7EAA\u5143\u6570\u5F97\u51FA\u3002</p></li><li><p><code>Timestamp</code> -\u521B\u5EFA\u5757\u65F6\u751F\u6210\u7684Unix\u65F6\u95F4\u6233\uFF08\u4EE5\u79D2\u4E3A\u5355\u4F4D\uFF09\u3002</p></li>",3),tl=n("code",null,"BeaconEntries",-1),ol={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.beacon-entries",target:"_blank",rel:"noopener noreferrer"},pl=n("code",null,"Ticket",-1),il={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.randomness-ticket-generation",target:"_blank",rel:"noopener noreferrer"},cl=t(`<li><p><code>Miner</code> -\u533A\u5757\u751F\u4EA7\u8005\u7684\u77FF\u5DE5\u6F14\u5458\u5730\u5740\u3002</p></li><li><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Messages
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>-</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>TxMeta
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5305\u542B\u5EFA\u8BAE\u5305\u542B\u5728\u65B0\u5757\u4E2D\u7684\u6D88\u606F\u7684\u5BF9\u8C61\u7684CID \uFF1A</p><ul><li>\u4ECE\u5185\u5B58\u6C60\u4E2D\u9009\u62E9\u4E00\u7EC4\u6D88\u606F\u4EE5\u5305\u62EC\u5728\u5757\u4E2D\uFF0C\u4EE5\u6EE1\u8DB3\u5757\u5927\u5C0F\u548C\u6C14\u4F53\u9650\u5236</li><li>\u5C06\u90AE\u4EF6\u5206\u4E3ABLS\u7B7E\u540D\u90AE\u4EF6\u548Csecpk\u7B7E\u540D\u90AE\u4EF6</li><li><code>TxMeta.BLSMessages</code>\uFF1A\u5305\u542B\u88F8\u7B14<code>UnsignedMessage</code>\u7684AMT\u6839\u76EE\u5F55\u7684CID</li><li><code>TxMeta.SECPMessages</code>\uFF1A\u4E00\u4E2AAMT\u7684\u6839\u7684CID\u5305\u62EC<code>SignedMessage</code>\u5C0F\u53F7</li></ul></li><li><p><code>BeaconEntries</code>\uFF1A\u4ECE\u4E2D\u5BFC\u51FA\u968F\u673A\u6027\u7684\u4FE1\u6807\u6761\u76EE\u5217\u8868</p></li><li><p><code>BLSAggregate</code> -\u4F7F\u7528BLS\u7B7E\u540D\u7684\u5757\u4E2D\u6240\u6709\u6D88\u606F\u7684\u805A\u96C6\u7B7E\u540D\u3002</p></li><li><p><code>Signature</code> -\u5728\u533A\u5757\u6807\u9898\u7684\u5E8F\u5217\u5316\u8868\u793A\u5F62\u5F0F\uFF08\u5E26\u6709\u7A7A\u7B7E\u540D\uFF09\u4E0A\u5177\u6709\u77FF\u5DE5\u7684\u5DE5\u4EBA\u5E10\u6237\u79C1\u94A5\u7684\u7B7E\u540D\uFF08\u8FD8\u5FC5\u987B\u4E0E\u7968\u8BC1\u7B7E\u540D\u5339\u914D\uFF09\u3002</p></li><li><p><code>ForkSignaling</code>-uint64\u6807\u5FD7\u7528\u4F5C\u4FE1\u4EE4\u5206\u53C9\u7684\u4E00\u90E8\u5206\u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u5E94\u8BBE\u7F6E\u4E3A0\u3002</p></li>`,6),ll=n("p",null,"\u6CE8\u610F\uFF0C\u8981\u751F\u6210\u6709\u6548\u5757\uFF0C\u65E0\u9700\u8BC4\u4F30\u8981\u5305\u542B\u5728\u5757\u4E2D\u7684\u6D88\u606F\u3002\u77FF\u5DE5\u53EF\u80FD\u4ECD\u5E0C\u671B\u901A\u8FC7\u6295\u673A\u65B9\u5F0F\u8BC4\u4F30\u6D88\u606F\uFF0C\u4EE5\u4FBF\u8FDB\u884C\u4F18\u5316\uFF0C\u4EE5\u5305\u62EC\u5C06\u6210\u529F\u6267\u884C\u5E76\u652F\u4ED8\u6700\u591A\u6C7D\u6CB9\u7684\u6D88\u606F\u3002",-1),ul=n("p",null,"\u4EA7\u751F\u79EF\u6728\u65F6\u4E0D\u8BC4\u4F30\u79EF\u6728\u5956\u52B1\u3002\u5728\u4EE5\u4E0B\u7EAA\u5143\u7684\u63D0\u793A\u96C6\u4E2D\u5305\u542B\u8BE5\u533A\u5757\u65F6\uFF0C\u5C06\u5BF9\u5176\u8FDB\u884C\u652F\u4ED8\u3002",-1),rl=n("p",null,"\u533A\u5757\u7684\u7B7E\u540D\u786E\u4FDD\u4E86\u533A\u5757\u5728\u4F20\u64AD\u540E\u7684\u5B8C\u6574\u6027\uFF0C\u56E0\u4E3A\u4E0E\u8BB8\u591APoW\u533A\u5757\u94FE\u4E0D\u540C\uFF0C\u53D1\u73B0\u4E2D\u5956\u7968\u8BC1\u4E0E\u533A\u5757\u751F\u6210\u65E0\u5173\u3002",-1),dl={id:"_2-4-1-4-1-2\u5757\u5E7F\u64AD",tabindex:"-1"},kl=n("a",{class:"header-anchor",href:"#_2-4-1-4-1-2\u5757\u5E7F\u64AD","aria-hidden":"true"},"#",-1),vl={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.block_producer.block-broadcast",target:"_blank",rel:"noopener noreferrer"},ml={href:"https://spec.filecoin.io/#section-algorithms.gossip_sub",target:"_blank",rel:"noopener noreferrer"},bl=n("code",null,"/fil/blocks",-1),hl=n("p",null,"\u77FF\u5DE5\u5E94\u5728\u4EA7\u751F\u6709\u6548\u5757\u540E\u7ACB\u5373\u8F93\u51FA\u5176\u6709\u6548\u5757\uFF0C\u5426\u5219\u5192\u7740\u5176\u4ED6\u77FF\u5DE5\u5192\u7740\u5728EPOCH_CUTOFF\u4E4B\u540E\u63A5\u6536\u8BE5\u5757\u4E14\u4E0D\u5C06\u5176\u5305\u62EC\u5728\u5F53\u524D\u65F6\u671F\u4E2D\u7684\u98CE\u9669\u3002",-1),fl={id:"_2-4-1-4-2\u5757\u5956\u52B1",tabindex:"-1"},_l=n("a",{class:"header-anchor",href:"#_2-4-1-4-2\u5757\u5956\u52B1","aria-hidden":"true"},"#",-1),gl={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.block_producer.block-rewards",target:"_blank",rel:"noopener noreferrer"},yl={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.sysactors.rewardactor",target:"_blank",rel:"noopener noreferrer"},wl={href:"https://spec.filecoin.io/#section-systems.filecoin_token",target:"_blank",rel:"noopener noreferrer"},xl={href:"https://spec.filecoin.io/#section-systems.filecoin_mining.miner_collaterals",target:"_blank",rel:"noopener noreferrer"},Cl={id:"_2-4-\u4FE1\u606F\u6C60",tabindex:"-1"},Sl=n("a",{class:"header-anchor",href:"#_2-4-\u4FE1\u606F\u6C60","aria-hidden":"true"},"#",-1),Fl={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.message_pool",target:"_blank",rel:"noopener noreferrer"},ql=n("p",null,[s("\u6D88\u606F\u6C60\uFF0C\u6216\u8005"),n("code",null,"mpool"),s("\u6216\u8005"),n("code",null,"mempool"),s("\u662FFilecoin\u534F\u8BAE\u4E2D\u7684\u6D88\u606F\u6C60\u3002\u5B83\u5145\u5F53Filecoin\u8282\u70B9\u4E0E\u7528\u4E8E\u94FE\u4E0B\u6D88\u606F\u4F20\u64AD\u7684\u5176\u4ED6\u8282\u70B9\u7684\u5BF9\u7B49\u7F51\u7EDC\u4E4B\u95F4\u7684\u63A5\u53E3\u3002\u8282\u70B9\u4F7F\u7528\u6D88\u606F\u6C60\u6765\u7EF4\u62A4\u5B83\u4EEC\u8981\u4F20\u8F93\u5230Filecoin VM\u5E76\u6DFB\u52A0\u5230\u94FE\u4E2D\u7684\u4E00\u7EC4\u6D88\u606F\uFF08\u5373\uFF0C\u6DFB\u52A0\u7528\u4E8E\u201C\u94FE\u4E0A\u201D\u6267\u884C\uFF09\u3002")],-1),Pl=n("p",null,"\u4E3A\u4E86\u4F7F\u6D88\u606F\u6700\u7EC8\u51FA\u73B0\u5728\u533A\u5757\u94FE\u4E2D\uFF0C\u5B83\u9996\u5148\u5FC5\u987B\u4F4D\u4E8E\u6D88\u606F\u6C60\u4E2D\u3002\u5B9E\u9645\u4E0A\uFF0C\u81F3\u5C11\u5728Filecoin\u7684Lotus\u5B9E\u73B0\u4E2D\uFF0C\u6CA1\u6709\u4E2D\u592E\u6D88\u606F\u6C60\u5B58\u50A8\u5728\u67D0\u5904\u3002\u800C\u662F\uFF0C\u6D88\u606F\u6C60\u662F\u4E00\u79CD\u62BD\u8C61\uFF0C\u5E76\u5B9E\u73B0\u4E3A\u7F51\u7EDC\u4E2D\u6BCF\u4E2A\u8282\u70B9\u4FDD\u7559\u7684\u6D88\u606F\u5217\u8868\u3002\u56E0\u6B64\uFF0C\u5F53\u8282\u70B9\u5C06\u65B0\u6D88\u606F\u653E\u5165\u6D88\u606F\u6C60\u65F6\uFF0C\u8BE5\u6D88\u606F\u5C06\u4F7F\u7528libp2p\u7684pubsub\u534F\u8BAEGossipSub\u4F20\u64AD\u5230\u7F51\u7EDC\u7684\u5176\u4F59\u90E8\u5206\u3002\u8282\u70B9\u9700\u8981\u8BA2\u9605\u76F8\u5E94\u7684pubsub\u4E3B\u9898\u624D\u80FD\u63A5\u6536\u6D88\u606F\u3002",-1),Al=n("p",null,[s("\u4F7F\u7528GossipSub\u8FDB\u884C\u6D88\u606F\u4F20\u64AD\u4E0D\u4F1A\u7ACB\u5373\u53D1\u751F\uFF0C\u56E0\u6B64\uFF0C\u5728\u4E0D\u540C\u8282\u70B9\u4E0A\u7684\u6D88\u606F\u6C60\u53EF\u4EE5\u540C\u6B65\u4E4B\u524D\u5B58\u5728\u4E00\u4E9B\u6EDE\u540E\u3002\u5B9E\u9645\u4E0A\uFF0C\u5728\u7ED9\u6D88\u606F\u6C60\u6DFB\u52A0\u8FDE\u7EED\u7684\u6D88\u606F\u6D41\u4EE5\u53CA\u4F20\u64AD\u6D88\u606F\u7684\u5EF6\u8FDF\u7684\u60C5\u51B5\u4E0B\uFF0C\u6D88\u606F\u6C60\u6C38\u8FDC\u4E0D\u4F1A\u5728\u7F51\u7EDC\u4E2D\u7684\u6240\u6709\u8282\u70B9\u4E4B\u95F4\u540C\u6B65\u3002\u8FD9\u4E0D\u662F\u7CFB\u7EDF\u7684\u7F3A\u70B9\uFF0C\u5982\u4E0D\u662F\u77ED\u4FE1\u6C60\u4E5F"),n("em",null,"\u9700\u8981"),s("\u901A\u8FC7\u7F51\u7EDC\u8FDB\u884C\u540C\u6B65\u3002")],-1),Bl=n("p",null,"\u6D88\u606F\u6C60\u5E94\u5177\u6709\u5B9A\u4E49\u7684\u6700\u5927\u5927\u5C0F\uFF0C\u4EE5\u907F\u514DDoS\u653B\u51FB\uFF0C\u5728DoS\u653B\u51FB\u4E2D\uFF0C\u8282\u70B9\u88AB\u5783\u573E\u90AE\u4EF6\u541E\u566C\u5E76\u8017\u5C3D\u5185\u5B58\u3002\u6D88\u606F\u6C60\u7684\u5EFA\u8BAE\u5927\u5C0F\u4E3A5000\u6761\u6D88\u606F\u3002",-1),El={id:"_2-4-2-1\u8BAF\u606F\u4F20\u64AD",tabindex:"-1"},Tl=n("a",{class:"header-anchor",href:"#_2-4-2-1\u8BAF\u606F\u4F20\u64AD","aria-hidden":"true"},"#",-1),Il={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.message_pool.message_syncer",target:"_blank",rel:"noopener noreferrer"},Rl={href:"https://github.com/libp2p/specs/tree/master/pubsub/gossipsub",target:"_blank",rel:"noopener noreferrer"},Ml={href:"https://github.com/libp2p/specs/tree/master/pubsub/gossipsub",target:"_blank",rel:"noopener noreferrer"},Dl=n("code",null,"/fil/msgs/",-1),Gl=n("em",null,"\u4E3B\u9898",-1),Vl={href:"https://spec.filecoin.io/#section-systems.filecoin_vm.message",target:"_blank",rel:"noopener noreferrer"},Ll=n("code",null,"/fil/msgs/",-1),Nl=t("<p>\u6709\u4E24\u4E2A\u4E0E\u6D88\u606F\u548C\u5757\u76F8\u5173\u7684\u4E3B\u8981pubsub\u4E3B\u9898\uFF1Ai\uFF09<code>/fil/msgs/</code>\u643A\u5E26\u6D88\u606F\u7684\u4E3B\u9898\uFF0C\u4EE5\u53CAii\uFF09<code>/fil/blocks/</code>\u643A\u5E26\u5757\u7684\u4E3B\u9898\u3002\u8BE5<code>/fil/msgs/</code>\u4E3B\u9898\u94FE\u63A5\u5230<code>mpool</code>\u3002\u6D41\u7A0B\u5982\u4E0B\uFF1A</p><ol><li>\u5F53\u5BA2\u6237\u60F3\u8981\u5728Filecoin\u7F51\u7EDC\u4E2D\u53D1\u9001\u6D88\u606F\u65F6\uFF0C\u4ED6\u4EEC\u4F1A\u5C06\u6D88\u606F\u53D1\u5E03\u5230<code>/fil/msgs/</code>\u4E3B\u9898\u3002</li><li>\u8BE5\u6D88\u606F\u4F7F\u7528GossipSub\u4F20\u64AD\u5230\u7F51\u7EDC\u4E2D\u7684\u6240\u6709\u5176\u4ED6\u8282\u70B9\uFF0C\u5E76\u6700\u7EC8\u51FA\u73B0\u5728<code>mpool</code>\u6240\u6709\u77FF\u5DE5\u4E2D\u3002</li><li>\u6839\u636E\u52A0\u5BC6\u8D27\u5E01\u7ECF\u6D4E\u89C4\u5219\uFF0C\u67D0\u4E9B\u77FF\u5DE5\u6700\u7EC8\u4F1A\u4ECE\u4E2D<code>mpool</code>\uFF08\u4E0E\u5176\u4ED6\u6D88\u606F\u4E00\u8D77\uFF09\u6311\u9009\u6D88\u606F\u5E76\u5C06\u5176\u5305\u542B\u5728\u4E00\u4E2A\u5757\u4E2D\u3002</li><li>\u77FF\u5DE5\u5728<code>/fil/blocks/</code>pubsub\u4E3B\u9898\u4E2D\u53D1\u5E03\u65B0\u6316\u6398\u7684\u5757\uFF0C\u5E76\u4E14\u8BE5\u5757\u4F20\u64AD\u5230\u7F51\u7EDC\u4E2D\u7684\u6240\u6709\u8282\u70B9\uFF08\u5305\u62EC\u53D1\u5E03\u6B64\u5757\u4E2D\u5305\u542B\u7684\u6D88\u606F\u7684\u8282\u70B9\uFF09\u3002</li></ol><p>\u8282\u70B9\u5FC5\u987B\u68C0\u67E5\u4F20\u5165\u6D88\u606F\u662F\u5426\u6709\u6548\uFF0C\u5373\u5B83\u4EEC\u662F\u5426\u5177\u6709\u6709\u6548\u7B7E\u540D\u3002\u5982\u679C\u8BE5\u6D88\u606F\u65E0\u6548\uFF0C\u5219\u5E94\u5C06\u5176\u4E22\u5F03\u5E76\u4E14\u4E0D\u5F97\u8F6C\u53D1\u3002</p>",3),jl=n("em",null,"\u5206\u6570",-1),Hl={href:"https://github.com/libp2p/specs/tree/master/pubsub/gossipsub",target:"_blank",rel:"noopener noreferrer"},Ol=n("p",null,"\u7B14\u8BB0\uFF1A",-1),Ul=n("ul",null,[n("li",null,[s("*\u8D44\u91D1\u68C0\u67E5\uFF1A*\u91CD\u8981\u7684\u662F\u8981\u6CE8\u610F\uFF0C"),n("code",null,"mpool"),s("\u903B\u8F91\u4E0D\u662F\u68C0\u67E5\u90AE\u4EF6\u53D1\u884C\u8005\u5E10\u6237\u4E2D\u662F\u5426\u6709\u8DB3\u591F\u7684\u8D44\u91D1\u3002\u77FF\u5DE5\u5728\u5C06\u6D88\u606F\u5305\u542B\u5728\u5757\u4E2D\u4E4B\u524D\u4F1A\u5BF9\u6B64\u8FDB\u884C\u68C0\u67E5\u3002")]),n("li",null,[s("*\u6D88\u606F\u6392\u5E8F\uFF1A*\u6D88\u606F\u6309\u7167"),n("code",null,"mpool"),s("\u5230\u8FBE\u77FF\u5DE5\u65F6\u9075\u5FAA\u7684\u52A0\u5BC6\u7ECF\u6D4E\u89C4\u5219\uFF0C\u6309\u77FF\u5DE5\u7684\u987A\u5E8F\u8FDB\u884C\u6392\u5E8F\uFF0C\u4EE5\u4FBF\u77FF\u5DE5\u7EC4\u6210\u4E0B\u4E00\u4E2A\u533A\u5757\u3002")])],-1),zl={id:"_2-4-2-2\u8BAF\u606F\u50A8\u5B58",tabindex:"-1"},Wl=n("a",{class:"header-anchor",href:"#_2-4-2-2\u8BAF\u606F\u50A8\u5B58","aria-hidden":"true"},"#",-1),Zl={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.message_pool.message_storage",target:"_blank",rel:"noopener noreferrer"},Kl=n("p",null,"\u5982\u524D\u6240\u8FF0\uFF0C\u6CA1\u6709\u5305\u542B\u6D88\u606F\u7684\u4E2D\u592E\u6C60\u3002\u76F8\u53CD\uFF0C\u6BCF\u4E2A\u8282\u70B9\u5FC5\u987B\u5DF2\u4E3A\u4F20\u5165\u6D88\u606F\u5206\u914D\u4E86\u5185\u5B58\u3002",-1),Ql={id:"_2-4-3\u94FE\u540C\u6B65",tabindex:"-1"},Jl=n("a",{class:"header-anchor",href:"#_2-4-3\u94FE\u540C\u6B65","aria-hidden":"true"},"#",-1),Xl={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.chainsync",target:"_blank",rel:"noopener noreferrer"},Yl=t("<p>\u533A\u5757\u94FE\u540C\u6B65\uFF08\u201C sync\u201D\uFF09\u662F\u533A\u5757\u94FE\u7CFB\u7EDF\u7684\u5173\u952E\u90E8\u5206\u3002\u5B83\u5904\u7406\u5757\u548C\u6D88\u606F\u7684\u68C0\u7D22\u548C\u4F20\u64AD\uFF0C\u56E0\u6B64\u8D1F\u8D23\u5206\u5E03\u5F0F\u72B6\u6001\u590D\u5236\u3002\u56E0\u6B64\uFF0C\u6B64\u8FC7\u7A0B\u5BF9\u5B89\u5168\u6027\u81F3\u5173\u91CD\u8981-\u72B6\u6001\u590D\u5236\u95EE\u9898\u53EF\u80FD\u5BF9\u533A\u5757\u94FE\u7684\u8FD0\u884C\u4EA7\u751F\u4E25\u91CD\u5F71\u54CD\u3002</p><p>\u5F53\u8282\u70B9\u9996\u6B21\u52A0\u5165\u7F51\u7EDC\u65F6\uFF0C\u5B83\u4F1A\u53D1\u73B0\u5BF9\u7B49\u8282\u70B9\uFF08\u901A\u8FC7\u4E0A\u9762\u8BA8\u8BBA\u7684\u5BF9\u7B49\u8282\u70B9\u53D1\u73B0\uFF09\uFF0C\u5E76\u52A0\u5165<code>/fil/blocks</code>\u548C<code>/fil/msgs</code>GossipSub\u4E3B\u9898\u3002\u5B83\u4FA6\u542C\u5176\u4ED6\u8282\u70B9\u6B63\u5728\u4F20\u64AD\u7684\u65B0\u5757\u3002\u5B83\u9009\u62E9\u4E00\u4E2A\u5757\u4F5C\u4E3A\uFF0C<code>BestTargetHead</code>\u5E76\u5F00\u59CB\u540C\u6B65\u4ECE\u5230\u6B64\u9AD8\u5EA6\u7684\u533A\u5757\u94FE<code>TrustedCheckpoint</code>\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u4E3A<code>GenesisBlock</code>or <code>GenesisCheckpoint</code>\u3002\u4E3A\u4E86\u6311\u9009<code>BestTargetHead</code>\u540C\u4F34\uFF0C\u4ED6\u4EEC\u6BD4\u8F83\u8EAB\u9AD8\u548C\u4F53\u91CD\u7684\u7EC4\u5408-\u8FD9\u4E9B\u503C\u8D8A\u9AD8\uFF0C\u533A\u5757\u51FA\u73B0\u5728\u4E3B\u94FE\u4E0A\u7684\u673A\u4F1A\u5C31\u8D8A\u9AD8\u3002\u5982\u679C\u4E24\u4E2A\u5757\u7684\u9AD8\u5EA6\u76F8\u540C\uFF0C\u5219\u5BF9\u7B49\u65B9\u5E94\u9009\u62E9\u6743\u91CD\u8F83\u9AD8\u7684\u4E00\u4E2A\u3002\u4E00\u65E6\u5BF9\u7B49\u65B9\u9009\u62E9\uFF0C<code>BestTargetHead</code>\u5B83\u5C06\u4F7F\u7528BlockSync\u534F\u8BAE\u6765\u83B7\u53D6\u5757\u5E76\u8FBE\u5230\u5F53\u524D\u9AD8\u5EA6\u3002\u4ECE\u90A3\u4E00\u70B9\u5F00\u59CB<code>CHAIN_FOLLOW</code> \u6A21\u5F0F\uFF0C\u5B83\u4F7F\u7528GossipSub\u63A5\u6536\u65B0\u7684\u5757\uFF0C\u6216\u8005\uFF0C\u5982\u679C\u542C\u5230\u6709\u5173\u5B83\u5C1A\u672A\u901A\u8FC7GossipSub\u63A5\u6536\u7684\u5757\u7684\u6D88\u606F\uFF0C\u5219\u4F7F\u7528Bitswap\u3002</p>",2),$l={id:"_2-4-3-chainsync\u6982\u8FF0",tabindex:"-1"},nu=n("a",{class:"header-anchor",href:"#_2-4-3-chainsync\u6982\u8FF0","aria-hidden":"true"},"#",-1),su={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.chainsync.chainsync-overview",target:"_blank",rel:"noopener noreferrer"},au=t("<p><code>ChainSync</code>\u662FFilecoin\u7528\u6765\u540C\u6B65\u5176\u533A\u5757\u94FE\u7684\u534F\u8BAE\u3002\u5B83\u7279\u5B9A\u4E8EFilecoin\u5728\u72B6\u6001\u8868\u793A\u548C\u5171\u8BC6\u89C4\u5219\u4E2D\u7684\u9009\u62E9\uFF0C\u4F46\u662F\u8DB3\u591F\u901A\u7528\uFF0C\u53EF\u4EE5\u670D\u52A1\u4E8E\u5176\u4ED6\u533A\u5757\u94FE\u3002<code>ChainSync</code>\u662F\u4E00\u7EC4\u8F83\u5C0F\u7684\u534F\u8BAE\uFF0C\u5B83\u4EEC\u5904\u7406\u540C\u6B65\u8FC7\u7A0B\u7684\u4E0D\u540C\u90E8\u5206\u3002</p><p>\u5728\u4EE5\u4E0B\u60C5\u51B5\u4E0B\uFF0C\u901A\u5E38\u9700\u8981\u94FE\u540C\u6B65\uFF1A</p><ol><li>\u5F53\u8282\u70B9\u9996\u6B21\u52A0\u5165\u7F51\u7EDC\u5E76\u4E14\u9700\u8981\u5728\u9A8C\u8BC1\u6216\u6269\u5C55\u94FE\u4E4B\u524D\u8FBE\u5230\u5F53\u524D\u72B6\u6001\u65F6\u3002</li><li>\u5F53\u8282\u70B9\u7531\u4E8E\u77ED\u6682\u65AD\u5F00\u800C\u5931\u53BB\u540C\u6B65\u65F6\u3002</li><li>\u5728\u6B63\u5E38\u64CD\u4F5C\u671F\u95F4\uFF0C\u4EE5\u8DDF\u4E0A\u6700\u65B0\u6D88\u606F\u548C\u5757\u3002</li></ol><p>\u5728\u8FD9\u4E09\u79CD\u60C5\u51B5\u4E0B\uFF0C\u4F7F\u7528\u4E09\u79CD\u4E3B\u8981\u534F\u8BAE\u6765\u5B9E\u73B0\u540C\u6B65\u3002</p><ul><li><code>GossipSub</code>\u662F\u7528\u4E8E\u4F20\u64AD\u6D88\u606F\u548C\u5757\u7684libp2p pubsub\u534F\u8BAE\u3002\u5F53\u8282\u70B9\u9700\u8981\u4E0E\u6B63\u5728\u4EA7\u751F\u548C\u4F20\u64AD\u7684\u65B0\u5757\u4FDD\u6301\u540C\u6B65\u65F6\uFF0C\u5B83\u4E3B\u8981\u7528\u4E8E\u4EE5\u4E0A\u7B2C\u4E09\u6B65\u3002</li><li><code>BlockSync</code> \u7528\u4E8E\u540C\u6B65\u94FE\u7684\u7279\u5B9A\u90E8\u5206\uFF0C\u5373\u4ECE\u7279\u5B9A\u9AD8\u5EA6\u5230\u7279\u5B9A\u9AD8\u5EA6\u3002</li><li><code>hello</code>\u534F\u8BAE\uFF0C\u5F53\u4E24\u4E2A\u5BF9\u7B49\u65B9\u9996\u6B21\u201C\u89C1\u9762\u201D\u65F6\uFF08\u5373\uFF0C\u4ED6\u4EEC\u7B2C\u4E00\u6B21\u76F8\u4E92\u8FDE\u63A5\uFF09\u4F7F\u7528\u3002\u6839\u636E\u534F\u8BAE\uFF0C\u4ED6\u4EEC\u4EA4\u6362\u94FE\u5934\u3002</li></ul><p>\u53E6\u5916\uFF0C<code>Bitswap</code>\u5F53\u8282\u70B9\u540C\u6B65\uFF08\u201C\u8FFD\u8D76\u201D\uFF09\u4F46GossipSub\u65E0\u6CD5\u5C06\u67D0\u4E9B\u5757\u4F20\u9012\u5230\u8282\u70B9\u65F6\uFF0C\u7528\u4E8E\u8BF7\u6C42\u548C\u63A5\u6536\u5757\u3002\u6700\u540E\uFF0C<code>GraphSync</code>\u53EF\u4EE5\u7528\u6765\u83B7\u53D6\u533A\u5757\u94FE\u7684\u4E00\u90E8\u5206\u4F5C\u4E3A\u7684\u66F4\u6709\u6548\u7248\u672C<code>Bitswap</code>\u3002</p><p>Filecoin\u8282\u70B9\u662Flibp2p\u8282\u70B9\uFF0C\u56E0\u6B64\u53EF\u4EE5\u8FD0\u884C\u591A\u79CD\u5176\u4ED6\u534F\u8BAE\u3002\u4E0EFilecoin\u4E2D\u7684\u5176\u4ED6\u4EFB\u4F55\u5185\u5BB9\u4E00\u6837\uFF0C\u8282\u70B9\u53EF\u4EE5\u9009\u62E9\u4F7F\u7528\u5176\u4ED6\u534F\u8BAE\u6765\u83B7\u5F97\u7ED3\u679C\u3002\u4E5F\u5C31\u662F\u8BF4\uFF0C\u8282\u70B9\u5FC5\u987B\u5B9E\u73B0<code>ChainSync</code>\u672C\u89C4\u8303\u4E2D\u6240\u8FF0\u7684\u7248\u672C\uFF0C\u624D\u80FD\u88AB\u89C6\u4E3AFilecoin\u7684\u5B9E\u73B0\u3002</p>",7),eu={id:"_2-4-3-2\u672F\u8BED\u548C\u6982\u5FF5",tabindex:"-1"},tu=n("a",{class:"header-anchor",href:"#_2-4-3-2\u672F\u8BED\u548C\u6982\u5FF5","aria-hidden":"true"},"#",-1),ou={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.chainsync.terms-and-concepts",target:"_blank",rel:"noopener noreferrer"},pu=t("<ul><li><code>LastCheckpoint``ChainSync</code>\u610F\u8BC6\u5230\u7684\u6700\u540E\u4E00\u4E2A\u4E25\u683C\u7684\u9762\u5411\u793E\u4F1A\u5171\u8BC6\u7684\u68C0\u67E5\u70B9\u3002\u8FD9\u4E2A\u5171\u8BC6\u68C0\u67E5\u70B9\u5B9A\u4E49\u4E86\u6700\u5C0F\u7684\u7EC8\u7ED3\u6027\u548C\u6700\u5C0F\u7684\u5386\u53F2\u57FA\u7840\u3002 <code>ChainSync</code>\u63A5\u53D7<code>LastCheckpoint</code>\u5E76\u5EFA\u7ACB\u4FE1\u5FF5\uFF0C\u6C38\u4E0D\u80CC\u79BB\u5176\u5386\u53F2\u3002</li><li><code>TargetHeads``BlockCIDs</code>\u4EE3\u8868\u5757\u751F\u4EA7\u8FB9\u7F18\u7684\u5757\u7684\u5217\u8868\u3002\u8FD9\u4E9B\u662F\u6700\u65B0\u548C\u6700\u597D\u7684<code>ChainSync</code>\u77E5\u8BC6\u3002\u5B83\u4EEC\u662F\u201C\u76EE\u6807\u201D\u5934\uFF0C\u56E0\u4E3A <code>ChainSync</code>\u5C06\u5C1D\u8BD5\u4E0E\u5176\u540C\u6B65\u3002\u8BE5\u5217\u8868\u6309\u201C\u6210\u4E3A\u6700\u4F73\u8FDE\u9501\u5E97\u7684\u53EF\u80FD\u6027\u201D\u6392\u5E8F\u3002\u5728\u8FD9\u4E00\u70B9\u4E0A\uFF0C\u53EA\u9700\u901A\u8FC7\u5373\u53EF\u5B9E\u73B0<code>ChainWeight</code>\u3002</li><li><code>BestTargetHead``BlockCID</code>\u5C1D\u8BD5\u4E0E\u4E4B\u540C\u6B65\u7684\u6700\u4F73\u94FE\u5934\u3002\u8FD9\u662F<code>TargetHeads</code></li></ul>",1),iu={id:"_2-4-3-3chainsync\u72B6\u6001\u673A",tabindex:"-1"},cu=n("a",{class:"header-anchor",href:"#_2-4-3-3chainsync\u72B6\u6001\u673A","aria-hidden":"true"},"#",-1),lu={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.chainsync.chainsync-state-machine",target:"_blank",rel:"noopener noreferrer"},uu=t('<p>\u5728\u8F83\u9AD8\u7EA7\u522B\u4E0A\uFF0C\u8BF7<code>ChainSync</code>\u6267\u884C\u4EE5\u4E0B\u64CD\u4F5C\uFF1A</p><ul><li>\u7B2C1\u90E8\u5206\uFF1A\u9A8C\u8BC1\u5185\u90E8\u72B6\u6001\uFF08<code>INIT</code>\u4EE5\u4E0B\u72B6\u6001\uFF09 <ul><li>\u5E94\u8BE5\u9A8C\u8BC1\u6570\u636E\u7ED3\u6784\u5E76\u9A8C\u8BC1\u672C\u5730\u94FE</li><li>\u8D44\u6E90\u6602\u8D35\u7684\u9A8C\u8BC1\u53EF\u80FD\u4F1A\u88AB\u8DF3\u8FC7\uFF0C\u8282\u70B9\u81EA\u884C\u627F\u62C5\u98CE\u9669</li></ul></li><li>\u7B2C2\u90E8\u5206\uFF1A\u5F15\u5BFC\u81F3\u7F51\u7EDC\uFF08<code>BOOTSTRAP</code>\uFF09 <ul><li>\u6B65\u9AA41.\u5F15\u5BFC\u5230\u7F51\u7EDC\uFF0C\u5E76\u83B7\u5F97\u4E00\u7EC4\u201C\u8DB3\u591F\u5B89\u5168\u201D\u7684\u5BF9\u7B49\u4F53\uFF08\u4E0B\u9762\u6709\u66F4\u591A\u8BE6\u7EC6\u4FE1\u606F\uFF09</li><li>\u6B65\u9AA42.\u5F15\u5BFC\u81F3<code>GossipSub</code>\u6E20\u9053</li></ul></li><li>\u7B2C3\u90E8\u5206\uFF1A\u540C\u6B65\u53D7\u4FE1\u4EFB\u7684\u68C0\u67E5\u70B9\u72B6\u6001\uFF08<code>SYNC_CHECKPOINT</code>\uFF09 <ul><li>\u6B65\u9AA41.\u4EE5<code>TrustedCheckpoint</code>\uFF08\u9ED8\u8BA4\u4E3A<code>GenesisCheckpoint</code>\uFF09\u5F00\u5934\u3002\u672C<code>TrustedCheckpoint</code>\u4E0D\u5E94\u8BE5\u5728\u8F6F\u4EF6\u8FDB\u884C\u9A8C\u8BC1\uFF0C\u5B83\u5E94\u8BE5\u7531\u8FD0\u8425\u5546\u8FDB\u884C\u9A8C\u8BC1\u3002</li><li>\u7B2C2\u6B65\u3002\u83B7\u53D6\u5B83\u6240\u6307\u5411\u7684\u5757\uFF0C\u4EE5\u53CA\u8BE5\u5757\u7684\u7236\u6BCD</li><li>\u7B2C3\u6B65\u3002 <code>StateTree</code></li></ul></li><li>\u7B2C4\u90E8\u5206\uFF1A\u8FFD\u4E0A\u94FE\uFF08<code>CHAIN_CATCHUP</code>\uFF09 <ul><li>\u6B65\u9AA41.\u4FDD\u6301\u4E00\u7EC4<code>TargetHeads</code>\uFF08<code>BlockCIDs</code>\uFF09\uFF0C\u5E76\u9009\u62E9<code>BestTargetHead</code>\u4ECE\u5B83</li><li>\u6B65\u9AA42.\u4E0E\u6700\u65B0\u89C2\u5BDF\u5230\u7684\u5934\u90E8\u540C\u6B65\uFF0C\u9A8C\u8BC1\u671D\u5411\u5B83\u4EEC\u7684\u5757\uFF08\u8BF7\u6C42\u4E2D\u95F4\u70B9\uFF09</li><li>\u6B65\u9AA43.\u968F\u7740\u9A8C\u8BC1\u7684\u8FDB\u884C\uFF0C<code>TargetHeads</code>\u5E76\u4E14<code>BestTargetHead</code>\u53EF\u80FD\u4F1A\u6539\u53D8\uFF0C\u56E0\u4E3A\u751F\u4EA7\u8FB9\u7F18\u7684\u65B0\u5757\u5C06\u5230\u8FBE\uFF0C\u5E76\u4E14\u67D0\u4E9B\u76EE\u6807\u5934\u6216\u901A\u5F80\u5B83\u4EEC\u7684\u8DEF\u5F84\u53EF\u80FD\u65E0\u6CD5\u9A8C\u8BC1\u3002</li><li>\u7B2C4\u6B65\u3002\u5F53\u8282\u70B9\u201C\u8D76\u4E0A\u201D\u65F6\u5B8C\u6210<code>BestTargetHead</code>\uFF08\u68C0\u7D22\u6240\u6709\u72B6\u6001\uFF0C\u94FE\u63A5\u5230\u672C\u5730\u94FE\uFF0C\u9A8C\u8BC1\u6240\u6709\u5757\u7B49\uFF09\u3002</li></ul></li><li>\u7B2C5\u90E8\u5206\uFF1A\u4FDD\u6301\u540C\u6B65\uFF0C\u5E76\u53C2\u4E0E\u5757\u4F20\u64AD\uFF08<code>CHAIN_FOLLOW</code>\uFF09 <ul><li>\u6B65\u9AA41.\u5982\u679C\u5B89\u5168\u6761\u4EF6\u53D1\u751F\u53D8\u5316\uFF0C\u8BF7\u8FD4\u56DE\u81F3\u7B2C4\u90E8\u5206\uFF08<code>CHAIN_CATCHUP</code>\uFF09</li><li>\u6B65\u9AA42.\u63A5\u6536\uFF0C\u9A8C\u8BC1\u548C\u4F20\u64AD\u6536\u5230\u7684\u4FE1\u606F <code>Blocks</code></li><li>\u7B2C3\u6B65\u3002\u73B0\u5728\u66F4\u52A0\u786E\u5B9A\u62E5\u6709\u6700\u4F73\u94FE\uFF0C\u6700\u7EC8\u786E\u5B9A\u201C\u63D0\u793A\u201D\u5E76\u63A8\u8FDB\u94FE\u72B6\u6001\u3002</li></ul></li></ul><p><code>ChainSync</code>\u4F7F\u7528\u4EE5\u4E0B<em>\u6982\u5FF5\u6027</em>\u72B6\u6001\u673A\u3002\u7531\u4E8E\u8FD9\u662F\u4E00\u4E2A<em>\u6982\u5FF5\u6027\u7684</em>\u72B6\u6001\u673A\uFF0C\u56E0\u6B64\u5B9E\u73B0\u53EF\u80FD\u4F1A\u504F\u79BB\u7CBE\u786E\u5B9E\u73B0\u8FD9\u4E9B\u72B6\u6001\u6216\u4E25\u683C\u5212\u5206\u5B83\u4EEC\u7684\u72B6\u6001\u3002\u5B9E\u73B0\u53EF\u80FD\u4F1A\u6A21\u7CCA\u72B6\u6001\u4E4B\u95F4\u7684\u754C\u7EBF\u3002\u5982\u679C\u662F\u8FD9\u6837\uFF0C\u5B9E\u73B0\u5FC5\u987B\u786E\u4FDD\u66F4\u6539\u540E\u7684\u534F\u8BAE\u7684\u5B89\u5168\u6027\u3002</p><p><img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gn7v5rtlrlj31aw0petbh.jpg" alt="image-20210201111716710"></p>',4),ru={id:"_2-4-3-4\u540C\u884C\u53D1\u73B0",tabindex:"-1"},du=n("a",{class:"header-anchor",href:"#_2-4-3-4\u540C\u884C\u53D1\u73B0","aria-hidden":"true"},"#",-1),ku={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.chainsync.peer-discovery",target:"_blank",rel:"noopener noreferrer"},vu=n("p",null,"\u5BF9\u7B49\u53D1\u73B0\u662F\u6574\u4E2A\u4F53\u7CFB\u7ED3\u6784\u7684\u5173\u952E\u90E8\u5206\u3002\u9519\u8BEF\u5730\u64CD\u4F5C\u53EF\u80FD\u4F1A\u5BF9\u534F\u8BAE\u7684\u64CD\u4F5C\u9020\u6210\u4E25\u91CD\u540E\u679C\u3002\u5F53\u52A0\u5165\u7F51\u7EDC\u65F6\uFF0C\u65B0\u8282\u70B9\u6700\u521D\u8FDE\u63A5\u7684\u4E00\u7EC4\u5BF9\u7B49\u70B9\u53EF\u80FD\u4F1A\u5B8C\u5168\u652F\u914D\u8BE5\u8282\u70B9\u5BF9\u5176\u4ED6\u5BF9\u7B49\u70B9\u7684\u4E86\u89E3\uFF0C\u56E0\u6B64\uFF0C\u5C06\u4E3B\u5BFC\u8BE5\u8282\u70B9\u6240\u62E5\u6709\u7684\u7F51\u7EDC\u72B6\u6001\u3002",-1),mu=n("p",null,"\u5BF9\u7B49\u53D1\u73B0\u53EF\u4EE5\u901A\u8FC7\u4EFB\u610F\u5916\u90E8\u624B\u6BB5\u6765\u9A71\u52A8\uFF0C\u5E76\u88AB\u63A8\u5230ChainSync\u6240\u6D89\u53CA\u534F\u8BAE\uFF08\u5373GossipSub\uFF0CBitswap\uFF0CBlockSync\uFF09\u7684\u6838\u5FC3\u529F\u80FD\u4E4B\u5916\u3002\u8FD9\u5141\u8BB8\u8FDB\u884C\u6B63\u4EA4\u7684\uFF0C\u7531\u5E94\u7528\u7A0B\u5E8F\u9A71\u52A8\u7684\u5F00\u53D1\uFF0C\u5E76\u4E14\u65E0\u9700\u5916\u90E8\u4F9D\u8D56\u6765\u5B9E\u73B0\u534F\u8BAE\u3002\u4F46\u662F\uFF0CGossipSub\u534F\u8BAE\u652F\u6301\uFF1Ai\uFF09\u5BF9\u7B49\u4EA4\u6362\uFF0C\u4EE5\u53CAii\uFF09\u663E\u5F0F\u5BF9\u7B49\u534F\u8BAE\u3002",-1),bu={id:"_2-4-3-4-1\u540C\u884C\u4EA4\u6D41",tabindex:"-1"},hu=n("a",{class:"header-anchor",href:"#_2-4-3-4-1\u540C\u884C\u4EA4\u6D41","aria-hidden":"true"},"#",-1),fu={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.chainsync.peer-exchange",target:"_blank",rel:"noopener noreferrer"},_u=n("p",null,"Peer Exchange\u5141\u8BB8\u5E94\u7528\u7A0B\u5E8F\u4ECE\u4E00\u7EC4\u5DF2\u77E5\u7684\u5BF9\u7B49\u65B9\u8FDB\u884C\u5F15\u5BFC\uFF0C\u800C\u65E0\u9700\u5916\u90E8\u5BF9\u7B49\u65B9\u53D1\u73B0\u673A\u5236\u3002\u6B64\u8FC7\u7A0B\u53EF\u4EE5\u901A\u8FC7\u5F15\u5BFC\u8282\u70B9\u6216\u5176\u4ED6\u666E\u901A\u5BF9\u7B49\u8282\u70B9\u6765\u5B9E\u73B0\u3002**\u5F15\u5BFC\u8282\u70B9\u5FC5\u987B\u7531\u7CFB\u7EDF\u64CD\u4F5C\u5458\u7EF4\u62A4\uFF0C\u5E76\u4E14\u5FC5\u987B\u6B63\u786E\u914D\u7F6E\u3002**\u5B83\u4EEC\u5FC5\u987B\u7A33\u5B9A\u5E76\u4E14\u72EC\u7ACB\u4E8E\u534F\u8BAE\u6784\u9020\uFF08\u4F8B\u5982GossipSub\u7F51\u683C\u6784\u9020\uFF09\u8FD0\u884C\uFF0C\u4E5F\u5C31\u662F\u8BF4\uFF0C\u5F15\u5BFC\u8282\u70B9\u4E0D\u7EF4\u62A4\u4E0E\u7F51\u683C\u7684\u8FDE\u63A5\u3002",-1),gu={href:"https://github.com/libp2p/specs/tree/master/pubsub/gossipsub",target:"_blank",rel:"noopener noreferrer"},yu={id:"_2-4-3-4-2\u660E\u786E\u7684\u5BF9\u7B49\u534F\u8BAE",tabindex:"-1"},wu=n("a",{class:"header-anchor",href:"#_2-4-3-4-2\u660E\u786E\u7684\u5BF9\u7B49\u534F\u8BAE","aria-hidden":"true"},"#",-1),xu={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.chainsync.explicit-peering-agreements",target:"_blank",rel:"noopener noreferrer"},Cu=n("p",null,"\u4F7F\u7528\u660E\u786E\u7684\u5BF9\u7B49\u534F\u8BAE\uFF0C\u8FD0\u8425\u5546\u5FC5\u987B\u6307\u5B9A\u52A0\u5165\u8282\u70B9\u65F6\u8282\u70B9\u5E94\u8FDE\u63A5\u5230\u7684\u5BF9\u7B49\u65B9\u5217\u8868\u3002\u8BE5\u534F\u8BAE\u5FC5\u987B\u5177\u6709\u53EF\u7528\u4E8E\u6307\u5B9A\u8FD9\u4E9B\u9009\u9879\u7684\u9009\u9879\u3002\u5BF9\u4E8E\u6BCF\u4E2A\u663E\u5F0F\u5BF9\u7B49\u65B9\uFF0C\u8DEF\u7531\u5668\u5FC5\u987B\u5EFA\u7ACB\u5E76\u7EF4\u6301\u53CC\u5411\uFF08\u5BF9\u7B49\uFF09\u8FDE\u63A5\u3002",-1),Su={id:"_2-4-3\u6E10\u8FDB\u5757\u9A8C\u8BC1",tabindex:"-1"},Fu=n("a",{class:"header-anchor",href:"#_2-4-3\u6E10\u8FDB\u5757\u9A8C\u8BC1","aria-hidden":"true"},"#",-1),qu={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.chainsync.progressive-block-validation",target:"_blank",rel:"noopener noreferrer"},Pu={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.struct.block",target:"_blank",rel:"noopener noreferrer"},Au=n("li",null,"\u9A8C\u8BC1\u8BA1\u7B97\u91CF\u5F88\u5927\uFF0C\u5E76\u4E14\u662F\u4E25\u91CD\u7684DOS\u653B\u51FB\u5A92\u4ECB\u3002",-1),Bu=n("li",null,"\u5B89\u5168\u7684\u5B9E\u73B0\u5FC5\u987B\u4ED4\u7EC6\u5B89\u6392\u9A8C\u8BC1\u65F6\u95F4\uFF0C\u5E76\u5728\u4E0D\u5B8C\u5168\u9A8C\u8BC1\u5757\u7684\u60C5\u51B5\u4E0B\u5C06\u4FEE\u526A\u5757\u7684\u5DE5\u4F5C\u51CF\u81F3\u6700\u5C11\u3002",-1),Eu=n("li",null,[n("code",null,"ChainSync"),s("\u5E94\u8BE5\u4FDD\u7559\u672A\u9A8C\u8BC1\u5757\u7684\u7F13\u5B58\uFF08\u6700\u597D\u6309\u5C5E\u4E8E\u94FE\u7684\u53EF\u80FD\u6027\u6392\u5E8F\uFF09\uFF0C\u5E76\u5728\u4F20\u9012\u672A\u9A8C\u8BC1\u5757"),n("code",null,"FinalityTipset"),s("\u6216"),n("code",null,"ChainSync"),s("\u627F\u53D7\u5927\u91CF\u8D44\u6E90\u65F6\u5220\u9664\u672A\u9A8C\u8BC1\u5757\u3002")],-1),Tu=n("li",null,"\u8FD9\u4E9B\u9636\u6BB5\u53EF\u4EE5\u90E8\u5206\u5730\u7528\u4E8E\u5019\u9009\u94FE\u4E2D\u7684\u8BB8\u591A\u5757\uFF0C\u4EE5\u4FBF\u5728\u5B9E\u9645\u8FDB\u884C\u6602\u8D35\u7684\u9A8C\u8BC1\u5DE5\u4F5C\u4E4B\u524D\u5F88\u957F\u65F6\u95F4\u5C31\u6E05\u9664\u6389\u574F\u5757\u3002",-1),Iu=n("strong",null,"\u5757\u9A8C\u8BC1\u7684\u6E10\u8FDB\u9636\u6BB5",-1),Ru=n("li",null,[n("strong",null,"BV0-\u8BED\u6CD5"),s("\uFF1A\u5E8F\u5217\u5316\uFF0C\u952E\u5165\uFF0C\u503C\u8303\u56F4\u3002")],-1),Mu=n("li",null,[n("strong",null,"BV1-\u5408\u7406\u7684\u5171\u8BC6"),s("\uFF1A\u5408\u7406\u7684\u77FF\u5DE5\uFF0C\u91CD\u91CF\u548C\u5386\u65F6\u503C\uFF08\u4F8B\u5982\u6765\u81EA\u7684\u94FE\u72B6\u72B6\u6001"),n("code",null,"b.ChainEpoch - consensus.LookbackParameter"),s("\uFF09\u3002")],-1),Du=n("li",null,[n("strong",null,"BV2-\u5757\u7B7E\u540D")],-1),Gu=n("strong",null,"BV3-\u4FE1\u6807\u6761\u76EE",-1),Vu={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.validating-beacon-entries-on-block-reception",target:"_blank",rel:"noopener noreferrer"},Lu=t("<li><strong>BV4-ElectionProof</strong>\uFF1A\u751F\u6210\u4E86\u6709\u6548\u7684\u9009\u4E3E\u8BC1\u660E\u3002</li><li><strong>BV5-WinningPoSt</strong>\uFF1A\u751F\u6210\u6B63\u786E\u7684PoSt\u3002</li><li><strong>BV6-\u94FE\u8840\u7EDF\u548C\u7EC8\u7ED3\u6027</strong>\uFF1A\u9A8C\u8BC1\u533A\u5757\u94FE\u662F\u5426\u56DE\u5230\u7EC8\u7ED3\u94FE\uFF0C\u800C\u4E0D\u662F\u7EC8\u7ED3\u6027\u3002</li><li><strong>BV7-\u6D88\u606F\u7B7E\u540D</strong>\uFF1A</li><li><strong>BV8-\u72B6\u6001\u6811</strong>\uFF1A\u7236\u63D0\u793A\u6D88\u606F\u6267\u884C\u5C06\u4EA7\u751F\u58F0\u660E\u7684\u72B6\u6001\u6811\u6839\u548C\u6536\u636E\u3002</li>",5),Nu={id:"_2-4-\u50A8\u80FD\u5171\u8BC6",tabindex:"-1"},ju=n("a",{class:"header-anchor",href:"#_2-4-\u50A8\u80FD\u5171\u8BC6","aria-hidden":"true"},"#",-1),Hu={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus",target:"_blank",rel:"noopener noreferrer"},Ou={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.storage_power_actor.the-power-table",target:"_blank",rel:"noopener noreferrer"},Uu={href:"https://spec.filecoin.io/#section-algorithms.expected_consensus",target:"_blank",rel:"noopener noreferrer"},zu=n("p",null,"\u7B80\u800C\u8A00\u4E4B\uFF0CSPC\u5B50\u7CFB\u7EDF\u63D0\u4F9B\u4EE5\u4E0B\u670D\u52A1\uFF1A",-1),Wu={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.storage_power_actor.the-power-table",target:"_blank",rel:"noopener noreferrer"},Zu={href:"https://spec.filecoin.io/#section-algorithms.expected_consensus",target:"_blank",rel:"noopener noreferrer"},Ku={href:"https://spec.filecoin.io/#section-libraries.drand",target:"_blank",rel:"noopener noreferrer"},Qu={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.tickets",target:"_blank",rel:"noopener noreferrer"},Ju={href:"https://spec.filecoin.io/#section-algorithms.expected_consensus.secret-leader-election",target:"_blank",rel:"noopener noreferrer"},Xu={href:"https://spec.filecoin.io/#section-algorithms.expected_consensus.chain-selection",target:"_blank",rel:"noopener noreferrer"},Yu={href:"https://spec.filecoin.io/#section-algorithms.expected_consensus.finality-in-ec",target:"_blank",rel:"noopener noreferrer"},$u={id:"_2-4-4-1\u533A\u5206\u5B58\u50A8\u77FF\u5DE5\u548C\u5757\u77FF\u5DE5",tabindex:"-1"},nr=n("a",{class:"header-anchor",href:"#_2-4-4-1\u533A\u5206\u5B58\u50A8\u77FF\u5DE5\u548C\u5757\u77FF\u5DE5","aria-hidden":"true"},"#",-1),sr={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.distinguishing-between-storage-miners-and-block-miners",target:"_blank",rel:"noopener noreferrer"},ar=n("p",null,"\u5728Filecoin\u7F51\u7EDC\u4E2D\u6709\u4E24\u79CD\u83B7\u53D6Filecoin\u4EE4\u724C\u7684\u65B9\u6CD5\uFF1A",-1),er={href:"https://spec.filecoin.io/#section-systems.filecoin_markets.storage_market",target:"_blank",rel:"noopener noreferrer"},tr={href:"https://spec.filecoin.io/#section-systems.filecoin_mining.storage_mining",target:"_blank",rel:"noopener noreferrer"},or={href:"https://spec.filecoin.io/#section-algorithms.expected_consensus.secret-leader-election",target:"_blank",rel:"noopener noreferrer"},pr={href:"https://spec.filecoin.io/#section-algorithms.pos.porep",target:"_blank",rel:"noopener noreferrer"},ir={href:"https://spec.filecoin.io/#section-algorithms.pos.post",target:"_blank",rel:"noopener noreferrer"},cr={href:"https://spec.filecoin.io/#section-systems.filecoin_mining.storage_mining.storage_miner_actor",target:"_blank",rel:"noopener noreferrer"},lr={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.storage_power_actor",target:"_blank",rel:"noopener noreferrer"},ur={id:"_2-4-4-2\u4E0A\u7535",tabindex:"-1"},rr=n("a",{class:"header-anchor",href:"#_2-4-4-2\u4E0A\u7535","aria-hidden":"true"},"#",-1),dr={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.on-power",target:"_blank",rel:"noopener noreferrer"},kr=t("<p>\u8D28\u91CF\u8C03\u6574\u540E\u7684\u529F\u7387\u4F5C\u4E3A\u5176<em><strong>\u6247\u533A\u8D28\u91CF*<strong>\u7684\u9759\u6001\u51FD\u6570\u5206\u914D\u7ED9\u6BCF\u4E2A\u6247\u533A\uFF0C\u5176\u4E2D\u5305\u62EC\uFF1Ai\uFF09<strong>\u6247\u533A\u65F6\u7A7A</strong>\uFF0C\u5B83\u662F\u6247\u533A\u5927\u5C0F\u548C\u627F\u8BFA\u7684\u5B58\u50A8\u6301\u7EED\u65F6\u95F4\u7684\u4E58\u79EF\uFF0Cii\uFF09<strong>\u4EA4\u6613\u6743\u91CD</strong>\uFF0C\u8BE5\u6743</strong>\u91CD</strong>\u8F6C\u6362\u7531\u4EA4\u6613\u8FBE\u6210\u5171\u8BC6\u7684\u6743\u529B\uFF0Ciii\uFF09<strong>\u4EA4\u6613\u8D28\u91CF\u4E58\u6570</strong>\uFF0C\u8BE5</em><em>\u4E58\u6570</em>*\u53D6\u51B3\u4E8E\u884C\u4E1A\u5185\u5B8C\u6210\u7684\u4EA4\u6613\u7C7B\u578B\uFF08\u5373CC\uFF0C\u5E38\u89C4\u4EA4\u6613\u6216\u5DF2\u9A8C\u8BC1\u7684\u5BA2\u6237\u4EA4\u6613\uFF09\uFF0C\u6700\u540E\uFF0Civ\uFF09<strong>\u90E8\u95E8\u8D28\u91CF\u4E58\u6570</strong>\uFF0C\u5373\u4EA4\u6613\u8D28\u91CF\u4E58\u6570\u4E58\u4EE5\u8BE5\u884C\u4E1A\u4E2D\u6BCF\u79CD\u7C7B\u578B\u7684\u4EA4\u6613\u6240\u5360\u7528\u7684\u65F6\u7A7A\u91CF\u6765\u52A0\u6743\u3002</p><p>\u8BE5<strong>\u90E8\u95E8\u7684\u8D28\u91CF</strong>\u662F\u6620\u5C04\u5927\u5C0F\uFF0C\u6301\u7EED\u65F6\u95F4\u548C\u6D3B\u8DC3\u4EA4\u6613\u7684\u90E8\u95E8\u5176\u4E00\u751F\u7684\u65F6\u95F4\u53BB\u5BF9\u6743\u529B\u548C\u62A5\u916C\u5206\u914D\u78B0\u649E\u65F6\u7C7B\u578B\u7684\u63AA\u65BD\u3002</p>",2),vr=n("em",null,"\u627F\u8BFA\u5BB9\u91CF\uFF08CC\uFF09",-1),mr=n("em",null,"\u5E38\u89C4\u4EA4\u6613",-1),br=n("em",null,"\u9A8C\u8BC1\u5BA2\u6237",-1),hr={href:"https://spec.filecoin.io/#section-systems.filecoin_mining.sector",target:"_blank",rel:"noopener noreferrer"},fr={href:"https://spec.filecoin.io/#section-systems.filecoin_mining.sector.sector_quality",target:"_blank",rel:"noopener noreferrer"},_r={href:"https://spec.filecoin.io/#section-algorithms.verified_clients",target:"_blank",rel:"noopener noreferrer"},gr={href:"https://spec.filecoin.io/#section-algorithms.cryptoecon",target:"_blank",rel:"noopener noreferrer"},yr=n("strong",null,"\u8D28\u91CF\u8C03\u6574\u540E\u7684\u6743\u529B",-1),wr={href:"https://spec.filecoin.io/#section-algorithms.expected_consensus.secret-leader-election",target:"_blank",rel:"noopener noreferrer"},xr=n("p",null,"\u66F4\u51C6\u786E\u5730\u8BF4\uFF0C\u6211\u4EEC\u5177\u6709\u4EE5\u4E0B\u5B9A\u4E49\uFF1A",-1),Cr=n("ul",null,[n("li",null,[n("em",null,"\u539F\u59CB\u5B57\u8282\u529F\u7387"),s("\uFF1A\u6247\u533A\u5927\u5C0F\uFF0C\u4EE5\u5B57\u8282\u4E3A\u5355\u4F4D\u3002")]),n("li",null,[n("em",null,"\u8D28\u91CF\u8C03\u6574\u540E\u7684\u529F\u7387"),s("\uFF1A\u7F51\u7EDC\u4E0A\u5B58\u50A8\u7684\u6570\u636E\u7684\u5171\u8BC6\u529F\u7387\uFF0C\u7B49\u4E8E\u539F\u59CB\u5B57\u8282\u529F\u7387\u4E58\u4EE5\u6247\u533A\u8D28\u91CF\u4E58\u6570\u3002")])],-1),Sr={id:"_2-4-4-3\u4FE1\u6807\u6761\u76EE",tabindex:"-1"},Fr=n("a",{class:"header-anchor",href:"#_2-4-4-3\u4FE1\u6807\u6761\u76EE","aria-hidden":"true"},"#",-1),qr={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.beacon-entries",target:"_blank",rel:"noopener noreferrer"},Pr={href:"https://spec.filecoin.io/#section-libraries.drand",target:"_blank",rel:"noopener noreferrer"},Ar={href:"https://spec.filecoin.io/#section-algorithms.crypto.randomness",target:"_blank",rel:"noopener noreferrer"},Br=n("p",null,"\u53CD\u8FC7\u6765\uFF0C\u8FD9\u4E9B\u968F\u673A\u79CD\u5B50\u7531\u4EE5\u4E0B\u4EBA\u5458\u4F7F\u7528\uFF1A",-1),Er={href:"https://spec.filecoin.io/#section-systems.filecoin_mining.sector.sealing",target:"_blank",rel:"noopener noreferrer"},Tr={href:"https://spec.filecoin.io/#section-systems.filecoin_mining.storage_proving.poster",target:"_blank",rel:"noopener noreferrer"},Ir={href:"https://spec.filecoin.io/#section-algorithms.expected_consensus.secret-leader-election",target:"_blank",rel:"noopener noreferrer"},Rr=n("p",null,"\u8BE5\u968F\u673A\u6027\u53EF\u4EE5\u901A\u8FC7\u6839\u636E\u5176\u5B89\u5168\u6027\u8981\u6C42\u4F7F\u7528\u5B83\u4EEC\u7684\u5404\u4E2A\u534F\u8BAE\u4ECE\u5404\u79CDFilecoin\u94FE\u7EAA\u5143\u4E2D\u5F97\u51FA\u3002",-1),Mr=n("p",null,[s("\u91CD\u8981\u7684\u662F\u8981\u6CE8\u610F\uFF0C\u7ED9\u5B9A\u7684Filecoin\u7F51\u7EDC\u548C\u7ED9\u5B9A\u7684drand\u7F51\u7EDC\u4E0D\u5FC5\u5177\u6709\u76F8\u540C\u7684\u5FAA\u73AF\u65F6\u95F4\uFF0C\u5373Filecoin\u751F\u6210\u7684\u5757\u53EF\u80FD\u6BD4drand\u751F\u6210\u7684\u968F\u673A\u6027\u66F4\u5FEB\u6216\u66F4\u6162\u3002\u4F8B\u5982\uFF0C\u5982\u679Cdrand\u4FE1\u6807\u4EA7\u751F\u7684\u968F\u673A\u6027\u662FFilecoin\u4EA7\u751F\u5757\u7684\u4E24\u500D\uFF0C\u90A3\u4E48\u6211\u4EEC\u53EF\u80FD\u671F\u671B\u5728Filecoin\u65F6\u4EE3\u4EA7\u751F\u4E24\u4E2A\u968F\u673A\u503C\uFF0C\u53CD\u4E4B\uFF0C\u5982\u679CFilecoin\u7F51\u7EDC\u7684\u901F\u5EA6\u662Fdrand\u7684\u4E24\u500D\uFF0C\u5219\u6211\u4EEC\u53EF\u80FD\u671F\u671B\u4E00\u4E2A\u968F\u673A\u503C\u6BCF\u9694\u4E00\u4E2AFilecoin\u65F6\u4EE3\u3002\u56E0\u6B64\uFF0C\u53D6\u51B3\u4E8E\u4E24\u4E2A\u7F51\u7EDC\u7684\u914D\u7F6E\uFF0C\u67D0\u4E9BFilecoin\u5757\u53EF\u80FD\u5305\u542B\u591A\u4E2A\u6216\u4E0D\u5305\u542Bdrand\u6761\u76EE\u3002\u6B64\u5916\uFF0C\u5FC5\u987B\u786E\u4FDD\u4E2D\u65AD\u671F\u95F4\u5BF9drand\u7F51\u7EDC\u8FDB\u884C\u7684\u65B0\u7684\u968F\u673A\u6027\u6761\u76EE\u7684\u4EFB\u4F55\u547C\u53EB\u90FD\u5E94\u88AB\u963B\u6B62\uFF0C\u5982"),n("code",null,"drand.Public()"),s(" \u4E0B\u9762\u7684\u7535\u8BDD\u3002\u5728\u6240\u6709\u60C5\u51B5\u4E0B\uFF0CFilecoin\u5757\u90FD\u5FC5\u987B\u5305\u62EC\u81EA"),n("code",null,"BeaconEntries"),s("\u5757\u5934\u5B57\u6BB5\u4E2D\u7684\u6700\u540E\u4E00\u4E2A\u7EAA\u5143\u4EE5\u6765\u751F\u6210\u7684\u6240\u6709drand beacon\u8F93\u51FA\u3002\u7ED9\u5B9AFilecoin\u7EAA\u5143\u7684\u4EFB\u4F55\u968F\u673A\u6027\u4F7F\u7528\u90FD\u5E94\u4F7F\u7528Filecoin\u5757\u4E2D\u5305\u542B\u7684\u6700\u540E\u4E00\u4E2A\u6709\u6548drand\u6761\u76EE\u3002\u5982\u4E0B\u6240\u793A\u3002")],-1),Dr={id:"_2-4-4-3-1\u83B7\u53D6vm\u7684drand\u968F\u673A\u6027",tabindex:"-1"},Gr=n("a",{class:"header-anchor",href:"#_2-4-4-3-1\u83B7\u53D6vm\u7684drand\u968F\u673A\u6027","aria-hidden":"true"},"#",-1),Vr={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.get-drand-randomness-for-vm",target:"_blank",rel:"noopener noreferrer"},Lr=n("p",null,"\u5BF9\u4E8E\u8BF8\u5982PoRep\u521B\u5EFA\uFF0C\u8BC1\u660E\u9A8C\u8BC1\u4E4B\u7C7B\u7684\u64CD\u4F5C\uFF0C\u6216\u8005\u9700\u8981Filecoin VM\u968F\u673A\u6027\u7684\u4EFB\u4F55\u64CD\u4F5C\uFF0C\u5E94\u8BE5\u6709\u4E00\u79CD\u65B9\u6CD5\u53EF\u4EE5\u4ECE\u94FE\u4E2D\u6B63\u786E\u63D0\u53D6drand\u6761\u76EE\u3002\u8BF7\u6CE8\u610F\uFF0C\u5982\u679Cdrand\u8F83\u6162\uFF0C\u5219\u8BE5\u56DE\u5408\u53EF\u80FD\u8DE8\u8D8A\u591A\u4E2Afilecoin\u65F6\u671F\u3002\u6700\u4F4E\u7684\u65F6\u671F\u53F7\u5757\u5C06\u5305\u542B\u8BF7\u6C42\u7684\u4FE1\u6807\u6761\u76EE\u3002\u540C\u6837\uFF0C\u5982\u679C\u5728\u5E94\u63D2\u5165\u4FE1\u6807\u7684\u4F4D\u7F6E\u5B58\u5728\u96F6\u8F6E\uFF0C\u6211\u4EEC\u9700\u8981\u5728\u94FE\u4E0A\u8FDB\u884C\u8FED\u4EE3\u4EE5\u627E\u5230\u5C06\u6761\u76EE\u63D2\u5165\u5230\u7684\u4F4D\u7F6E\u3002\u5177\u4F53\u800C\u8A00\uFF0C\u4E0B\u4E00\u4E2A\u975E\u7A7A\u5757\u5FC5\u987B\u5305\u542B\u5B9A\u4E49\u6240\u8BF7\u6C42\u7684drand\u6761\u76EE\u3002",-1),Nr={id:"_2-4-4-3-2\u4ECEdrand\u7F51\u7EDC\u83B7\u53D6\u968F\u673A\u6027",tabindex:"-1"},jr=n("a",{class:"header-anchor",href:"#_2-4-4-3-2\u4ECEdrand\u7F51\u7EDC\u83B7\u53D6\u968F\u673A\u6027","aria-hidden":"true"},"#",-1),Hr={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.fetch-randomness-from-drand-network",target:"_blank",rel:"noopener noreferrer"},Or=n("p",null,"\u8FDB\u884C\u6316\u6398\u65F6\uFF0C\u77FF\u5DE5\u53EF\u4EE5\u4ECEdrand\u7F51\u7EDC\u4E2D\u83B7\u53D6\u6761\u76EE\uFF0C\u4EE5\u5C06\u5176\u5305\u62EC\u5728\u65B0\u5757\u4E2D\u3002",-1),Ur={href:"https://spec.filecoin.io/#example-drandbeacon",target:"_blank",rel:"noopener noreferrer"},zr=t(`<p>DrandBeacon\u5C06Lotus\u4E0Edrand\u7F51\u7EDC\u76F8\u8FDE\uFF0C\u4EE5\u4FBF\u4EE5\u4E0EFilecoin\u8F6E\u6B21/\u7EAA\u5143\u4E00\u81F4\u7684\u65B9\u5F0F\u5411\u7CFB\u7EDF\u63D0\u4F9B\u968F\u673A\u6027\u3002</p><p>\u6211\u4EEC\u901A\u8FC7\u5176\u516C\u5171HTTP\u7AEF\u70B9\u8FDE\u63A5\u5230drand\u5BF9\u7B49\u65B9\u3002\u5BF9\u7B49\u70B9\u5728drandServers\u53D8\u91CF\u4E2D\u679A\u4E3E\u3002</p><p>Drand\u94FE\u7684\u6839\u4FE1\u4EFB\u662F\u4ECEbuild.DrandChain\u914D\u7F6E\u7684\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> DrandBeacon <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 client dclient<span class="token punctuation">.</span>Client

 pubkey kyber<span class="token punctuation">.</span>Point

 <span class="token comment">// seconds</span>
 interval time<span class="token punctuation">.</span>Duration

 drandGenTime <span class="token builtin">uint64</span>
 filGenTime   <span class="token builtin">uint64</span>
 filRoundTime <span class="token builtin">uint64</span>

 cacheLk    sync<span class="token punctuation">.</span>Mutex
 localCache <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">uint64</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>BeaconEntry
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4),Wr={href:"https://spec.filecoin.io/#example-beaconentriesforblock",target:"_blank",rel:"noopener noreferrer"},Zr=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">BeaconEntriesForBlock</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> bSchedule Schedule<span class="token punctuation">,</span> epoch abi<span class="token punctuation">.</span>ChainEpoch<span class="token punctuation">,</span> parentEpoch abi<span class="token punctuation">.</span>ChainEpoch<span class="token punctuation">,</span> prev types<span class="token punctuation">.</span>BeaconEntry<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>BeaconEntry<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token punctuation">{</span>
  parentBeacon <span class="token operator">:=</span> bSchedule<span class="token punctuation">.</span><span class="token function">BeaconForEpoch</span><span class="token punctuation">(</span>parentEpoch<span class="token punctuation">)</span>
  currBeacon <span class="token operator">:=</span> bSchedule<span class="token punctuation">.</span><span class="token function">BeaconForEpoch</span><span class="token punctuation">(</span>epoch<span class="token punctuation">)</span>
  <span class="token keyword">if</span> parentBeacon <span class="token operator">!=</span> currBeacon <span class="token punctuation">{</span>
   <span class="token comment">// Fork logic</span>
   round <span class="token operator">:=</span> currBeacon<span class="token punctuation">.</span><span class="token function">MaxBeaconRoundForEpoch</span><span class="token punctuation">(</span>epoch<span class="token punctuation">)</span>
   out <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>BeaconEntry<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
   rch <span class="token operator">:=</span> currBeacon<span class="token punctuation">.</span><span class="token function">Entry</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> round<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
   res <span class="token operator">:=</span> <span class="token operator">&lt;-</span>rch
   <span class="token keyword">if</span> res<span class="token punctuation">.</span>Err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;getting entry %d returned error: %w&quot;</span><span class="token punctuation">,</span> round<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>Err<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   out<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">.</span>Entry
   rch <span class="token operator">=</span> currBeacon<span class="token punctuation">.</span><span class="token function">Entry</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> round<span class="token punctuation">)</span>
   res <span class="token operator">=</span> <span class="token operator">&lt;-</span>rch
   <span class="token keyword">if</span> res<span class="token punctuation">.</span>Err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;getting entry %d returned error: %w&quot;</span><span class="token punctuation">,</span> round<span class="token punctuation">,</span> res<span class="token punctuation">.</span>Err<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   out<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">.</span>Entry
   <span class="token keyword">return</span> out<span class="token punctuation">,</span> <span class="token boolean">nil</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>

 beacon <span class="token operator">:=</span> bSchedule<span class="token punctuation">.</span><span class="token function">BeaconForEpoch</span><span class="token punctuation">(</span>epoch<span class="token punctuation">)</span>

 start <span class="token operator">:=</span> build<span class="token punctuation">.</span>Clock<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

 maxRound <span class="token operator">:=</span> beacon<span class="token punctuation">.</span><span class="token function">MaxBeaconRoundForEpoch</span><span class="token punctuation">(</span>epoch<span class="token punctuation">)</span>
 <span class="token keyword">if</span> maxRound <span class="token operator">==</span> prev<span class="token punctuation">.</span>Round <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
 <span class="token punctuation">}</span>

 <span class="token comment">// TODO: this is a sketchy way to handle the genesis block not having a beacon entry</span>
 <span class="token keyword">if</span> prev<span class="token punctuation">.</span>Round <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
  prev<span class="token punctuation">.</span>Round <span class="token operator">=</span> maxRound <span class="token operator">-</span> <span class="token number">1</span>
 <span class="token punctuation">}</span>

 cur <span class="token operator">:=</span> maxRound
 <span class="token keyword">var</span> out <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>BeaconEntry
 <span class="token keyword">for</span> cur <span class="token operator">&gt;</span> prev<span class="token punctuation">.</span>Round <span class="token punctuation">{</span>
  rch <span class="token operator">:=</span> beacon<span class="token punctuation">.</span><span class="token function">Entry</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> cur<span class="token punctuation">)</span>
  <span class="token keyword">select</span> <span class="token punctuation">{</span>
  <span class="token keyword">case</span> resp <span class="token operator">:=</span> <span class="token operator">&lt;-</span>rch<span class="token punctuation">:</span>
   <span class="token keyword">if</span> resp<span class="token punctuation">.</span>Err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;beacon entry request returned error: %w&quot;</span><span class="token punctuation">,</span> resp<span class="token punctuation">.</span>Err<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>

   out <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>out<span class="token punctuation">,</span> resp<span class="token punctuation">.</span>Entry<span class="token punctuation">)</span>
   cur <span class="token operator">=</span> resp<span class="token punctuation">.</span>Entry<span class="token punctuation">.</span>Round <span class="token operator">-</span> <span class="token number">1</span>
  <span class="token keyword">case</span> <span class="token operator">&lt;-</span>ctx<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;context timed out waiting on beacon entry to come back for epoch %d: %w&quot;</span><span class="token punctuation">,</span> epoch<span class="token punctuation">,</span> ctx<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>

 log<span class="token punctuation">.</span><span class="token function">Debugw</span><span class="token punctuation">(</span><span class="token string">&quot;fetching beacon entries&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;took&quot;</span><span class="token punctuation">,</span> build<span class="token punctuation">.</span>Clock<span class="token punctuation">.</span><span class="token function">Since</span><span class="token punctuation">(</span>start<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;numEntries&quot;</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token function">reverse</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span>
 <span class="token keyword">return</span> out<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Kr={href:"https://spec.filecoin.io/#example-maxbeaconroundforepoch",target:"_blank",rel:"noopener noreferrer"},Qr=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>db <span class="token operator">*</span>DrandBeacon<span class="token punctuation">)</span> <span class="token function">MaxBeaconRoundForEpoch</span><span class="token punctuation">(</span>filEpoch abi<span class="token punctuation">.</span>ChainEpoch<span class="token punctuation">)</span> <span class="token builtin">uint64</span> <span class="token punctuation">{</span>
 <span class="token comment">// TODO: sometimes the genesis time for filecoin is zero and this goes negative</span>
 latestTs <span class="token operator">:=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">uint64</span><span class="token punctuation">(</span>filEpoch<span class="token punctuation">)</span> <span class="token operator">*</span> db<span class="token punctuation">.</span>filRoundTime<span class="token punctuation">)</span> <span class="token operator">+</span> db<span class="token punctuation">.</span>filGenTime<span class="token punctuation">)</span> <span class="token operator">-</span> db<span class="token punctuation">.</span>filRoundTime
 dround <span class="token operator">:=</span> <span class="token punctuation">(</span>latestTs <span class="token operator">-</span> db<span class="token punctuation">.</span>drandGenTime<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">uint64</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>interval<span class="token punctuation">.</span><span class="token function">Seconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token keyword">return</span> dround
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Jr={id:"_2-4-4-3-3\u5728\u5757\u63A5\u6536\u65F6\u9A8C\u8BC1\u4FE1\u6807\u6761\u76EE",tabindex:"-1"},Xr=n("a",{class:"header-anchor",href:"#_2-4-4-3-3\u5728\u5757\u63A5\u6536\u65F6\u9A8C\u8BC1\u4FE1\u6807\u6761\u76EE","aria-hidden":"true"},"#",-1),Yr={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.validating-beacon-entries-on-block-reception",target:"_blank",rel:"noopener noreferrer"},$r=n("p",null,"Filecoin\u94FE\u5C06\u5305\u542B\u4ECEFilecoin\u8D77\u6E90\u5230\u5F53\u524D\u533A\u5757\u7684\u6574\u4E2A\u4FE1\u6807\u8F93\u51FA\u3002",-1),nd={href:"https://spec.filecoin.io/#section-libraries.drand",target:"_blank",rel:"noopener noreferrer"},sd={href:"https://github.com/drand/drand/blob/763e9a252cf59060c675ced0562e8eba506971c1/chain/beacon.go#L76",target:"_blank",rel:"noopener noreferrer"},ad=n("code",null,"Verify",-1),ed={href:"https://spec.filecoin.io/#example-validateblockvalues",target:"_blank",rel:"noopener noreferrer"},td=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">ValidateBlockValues</span><span class="token punctuation">(</span>bSchedule Schedule<span class="token punctuation">,</span> h <span class="token operator">*</span>types<span class="token punctuation">.</span>BlockHeader<span class="token punctuation">,</span> parentEpoch abi<span class="token punctuation">.</span>ChainEpoch<span class="token punctuation">,</span>
 prevEntry types<span class="token punctuation">.</span>BeaconEntry<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
 <span class="token punctuation">{</span>
  parentBeacon <span class="token operator">:=</span> bSchedule<span class="token punctuation">.</span><span class="token function">BeaconForEpoch</span><span class="token punctuation">(</span>parentEpoch<span class="token punctuation">)</span>
  currBeacon <span class="token operator">:=</span> bSchedule<span class="token punctuation">.</span><span class="token function">BeaconForEpoch</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>Height<span class="token punctuation">)</span>
  <span class="token keyword">if</span> parentBeacon <span class="token operator">!=</span> currBeacon <span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>BeaconEntries<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;expected two beacon entries at beacon fork, got %d&quot;</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>BeaconEntries<span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   err <span class="token operator">:=</span> currBeacon<span class="token punctuation">.</span><span class="token function">VerifyEntry</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>BeaconEntries<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> h<span class="token punctuation">.</span>BeaconEntries<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
   <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;beacon at fork point invalid: (%v, %v): %w&quot;</span><span class="token punctuation">,</span>
     h<span class="token punctuation">.</span>BeaconEntries<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> h<span class="token punctuation">.</span>BeaconEntries<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> <span class="token boolean">nil</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>

 <span class="token comment">// TODO: fork logic</span>
 b <span class="token operator">:=</span> bSchedule<span class="token punctuation">.</span><span class="token function">BeaconForEpoch</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>Height<span class="token punctuation">)</span>
 maxRound <span class="token operator">:=</span> b<span class="token punctuation">.</span><span class="token function">MaxBeaconRoundForEpoch</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>Height<span class="token punctuation">)</span>
 <span class="token keyword">if</span> maxRound <span class="token operator">==</span> prevEntry<span class="token punctuation">.</span>Round <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>BeaconEntries<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;expected not to have any beacon entries in this block, got %d&quot;</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>BeaconEntries<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>BeaconEntries<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;expected to have beacon entries in this block, but didn&#39;t find any&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 last <span class="token operator">:=</span> h<span class="token punctuation">.</span>BeaconEntries<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>BeaconEntries<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
 <span class="token keyword">if</span> last<span class="token punctuation">.</span>Round <span class="token operator">!=</span> maxRound <span class="token punctuation">{</span>
  <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;expected final beacon entry in block to be at round %d, got %d&quot;</span><span class="token punctuation">,</span> maxRound<span class="token punctuation">,</span> last<span class="token punctuation">.</span>Round<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">for</span> i<span class="token punctuation">,</span> e <span class="token operator">:=</span> <span class="token keyword">range</span> h<span class="token punctuation">.</span>BeaconEntries <span class="token punctuation">{</span>
  <span class="token keyword">if</span> err <span class="token operator">:=</span> b<span class="token punctuation">.</span><span class="token function">VerifyEntry</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> prevEntry<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> xerrors<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;beacon entry %d (%d - %x (%d)) was invalid: %w&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> e<span class="token punctuation">.</span>Round<span class="token punctuation">,</span> e<span class="token punctuation">.</span>Data<span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>Data<span class="token punctuation">)</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  prevEntry <span class="token operator">=</span> e
 <span class="token punctuation">}</span>

 <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),od={id:"_2-4-4-4\u95E8\u7968",tabindex:"-1"},pd=n("a",{class:"header-anchor",href:"#_2-4-4-4\u95E8\u7968","aria-hidden":"true"},"#",-1),id={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.tickets",target:"_blank",rel:"noopener noreferrer"},cd=n("p",null,"Filecoin\u5757\u6807\u9898\u8FD8\u5305\u542B\u4E00\u4E2A\u4ECE\u5176\u65F6\u4EE3\u7684\u4FE1\u6807\u6761\u76EE\u751F\u6210\u7684\u201C\u7968\u201D\u3002\u5BF9\u4E8E\u7B49\u91CD\u7684\u8D27\u53C9\uFF0C\u7968\u8BC1\u7528\u4E8E\u5728\u201C\u8D27\u53C9\u9009\u62E9\u89C4\u5219\u201D\u4E2D\u6253\u7834\u5E73\u5C40\u3002",-1),ld=n("p",null,"\u6BCF\u5F53\u5728Filecoin\u4E2D\u6BD4\u8F83\u7968\u8BC1\u65F6\uFF0C\u6BD4\u8F83\u5C31\u662F\u7968\u8BC1\u7684VRF\u6458\u8981\u7684\u5B57\u8282\u3002",-1),ud={id:"_2-4-4-4-1\u968F\u673A\u7968\u751F\u6210",tabindex:"-1"},rd=n("a",{class:"header-anchor",href:"#_2-4-4-4-1\u968F\u673A\u7968\u751F\u6210","aria-hidden":"true"},"#",-1),dd={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.randomness-ticket-generation",target:"_blank",rel:"noopener noreferrer"},kd=t(`<p>\u5728Filecoin\u65F6\u4EE3<code>n</code>\uFF0C\u5C06\u4F7F\u7528\u76F8\u5E94\u7684\u4FE1\u6807\u6761\u76EE\u751F\u6210\u65B0\u7684\u7968\u8BC1<code>n</code>\u3002</p><p>\u77FF\u5DE5\u901A\u8FC7\u53EF\u9A8C\u8BC1\u968F\u673A\u51FD\u6570\uFF08VRF\uFF09\u8FD0\u884C\u4FE1\u6807\u6761\u76EE\u4EE5\u83B7\u53D6\u65B0\u7684\u552F\u4E00\u7968\u8BC1\u3002\u4FE1\u6807\u6761\u76EE\u524D\u9762\u5E26\u6709\u7968\u8BC1\u57DF\u5206\u9694\u6807\u7B7E\uFF0C\u5E76\u4E0E\u77FF\u5DE5\u53C2\u4E0E\u8005\u5730\u5740\u76F8\u8FDE\uFF08\u4EE5\u786E\u4FDD\u4F7F\u7528\u76F8\u540C\u5DE5\u4F5C\u4EBA\u5458\u5BC6\u94A5\u7684\u77FF\u5DE5\u83B7\u5F97\u4E0D\u540C\u7684\u7968\u8BC1\uFF09\u3002</p><p>\u751F\u6210\u7ED9\u5B9A\u7EAA\u5143n\u7684\u7968\u8BC1\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>randSeed = GetRandomnessFromBeacon(n)
newTicketRandomness = VRF_miner(H(TicketProdDST || index || Serialization(randSeed, minerActorAddress)))
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,4),vd={href:"https://spec.filecoin.io/#section-algorithms.crypto.vrf",target:"_blank",rel:"noopener noreferrer"},md={id:"_2-4-4-4-2\u7968\u8BC1\u9A8C\u8BC1",tabindex:"-1"},bd=n("a",{class:"header-anchor",href:"#_2-4-4-4-2\u7968\u8BC1\u9A8C\u8BC1","aria-hidden":"true"},"#",-1),hd={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.ticket-validation",target:"_blank",rel:"noopener noreferrer"},fd=n("p",null,"\u6BCF\u4E2A\u7968\u8BC1\u5E94\u4ECEVRF\u94FE\u4E2D\u7684\u524D\u4E00\u4E2A\u7968\u8BC1\u751F\u6210\uFF0C\u5E76\u8FDB\u884C\u76F8\u5E94\u7684\u9A8C\u8BC1\u3002",-1),_d={id:"_2-4-4-5\u6700\u5C0F\u77FF\u5DE5\u89C4\u6A21",tabindex:"-1"},gd=n("a",{class:"header-anchor",href:"#_2-4-4-5\u6700\u5C0F\u77FF\u5DE5\u89C4\u6A21","aria-hidden":"true"},"#",-1),yd={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.minimum-miner-size",target:"_blank",rel:"noopener noreferrer"},wd=t("<p>\u4E3A\u4E86\u786E\u4FDD\u5B58\u50A8\u7535\u6E90\u5171\u8BC6\uFF0C\u7CFB\u7EDF\u5B9A\u4E49\u4E86\u53C2\u4E0E\u5171\u8BC6\u6240\u9700\u7684\u6700\u5C0F\u77FF\u673A\u5927\u5C0F\u3002</p><p>\u5177\u4F53\u800C\u8A00\uFF0C\u77FF\u5DE5\u5FC5\u987B\u81F3\u5C11<code>MIN_MINER_SIZE_STOR</code>\u5177\u6709\u7535\u91CF\uFF08\u5373\u5F53\u524D\u5728\u5B58\u50A8\u4EA4\u6613\u4E2D\u4F7F\u7528\u7684\u5B58\u50A8\u7535\u6E90\uFF09\u624D\u80FD\u53C2\u4E0E\u9886\u5BFC\u8005\u9009\u4E3E\u3002\u5982\u679C\u6CA1\u6709\u77FF\u5DE5\u62E5\u6709<code>MIN_MINER_SIZE_STOR</code>\u6216\u62E5\u6709\u66F4\u591A\u6743\u529B\uFF0C\u5219\u81F3\u5C11\u5177\u6709\u4E0E\u77FF\u5DE5\u9876\u90E8\u6700\u5C0F<code>MIN_MINER_SIZE_TARG</code>\u7684\u77FF\u5DE5\uFF08\u6309\u5B58\u50A8\u529F\u7387\u6392\u5E8F\uFF09\u7684\u529F\u7387\u76F8\u540C\u7684\u77FF\u5DE5\u5C06\u80FD\u591F\u53C2\u52A0\u9886\u5BFC\u4EBA\u9009\u4E3E\u3002\u4EE5\u7B80\u5355\u7684\u82F1\u8BED<code>MIN_MINER_SIZE_TARG = 3</code>\u4E3A\u4F8B\uFF0C\u8FD9\u610F\u5473\u7740\u5177\u6709\u81F3\u5C11\u4E0E\u7B2C\u4E09\u5927\u77FF\u5546\u76F8\u540C\u6743\u529B\u7684\u77FF\u5DE5\u5C06\u6709\u8D44\u683C\u53C2\u52A0\u5171\u8BC6\u3002</p><p>\u5C0F\u4E8E\u6B64\u503C\u7684\u77FF\u5DE5\u65E0\u6CD5\u5728\u7F51\u7EDC\u4E2D\u8FDB\u884C\u533A\u5757\u6316\u6398\u5E76\u83B7\u5F97\u533A\u5757\u5956\u52B1\u3002\u5373\u4F7F\u4ED6\u4EEC\u7684\u6743\u529B\u4E0D\u4F1A\u88AB\u7B97\u4F5C\u9886\u5BFC\u4EBA\u9009\u4E3E\u7684\u7968\u6570\uFF0C\u4ED6\u4EEC\u7684\u6743\u529B\u4ECD\u5C06\u8BA1\u5165\u6574\u4E2A\u7F51\u7EDC\uFF08\u539F\u59CB\u6216\u8981\u6C42\u7684\uFF09\u5B58\u50A8\u80FD\u529B\u4E2D\u3002\u4F46\u662F\uFF0C<strong>\u91CD\u8981\u7684\u662F\u8981\u6CE8\u610F\uFF0C\u6B64\u7C7B\u77FF\u5DE5\u4ECD\u7136\u4F1A\u906D\u53D7\u5176\u6743\u529B\u7684\u8FC7\u5931\u5E76\u56E0\u6B64\u53D7\u5230\u60E9\u7F5A</strong>\u3002</p><p>\u56E0\u6B64\uFF0C\u8981\u5F15\u5BFC\u7F51\u7EDC\uFF0C\u8D77\u6E90\u5757\u5FC5\u987B\u5305\u62EC\u77FF\u5DE5\uFF08\u53EF\u80FD\u53EA\u662FCommittedCapacity\u6247\u533A\uFF09\u6765\u542F\u52A8\u7F51\u7EDC\u3002</p><p>\u8BE5<code>MIN_MINER_SIZE_TARG</code>\u6761\u4EF6\u5C06\u4E0D\u4F1A\u5728\u4EFB\u4F55\u77FF\u5DE5\u62E5\u6709\u7684<code>MIN_MINER_SIZE_STOR</code>\u6743\u529B\u90FD\u8D85\u8FC7\u7684\u7F51\u7EDC\u4E2D\u4F7F\u7528\u3002\u5C3D\u7BA1\u5982\u6B64\uFF0C\u5B83\u7684\u5B9A\u4E49\u662F\u4E3A\u4E86\u786E\u4FDD\u5C0F\u578B\u7F51\u7EDC\u4E2D\u7684\u6D3B\u52A8\uFF08\u4F8B\u5982\uFF0C\u63A5\u8FD1\u8D77\u6E90\u6216\u5728\u6389\u7535\u4E4B\u540E\uFF09\u3002</p>",5),xd={id:"_2-4-4-6\u50A8\u80FD\u6F14\u5458",tabindex:"-1"},Cd=n("a",{class:"header-anchor",href:"#_2-4-4-6\u50A8\u80FD\u6F14\u5458","aria-hidden":"true"},"#",-1),Sd={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.storage_power_actor",target:"_blank",rel:"noopener noreferrer"},Fd={id:"_2-4-4-6-1storagepoweractorstate-\u5B9E\u4F5C",tabindex:"-1"},qd=n("a",{class:"header-anchor",href:"#_2-4-4-6-1storagepoweractorstate-\u5B9E\u4F5C","aria-hidden":"true"},"#",-1),Pd={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.storage_power_actor.storagepoweractorstate-implementation",target:"_blank",rel:"noopener noreferrer"},Ad=n("code",null,"StoragePowerActorState",-1),Bd={href:"https://spec.filecoin.io/#example-state",target:"_blank",rel:"noopener noreferrer"},Ed=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> State <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 TotalRawBytePower abi<span class="token punctuation">.</span>StoragePower
 <span class="token comment">// TotalBytesCommitted includes claims from miners below min power threshold</span>
 TotalBytesCommitted  abi<span class="token punctuation">.</span>StoragePower
 TotalQualityAdjPower abi<span class="token punctuation">.</span>StoragePower
 <span class="token comment">// TotalQABytesCommitted includes claims from miners below min power threshold</span>
 TotalQABytesCommitted abi<span class="token punctuation">.</span>StoragePower
 TotalPledgeCollateral abi<span class="token punctuation">.</span>TokenAmount

 <span class="token comment">// These fields are set once per epoch in the previous cron tick and used</span>
 <span class="token comment">// for consistent values across a single epoch&#39;s state transition.</span>
 ThisEpochRawBytePower     abi<span class="token punctuation">.</span>StoragePower
 ThisEpochQualityAdjPower  abi<span class="token punctuation">.</span>StoragePower
 ThisEpochPledgeCollateral abi<span class="token punctuation">.</span>TokenAmount
 ThisEpochQAPowerSmoothed  smoothing<span class="token punctuation">.</span>FilterEstimate

 MinerCount <span class="token builtin">int64</span>
 <span class="token comment">// Number of miners having proven the minimum consensus power.</span>
 MinerAboveMinPowerCount <span class="token builtin">int64</span>

 <span class="token comment">// A queue of events to be triggered by cron, indexed by epoch.</span>
 CronEventQueue cid<span class="token punctuation">.</span>Cid <span class="token comment">// Multimap, (HAMT[ChainEpoch]AMT[CronEvent])</span>

 <span class="token comment">// First epoch in which a cron task may be stored.</span>
 <span class="token comment">// Cron will iterate every epoch between this and the current epoch inclusively to find tasks to execute.</span>
 FirstCronEpoch abi<span class="token punctuation">.</span>ChainEpoch

 <span class="token comment">// Claimed power for each miner.</span>
 Claims cid<span class="token punctuation">.</span>Cid <span class="token comment">// Map, HAMT[address]Claim</span>

 ProofValidationBatch <span class="token operator">*</span>cid<span class="token punctuation">.</span>Cid <span class="token comment">// Multimap, (HAMT[Address]AMT[SealVerifyInfo])</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Td={id:"_2-4-4-6-2storagepoweractor-\u5B9E\u4F5C",tabindex:"-1"},Id=n("a",{class:"header-anchor",href:"#_2-4-4-6-2storagepoweractor-\u5B9E\u4F5C","aria-hidden":"true"},"#",-1),Rd={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.storage_power_actor.storagepoweractor-implementation",target:"_blank",rel:"noopener noreferrer"},Md=n("code",null,"StoragePowerActor",-1),Dd={href:"https://spec.filecoin.io/#example-exports",target:"_blank",rel:"noopener noreferrer"},Gd=t(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>a Actor<span class="token punctuation">)</span> <span class="token function">Exports</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span>
  builtin<span class="token punctuation">.</span>MethodConstructor<span class="token punctuation">:</span> a<span class="token punctuation">.</span>Constructor<span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token punctuation">:</span>                         a<span class="token punctuation">.</span>CreateMiner<span class="token punctuation">,</span>
  <span class="token number">3</span><span class="token punctuation">:</span>                         a<span class="token punctuation">.</span>UpdateClaimedPower<span class="token punctuation">,</span>
  <span class="token number">4</span><span class="token punctuation">:</span>                         a<span class="token punctuation">.</span>EnrollCronEvent<span class="token punctuation">,</span>
  <span class="token number">5</span><span class="token punctuation">:</span>                         a<span class="token punctuation">.</span>OnEpochTickEnd<span class="token punctuation">,</span>
  <span class="token number">6</span><span class="token punctuation">:</span>                         a<span class="token punctuation">.</span>UpdatePledgeTotal<span class="token punctuation">,</span>
  <span class="token number">7</span><span class="token punctuation">:</span>                         <span class="token boolean">nil</span><span class="token punctuation">,</span> <span class="token comment">// deprecated</span>
  <span class="token number">8</span><span class="token punctuation">:</span>                         a<span class="token punctuation">.</span>SubmitPoRepForBulkVerify<span class="token punctuation">,</span>
  <span class="token number">9</span><span class="token punctuation">:</span>                         a<span class="token punctuation">.</span>CurrentTotalPower<span class="token punctuation">,</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Vd={href:"https://spec.filecoin.io/#example-minerconstructorparams",target:"_blank",rel:"noopener noreferrer"},Ld=t(`<p>\u6B64\u5904\u5B9A\u4E49\u4E86\u5B58\u50A8\u77FF\u5DE5\u53C2\u4E0E\u8005\u7684\u6784\u9020\u51FD\u6570\u53C2\u6570\uFF0C\u4EE5\u4FBF\u9AD8\u7EA7\u53C2\u4E0E\u8005\u53EF\u4EE5\u5C06\u5B83\u4EEC\u53D1\u9001\u7ED9\u521D\u59CB\u5316\u53C2\u4E0E\u8005\u4EE5\u5B9E\u4F8B\u5316\u77FF\u5DE5\u3002\u4ECEv0\u5F00\u59CB\u66F4\u6539\uFF1A</p><ul><li>\u6DFB\u52A0\u4E86ControlAddrs</li></ul><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> MinerConstructorParams <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 OwnerAddr     addr<span class="token punctuation">.</span>Address
 WorkerAddr    addr<span class="token punctuation">.</span>Address
 ControlAddrs  <span class="token punctuation">[</span><span class="token punctuation">]</span>addr<span class="token punctuation">.</span>Address
 SealProofType abi<span class="token punctuation">.</span>RegisteredSealProof
 PeerId        abi<span class="token punctuation">.</span>PeerID
 Multiaddrs    <span class="token punctuation">[</span><span class="token punctuation">]</span>abi<span class="token punctuation">.</span>Multiaddrs
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),Nd={id:"_2-4-4-6-3\u529F\u7387\u8868",tabindex:"-1"},jd=n("a",{class:"header-anchor",href:"#_2-4-4-6-3\u529F\u7387\u8868","aria-hidden":"true"},"#",-1),Hd={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.storage_power_actor.the-power-table",target:"_blank",rel:"noopener noreferrer"},Od=t(`<p>\u7ED9\u5B9A\u77FF\u5DE5\u901A\u8FC7EC\u7684\u9886\u5BFC\u8005\u9009\u4E3E\u4EA7\u751F\u7684\u533A\u5757\u90E8\u5206\uFF08\u56E0\u6B64\u4ED6\u4EEC\u83B7\u5F97\u7684\u533A\u5757\u5956\u52B1\uFF09\u4E0E\u4ED6\u4EEC<code>Quality-Adjusted Power Fraction</code>\u7684\u65F6\u95F4\u6210\u6B63\u6BD4\u3002\u4E5F\u5C31\u662F\u8BF4\uFF0C\u8D28\u91CF\u8C03\u6574\u540E\u7684\u529F\u7387\u4EE3\u8868\u7F51\u7EDC\u4E0A\u603B\u8D28\u91CF\u8C03\u6574\u540E\u7684\u529F\u7387\u76841\uFF05\u7684\u77FF\u5DE5\u5E94\u6309\u9884\u671F\u5F00\u91C71\uFF05\u7684\u533A\u5757\u3002</p><p>SPC\u63D0\u4F9B\u4E86\u4E00\u4E2A\u529F\u7387\u8868\u62BD\u8C61\uFF0C\u53EF\u968F\u65F6\u95F4\u8DDF\u8E2A\u77FF\u5DE5\u529F\u7387\uFF08\u5373\u77FF\u5DE5\u5B58\u50A8\u76F8\u5BF9\u4E8E\u7F51\u7EDC\u5B58\u50A8\uFF09\u3002\u9488\u5BF9\u65B0\u7684\u90E8\u95E8\u627F\u8BFA\uFF08\u589E\u52A0\u77FF\u5DE5\u529F\u7387\uFF09\uFF0C\u5931\u8D25\u7684PoSt\uFF08\u51CF\u5C11\u77FF\u5DE5\u529F\u7387\uFF09\u6216\u5176\u4ED6\u5B58\u50A8\u548C\u5171\u8BC6\u6545\u969C\uFF0C\u66F4\u65B0\u4E86\u529F\u7387\u8868\u3002</p><p>\u90E8\u95E8ProveCommit\u662F\u7B2C\u4E00\u6B21\u5411\u7F51\u7EDC\u8BC1\u660E\u529F\u7387\uFF0C\u56E0\u6B64\uFF0C\u6210\u529F\u7684\u90E8\u95E8ProveCommit\u4F1A\u9996\u5148\u6DFB\u52A0\u529F\u7387\u3002\u5F53\u5BA3\u5E03\u4E00\u4E2A\u6247\u533A\u5DF2\u6062\u590D\u65F6\uFF0C\u4E5F\u4F1A\u6DFB\u52A0\u7535\u6E90\u3002\u77FF\u5DE5\u6709\u671B\u5728\u5176\u8D21\u732E\u529B\u91CF\u7684\u6240\u6709\u9886\u57DF\u8FDB\u884C\u8BC1\u660E\u3002</p><p>\u5F53\u6247\u533A\u5230\u671F\uFF0C\u58F0\u660E\u6216\u68C0\u6D4B\u5230\u6247\u533A\u6709\u6545\u969C\u6216\u901A\u8FC7\u77FF\u5DE5\u8C03\u7528\u7EC8\u6B62\u65F6\uFF0C\u529F\u7387\u4F1A\u964D\u4F4E\u3002\u77FF\u5DE5\u8FD8\u53EF\u4EE5\u901A\u8FC7\u5EF6\u957F\u90E8\u95E8\u7684\u5BFF\u547D<code>ExtendSectorExpiration</code>\u3002</p><p>\u529F\u7387\u8868\u4E2D\u7684Miner\u751F\u547D\u5468\u671F\u5E94\u5927\u81F4\u5982\u4E0B\uFF1A</p><ul><li><p><code>MinerRegistration</code>\uFF1A\u5B58\u50A8\u6316\u6398\u5B50\u7CFB\u7EDF\u5C06\u4E00\u4E2A\u5177\u6709\u5173\u8054\u5DE5\u4F5C\u4EBA\u5458\u516C\u7528\u5BC6\u94A5\u548C\u5730\u5740\u7684\u65B0\u77FF\u5DE5\u53CA\u5176\u5173\u8054\u7684\u6247\u533A\u5927\u5C0F\uFF08\u5728\u6BCF\u4E2A\u5DE5\u4F5C\u4EBA\u5458\u4E2D\u53EA\u6709\u4E00\u4E2A\uFF09\u6CE8\u518C\u5230\u4E86\u529F\u7387\u8868\u4E2D\u3002</p></li><li><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>UpdatePower
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\uFF1A\u8FD9\u4E9B\u529F\u7387\u589E\u91CF\u548C\u51CF\u91CF\u7531\u5404\u79CD\u5B58\u50A8\u53C2\u4E0E\u8005\u8C03\u7528\uFF08\u56E0\u6B64\u5FC5\u987B\u7531\u7F51\u7EDC\u4E0A\u7684\u6BCF\u4E2A\u5B8C\u6574\u8282\u70B9\u8FDB\u884C\u9A8C\u8BC1\uFF09\u3002\u7279\u522B\uFF1A</p><ul><li>\u529F\u7387\u589E\u52A0\u4E3A <code>SectorProveCommit</code></li><li>\u4E22\u5931WindowPoSt\uFF08<code>DetectedFault</code>\uFF09\u540E\uFF0C\u5206\u533A\u7684\u529F\u6548\u4F1A\u7ACB\u5373\u964D\u4F4E\u3002</li><li>\u5F53\u7279\u5B9A\u6247\u533A\u901A\u8FC7\u201C\u58F0\u660E\u7684\u6545\u969C\u201D\u6216\u201C\u8DF3\u8FC7\u7684\u6545\u969C\u201D\u8FDB\u5165\u6545\u969C\u72B6\u6001\u65F6\uFF0C\u5176\u529F\u7387\u5C06\u51CF\u5C0F\u3002</li><li>PoSt\u5BA3\u5E03\u5E76\u8BC1\u660E\u6062\u590D\u540E\uFF0C\u5C06\u589E\u52A0\u7279\u5B9A\u90E8\u95E8\u7684\u529B\u91CF\u3002</li><li>\u901A\u8FC7\u77FF\u5DE5\u53D1\u7968\u5230\u671F\u6216\u7EC8\u6B62\u67D0\u4E2A\u7279\u5B9A\u90E8\u95E8\u7684\u7535\u6E90\u540E\uFF0C\u8BE5\u7535\u6E90\u5C06\u88AB\u5220\u9664\u3002</li></ul></li></ul><p>\u603B\u800C\u8A00\u4E4B\uFF0C\u53EA\u6709\u5904\u4E8E\u6D3B\u52A8\u72B6\u6001\u7684\u6247\u533A\u624D\u80FD\u63A7\u5236\u7535\u6E90\u3002\u5728\u4E0A\u6DFB\u52A0\u6247\u533A\u540E\uFF0C\u8BE5\u6247\u533A\u5C06\u53D8\u4E3A\u6D3B\u52A8\u72B6\u6001<code>ProveCommit</code>\u3002\u8FDB\u5165\u6545\u969C\u72B6\u6001\u540E\uFF0C\u7535\u6E90\u7ACB\u5373\u51CF\u5C0F\u3002\u786E\u8BA4\u5DF2\u58F0\u660E\u6062\u590D\u540E\uFF0C\u7535\u6E90\u5373\u4F1A\u6062\u590D\u3002\u901A\u8FC7\u77FF\u5DE5\u8C03\u7528\u7EC8\u6B62\u6216\u7EC8\u6B62\u67D0\u4E2A\u6247\u533A\u7684\u7535\u6E90\u540E\uFF0C\u8BE5\u7535\u6E90\u5C06\u88AB\u5220\u9664\u3002</p>`,7),Ud={id:"_2-4-4-6-4\u8D28\u62BC\u62B5\u62BC\u54C1",tabindex:"-1"},zd=n("a",{class:"header-anchor",href:"#_2-4-4-6-4\u8D28\u62BC\u62B5\u62BC\u54C1","aria-hidden":"true"},"#",-1),Wd={href:"https://spec.filecoin.io/#section-systems.filecoin_blockchain.storage_power_consensus.storage_power_actor.pledge-collateral",target:"_blank",rel:"noopener noreferrer"},Zd=n("p",null,"\u8D28\u62BC\u62B5\u62BC\u54C1\u56E0\u5F71\u54CD\u5B58\u50A8\u7535\u6E90\u5171\u8BC6\u7684\u4EFB\u4F55\u6545\u969C\u800C\u88AB\u524A\u51CF\uFF0C\u5176\u4E2D\u5305\u62EC\uFF1A",-1),Kd={href:"https://spec.filecoin.io/#section-algorithms.expected_consensus.consensus-faults",target:"_blank",rel:"noopener noreferrer"},Qd=n("code",null,"StoragePowerActor",-1),Jd={href:"https://spec.filecoin.io/#section-systems.filecoin_markets.onchain_storage_market.faults.storage-faults",target:"_blank",rel:"noopener noreferrer"},Xd=n("code",null,"CronActor",-1),Yd={href:"https://spec.filecoin.io/#section-systems.filecoin_markets.onchain_storage_market.faults.storage-faults",target:"_blank",rel:"noopener noreferrer"},$d={href:"https://spec.filecoin.io/#section-systems.filecoin_mining.miner_collaterals",target:"_blank",rel:"noopener noreferrer"};function nk(sk,ak){const a=c("ExternalLinkIcon");return p(),i("div",null,[n("blockquote",null,[n("p",null,[s("\u7FFB\u8BD1\u81EA\uFF1A"),n("a",u,[s("https://spec.filecoin.io/#section-systems.filecoin_vm.interpreter"),e(a)])])]),r,n("h2",d,[k,s(" 2.1 "),n("a",v,[s("Filecoin\u8282\u70B9"),e(a)])]),m,b,h,n("h3",f,[_,s(" 2.1.1"),n("a",g,[s("\u8282\u70B9\u7C7B\u578B"),e(a)])]),y,n("h4",w,[x,s(" 2.1.1.1"),n("a",C,[s("\u8282\u70B9\u63A5\u53E3"),e(a)])]),n("p",null,[s("\u53EF\u4EE5\u5728"),n("a",S,[s("\u6B64\u5904"),e(a)]),s("\u627E\u5230Node\u63A5\u53E3\u7684Lotus\u5B9E\u73B0 \u3002")]),n("h4",F,[q,s(" 2.1.1.2"),n("a",P,[s("\u94FE\u9A8C\u8BC1\u5668\u8282\u70B9"),e(a)])]),A,n("p",null,[s("\u53EF\u4EE5\u5728"),n("a",B,[s("\u8FD9\u91CC"),e(a)]),s("\u627E\u5230Chain Verifier Node\u7684Lotus\u5B9E\u73B0 \u3002")]),n("h4",E,[T,s(" 2.1.1.3"),n("a",I,[s("\u5BA2\u6237\u7AEF\u8282\u70B9"),e(a)])]),R,n("p",null,[s("\u5BA2\u6237\u7AEF\u8282\u70B9\u7684Lotus\u5B9E\u73B0\u53EF\u4EE5\u5728"),n("a",M,[s("\u8FD9\u91CC"),e(a)]),s("\u627E\u5230 \u3002")]),n("h4",D,[G,s(" 2.1.1.4"),n("a",V,[s("\u5B58\u50A8\u77FF\u5DE5\u8282\u70B9"),e(a)])]),L,n("p",null,[s("\u53EF\u4EE5\u5728"),n("a",N,[s("\u6B64\u5904"),e(a)]),s("\u627E\u5230Storage Miner Node\u7684Lotus\u5B9E\u73B0 \u3002")]),n("h4",j,[H,s(" 2.1.1.5"),n("a",O,[s("\u68C0\u7D22\u77FF\u5DE5\u8282\u70B9"),e(a)])]),U,n("h4",z,[W,s(" 2.1.1.6"),n("a",Z,[s("\u4E2D\u7EE7\u8282\u70B9"),e(a)])]),K,n("h4",Q,[J,s(" 2.1.1.7"),n("a",X,[s("\u8282\u70B9\u914D\u7F6E"),e(a)])]),n("p",null,[s("\u53EF\u4EE5\u5728"),n("a",Y,[s("\u6B64\u5904"),e(a)]),s("\u627E\u5230Filecoin Node\u914D\u7F6E\u503C\u7684Lotus\u5B9E\u73B0 \u3002")]),n("h3",$,[nn,s(" 2.1.2"),n("a",sn,[s("\u8282\u70B9\u5B58\u50A8\u5E93"),e(a)])]),an,en,tn,n("p",null,[s("FileStore\u5B58\u50A8\u5E93\u7684Lotus\u5B9E\u73B0\u53EF\u4EE5\u5728"),n("a",on,[s("\u8FD9\u91CC"),e(a)]),s("\u627E\u5230 \u3002")]),n("h4",pn,[cn,s(" 2.1.2.1"),n("a",ln,[s("\u5BC6\u94A5\u5E93"),e(a)])]),un,rn,dn,n("ul",null,[kn,n("li",null,[vn,s("\u662F\u4E0E\u5B58\u50A8\u77FF\u5DE5\u53C2\u4E0E\u8005\u5730\u5740\u5173\u8054\u7684\u516C\u5171\u5BC6\u94A5\u3002\u53EF\u7531\u77FF\u5DE5\u9009\u62E9\u548C\u66F4\u6539\u3002\u8F85\u52A9\u5BC6\u94A5\u5BF9\u7528\u4E8E\u7B7E\u540D\u5757\uFF0C\u4E5F\u53EF\u4EE5\u7528\u4E8E\u7B7E\u540D\u5176\u4ED6\u6D88\u606F\u3002\u9274\u4E8E\u5B83\u662F"),n("a",mn,[s("\u53EF\u9A8C\u8BC1\u968F\u673A\u51FD\u6570\u7684"),e(a)]),s("\u4E00\u90E8\u5206\uFF0C\u5B83\u5FC5\u987B\u662FBLS\u5BC6\u94A5\u5BF9 \u3002")])]),bn,n("p",null,[s("\u5728"),n("a",hn,[s("Storage Miner Actor\u4E2D"),e(a)]),s("\u6307\u5B9A\u4E86\u66F4\u6539\u94FE\u4E0A\u5DE5\u4F5C\u7A0B\u5E8F\u5BC6\u94A5\u5BF9\uFF08\u5373\u4E0E\u5B58\u50A8\u77FF\u5DE5actor\u5173\u8054\u7684\u5DE5\u4F5C\u4EBA\u5458Key\uFF09\u7684\u8FC7\u7A0B \u3002\u8BF7\u6CE8\u610F\uFF0C\u8FD9\u662F\u4E00\u4E2A\u4E24\u6B65\u8FC7\u7A0B\u3002\u9996\u5148\uFF0C\u77FF\u5DE5\u901A\u8FC7\u5411\u94FE\u53D1\u9001\u6D88\u606F\u6765\u8FDB\u884C\u66F4\u6539\u3002\u7136\u540E\uFF0C\u77FF\u5DE5\u5728\u968F\u673A\u56DE\u6EAF\u65F6\u95F4\u4E4B\u540E\u786E\u8BA4\u5BC6\u94A5\u66F4\u6539\u3002\u6700\u540E\uFF0C\u5728\u989D\u5916\u7684\u968F\u673A\u56DE\u6EAF\u65F6\u95F4\u4E4B\u540E\uFF0C\u77FF\u5DE5\u5C06\u5F00\u59CB\u4F7F\u7528\u65B0\u5BC6\u94A5\u5BF9\u5757\u8FDB\u884C\u7B7E\u540D\u3002\u5B58\u5728\u6B64\u5EF6\u8FDF\u662F\u4E3A\u4E86\u9632\u6B62\u81EA\u9002\u5E94\u5BC6\u94A5\u9009\u62E9\u653B\u51FB\u3002")]),fn,n("h4",_n,[gn,s(" 2.1.2.2"),n("a",yn,[s("IPLD\u5546\u5E97"),e(a)])]),wn,xn,Cn,Sn,n("p",null,[s("\u6709\u5173IPLD\u7684\u66F4\u591A\u8BE6\u7EC6\u4FE1\u606F\uFF0C\u8BF7\u53C2\u89C1\u5176 "),n("a",Fn,[s("\u89C4\u8303"),e(a)]),s("\u3002")]),n("h5",qn,[Pn,s(" 2.1.2.2.1"),n("a",An,[s("\u6570\u636E\u6A21\u578B"),e(a)])]),n("p",null,[s("IPLD\u7684\u6838\u5FC3\u662F\u5B9A\u4E49\u7528\u4E8E\u8868\u793A\u6570\u636E\u7684 "),n("a",Bn,[s("\u6570\u636E\u6A21\u578B"),e(a)]),s("\u3002\u6570\u636E\u6A21\u578B\u65E8\u5728\u901A\u8FC7\u5404\u79CD\u7F16\u7A0B\u8BED\u8A00\u8FDB\u884C\u5B9E\u9645\u5B9E\u73B0\uFF0C\u540C\u65F6\u4FDD\u6301\u5BF9\u5185\u5BB9\u5BFB\u5740\u6570\u636E\u7684\u53EF\u7528\u6027\u4EE5\u53CA\u4E0E\u8BE5\u6570\u636E\u4EA4\u4E92\u7684\u5404\u79CD\u901A\u7528\u5DE5\u5177\u3002")]),n("p",null,[s("\u6570\u636E\u6A21\u578B\u5305\u62EC\u4E00\u7CFB\u5217\u6807\u51C6\u57FA\u672C\u7C7B\u578B\uFF08\u6216\u201C\u79CD\u7C7B\u201D\uFF09\uFF0C\u4F8B\u5982\u5E03\u5C14\uFF0C\u6574\u6570\uFF0C\u5B57\u7B26\u4E32\uFF0C\u7A7A\u503C\u548C\u5B57\u8282\u6570\u7EC4\uFF0C\u4EE5\u53CA\u4E24\u79CD\u9012\u5F52\u7C7B\u578B\uFF1A\u5217\u8868\u548C\u6620\u5C04\u3002\u7531\u4E8EIPLD\u662F\u4E3A\u5185\u5BB9\u5BFB\u5740\u6570\u636E\u800C\u8BBE\u8BA1\u7684\uFF0C\u56E0\u6B64IPLD\u5728\u5176\u6570\u636E\u6A21\u578B\u4E2D\u8FD8\u5305\u542B\u201C\u94FE\u63A5\u201D\u539F\u8BED\u3002\u5B9E\u9645\u4E0A\uFF0C\u94FE\u63A5\u4F7F\u7528 "),n("a",En,[s("CID"),e(a)]),s("\u89C4\u8303\u3002IPLD\u6570\u636E\u88AB\u7EC4\u7EC7\u4E3A\u201C\u5757\u201D\uFF0C\u5176\u4E2D\u4E00\u4E2A\u5757\u7531\u539F\u59CB\u7F16\u7801\u6570\u636E\u53CA\u5176\u5185\u5BB9\u5730\u5740\u6216CID\u8868\u793A\u3002\u6BCF\u4E2A\u5185\u5BB9\u53EF\u5BFB\u5740\u7684\u6570\u636E\u5757\u90FD\u53EF\u4EE5\u8868\u793A\u4E3A\u4E00\u4E2A\u5757\uFF0C\u5E76\u4E14\u5757\u53EF\u4EE5\u4E00\u8D77\u5F62\u6210\u4E00\u4E2A\u76F8\u5E72\u56FE\u6216 "),n("a",Tn,[s("Merkle DAG"),e(a)]),s("\u3002")]),n("p",null,[s("\u5E94\u7528\u7A0B\u5E8F\u901A\u8FC7\u6570\u636E\u6A21\u578B\u4E0EIPLD\u4EA4\u4E92\uFF0C\u800CIPLD\u901A\u8FC7\u4E00\u7EC4\u7F16\u89E3\u7801\u5668\u5904\u7406\u7F16\u7EC4\u548C\u89E3\u7EC4\u3002IPLD\u7F16\u89E3\u7801\u5668\u53EF\u80FD\u652F\u6301\u5B8C\u6574\u7684\u6570\u636E\u6A21\u578B\u6216\u90E8\u5206\u6570\u636E\u6A21\u578B\u3002\u652F\u6301\u5B8C\u6574\u6570\u636E\u6A21\u578B\u7684\u4E24\u4E2A\u7F16\u89E3\u7801\u5668\u662F "),n("a",In,[s("DAG-CBOR"),e(a)]),s("\u548C "),n("a",Rn,[s("DAG-JSON"),e(a)]),s("\u3002\u8FD9\u4E9B\u7F16\u89E3\u7801\u5668\u5206\u522B\u57FA\u4E8ECBOR\u548CJSON\u5E8F\u5217\u5316\u683C\u5F0F\uFF0C\u4F46\u5305\u62EC\u5141\u8BB8\u5B83\u4EEC\u5C01\u88C5IPLD\u6570\u636E\u6A21\u578B\uFF08\u5305\u62EC\u5176\u94FE\u63A5\u7C7B\u578B\uFF09\u7684\u89C4\u8303\u5316\u4EE5\u53CA\u53EF\u5728\u4EFB\u4F55\u6570\u636E\u96C6\u53CA\u5176\u5404\u81EA\u7684\u5185\u5BB9\u5730\u5740\uFF08\u6216\u54C8\u5E0C\u6458\u8981\uFF09\u3002\u8FD9\u4E9B\u89C4\u5219\u5305\u62EC\u5728\u5BF9\u5730\u56FE\u8FDB\u884C\u7F16\u7801\u65F6\u5BF9\u952E\u7684\u7279\u5B9A\u987A\u5E8F\u8FDB\u884C\u89C4\u5B9A\uFF0C\u6216\u8005\u5728\u5B58\u50A8\u65F6\u5BF9\u6574\u6570\u7C7B\u578B\u8FDB\u884C\u5927\u5C0F\u8C03\u6574\u3002")]),n("h5",Mn,[Dn,s(" 2.1.2.2.2 "),n("a",Gn,[s("Filecoin\u4E2D\u7684IPLD"),e(a)])]),Vn,Ln,Nn,n("h6",jn,[Hn,s(" 2.1.2.2.2.1"),n("a",On,[s("IpldStores"),e(a)])]),Un,n("ul",null,[zn,n("li",null,[s("\u4E00\u79CD"),Wn,s("\u5B58\u50A8\u6765\u81EA\u7ED9\u5B9A"),Zn,s("\u533A\u5757\u94FE\u7684\u6709\u6548\u8D1F\u8F7D\u72B6\u6001\uFF0C\u6216\u8005\u5B58\u50A8\u7531"),n("a",Kn,[s("Filecoin VM"),e(a)]),s("\u5E94\u7528\u4E8E\u7ED9\u5B9A\u72B6\u6001\u7684\u7ED9\u5B9A\u94FE\u4E2D\u6240\u6709\u5757\u6D88\u606F\u7684 "),n("a",Qn,[s("\u7ED3\u679C"),e(a)]),s("\u3002")])]),n("p",null,[s("\u7684"),Jn,s("\u662F\u901A\u8FC7\u4ECE\u4ED6\u4EEC\u7684\u540C\u8F88\u8282\u70B9\u4E2D\u7684\u5F15\u5BFC\u9636\u6BB5\u4E0B\u8F7D "),n("a",Xn,[s("\u94FE\u540C\u6B65"),e(a)]),s("\uFF0C\u5E76\u4E14\u7531\u8282\u70B9\u6B64\u540E\u88AB\u5B58\u50A8\u3002\u6BCF\u6B21\u63A5\u6536\u5230\u65B0\u7684\u5757\u65F6\uFF0C\u6216\u8005\u8282\u70B9\u540C\u6B65\u5230\u65B0\u7684\u6700\u4F73\u94FE\u65F6\uFF0C\u5B83\u90FD\u4F1A\u66F4\u65B0\u3002")]),n("p",null,[s("\u7684"),Yn,s("\u662F\u901A\u8FC7\u5728\u7ED9\u5B9A\u7684\u6240\u6709\u5757\u6D88\u606F\u7684\u6267\u884C\u8BA1\u7B97"),$n,s("\uFF0C\u5E76\u4E14\u7531\u8282\u70B9\u6B64\u540E\u88AB\u5B58\u50A8\u3002"),n("a",ns,[s("VM\u89E3\u91CA\u5668\u4F1A"),e(a)]),s("\u4F7F\u7528\u6BCF\u4E2A\u65B0\u4F20\u5165\u5757\u7684\u5904\u7406\u5BF9\u5176\u8FDB\u884C\u66F4\u65B0 \uFF0C\u5E76\u76F8\u5E94\u5730\u7531\u5728"),n("a",ss,[s("\u5757\u6807\u9898"),e(a)]),s(),as,s("\u5B57\u6BB5\u4E2D\u5728\u5176\u4E0A\u65B9\u751F\u6210\u7684\u65B0\u5757\u8FDB\u884C\u5F15\u7528 \u3002")]),es,ts,n("p",null,[s("libp2p\u7684\u5B8C\u6574\u89C4\u8303\u53EF\u4EE5\u5728"),n("a",os,[s("https://github.com/libp2p/specs\u4E2D"),e(a)]),s("\u627E\u5230 \u3002\u8FD9\u662FFilecoin\u4F7F\u7528\u7684libp2p\u534F\u8BAE\u7684\u5217\u8868\u3002")]),n("ul",null,[n("li",null,[ps,s(" Graphsync\u662F\u4E00\u79CD\u7528\u4E8E\u5728\u5BF9\u7B49\u70B9\u4E4B\u95F4\u540C\u6B65\u56FE\u7684\u534F\u8BAE\u3002\u5B83\u7528\u4E8E\u5728Filecoin\u8282\u70B9\u4E4B\u95F4\u5F15\u7528\uFF0C\u5BFB\u5740\uFF0C\u8BF7\u6C42\u548C\u4F20\u8F93\u533A\u5757\u94FE\u548C\u7528\u6237\u6570\u636E\u3002\u6240\u8FF0 "),n("a",is,[s("GraphSync\u7684\u8349\u6848\u89C4\u8303"),e(a)]),s("\u63D0\u4F9B\u7684\u6982\u5FF5\uFF0C\u63A5\u53E3\u548C\u7531GraphSync\u4F7F\u7528\u7684\u7F51\u7EDC\u6D88\u606F\u7684\u66F4\u591A\u7EC6\u8282\u3002\u534F\u8BAEID\u6CA1\u6709Filecoin\u7279\u5B9A\u7684\u4FEE\u6539\u3002")]),n("li",null,[s("**Gossipsub\uFF1A**\u4F7F\u7528\u57FA\u4E8EGossip\u7684pubsub\u534F\u8BAE\uFF08\u7F29\u5199\u4E3A*GossipSub\uFF09\uFF0C*\u901A\u8FC7Filecoin\u7F51\u7EDC\u4F20\u64AD\u5757\u5934\u548C\u6D88\u606F\u3002\u4E0E\u4F20\u7EDF\u7684pubsub\u534F\u8BAE\u4E00\u6837\uFF0C\u8282\u70B9\u8BA2\u9605\u4E3B\u9898\u5E76\u63A5\u6536\u5728\u8FD9\u4E9B\u4E3B\u9898\u4E0A\u53D1\u5E03\u7684\u6D88\u606F\u3002\u5F53\u8282\u70B9\u4ECE\u5176\u8BA2\u9605\u7684\u4E3B\u9898\u63A5\u6536\u6D88\u606F\u65F6\uFF0C\u5B83\u4EEC\u5C06\u8FD0\u884C\u9A8C\u8BC1\u8FC7\u7A0B\uFF0C\u5E76\u4E14i\uFF09\u5C06\u6D88\u606F\u4F20\u9012\u7ED9\u5E94\u7528\u7A0B\u5E8F\uFF1B ii\uFF09\u5C06\u6D88\u606F\u8FDB\u4E00\u6B65\u8F6C\u53D1\u7ED9\u4ED6\u4EEC\u77E5\u9053\u5DF2\u8BA2\u9605\u540C\u4E00\u4E3B\u9898\u7684\u8282\u70B9\u3002\u6B64\u5916\uFF0CFileCoin\u4E2D\u4F7F\u7528\u7684GossipSub v1.1\u7248\u672C\u901A\u8FC7\u5B89\u5168\u673A\u5236\u8FDB\u884C\u4E86\u589E\u5F3A\uFF0C\u8BE5\u673A\u5236\u4F7F\u534F\u8BAE\u53EF\u4EE5\u62B5\u5FA1\u5B89\u5168\u653B\u51FB\u3002\u8BE5 "),n("a",cs,[s("GossipSub\u89C4\u683C"),e(a)]),s("\u63D0\u4F9B\u6709\u5173\u5176\u8BBE\u8BA1\u548C\u5B9E\u73B0\u7684\u6240\u6709\u534F\u8BAE\u8BE6\u7EC6\u4FE1\u606F\uFF0C\u4EE5\u53CA\u534F\u8BAE\u53C2\u6570\u7684\u7279\u5B9A\u8BBE\u7F6E\u3002\u5C1A\u672A\u5BF9\u534F\u8BAEID\u8FDB\u884Cfilecoin\u7684\u7279\u5B9A\u4FEE\u6539\u3002\u4F46\u662F\u8BDD\u9898\u6807\u8BC6\u5FC5\u987B\u662F\u5F62\u5F0F"),ls,s("\u548C"),us]),n("li",null,[rs,s(" Kademlia DHT\u662F\u4E00\u4E2A\u5206\u5E03\u5F0F\u54C8\u5E0C\u8868\uFF0C\u5728\u7279\u5B9A\u8282\u70B9\u7684\u6700\u5927\u67E5\u627E\u6570\u4E0A\u5177\u6709\u5BF9\u6570\u8303\u56F4\u3002\u5728Filecoin\u7F51\u7EDC\u4E2D\uFF0CKademlia DHT\u4E3B\u8981\u7528\u4E8E\u5BF9\u7B49\u53D1\u73B0\u548C\u5BF9\u7B49\u8DEF\u7531\u3002\u7279\u522B\u662F\uFF0C\u5F53\u4E00\u4E2A\u8282\u70B9\u60F3\u8981\u5728Filecoin\u7F51\u7EDC\u4E2D\u5B58\u50A8\u6570\u636E\u65F6\uFF0C\u5B83\u4EEC\u4F1A\u83B7\u5F97\u4E00\u4E2A\u77FF\u5DE5\u5217\u8868\u53CA\u5176\u8282\u70B9\u4FE1\u606F\u3002\u8BE5\u8282\u70B9\u4FE1\u606F\uFF08\u9664\u5176\u4ED6\u5916\uFF09\u5305\u62EC\u77FF\u5DE5\u7684PeerID\u3002\u4E3A\u4E86\u8FDE\u63A5\u5230\u77FF\u5DE5\u5E76\u4EA4\u6362\u6570\u636E\uFF0C\u60F3\u8981\u5728\u7F51\u7EDC\u4E2D\u5B58\u50A8\u6570\u636E\u7684\u8282\u70B9\u5FC5\u987B\u627E\u5230\u77FF\u5DE5\u7684\u591A\u5730\u5740\uFF0C\u4ED6\u4EEC\u901A\u8FC7\u67E5\u8BE2DHT\u6765\u5B9E\u73B0\u3002\u6240\u8FF0 "),n("a",ds,[s("libp2p\u5580DHT\u89C4\u8303"),e(a)]),s("\u63D0\u4F9B\u4E86DHT\u7ED3\u6784\u7684\u5B9E\u73B0\u7EC6\u8282\u3002\u5BF9\u4E8EFilecoin\u7F51\u7EDC\uFF0C\u534F\u8BAEID\u7684\u683C\u5F0F\u5FC5\u987B\u4E3A"),ks,s("\u3002")]),vs,ms]),n("h3",bs,[hs,s(" 2.1.4"),n("a",fs,[s("\u65F6\u949F"),e(a)])]),_s,gs,n("h4",ys,[ws,s(" 2.1.4.1"),n("a",xs,[s("\u65F6\u949F\u7528\u9014"),e(a)])]),Cs,n("ul",null,[n("li",null,[s("\u901A\u8FC7\u540C\u6B65\u8282\u70B9\u6765\u9A8C\u8BC1\u4F20\u5165\u5757\u662F\u5426\u5728\u7ED9\u5B9A\u65F6\u95F4\u6233\u7684\u9002\u5F53\u7EAA\u5143\u5185\u88AB\u6316\u6398\uFF08\u8BF7\u53C2\u89C1 "),n("a",Ss,[s("\u5757\u9A8C\u8BC1"),e(a)]),s("\uFF09\u3002\u8FD9\u662F\u53EF\u80FD\u7684\uFF0C\u56E0\u4E3A\u7CFB\u7EDF\u65F6\u949F\u59CB\u7EC8\u5C06\u65F6\u95F4\u6620\u5C04\u5230\u552F\u4E00\u7684\u7EAA\u5143\u53F7\uFF0C\u8BE5\u7EAA\u5143\u53F7\u5B8C\u5168\u7531\u521B\u4E16\u5757\u4E2D\u7684\u5F00\u59CB\u65F6\u95F4\u786E\u5B9A\u3002")]),Fs,n("li",null,[s("\u901A\u8FC7\u5141\u8BB8\u8282\u70B9\u5728\u4E0B\u4E00\u8F6E\u5C1D\u8BD5\u9886\u5BFC\u8005\u9009\u4E3E\uFF08\u5982\u679C\u5728\u5F53\u524D\u8F6E\u4E2D\u6CA1\u6709\u4EBA\u4EA7\u751F\u963B\u788D\u7684\u60C5\u51B5\u4E0B\uFF09\u6765\u6316\u6398\u8282\u70B9\uFF0C\u4EE5\u4FDD\u6301\u534F\u8BAE\u7684\u6D3B\u8DC3\u6027\uFF08\u8BF7\u53C2\u9605 "),n("a",qs,[s("\u5B58\u50A8\u7535\u6E90\u5171\u8BC6"),e(a)]),s("\uFF09\u3002")])]),Ps,n("ol",null,[n("li",null,[s("\u76F8\u5BF9\u4E8E\u5176\u4ED6\u8282\u70B9\u5177\u6709\u8DB3\u591F\u4F4E\u7684\u504F\u79FB\u91CF\uFF0C\u4EE5\u4F7F\u4ECE\u5176\u4ED6\u8282\u70B9\u7684\u89D2\u5EA6\u6765\u770B\uFF0C\u4E0D\u4F1A\u5728\u88AB\u8BA4\u4E3A\u662F\u672A\u6765\u7EAA\u5143\u7684\u7EAA\u5143\u4E2D\u5F00\u91C7\u533A\u5757\uFF08\u8FD9\u4E9B\u533A\u5757\u76F4\u5230\u6839\u636E"),n("a",As,[s("\u9A8C\u8BC1\u89C4\u5219"),e(a)]),s("\u7684\u6B63\u786E\u7EAA\u5143/\u65F6\u95F4\u624D\u88AB "),n("a",Bs,[s("\u9A8C\u8BC1"),e(a)]),s("\uFF09\u3002")]),Es]),Ts,n("h4",Is,[Rs,s(" 2.1.4.2"),n("a",Ms,[s("\u65F6\u949F\u8981\u6C42"),e(a)])]),Ds,n("p",null,[s("\u9884\u8BA1\u8BA1\u7B97\u673A\u7EA7\u6676\u4F53\u7684\u504F\u5DEE\u4E3A "),n("a",Gs,[s("1ppm"),e(a)]),s("\uFF08\u5373\u6BCF\u79D21\u5FAE\u79D2\uFF0C\u6216\u6BCF\u54680.6\u79D2\uFF09\u3002\u56E0\u6B64\uFF0C\u4E3A\u4E86\u9075\u5B88\u4E0A\u8FF0\u8981\u6C42\uFF1A")]),n("ul",null,[n("li",null,[s("\u8282\u70B9\u5E94\u8FD0\u884CNTP\u5B88\u62A4\u7A0B\u5E8F\uFF08\u4F8B\u5982timesyncd\uFF0Cntpd\uFF0Cchronyd\uFF09\uFF0C\u4EE5\u4F7F\u5176\u65F6\u949F\u4E0E\u4E00\u4E2A\u6216\u591A\u4E2A\u53EF\u9760\u7684\u5916\u90E8\u5F15\u7528\u4FDD\u6301\u540C\u6B65\u3002 "),n("ul",null,[n("li",null,[s("\u6211\u4EEC\u5EFA\u8BAE\u4EE5\u4E0B\u6765\u6E90\uFF1A "),n("ul",null,[n("li",null,[Vs,s("\uFF08 "),n("a",Ls,[s("\u8BE6\u7EC6"),e(a)]),s("\uFF09")]),n("li",null,[Ns,s("\uFF08 "),n("a",js,[s("\u8BE6\u7EC6"),e(a)]),s("\uFF09")]),n("li",null,[Hs,s("\uFF08 "),n("a",Os,[s("\u8BE6\u7EC6"),e(a)]),s("\uFF09")]),n("li",null,[Us,s("\uFF08 "),n("a",zs,[s("\u8BE6\u7EC6"),e(a)]),s("\uFF09")])])])])]),Ws]),Zs,n("h2",Ks,[Qs,s(" 2.2"),n("a",Js,[s("\u6587\u4EF6\u548C\u6570\u636E"),e(a)])]),Xs,n("h3",Ys,[$s,s(" 2.2.1"),n("a",na,[s("\u6587\u4EF6"),e(a)])]),n("p",null,[n("a",sa,[s("\u4F8B\uFF1A"),e(a)])]),aa,n("h4",ea,[ta,s(" 2.2.1.1"),n("a",oa,[s("FileStore-\u6587\u4EF6\u7684\u672C\u5730\u5B58\u50A8"),e(a)])]),pa,n("p",null,[n("a",ia,[s("\u4F8B\uFF1A"),e(a)])]),ca,n("h5",la,[ua,s(" 2.2.1.1.1"),n("a",ra,[s("\u53D8\u5316\u7684\u7528\u6237\u9700\u6C42"),e(a)])]),da,n("h5",ka,[va,s(" 2.2.1.1.2"),n("a",ma,[s("\u5B9E\u65BD\u5B9E\u4F8B"),e(a)])]),ba,n("h3",ha,[fa,s(" 2.2.2"),n("a",_a,[s("\u6587\u4EF6\u5E01\u7247"),e(a)])]),ga,n("h4",ya,[wa,s(" 2.2.2.1"),n("a",xa,[s("\u6570\u636E\u8868\u793A"),e(a)])]),Ca,Sa,Fa,n("ol",null,[qa,n("li",null,[s("\u4E3A\u4E86\u5236\u4F5C"),Pa,s("\uFF0CIPLD DAG\u88AB\u5E8F\u5217\u5316\u4E3A "),n("a",Aa,[s("\u201C Content-Addressable aRchive\u201D\uFF08\u3002car\uFF09"),e(a)]),s("\u6587\u4EF6\uFF0C\u8BE5\u6587\u4EF6\u4E3A\u539F\u59CB\u5B57\u8282\u683C\u5F0F\u3002CAR\u6587\u4EF6\u662F\u4E00\u4E2A\u4E0D\u900F\u660E\u7684\u6570\u636E\u5757\uFF0C\u53EF\u6253\u5305\u5728\u4E00\u8D77\u5E76\u4F20\u8F93IPLD\u8282\u70B9\u3002\u8BE5"),Ba,s("\u662FCAR'ed\u548C\u672ACAR'ed\u7ED3\u6784\u4E4B\u95F4\u5E38\u89C1\u3002\u5F53\u7A0D\u540E\u5728\u5B58\u50A8\u5BA2\u6237\u7AEF\u548C\u5B58\u50A8\u63D0\u4F9B\u8005\u4E4B\u95F4\u4F20\u8F93\u6570\u636E\u65F6\uFF0C\u8FD9\u5C06\u5728\u7A0D\u540E\u7684\u6570\u636E\u68C0\u7D22\u671F\u95F4\u6709\u6240\u5E2E\u52A9\u3002")]),Ea]),Ta,n("h4",Ia,[Ra,s(" 2.2.2.2"),n("a",Ma,[s("\u4EF6\u5546\u5E97"),e(a)])]),n("p",null,[s("\u8BE5"),Da,s("\u6A21\u5757\u5141\u8BB8\u4ECE\u672C\u5730\u5B58\u50A8\u4E2D\u5B58\u50A8\u548C\u68C0\u7D22\u788E\u7247\u3002\u96F6\u914D\u4EF6\u5546\u5E97\u7684\u4E3B\u8981\u76EE\u6807\u662F\u5E2E\u52A9 "),n("a",Ga,[s("\u5B58\u50A8"),e(a)]),s("\u548C "),n("a",Va,[s("\u68C0\u7D22\u5E02\u573A"),e(a)]),s("\u6A21\u5757\u67E5\u627E\u5BC6\u5C01\u6570\u636E\u5728\u90E8\u95E8\u5185\u90E8\u7684\u4F4D\u7F6E\u3002\u5B58\u50A8\u5E02\u573A\u5199\u5165\u6570\u636E\uFF0C\u800C\u68C0\u7D22\u5E02\u573A\u8BFB\u53D6\u6570\u636E\uFF0C\u4EE5\u4FBF\u53D1\u9001\u7ED9\u68C0\u7D22\u5BA2\u6237\u3002")]),n("p",null,[s("\u5728"),n("a",La,[s("\u6B64\u5904"),e(a)]),s("\u53EF\u4EE5\u627E\u5230PieceStore\u6A21\u5757\u7684\u5B9E\u73B0 \u3002")]),n("h3",Na,[ja,s(" 2.2.3"),n("a",Ha,[s("Filecoin\u4E2D\u7684\u6570\u636E\u4F20\u8F93"),e(a)])]),Oa,Ua,za,n("h4",Wa,[Za,s(" 2.2.3.1"),n("a",Ka,[s("\u6A21\u7EC4"),e(a)])]),Qa,Ja,n("h4",Xa,[Ya,s(" 2.2.3.2"),n("a",$a,[s("\u672F\u8BED"),e(a)])]),n("ul",null,[ne,n("li",null,[se,s("\uFF1A\u4F20\u8F93\u7A0B\u5E8F\u4F7F\u7528\u7684\u9ED8\u8BA4\u57FA\u7840\u4F20\u8F93\u534F\u8BAE\u3002\u5B8C\u6574\u7684graphsync\u89C4\u8303\u53EF\u5728"),n("a",ae,[s("\u6B64\u5904"),e(a)]),s("\u627E\u5230")])]),n("h4",ee,[te,s(" 2.2.3.3"),n("a",oe,[s("\u8BF7\u6C42\u9636\u6BB5"),e(a)])]),pe,ie,n("p",null,[s("\u8BF7\u6CE8\u610F\uFF0C\u201C\u534F\u5546\u201D\u548C\u201C\u8F6C\u79FB\u201D\u9636\u6BB5\u53EF\u4EE5\u53D1\u751F\u5728\u5355\u72EC\u7684\u5F80\u8FD4\u884C\u7A0B\u4E2D\uFF0C\u4E5F\u53EF\u80FD\u5728\u76F8\u540C\u7684\u5F80\u8FD4\u884C\u7A0B\u4E2D\u53D1\u751F\uFF0C\u5176\u4E2D\u8BF7\u6C42\u65B9\u901A\u8FC7\u53D1\u9001\u8BF7\u6C42\u9690\u5F0F\u5730\u540C\u610F\uFF0C\u800C\u54CD\u5E94\u65B9\u53EF\u4EE5\u540C\u610F\u5E76\u7ACB\u5373\u53D1\u9001\u6216\u63A5\u6536\u6570\u636E\u3002\u8BE5\u8FC7\u7A0B\u662F\u5728\u4E00\u6B21\u8FD8\u662F\u591A\u6B21\u5F80\u8FD4\u4E2D\u8FDB\u884C\uFF0C\u90E8\u5206\u53D6\u51B3\u4E8E\u8BF7\u6C42\u662F\u63A8\u5F0F\u8BF7\u6C42\uFF08\u5B58\u50A8\u4EA4\u6613\uFF09\u8FD8\u662F\u62C9\u53D6\u8BF7\u6C42\uFF08\u68C0\u7D22\u4EA4\u6613\uFF09\uFF0C\u4EE5\u53CA\u6570\u636E\u4F20\u8F93\u534F\u5546\u8FC7\u7A0B\u662F\u5426\u80FD\u591F\u6267\u884C\u56DE\u5230\u5E95\u5C42\u7684\u8FD0\u8F93\u673A\u5236\u4E0A\u3002\u5728\u4F7F\u7528GraphSync\u4F5C\u4E3A\u4F20\u8F93\u673A\u5236\u7684\u60C5\u51B5\u4E0B\uFF0C\u53EF\u4EE5\u4F7F\u7528"),n("a",ce,[s("GraphSync\u7684\u5185\u7F6E\u53EF\u6269\u5C55\u6027"),e(a)]),s("\u5C06\u6570\u636E\u4F20\u8F93\u8BF7\u6C42\u4F5C\u4E3A\u5BF9GraphSync\u534F\u8BAE "),n("a",le,[s("\u7684\u6269\u5C55"),e(a)]),s("\u3002\u56E0\u6B64\uFF0C\u62C9\u53D6\u8BF7\u6C42\u4EC5\u9700\u8981\u4E00\u6B21\u5F80\u8FD4\u3002\u4F46\u662F\uFF0C\u7531\u4E8EGraphsync\u662F\u4E0D\u76F4\u63A5\u652F\u6301"),ue,s("\u7C7B\u578B\u8BF7\u6C42\u7684\u8BF7\u6C42/\u54CD\u5E94\u534F\u8BAE\uFF0C\u56E0\u6B64\u5728Push\u60C5\u51B5\u4E0B\uFF0C\u534F\u5546\u662F\u901A\u8FC7\u6570\u636E\u4F20\u8F93\u81EA\u8EAB\u7684libp2p\u534F\u8BAE\u5728\u5355\u72EC\u7684\u8BF7\u6C42\u4E2D\u8FDB\u884C\u7684"),re,s("\u3002\u5176\u4ED6\u672A\u6765\u7684\u8FD0\u8F93\u673A\u5236\u53EF\u80FD\u4F1A\u540C\u65F6\u5904\u7406\u201C\u63A8\u201D\u548C\u201C\u63A8\u201D\uFF0C\u4E5F\u53EF\u80FD\u4E0D\u4F1A\u4E00\u6B21\u5904\u7406\u3002\u63A5\u6536\u5230\u6570\u636E\u4F20\u8F93\u8BF7\u6C42\u540E\uFF0C\u6570\u636E\u4F20\u8F93\u6A21\u5757\u4F1A\u5BF9\u51ED\u8BC1\u8FDB\u884C\u89E3\u7801\uFF0C\u5E76\u5C06\u5176\u4EA4\u4ED8\u7ED9\u8BF7\u6C42\u9A8C\u8BC1\u5668\u3002\u5728\u5B58\u50A8\u4EA4\u6613\u4E2D\uFF0C\u8BF7\u6C42\u9A8C\u8BC1\u7A0B\u5E8F\u68C0\u67E5\u6240\u5305\u542B\u7684\u4EA4\u6613\u662F\u5426\u662F\u6536\u4EF6\u4EBA\u4E4B\u524D\u5DF2\u7ECF\u540C\u610F\u7684\u4EA4\u6613\u3002\u5BF9\u4E8E\u68C0\u7D22\u4EA4\u6613\uFF0C\u8BF7\u6C42\u5305\u62EC\u6709\u5173\u68C0\u7D22\u4EA4\u6613\u672C\u8EAB\u7684\u5EFA\u8BAE\u3002\u53EA\u8981\u8BF7\u6C42\u9A8C\u8BC1\u8005\u63A5\u53D7\u4EA4\u6613\u5EFA\u8BAE\uFF0C\u6240\u6709\u64CD\u4F5C\u90FD\u5C06\u4F5C\u4E3A\u4E00\u6B21\u5F80\u8FD4\u7ACB\u5373\u5B8C\u6210\u3002")]),de,n("h4",ke,[ve,s(" 2.2.3.6"),n("a",me,[s("\u534F\u8BAE"),e(a)])]),be,he,n("h4",fe,[_e,s(" 2.2.3.7"),n("a",ge,[s("\u6570\u636E\u7ED3\u6784"),e(a)])]),n("p",null,[n("a",ye,[s("\u793A\u4F8B\uFF1A\u6570\u636E\u4F20\u8F93\u7C7B\u578B"),e(a)])]),we,n("p",null,[n("a",xe,[s("\u793A\u4F8B\uFF1A\u6570\u636E\u4F20\u8F93\u72B6\u6001"),e(a)])]),Ce,n("p",null,[n("a",Se,[s("\u793A\u4F8B\uFF1A\u6570\u636E\u4F20\u8F93\u7BA1\u7406\u5668"),e(a)])]),Fe,n("h3",qe,[Pe,s(" 2.2.4"),n("a",Ae,[s("\u6570\u636E\u683C\u5F0F\u548C\u5E8F\u5217\u5316"),e(a)])]),Be,n("p",null,[s("\u5728"),n("a",Ee,[s("\u6B64\u5904\u4E86\u89E3\u6709\u5173CBOR\u4F7F\u7528\u60C5\u51B5"),e(a)]),s("\u548C "),n("a",Te,[s("Filecoin\u4E2D\u7684"),e(a)]),n("a",Ie,[s("int\u7C7B\u578B\u7684"),e(a)]),s("\u66F4\u591A\u8BBE\u8BA1\u6CE8\u610F "),n("a",Re,[s("\u4E8B\u9879"),e(a)]),s("\u3002")]),n("h4",Me,[De,s(" 2.2.4.1"),n("a",Ge,[s("\u8D44\u6599\u683C\u5F0F"),e(a)])]),Ve,n("p",null,[s("\u60A8\u8FD8\u53EF\u4EE5\u5728Filecoin\u534F\u8BAE\u4E2D\u9605\u8BFB\u6709\u5173"),n("a",Le,[s("\u6570\u636E\u683C\u5F0F\u7684"),e(a)]),s("\u66F4\u591A "),n("a",Ne,[s("\u4FE1\u606F\uFF0C\u4F5C\u4E3A\u968F\u673A\u6027\u751F\u6210"),e(a)]),s("\u7684\u4E00\u90E8\u5206\u3002")]),n("h4",je,[He,s(" 2.2.4.2"),n("a",Oe,[s("\u5E8F\u5217\u5316"),e(a)])]),Ue,n("p",null,[s("Filecoin\u4E2D\u7684\u6240\u6709\u6570\u636E\u7ED3\u6784\u90FD\u662F "),n("a",ze,[s("CBOR"),e(a)]),s("\u5143\u7EC4\u7F16\u7801\u7684\u3002\u4E5F\u5C31\u662F\u8BF4\uFF0C\u5728Filecoin\u7CFB\u7EDF\u4E2D\u4F7F\u7528\u7684\u4EFB\u4F55\u6570\u636E\u7ED3\u6784\uFF08\u672C\u89C4\u8303\u4E2D\u7684\u7ED3\u6784\uFF09\u90FD\u5E94\u6309\u58F0\u660E\u987A\u5E8F\u5E8F\u5217\u5316\u4E3ACBOR\u6570\u7EC4\uFF0C\u5E76\u5E26\u6709\u4E0E\u6570\u636E\u7ED3\u6784\u5B57\u6BB5\u76F8\u5BF9\u5E94\u7684\u9879\u3002")]),n("p",null,[s("\u4F60\u53EF\u4EE5\u627E\u5230\u5728CBOR\u4E3B\u8981\u6570\u636E\u7C7B\u578B\u7684\u7F16\u7801\u7ED3\u6784 "),n("a",We,[s("\u5728\u8FD9\u91CC"),e(a)]),s("\u3002")]),Ze,n("h2",Ke,[Qe,s(" 2.3"),n("a",Je,[s("\u865A\u62DF\u673A"),e(a)])]),Xe,Ye,$e,n("h3",nt,[st,s(" 2.3.1"),n("a",at,[s("VM Actor\u63A5\u53E3"),e(a)])]),et,n("p",null,[n("a",tt,[s("\u4F8B\uFF1A"),e(a)])]),ot,n("h3",pt,[it,s(" 2.3.2"),n("a",ct,[s("\u72B6\u6001\u6811"),e(a)])]),lt,n("p",null,[n("a",ut,[s("\u793A\u4F8B\uFF1AStateTree"),e(a)])]),rt,n("h3",dt,[kt,s(" 2.3.3"),n("a",vt,[s("VM\u6D88\u606F-Actor\u65B9\u6CD5\u8C03\u7528"),e(a)])]),mt,bt,ht,ft,n("h4",_t,[gt,s(" 2.3.3.1"),n("a",yt,[s("\u6D88\u606F\u8BED\u6CD5\u9A8C\u8BC1"),e(a)])]),wt,n("h4",xt,[Ct,s(" 2.3.3.2"),n("a",St,[s("\u6D88\u606F\u8BED\u4E49\u9A8C\u8BC1"),e(a)])]),Ft,n("p",null,[n("a",qt,[s("\u4F8B\uFF1A"),e(a)])]),Pt,n("h3",At,[Bt,s(" 2.3.4"),n("a",Et,[s("VM\u8FD0\u884C\u65F6\u73AF\u5883\uFF08\u5728VM\u5185\u90E8\uFF09"),e(a)])]),n("h4",Tt,[It,s(" 2.3.4.1"),n("a",Rt,[s("\u6536\u636E"),e(a)])]),Mt,n("h4",Dt,[Gt,s(" 2.3.4.2"),n("a",Vt,[Lt,s(" \u6F14\u5458\u754C\u9762"),e(a)])]),n("p",null,[s("\u6F14\u5458\u63A5\u53E3\u7684\u5B9E\u73B0\u53EF\u4EE5\u5728"),n("a",Nt,[s("\u8FD9\u91CC"),e(a)]),s("\u627E\u5230")]),n("h4",jt,[Ht,s(" 2.3.4.3"),n("a",Ot,[Ut,s(" \u865A\u62DF\u673A\u5B9E\u65BD"),e(a)])]),n("p",null,[s("Filecoin\u865A\u62DF\u673A\u8FD0\u884C\u65F6\u7684Lotus\u5B9E\u73B0\u53EF\u5728"),n("a",zt,[s("\u6B64\u5904"),e(a)]),s("\u627E\u5230")]),n("h4",Wt,[Zt,s(" 2.3.4.4"),n("a",Kt,[s("\u9000\u51FA\u7801"),e(a)])]),n("p",null,[s("\u6709\u4E00\u4E9B\u7531\u4E0D\u540C\u53C2\u4E0E\u8005\u5171\u4EAB\u7684\u5E38\u89C1\u8FD0\u884C\u65F6\u9000\u51FA\u4EE3\u7801\u3002\u5B83\u4EEC\u7684\u5B9A\u4E49\u53EF\u4EE5\u5728"),n("a",Qt,[s("\u8FD9\u91CC"),e(a)]),s("\u627E\u5230 \u3002")]),n("h3",Jt,[Xt,s(" 2.3.5"),n("a",Yt,[s("\u7164\u6C14\u8D39"),e(a)])]),n("h4",$t,[no,s(" 2.3.5.1"),n("a",so,[s("\u6982\u8981"),e(a)])]),ao,n("h4",eo,[to,s(" 2.3.5.2"),n("a",oo,[s("\u53C2\u91CF"),e(a)])]),po,n("p",null,[n("a",io,[s("\u793A\u4F8B\uFF1AComputeGasOverestimationBurn"),e(a)])]),co,n("p",null,[n("a",lo,[s("\u793A\u4F8B\uFF1AComputeNextBaseFee"),e(a)])]),uo,n("h4",ro,[ko,s(" 2.3.5.3"),n("a",vo,[s("\u6CE8\u91CA\u4E0E\u542B\u4E49"),e(a)])]),mo,n("h3",bo,[ho,s(" 2.3.6"),n("a",fo,[s("\u7CFB\u7EDF\u89D2\u8272"),e(a)])]),_o,go,n("ul",null,[n("li",null,[s("\u5728 "),n("a",yo,[s("InitActor"),e(a)]),s("\uFF0C\u521D\u59CB\u5316\u65B0\u7684\u53C2\u4E0E\u8005\u548C\u8BB0\u5F55\u7F51\u7EDC\u540D\u79F0\uFF0C")]),n("li",null,[s("\u5728 "),n("a",wo,[s("CronActor"),e(a)]),s("\uFF0C\uFF0C\u5728\u6BCF\u4E2A\u65F6\u95F4\u6BB5\u8FD0\u884C\u5173\u952E\u529F\u80FD\u7684\u8C03\u5EA6\u6F14\u5458\u3002\u8FD8\u6709\u4E24\u4E2A\u4E0EVM\u4EA4\u4E92\u7684\u53C2\u4E0E\u8005\uFF1A")]),n("li",null,[s("\u8D1F\u8D23\u7528\u6237\u5E10\u6237\uFF08\u975E\u5355\u4E00\u5E10\u6237\uFF09\u7684 "),n("a",xo,[s("AccountActor"),e(a)]),s("\uFF0C\u4EE5\u53CA")]),n("li",null,[s("\u8BE5 "),n("a",Co,[s("RewardActor"),e(a)]),s("\u5757\u5956\u52B1\u548C\u4EE4\u724C\u5F52\u5C5E\uFF08\u5355\uFF09\u3002")])]),So,n("ul",null,[n("li",null,[Fo,s("\uFF1A\u8D1F\u8D23\u7BA1\u7406\u5B58\u50A8\u548C\u68C0\u7D22\u4EA4\u6613[ "),n("a",qo,[s("Market Actor Repo"),e(a)]),s(" ]")]),n("li",null,[Po,s("\uFF1A\u8D1F\u8D23\u5904\u7406\u91C7\u77FF\u4E1A\u52A1\u5E76\u6536\u96C6\u8BC1\u636E\u7684"),n("a",Ao,[s("\u6F14\u5458"),e(a)]),s("[ "),n("a",Bo,[s("Storage Miner Actor Repo"),e(a)]),s(" ]")]),n("li",null,[Eo,s("\uFF08\u6216Multi-Signature Wallet Actor\uFF09\uFF1A\u8D1F\u8D23\u5904\u7406\u6D89\u53CAFilecoin\u94B1\u5305\u7684\u64CD\u4F5C[ "),n("a",To,[s("Multisig Actor Repo"),e(a)]),s(" ]")]),n("li",null,[Io,s("\uFF1A\u8D1F\u8D23\u5EFA\u7ACB\u548C\u7ED3\u7B97\u4E0E\u652F\u4ED8\u6E20\u9053\u6709\u5173\u7684\u8D44\u91D1[ "),n("a",Ro,[s("Paych Actor Repo"),e(a)]),s(" ]")]),n("li",null,[Mo,s("\uFF1A\u8D1F\u8D23\u8DDF\u8E2A\u6BCF\u4E2A\u5B58\u50A8\u77FF\u5DE5\u5206\u914D\u7684\u5B58\u50A8\u529F\u7387[ "),n("a",Do,[s("Storage Power Actor"),e(a)]),s(" ]")]),n("li",null,[Go,s("\uFF1A\u8D1F\u8D23\u7BA1\u7406\u5DF2\u9A8C\u8BC1\u7684\u5BA2\u6237[ "),n("a",Vo,[s("Verifreg Actor Repo"),e(a)]),s(" ]")]),n("li",null,[Lo,s("\uFF1A\u666E\u901A\u7CFB\u7EDF\u6F14\u5458[ "),n("a",No,[s("System Actor Repo"),e(a)]),s(" ]")])]),n("h4",jo,[Ho,s(" 2.3.6.1"),n("a",Oo,[s("CronActor"),e(a)])]),Uo,n("p",null,[n("a",zo,[s("\u4F8B\uFF1A"),e(a)])]),Wo,n("h4",Zo,[Ko,s(" 2.3.6.2"),n("a",Qo,[s("\u521D\u59CB\u5316\u6F14\u5458"),e(a)])]),Jo,Xo,n("p",null,[n("a",Yo,[s("\u4F8B\uFF1A"),e(a)])]),$o,n("h4",np,[sp,s(" 2.3.6.3"),n("a",ap,[s("\u5956\u52B1\u6F14\u5458"),e(a)])]),ep,n("p",null,[n("a",tp,[s("\u4F8B\uFF1A"),e(a)])]),op,n("h4",pp,[ip,s(" 2.3.6.4"),n("a",cp,[s("AccountActor"),e(a)])]),lp,n("p",null,[n("a",up,[s("\u4F8B\uFF1A"),e(a)])]),rp,n("h3",dp,[kp,s(" 2.3.7"),n("a",vp,[s("VM\u89E3\u91CA\u5668-\u6D88\u606F\u8C03\u7528\uFF08\u5916\u90E8VM\uFF09"),e(a)])]),mp,bp,n("h4",hp,[fp,s(" 2.3.7.1"),n("a",_p,[s("\u9690\u5F0F\u6D88\u606F"),e(a)])]),gp,yp,wp,xp,Cp,Sp,n("h4",Fp,[qp,s(" 2.3.7.2"),n("a",Pp,[s("\u7164\u6C14\u8D39"),e(a)])]),Ap,Bp,n("h4",Ep,[Tp,s(" 2.3.7.3"),n("a",Ip,[s("\u90AE\u4EF6\u91CD\u590D"),e(a)])]),Rp,n("h4",Mp,[Dp,s(" 2.3.7.4"),n("a",Gp,[s("\u6D88\u606F\u6709\u6548\u6027\u548C\u5931\u8D25"),e(a)])]),n("p",null,[s("\u6709\u6548\u5757\u4E2D\u7684\u6BCF\u4E2A\u6D88\u606F\u90FD\u53EF\u4EE5\u88AB\u5904\u7406\u5E76\u4EA7\u751F\u6536\u636E\uFF08\u8BF7\u6CE8\u610F\uFF0C\u5757\u6709\u6548\u6027\u8868\u793A\u6240\u6709\u6D88\u606F\u5728\u8BED\u6CD5\u4E0A\u5747\u6709\u6548\u2013\u8BF7\u53C2\u9605 "),n("a",Vp,[s("\u6D88\u606F\u8BED\u6CD5"),e(a)]),s("\u2013\u5E76\u6B63\u786E\u7B7E\u540D\uFF09\u3002\u4F46\u662F\uFF0C\u6267\u884C\u6210\u529F\u4E0E\u5426\u53D6\u51B3\u4E8E\u6D88\u606F\u6240\u5E94\u7528\u7684\u72B6\u6001\u3002\u5982\u679C\u6D88\u606F\u6267\u884C\u5931\u8D25\uFF0C\u5219\u76F8\u5E94\u7684\u6536\u636E\u5C06\u643A\u5E26\u975E\u96F6\u7684\u9000\u51FA\u4EE3\u7801\u3002")]),Lp,n("h2",Np,[jp,s(" 2.4"),n("a",Hp,[s("\u533A\u5757\u94FE"),e(a)])]),Op,Up,n("ul",null,[n("li",null,[s("\u4E00\u4E2A "),n("a",zp,[s("\u6D88\u606F\u6C60"),e(a)]),s("\u5B50\u7CFB\u7EDF\u8282\u70B9\u4F7F\u7528\u8DDF\u8E2A\u548C\u6D88\u606F\u4F20\u64AD\u77FF\u5DE5\u5DF2\u7ECF\u5BA3\u5E03\u4ED6\u4EEC\u8981\u5728blockchain\u5305\u62EC\u3002")]),n("li",null,[s("\u7528\u4E8E\u89E3\u91CA\u548C\u6267\u884C\u6D88\u606F\u4EE5\u66F4\u65B0\u7CFB\u7EDF\u72B6\u6001\u7684 "),n("a",Wp,[s("\u865A\u62DF"),e(a)]),s("\u673A\u5B50\u7CFB\u7EDF\u3002")]),n("li",null,[s("\u4E00 "),n("a",Zp,[s("\u56FD\u6811"),e(a)]),s("\uFF0C\u5176\u7BA1\u7406\u7684\u521B\u5EFA\u548C\u72B6\u6001\u7684\u6811\u6728\uFF08\u7CFB\u7EDF\u72B6\u6001\uFF09\u4ECE\u7ED9\u5B9A\u7684\u5B50\u94FE\u786E\u5B9A\u6027VM\u4EA7\u751F\u7684\u7EF4\u62A4\u5B50\u7CFB\u7EDF\u3002")]),n("li",null,[s("\u7532 "),n("a",Kp,[s("\u94FE\u540C\u6B65\uFF08ChainSync\uFF09"),e(a)]),s(" susbystem\u9A8C\u8BC1\u6D88\u606F\u5757\u8BE5\u8F68\u9053\u548C\u4F20\u64AD\uFF0C\u4FDD\u6301\u5957\u5019\u9009\u94FE\u5728\u5176\u4E0A\u53EF\u4EE5\u77FF\u5DE5\u548C\u77FF\u4E0A\u7684\u4F20\u5165\u5757\u8FD0\u884C\u8BED\u6CD5\u9A8C\u8BC1\u3002")]),n("li",null,[s("\u4E00\u4E2A "),n("a",Qp,[s("\u5B58\u50A8\u529F\u7387\u5171\u8BC6"),e(a)]),s("\u5B50\u7CFB\u7EDF\uFF0C\u8BE5\u5B50\u7CFB\u7EDF\u8DDF\u8E2A\u7ED9\u5B9A\u94FE\u7684\u5B58\u50A8\u72B6\u6001\uFF08\u5373 "),n("a",Jp,[s("Storage Subystem"),e(a)]),s("\uFF09\uFF0C\u5E76\u5E2E\u52A9\u533A\u5757\u94FE\u7CFB\u7EDF\u9009\u62E9\u8981\u6269\u5C55\u7684\u5B50\u94FE\u5E76\u5C06\u5176\u5305\u62EC\u5728\u5B50\u94FE\u4E2D\u3002")])]),Xp,n("ul",null,[n("li",null,[s("\u4E00\u4E2A "),n("a",Yp,[s("\u94FE\u7ECF\u7406"),e(a)]),s("\uFF0C\u5B83\u4FDD\u6301\u7ED9\u5B9A\u94FE\u7684\u72B6\u6001\uFF0C\u63D0\u4F9B\u8BBE\u65BD\u7B49blockchain\u5B50\u7CFB\u7EDF\u5C06\u5728\u987A\u5E8F\u67E5\u8BE2\u6709\u5173\u6700\u65B0\u7684\u94FE\u8DEF\u72B6\u6001\u6765\u8FD0\u884C\uFF0C\u5E76\u786E\u4FDD\u8FDB\u5165\u5757\u7EB3\u5165\u94FE\u4E4B\u524D\u5728\u8BED\u4E49\u9A8C\u8BC1\u3002")]),n("li",null,[s("\u963F "),n("a",$p,[s("\u5757\u751F\u4EA7\u8005"),e(a)]),s("\u88AB\u79F0\u4E3A\u5728\u4E00\u4E2A\u6210\u529F\u7684\u9886\u5BFC\u4EBA\u9009\u4E3E\u7684\u4E8B\u4EF6\uFF0C\u4EE5\u4EA7\u751F\u4E00\u4E2A\u65B0\u7684\u5757\uFF0C\u5C06\u5176\u8F6C\u53D1\u5230\u6240\u8FF0\u540C\u6B65\u88C5\u7F6E\u4E3A\u4F20\u64AD\u4E4B\u524D\u6269\u5C55\u5F53\u524D\u6700\u91CD\u94FE\u3002")])]),n("p",null,[s("\u4ECE\u9AD8\u5C42\u6B21\u6765\u770B\uFF0CFilecoin\u533A\u5757\u94FE\u901A\u8FC7\u8FDE\u7EED\u51E0\u8F6E\u7684\u9886\u5BFC\u4EBA\u9009\u4E3E\u800C\u589E\u957F\uFF0C\u5728\u9009\u4E3E\u4E2D\uFF0C\u8BB8\u591A\u77FF\u5DE5\u88AB\u9009\u4E3E\u4EA7\u751F\u4E00\u4E2A\u533A\u5757\uFF0C\u5C06\u5176\u7EB3\u5165\u94FE\u4E2D\u5C06\u4E3A\u4ED6\u4EEC\u8D62\u5F97\u533A\u5757\u5956\u52B1\u3002Filecoin\u7684\u533A\u5757\u94FE\u4F9D\u9760\u5B58\u50A8\u80FD\u529B\u8FD0\u884C\u3002\u4E5F\u5C31\u662F\u8BF4\uFF0C\u77FF\u5DE5\u901A\u8FC7\u5176\u5171\u8BC6\u7B97\u6CD5\u6765\u786E\u5B9A\u8981\u5F00\u91C7\u7684\u5B50\u94FE\u53D6\u51B3\u4E8E\u8BE5\u5B50\u94FE\u7684\u5B58\u50A8\u91CF\u3002\u5728\u9AD8\u5C42\uFF0C\u201C "),n("a",ni,[s("\u5B58\u50A8\u529F\u7387\u5171\u8BC6\u201D"),e(a)]),s("\u5B50\u7CFB\u7EDF\u7EF4\u62A4\u4E00\u4E2A"),si,s("\uFF0C\u8BE5"),ai,s("\u8DDF\u8E2A"),n("a",ei,[s("\u5B58\u50A8\u77FF\u5DE5\u53C2\u4E0E\u8005"),e(a)]),s("\u901A\u8FC7"),ti,s("\u548C"),oi,s("\u7F51\u7EDC\u8D21\u732E\u7684\u5B58\u50A8\u91CF \u3002")]),n("h3",pi,[ii,s(" 2.4.1"),n("a",ci,[s("\u79EF\u6728"),e(a)])]),li,n("h4",ui,[ri,s(" 2.4.1.1"),n("a",di,[s("\u5757"),e(a)])]),ki,vi,mi,n("p",null,[n("a",bi,[s("\u793A\u4F8B\uFF1AFullBlock"),e(a)])]),hi,n("p",null,[s("A"),fi,s("\u662F\u5757\u7684\u89C4\u8303\u8868\u793A\u3002BlockHeader\u5728\u77FF\u5DE5\u8282\u70B9\u4E4B\u95F4\u4F20\u64AD\u3002\u4ECEblockcheader\u6D88\u606F\u4E2D\uFF0C\u77FF\u5DE5\u62E5\u6709\u6240\u6709\u5FC5\u9700\u7684\u4FE1\u606F\uFF0C\u4EE5\u5E94\u7528\u5173\u8054"),_i,s("\u7684\u72B6\u6001\u5E76\u66F4\u65B0\u94FE\u3002\u4E3A\u4E86\u505A\u5230\u8FD9\u4E00\u70B9\uFF0C"),gi,s("\u4E0B\u9762\u663E\u793A\u4E86\u9700\u8981\u5305\u542B\u7684\u6700\u5C11\u4FE1\u606F\u9879\u96C6\uFF0C\u5176\u4E2D\u5305\u62EC\uFF1A\u77FF\u5DE5\u7684\u5730\u5740\uFF0C\u7968\u8BC1\uFF0C "),n("a",yi,[s("\u65F6\u7A7A\u8BC1\u660E"),e(a)]),s("\uFF0C\u6B64\u5757\u6240\u5728\u7684\u7236\u6BCD\u7684CID\u4ECEIPLD DAG\u4EE5\u53CA\u6D88\u606F\u81EA\u8EAB\u7684CID\u6F14\u53D8\u800C\u6765\u3002")]),wi,n("p",null,[n("a",xi,[s("\u793A\u4F8B\uFF1ABlockHeader"),e(a)])]),Ci,n("p",null,[n("a",Si,[s("\u793A\u4F8B\uFF1A\u7968\u8BC1"),e(a)])]),Fi,n("p",null,[n("a",qi,[s("\u793A\u4F8B\uFF1AElectionProof"),e(a)])]),Pi,n("p",null,[n("a",Ai,[s("\u793A\u4F8B\uFF1ABeaconEntry"),e(a)])]),Bi,n("p",null,[s("\u8BE5"),Ei,s("\u7ED3\u6784\u5FC5\u987B\u5F15\u7528\u5F53\u524D\u56DE\u5408\u7684TicketWinner\uFF0C\u4EE5\u786E\u4FDD\u5C06\u6B63\u786E\u7684\u83B7\u80DC\u8005\u4F20\u9012\u7ED9 "),n("a",Ti,[s("ChainSync"),e(a)]),s("\u3002")]),Ii,n("p",null,[n("a",Ri,[s("\u793A\u4F8B\uFF1A\u6D88\u606F"),e(a)])]),Mi,n("p",null,[s("\u5728\u5C06\u6D88\u606F\u4F20\u9012\u5230"),n("a",Di,[s("\u94FE\u540C\u6B65\u903B\u8F91"),e(a)]),s("\u4E4B\u524D\uFF0C\u8FD8\u5C06\u5BF9\u5176\u8FDB\u884C\u9A8C\u8BC1 \uFF1A")]),n("p",null,[n("a",Gi,[s("\u793A\u4F8B\uFF1AValidForBlockInclusion"),e(a)])]),Vi,n("h5",Li,[Ni,s(" 2.4.1.1.1"),n("a",ji,[s("\u5757\u8BED\u6CD5\u9A8C\u8BC1"),e(a)])]),Hi,n("h5",Oi,[Ui,s(" 2.4.1.1.2"),n("a",zi,[s("\u963B\u6B62\u8BED\u4E49\u9A8C\u8BC1"),e(a)])]),Wi,Zi,Ki,n("p",null,[n("a",Qi,[s("\u793A\u4F8B\uFF1AValidateBlock"),e(a)])]),Ji,n("ul",null,[Xi,n("li",null,[Yi,s("\u5757\u7684CID\u4E0E\u4ECE\u7236"),n("a",$i,[s("Tipset"),e(a)]),s("\u8BA1\u7B97\u7684\u72B6\u6001CID\u5339\u914D \u3002")]),nc,sc,ac]),ec,n("h4",tc,[oc,s(" 2.4.1.2"),n("a",pc,[s("\u5C0F\u8D39"),e(a)])]),n("p",null,[s("\u9884\u671F\u5171\u8BC6\u5728\u6BCF\u4E2A\u65F6\u671F\u6982\u7387\u9009\u4E3E\u51FA\u591A\u4E2A\u9886\u5BFC\u8005\uFF0C\u8FD9\u610F\u5473\u7740Filecoin\u94FE\u5728\u6BCF\u4E2A\u65F6\u671F\u53EF\u80FD\u5305\u542B\u96F6\u4E2A\u6216\u591A\u4E2A\u533A\u5757\uFF08\u6BCF\u4E2A\u9009\u4E3E\u7684\u77FF\u5DE5\u4E00\u4E2A\uFF09\u3002\u6765\u81EA\u540C\u4E00\u65F6\u671F\u7684\u5757\u88AB\u7EC4\u88C5\u5230\u63D0\u793A\u96C6\u4E2D\u3002\u6240\u8FF0 "),n("a",ic,[s("VM\u89E3\u91CA\u5668"),e(a)]),s("\u901A\u8FC7\u5728tipset\u6267\u884C\u7684\u6240\u6709\u6D88\u606F\uFF08\u5305\u62EC\u5728\u591A\u4E8E\u4E00\u4E2A\u7684\u5757\u76F8\u540C\u6D88\u606F\u7684\u91CD\u590D\u6570\u636E\u5220\u9664\u4E4B\u540E\uFF09\u4FEE\u6539Filecoin\u72B6\u6001\u6811\u3002")]),cc,n("p",null,[s("\u7531\u4E8E\u7F51\u7EDC\u4F20\u64AD\u5EF6\u8FDF\uFF0C\u5728\u65F6\u95F4\u6BB5N + 1\u4E2D\u7684\u77FF\u5DE5\u53EF\u80FD\u4F1A\u4ECE\u5176\u7236\u63D0\u793A\u96C6\u4E2D\u5FFD\u7565\u5728\u65F6\u95F4\u6BB5N\u5904\u6316\u6398\u7684\u6709\u6548\u5757\u3002\u8FD9\u4E0D\u4F1A\u4F7F\u65B0\u751F\u6210\u7684\u5757\u65E0\u6548\uFF0C\u4F46\u662F\u4F1A\u964D\u4F4E\u5176\u6743\u91CD\u548C\u6210\u4E3AEC"),n("a",lc,[s("\u94FE\u9009\u62E9"),e(a)]),s("\u529F\u80FD\u5B9A\u4E49\u7684\u534F\u8BAE\u4E2D\u89C4\u8303\u94FE\u4E00\u90E8\u5206\u7684\u673A\u4F1A \u3002")]),n("p",null,[s("\u5757\u751F\u4EA7\u8005\u5E94\u8BE5\u534F\u8C03\u4ED6\u4EEC\u5982\u4F55\u9009\u62E9\u8981\u5305\u542B\u5728\u5757\u4E2D\u7684\u6D88\u606F\uFF0C\u4EE5\u907F\u514D\u91CD\u590D\uFF0C\u4ECE\u800C\u4ECE\u6D88\u606F\u8D39\u7528\u4E2D\u6700\u5927\u5316\u4ED6\u4EEC\u7684\u9884\u671F\u6536\u76CA\uFF08\u8BF7\u53C2\u9605 "),n("a",uc,[s("\u6D88\u606F\u6C60"),e(a)]),s("\uFF09\u3002")]),rc,n("p",null,[n("a",dc,[s("\u793A\u4F8B\uFF1ATipSet"),e(a)])]),kc,n("p",null,[n("a",vc,[s("\u793A\u4F8B\uFF1ANewTipSet"),e(a)])]),mc,n("h4",bc,[hc,s(" 2.4.1.3"),n("a",fc,[s("\u8FDE\u9501\u5E97\u7ECF\u7406"),e(a)])]),_c,gc,n("h5",yc,[wc,s(" 2.4.1.3.1"),n("a",xc,[s("\u5EF6\u4F38\u94FE"),e(a)])]),n("h6",Cc,[Sc,s(" 2.4.1.3.1.1"),n("a",Fc,[s("\u63A5\u6536\u5757\u63A5\u6536"),e(a)])]),qc,Pc,Ac,n("p",null,[s("\u94FE\u9009\u62E9\u662FFilecoin\u533A\u5757\u94FE\u5DE5\u4F5C\u65B9\u5F0F\u7684\u5173\u952E\u7EC4\u6210\u90E8\u5206\u3002\u7B80\u800C\u8A00\u4E4B\uFF0C\u6BCF\u4E2A\u94FE\u90FD\u6709\u76F8\u5173\u7684\u6743\u91CD\uFF0C\u8FD9\u4E9B\u6743\u91CD\u8BF4\u660E\u4E86\u5728\u5176\u4E0A\u5F00\u91C7\u7684\u5757\u6570\u4EE5\u53CA\u5B83\u4EEC\u8DDF\u8E2A\u7684\u529F\u7387\uFF08\u5B58\u50A8\uFF09\u3002\u201C\u9009\u62E9"),n("a",Bc,[s("\u94FE\u201D"),e(a)]),s("\u90E8\u5206\u63D0\u4F9B\u4E86\u6709\u5173\u9009\u62E9\u5DE5\u4F5C\u539F\u7406\u7684\u5168\u90E8\u8BE6\u7EC6\u4FE1\u606F \u3002")]),Ec,Tc,n("h6",Ic,[Rc,s(" 2.4.1.3.1.2"),n("a",Mc,[s("ChainTipsManager"),e(a)])]),Dc,n("h4",Gc,[Vc,s(" 2.4.1.4"),n("a",Lc,[s("\u5236\u7247\u4EBA"),e(a)])]),n("h5",Nc,[jc,s(" 2.4.1.4.1"),n("a",Hc,[s("\u91C7\u77FF\u5757"),e(a)])]),n("p",null,[s("\u5982\u679C\u5DF2\u8BC1\u660E\u62E5\u6709\u6EE1\u8DB3"),n("a",Oc,[s("\u6700\u5C0F\u77FF\u5DE5\u89C4\u6A21"),e(a)]),s("\u9608\u503C\u8981\u6C42\u7684\u50A8\u91CF\uFF0C\u5219\u5411\u50A8\u80FD\u6F14\u5458\u6CE8\u518C\u7684\u77FF\u5DE5\u53EF\u4EE5\u5F00\u59CB\u751F\u6210\u548C\u68C0\u67E5\u9009\u4E3E\u7968 \u3002")]),Uc,n("h6",zc,[Wc,s(" 2.4.1.4.1.1"),n("a",Zc,[s("\u5757\u521B\u5EFA"),e(a)])]),Kc,n("p",null,[s("\u89C1 "),n("a",Qc,[s("VM\u89E3\u91CA"),e(a)]),s("\u4E3A\u6BCD\u4F53tipset\u8BC4\u4EF7\u7684\u7EC6\u8282\uFF0C\u5E76 "),n("a",Jc,[s("\u963B\u6B62"),e(a)]),s("\u5BF9\u6709\u6548\u5757\u6807\u5934\u503C\u7684\u7EA6\u675F\u3002")]),Xc,n("ul",null,[Yc,n("li",null,[n("p",null,[$c,s("-\u7236\u94FE\u7684\u6743\u91CD\uFF08\u8BF7\u53C2\u9605\u201C "),n("a",nl,[s("\u94FE\u9009\u62E9\u201D"),e(a)]),s("\uFF09\u3002")])]),n("li",null,[n("p",null,[sl,s("-\u6765\u81EA\u7236\u63D0\u793A\u96C6\u72B6\u6001\u8BC4\u4F30\u7684\u72B6\u6001\u6839\u7684CID\uFF08\u8BF7\u53C2\u9605 "),n("a",al,[s("VM Interpreter"),e(a)]),s("\uFF09\u3002")])]),el,n("li",null,[n("p",null,[tl,s("-\u4ECE\u6700\u540E\u4E00\u4E2A\u5757\u5F00\u59CB\u751F\u6210\u7684\u4E00\u7EC4drand\u6761\u76EE\uFF08\u8BF7\u53C2\u9605 "),n("a",ol,[s("Beacon Entries"),e(a)]),s("\uFF09\u3002")])]),n("li",null,[n("p",null,[pl,s("-\u4ECE\u4E0A\u4E00\u4E2A\u7EAA\u5143\u751F\u6210\u7684\u65B0\u7968\u8BC1\uFF08\u8BF7\u53C2\u89C1 "),n("a",il,[s("\u7968\u8BC1\u751F\u6210"),e(a)]),s("\uFF09\u3002")])]),cl]),ll,ul,rl,n("h6",dl,[kl,s(" 2.4.1.4.1.2"),n("a",vl,[s("\u5757\u5E7F\u64AD"),e(a)])]),n("p",null,[s("\u5408\u683C\u7684\u77FF\u5DE5\u4F7F\u7528"),n("a",ml,[s("GossipSub"),e(a)]),s(),bl,s("\u4E3B\u9898\u5C06\u5B8C\u6210\u7684\u533A\u5757\u4F20\u64AD\u5230\u7F51\u7EDC \uFF0C\u5E76\u4E14\u5047\u8BBE\u4E00\u5207\u90FD\u6B63\u786E\u5B8C\u6210\uFF0C\u5219\u7F51\u7EDC\u5C06\u63A5\u53D7\u5B83\uFF0C\u5176\u4ED6\u77FF\u5DE5\u5C06\u5728\u5176\u4E4B\u4E0A\u8FDB\u884C\u6316\u6398\uFF0C\u4ECE\u800C\u83B7\u5F97\u77FF\u5DE5\u7684\u5956\u52B1\u3002")]),hl,n("h5",fl,[_l,s(" 2.4.1.4.2"),n("a",gl,[s("\u5757\u5956\u52B1"),e(a)])]),n("p",null,[s("\u96C6\u4F53\u5956\u52B1\u7531"),n("a",yl,[s("\u5956\u52B1\u6F14\u5458"),e(a)]),s("\u5904\u7406 \u3002\u5728"),n("a",wl,[s("Filecoin\u4EE4\u724C"),e(a)]),s("\u90E8\u5206\u8BA8\u8BBA\u4E86 \u6709\u5173\u533A\u5757\u5956\u52B1\u7684\u66F4\u591A\u8BE6\u7EC6\u4FE1\u606F\uFF0C\u5728"),n("a",xl,[s("\u77FF\u5DE5\u62B5\u62BC\u54C1"),e(a)]),s("\u90E8\u5206\u8BA8\u8BBA\u4E86\u6709\u5173\u533A\u5757\u5956\u52B1\u62B5\u62BC\u7684\u8BE6\u7EC6\u4FE1\u606F \u3002")]),n("h3",Cl,[Sl,s(" 2.4."),n("a",Fl,[s("\u4FE1\u606F\u6C60"),e(a)])]),ql,Pl,Al,Bl,n("h4",El,[Tl,s(" 2.4.2.1"),n("a",Il,[s("\u8BAF\u606F\u4F20\u64AD"),e(a)])]),n("p",null,[s("\u6D88\u606F\u6C60\u5FC5\u987B\u4E0Elibp2p pubsub "),n("a",Rl,[s("GossipSub"),e(a)]),s("\u534F\u8BAE\u63A5\u53E3 \u3002\u8FD9\u662F\u56E0\u4E3A\u6D88\u606F\u901A\u8FC7"),n("a",Ml,[s("GossipSub"),e(a)]),s("\u4F20\u64AD\u4E86 \u76F8\u5E94\u7684"),Dl,s(),Gl,s("\u3002\u53C2\u4E0E\u7F51\u7EDC\u7684\u4EFB\u4F55\u8282\u70B9\u90FD\u4F1A\u5728\u76F8\u5E94\u7684\u4E3B\u9898\u4E2D\u5BA3\u5E03\u6BCF\u4E2A "),n("a",Vl,[s("\u6D88\u606F"),e(a)]),Ll,s("\u3002")]),Nl,n("p",null,[s("GossipSub\u534F\u8BAE\u7684\u66F4\u65B0\u7684\u5F3A\u5316\u7248\u672C\u5305\u62EC\u591A\u79CD\u7F13\u89E3\u653B\u51FB\u7684\u7B56\u7565\u3002\u4F8B\u5982\uFF0C\u5F53\u8282\u70B9\u6536\u5230\u65E0\u6548\u6D88\u606F\u65F6\uFF0C\u5B83\u5C06\u8D1F"),jl,s("\u5206\u914D\u7ED9\u53D1\u9001\u65B9\u5BF9\u7B49\u65B9\u3002\u5BF9\u7B49\u5206\u6570\u4E0D\u4E0E\u5176\u4ED6\u8282\u70B9\u5171\u4EAB\uFF0C\u800C\u662F\u7531\u5176\u4E0E\u4E4B\u4EA4\u4E92\u7684\u6240\u6709\u5176\u4ED6\u5BF9\u7B49\u70B9\u5728\u6BCF\u4E2A\u5BF9\u7B49\u70B9\u672C\u5730\u4FDD\u5B58\u3002\u5982\u679C\u5BF9\u7B49\u65B9\u7684\u5F97\u5206\u4E0B\u964D\u5230\u9608\u503C\u4EE5\u4E0B\uFF0C\u5219\u5C06\u5176\u4ECE\u8BC4\u5206\u5BF9\u7B49\u65B9\u7684\u7F51\u683C\u4E2D\u6392\u9664\u3002\u6211\u4EEC\u5C06\u5728GossipSub\u90E8\u5206\u4E2D\u8BA8\u8BBA\u6709\u5173\u8FD9\u4E9B\u8BBE\u7F6E\u7684\u66F4\u591A\u8BE6\u7EC6\u4FE1\u606F\u3002\u5B8C\u6574\u7684\u7EC6\u8282\u53EF\u4EE5\u5728"),n("a",Hl,[s("GossipSub\u89C4\u8303\u4E2D"),e(a)]),s("\u627E\u5230 \u3002")]),Ol,Ul,n("h4",zl,[Wl,s(" 2.4.2.2"),n("a",Zl,[s("\u8BAF\u606F\u50A8\u5B58"),e(a)])]),Kl,n("h3",Ql,[Jl,s(" 2.4.3"),n("a",Xl,[s("\u94FE\u540C\u6B65"),e(a)])]),Yl,n("h4",$l,[nu,s(" 2.4.3."),n("a",su,[s("ChainSync\u6982\u8FF0"),e(a)])]),au,n("h4",eu,[tu,s(" 2.4.3.2"),n("a",ou,[s("\u672F\u8BED\u548C\u6982\u5FF5"),e(a)])]),pu,n("h4",iu,[cu,s(" 2.4.3.3"),n("a",lu,[s("ChainSync\u72B6\u6001\u673A"),e(a)])]),uu,n("h4",ru,[du,s(" 2.4.3.4"),n("a",ku,[s("\u540C\u884C\u53D1\u73B0"),e(a)])]),vu,mu,n("h5",bu,[hu,s(" 2.4.3.4.1"),n("a",fu,[s("\u540C\u884C\u4EA4\u6D41"),e(a)])]),_u,n("p",null,[s("\u6709\u5173Peer Exchange\u7684\u66F4\u591A\u8BE6\u7EC6\u4FE1\u606F\uFF0C\u8BF7\u53C2\u8003 "),n("a",gu,[s("GossipSub\u89C4\u8303"),e(a)]),s("\u3002")]),n("h5",yu,[wu,s(" 2.4.3.4.2"),n("a",xu,[s("\u660E\u786E\u7684\u5BF9\u7B49\u534F\u8BAE"),e(a)])]),Cu,n("h4",Su,[Fu,s(" 2.4.3"),n("a",qu,[s("\u6E10\u8FDB\u5757\u9A8C\u8BC1"),e(a)])]),n("ul",null,[n("li",null,[s("\u4E3A\u4E86\u4F7F\u8D44\u6E90\u652F\u51FA\u6700\u5C0F\u5316\uFF0C\u53EF\u4EE5\u9010\u6B65\u8FDB\u884C"),n("a",Pu,[s("\u533A\u5757"),e(a)]),s("\u9A8C\u8BC1\u3002")]),Au,Bu,Eu,Tu,n("li",null,[Iu,n("ul",null,[Ru,Mu,Du,n("li",null,[Gu,s("\uFF1A\u6709\u6548\u7684\u968F\u673A\u4FE1\u6807\u6761\u76EE\u5DF2\u63D2\u5165\u5230\u5757\u4E2D\uFF08\u8BF7\u53C2\u9605 "),n("a",Vu,[s("\u4FE1\u6807\u6761\u76EE\u9A8C\u8BC1"),e(a)]),s("\uFF09\u3002")]),Lu])])]),n("h3",Nu,[ju,s(" 2.4."),n("a",Hu,[s("\u50A8\u80FD\u5171\u8BC6"),e(a)])]),n("p",null,[s("\u5B58\u50A8\u7535\u6E90\u5171\u8BC6\uFF08SPC\uFF09\u5B50\u7CFB\u7EDF\u662F\u4F7FFilecoin\u8282\u70B9\u80FD\u591F\u5C31\u7CFB\u7EDF\u72B6\u6001\u8FBE\u6210\u4E00\u81F4\u7684\u4E3B\u8981\u63A5\u53E3\u3002\u300A\u5B58\u50A8\u529F\u7387\u5171\u8BC6\u300B\u5728\u5176\u201C"),n("a",Ou,[s("\u529F\u7387\u8868\u201D"),e(a)]),s("\u4E2D\u8003\u8651\u4E86\u5404\u4E2A\u5B58\u50A8\u77FF\u5DE5\u5728\u7ED9\u5B9A\u94FE\u4E2D\u8D85\u8FC7\u5171\u8BC6\u7684\u6709\u6548\u529F\u7387 \u3002\u5B83\u8FD8\u8FD0\u884C\u201C "),n("a",Uu,[s("\u9884\u671F\u5171\u8BC6\u201D"),e(a)]),s("\uFF08Filecoin\u4F7F\u7528\u7684\u57FA\u7840\u5171\u8BC6\u7B97\u6CD5\uFF09\uFF0C\u4F7F\u5B58\u50A8\u77FF\u5DE5\u53EF\u4EE5\u8FDB\u884C\u9886\u5BFC\u8005\u9009\u4E3E\u5E76\u751F\u6210\u66F4\u65B0Filecoin\u7CFB\u7EDF\u72B6\u6001\u7684\u65B0\u5757\u3002")]),zu,n("ul",null,[n("li",null,[s("\u8BBF\u95EE\u6BCF\u4E2A\u5B50\u94FE\u7684 "),n("a",Wu,[s("\u529F\u7387\u8868"),e(a)]),s("\uFF0C\u8BF4\u660E\u5404\u4E2A\u5B58\u50A8\u77FF\u5DE5\u7684\u529F\u7387\u548C\u94FE\u4E0A\u7684\u603B\u529F\u7387\u3002")]),n("li",null,[s("\u8BBF\u95EE \u5404\u4E2A\u5B58\u50A8\u77FF\u5DE5\u7684"),n("a",Zu,[s("\u9884\u671F\u5171\u8BC6"),e(a)]),s("\uFF0C\u4ECE\u800C\u5B9E\u73B0\uFF1A "),n("ul",null,[n("li",null,[s("\u6839\u636E\u534F\u8BAE\u7684\u5176\u4F59\u90E8\u5206\uFF0C\u8BBF\u95EE"),n("a",Ku,[s("drand"),e(a)]),s("\u63D0\u4F9B\u7684 \u53EF\u9A8C\u8BC1\u7684\u968F\u673A\u6027 "),n("a",Qu,[s("\u7968\u8BC1"),e(a)]),s("\u3002")]),n("li",null,[s("\u8FDB\u884C "),n("a",Ju,[s("\u9886\u5BFC\u4EBA\u9009\u4E3E"),e(a)]),s("\u4EA7\u751F\u65B0\u7684\u969C\u788D\u3002")]),n("li",null,[s("\u4F7F\u7528EC\u7684\u52A0\u6743\u529F\u80FD\u8DE8\u5B50\u94FE\u8FD0\u884C "),n("a",Xu,[s("\u94FE\u9009\u62E9"),e(a)]),s("\u3002")]),n("li",null,[s("\u6807\u8BC6 "),n("a",Yu,[s("\u6700\u8FD1\u5B8C\u6210\u7684\u63D0\u793A\u96C6"),e(a)]),s("\uFF0C\u4F9B\u6240\u6709\u534F\u8BAE\u53C2\u4E0E\u8005\u4F7F\u7528\u3002")])])])]),n("h4",$u,[nr,s(" 2.4.4.1"),n("a",sr,[s("\u533A\u5206\u5B58\u50A8\u77FF\u5DE5\u548C\u5757\u77FF\u5DE5"),e(a)])]),ar,n("ul",null,[n("li",null,[s("\u901A\u8FC7\u4F5C\u4E3A\u5B58\u50A8\u63D0\u4F9B\u8005\u53C2\u52A0 "),n("a",er,[s("\u5B58\u50A8\u5E02\u573A"),e(a)]),s("\u5E76\u7531\u5BA2\u6237\u652F\u4ED8\u6587\u4EF6\u5B58\u50A8\u4EA4\u6613\u7684\u8D39\u7528\u3002")]),n("li",null,[s("\u901A\u8FC7\u6316\u6398\u65B0\u7684\u533A\u5757\uFF0C\u6269\u5C55\u533A\u5757\u94FE\uFF0C\u4FDD\u62A4Filecoin\u5171\u8BC6\u673A\u5236\u4EE5\u53CA\u8FD0\u884C\u667A\u80FD\u5408\u7EA6\u4EE5\u6267\u884C\u72B6\u6001\u66F4\u65B0\u6765\u4F5C\u4E3A "),n("a",tr,[s("Storage Miner"),e(a)]),s("\u3002")])]),n("p",null,[s("\u6709\u4E24\u79CD\u7C7B\u578B\u7684\u201C\u77FF\u5DE5\u201D\uFF08\u5B58\u50A8\u77FF\u5DE5\u548C\u5757\u77FF\u5DE5\uFF09\u53EF\u4EE5\u533A\u5206\u3002 Filecoin\u7684"),n("a",or,[s("\u9886\u5BFC\u8005\u9009\u4E3E"),e(a)]),s("\u53D6\u51B3\u4E8E\u77FF\u5DE5\u7684\u5B58\u50A8\u80FD\u529B\u3002\u56E0\u6B64\uFF0C\u867D\u7136\u6240\u6709\u533A\u5757\u77FF\u5DE5\u90FD\u5C06\u662F\u5B58\u50A8\u77FF\u5DE5\uFF0C\u4F46\u4E0D\u4E00\u5B9A\u76F8\u53CD\u3002")]),n("p",null,[s("\u4F46\u662F\uFF0C\u9274\u4E8EFilecoin\u7684\u201C\u6709\u7528\u7684\u5DE5\u4F5C\u91CF\u8BC1\u660E\u201D\u662F\u901A\u8FC7\u6587\u4EF6\u5B58\u50A8\uFF08 "),n("a",pr,[s("PoRep"),e(a)]),s("\u548C "),n("a",ir,[s("PoSt"),e(a)]),s("\uFF09\u5B9E\u73B0\u7684\uFF0C\u5B58\u50A8\u77FF\u5DE5\u53C2\u4E0E\u9886\u5BFC\u8005\u9009\u4E3E\u7684\u5F00\u9500\u5F88\u5C11\u3002\u8FD9\u6837\u7684 "),n("a",cr,[s("Storage Miner Actor"),e(a)]),s("\u4EC5\u9700\u8981\u5411"),n("a",lr,[s("Storage Power Actor"),e(a)]),s("\u6CE8\u518C \u5373\u53EF\u53C2\u4E0E\u201C\u9884\u671F\u5171\u8BC6\u201D\u548C\u77FF\u533A\u3002")]),n("h4",ur,[rr,s(" 2.4.4.2"),n("a",dr,[s("\u4E0A\u7535"),e(a)])]),kr,n("p",null,[s("\u4E00\u4E2A\u90E8\u95E8\u7684\u8D28\u91CF\u53D6\u51B3\u4E8E\u5BF9\u8BE5\u90E8\u95E8\u5185\u90E8\u6570\u636E\u8FDB\u884C\u7684\u4EA4\u6613\u3002\u901A\u5E38\u6709\u4E09\u79CD\u7C7B\u578B\u7684\u4EA4\u6613\uFF1A"),vr,s("\uFF08\u5B9E\u9645\u4E0A\u6CA1\u6709\u4EFB\u4F55\u4EA4\u6613\uFF0C\u800C\u77FF\u5DE5\u5728\u8BE5\u90E8\u95E8\u5185\u90E8\u5B58\u50A8\u4EFB\u610F\u6570\u636E\uFF09\uFF0C"),mr,s("\uFF08\u77FF\u5DE5\u548C\u5BA2\u6237\u5C31\u5E02\u573A\u4EF7\u683C\u8FBE\u6210\u4E00\u81F4\uFF09\u4EE5\u53CA\u5728"),br,s("\u7684\u4EA4\u6613\uFF0C\u8FD9\u7ED9\u66F4\u591A\u7684\u6743\u529B\u90E8\u95E8\u3002\u6211\u4EEC\u8BF7\u8BFB\u8005\u9605\u8BFB\u201C "),n("a",hr,[s("\u6247\u533A"),e(a)]),s("\u548C "),n("a",fr,[s("\u6247\u533A\u8D28\u91CF\u201D"),e(a)]),s("\u90E8\u5206\uFF0C\u4EE5\u83B7\u53D6\u6709\u5173\u6247\u533A\u7C7B\u578B\u548C\u6247\u533A\u8D28\u91CF\u7684\u8BE6\u7EC6\u4FE1\u606F\uFF0C\u201C "),n("a",_r,[s("\u5DF2\u9A8C\u8BC1\u7684\u5BA2\u6237\u201D"),e(a)]),s("\u90E8\u5206\u53EF\u83B7\u5F97\u6709\u5173\u5DF2\u9A8C\u8BC1\u7684\u5BA2\u6237\u662F\u4EC0\u4E48\u7684\u66F4\u591A\u8BE6\u7EC6\u4FE1\u606F\uFF0C\u4EE5\u53CA "),n("a",gr,[s("CryptoEconomics"),e(a)]),s(" \u90E8\u5206\uFF0C\u4EE5\u83B7\u53D6\u4EA4\u6613\u6743\u91CD\u548C\u8D28\u91CF\u4E58\u6570\u4E0A\u7684\u7279\u5B9A\u53C2\u6570\u503C\u3002")]),n("p",null,[yr,s("\u662F\u6307\u77FF\u5DE5\u5728\u201C"),n("a",wr,[s("\u79D8\u5BC6\u9886\u5BFC\u4EBA\u9009\u4E3E\u201D\u4E2D"),e(a)]),s("\u6240\u83B7\u5F97\u7684\u7968\u6570\uFF0C\u5176 \u5B9A\u4E49\u662F\u968F\u7740\u77FF\u5DE5\u5BF9\u7F51\u7EDC\u7684\u627F\u8BFA\u5B58\u50A8\u91CF\u7EBF\u6027\u589E\u52A0\u3002")]),xr,Cr,n("h4",Sr,[Fr,s(" 2.4.4.3"),n("a",qr,[s("\u4FE1\u6807\u6761\u76EE"),e(a)])]),n("p",null,[s("Filecoin\u534F\u8BAE\u4F7F\u7528"),n("a",Pr,[s("drand"),e(a)]),s("\u4FE1\u6807\u4EA7\u751F\u7684 \u968F\u673A\u6027\u6765\u64AD\u79CD\u53EF\u5728\u94FE\u4E2D\u4F7F\u7528\u7684\u65E0\u504F\u968F\u673A\u6027\u79CD\u5B50\uFF08\u8BF7\u53C2\u9605 "),n("a",Ar,[s("\u968F\u673A\u6027"),e(a)]),s("\uFF09\u3002")]),Br,n("ul",null,[n("li",null,[s("\u8BE5 "),n("a",Er,[s("sector_sealer"),e(a)]),s("\u4E3ASealSeeds\u7ED3\u5408\u90E8\u95E8\u627F\u8BFA\u7ED9\u5B9A\u7684\u5B50\u94FE\u3002")]),n("li",null,[s("\u8BE5 "),n("a",Tr,[s("post_generator"),e(a)]),s("\u4E3APoStChallenges\u8BC1\u660E\u90E8\u95E8\u7EE7\u7EED\u81F4\u529B\u4E8E\u4E3A\u7ED9\u5B9A\u5757\u7684\u3002")]),n("li",null,[s("Storage Power\u5B50\u7CFB\u7EDF\u4F5C\u4E3A\u201C"),n("a",Ir,[s("\u79D8\u5BC6\u9886\u5BFC\u8005\u201D\u9009\u4E3E\u4E2D\u7684"),e(a)]),s("\u968F\u673A\u6027\uFF0C \u7528\u4E8E\u786E\u5B9A\u9009\u62E9\u77FF\u5DE5\u91C7\u77FF\u65B0\u533A\u5757\u7684\u9891\u7387\u3002")])]),Rr,Mr,n("h5",Dr,[Gr,s(" 2.4.4.3.1"),n("a",Vr,[s("\u83B7\u53D6VM\u7684drand\u968F\u673A\u6027"),e(a)])]),Lr,n("h5",Nr,[jr,s(" 2.4.4.3.2"),n("a",Hr,[s("\u4ECEdrand\u7F51\u7EDC\u83B7\u53D6\u968F\u673A\u6027"),e(a)])]),Or,n("p",null,[n("a",Ur,[s("\u793A\u4F8B\uFF1ADrandBeacon"),e(a)])]),zr,n("p",null,[n("a",Wr,[s("\u793A\u4F8B\uFF1ABeaconEntriesForBlock"),e(a)])]),Zr,n("p",null,[n("a",Kr,[s("\u793A\u4F8B\uFF1AMaxBeaconRoundForEpoch"),e(a)])]),Qr,n("h5",Jr,[Xr,s(" 2.4.4.3.3"),n("a",Yr,[s("\u5728\u5757\u63A5\u6536\u65F6\u9A8C\u8BC1\u4FE1\u6807\u6761\u76EE"),e(a)])]),$r,n("p",null,[s("\u8003\u8651\u5230\u5B83\u4EEC\u5728\u9886\u5BFC\u8005\u9009\u4E3E\u548CFilecoin\u4E2D\u5176\u4ED6\u5173\u952E\u534F\u8BAE\u4E2D\u7684\u4F5C\u7528\uFF0C\u5FC5\u987B\u4E3A\u6BCF\u4E2A\u533A\u5757\u9A8C\u8BC1\u533A\u5757\u7684\u4FE1\u6807\u6761\u76EE\u3002\u6709\u5173\u8BE6\u7EC6\u4FE1\u606F\uFF0C\u8BF7\u53C2\u89C1 "),n("a",nd,[s("drand"),e(a)]),s("\u3002\u53EF\u4EE5\u901A\u8FC7\u4F7F\u7528drand\u7684"),n("a",sd,[ad,e(a)]),s("\u7AEF\u70B9\uFF0C\u786E\u4FDD\u6BCF\u4E2A\u4FE1\u6807\u6761\u76EE\u90FD\u662F\u94FE\u4E2D\u524D\u4E00\u4E2A\u6761\u76EE\u7684\u6709\u6548\u7B7E\u540D\u6765\u5B8C\u6210\u6B64\u64CD\u4F5C \uFF1A")]),n("p",null,[n("a",ed,[s("\u793A\u4F8B\uFF1AValidateBlockValues"),e(a)])]),td,n("h4",od,[pd,s(" 2.4.4.4"),n("a",id,[s("\u95E8\u7968"),e(a)])]),cd,ld,n("h5",ud,[rd,s(" 2.4.4.4.1"),n("a",dd,[s("\u968F\u673A\u7968\u751F\u6210"),e(a)])]),kd,n("p",null,[n("a",vd,[s("\u53EF\u9A8C\u8BC1\u7684\u968F\u673A\u51FD\u6570"),e(a)]),s("\u7528\u4E8E\u7968\u8BC1\u751F\u6210\u3002")]),n("h5",md,[bd,s(" 2.4.4.4.2"),n("a",hd,[s("\u7968\u8BC1\u9A8C\u8BC1"),e(a)])]),fd,n("h4",_d,[gd,s(" 2.4.4.5"),n("a",yd,[s("\u6700\u5C0F\u77FF\u5DE5\u89C4\u6A21"),e(a)])]),wd,n("h4",xd,[Cd,s(" 2.4.4.6"),n("a",Sd,[s("\u50A8\u80FD\u6F14\u5458"),e(a)])]),n("h5",Fd,[qd,s(" 2.4.4.6.1"),n("a",Pd,[Ad,s(" \u5B9E\u4F5C"),e(a)])]),n("p",null,[n("a",Bd,[s("\u793A\u4F8B\uFF1A\u72B6\u6001"),e(a)])]),Ed,n("h5",Td,[Id,s(" 2.4.4.6.2"),n("a",Rd,[Md,s(" \u5B9E\u4F5C"),e(a)])]),n("p",null,[n("a",Dd,[s("\u793A\u4F8B\uFF1A\u51FA\u53E3"),e(a)])]),Gd,n("p",null,[n("a",Vd,[s("\u793A\u4F8B\uFF1AMinerConstructorParams"),e(a)])]),Ld,n("h5",Nd,[jd,s(" 2.4.4.6.3"),n("a",Hd,[s("\u529F\u7387\u8868"),e(a)])]),Od,n("h5",Ud,[zd,s(" 2.4.4.6.4"),n("a",Wd,[s("\u8D28\u62BC\u62B5\u62BC\u54C1"),e(a)])]),Zd,n("ul",null,[n("li",null,[s("\u5C24\u5176\u662F\u9884\u671F\u7684\u5171\u8BC6\u9519\u8BEF\uFF08\u8BF7\u53C2\u9605\u201C "),n("a",Kd,[s("\u5171\u8BC6\u9519\u8BEF\u201D"),e(a)]),s("\uFF09\uFF0C\u780D\u6740\u8005\u4F1A\u5C06\u8FD9\u4E9B\u9519\u8BEF\u62A5\u544A\u7ED9\uFF0C"),Qd,s("\u4EE5\u6362\u53D6\u5956\u52B1\u3002")]),n("li",null,[s("\u5F71\u54CD\u5171\u8BC6\u529F\u7387\u7684\u6545\u969C\uFF0C\u66F4\u4E00\u822C\u800C\u8A00\uFF0C\u5C24\u5176\u662F\u672A\u627F\u8BFA\u7684\u529F\u7387\u6545\u969C\uFF08\u5373\uFF0C "),n("a",Jd,[s("\u5B58\u50A8\u6545\u969C"),e(a)]),s("\uFF09\uFF0C\u5C06\u7531"),Xd,s("\u81EA\u52A8\u62A5\u544A\uFF0C\u6216\u8005\u5F53\u77FF\u5DE5\u7EC8\u6B62\u6247\u533A\u7684\u65F6\u95F4\u65E9\u4E8E\u627F\u8BFA\u7684\u6301\u7EED\u65F6\u95F4\u65F6\uFF0C\u5C06\u62A5\u544A\u8FD9\u4E9B"),n("a",Yd,[s("\u6545\u969C"),e(a)]),s("\u3002")])]),n("p",null,[s("\u6709\u5173\u8D28\u62BC\u62B5\u62BC\u54C1\u7684\u66F4\u8BE6\u7EC6\u8BA8\u8BBA\uFF0C\u8BF7\u53C2\u9605 "),n("a",$d,[s("\u77FF\u5DE5\u62B5\u62BC\u54C1\u90E8\u5206"),e(a)]),s("\u3002")])])}const ok=o(l,[["render",nk],["__file","FileCoin_technical_documentation.html.vue"]]);export{ok as default};
