import{_ as n}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as s,c as a,e as p}from"./app.48f1d0d6.js";const t={},o=p(`<h2 id="windows-hidden" tabindex="-1"><a class="header-anchor" href="#windows-hidden" aria-hidden="true">#</a> Windows Hidden</h2><p><code>whidden.py</code></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> tkinter <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> win32api
<span class="token keyword">import</span> win32con
<span class="token keyword">import</span> win32gui_struct
<span class="token keyword">import</span> win32gui
<span class="token keyword">import</span> os


<span class="token keyword">class</span> <span class="token class-name">SysTrayIcon</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    QUIT <span class="token operator">=</span> <span class="token string">&#39;QUIT&#39;</span>
    SPECIAL_ACTIONS <span class="token operator">=</span> <span class="token punctuation">[</span>QUIT<span class="token punctuation">]</span>
    FIRST_ID <span class="token operator">=</span> <span class="token number">1314</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>
                 icon<span class="token punctuation">,</span>
                 hover_text<span class="token punctuation">,</span>
                 menu_options<span class="token punctuation">,</span>
                 on_quit<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
                 default_menu_index<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
                 window_class_name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">:</span>
        s<span class="token punctuation">.</span>icon <span class="token operator">=</span> icon
        s<span class="token punctuation">.</span>hover_text <span class="token operator">=</span> hover_text
        s<span class="token punctuation">.</span>on_quit <span class="token operator">=</span> on_quit

        menu_options <span class="token operator">=</span> menu_options <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&#39;退出&#39;</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>QUIT<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>_next_action_id <span class="token operator">=</span> s<span class="token punctuation">.</span>FIRST_ID
        s<span class="token punctuation">.</span>menu_actions_by_id <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>menu_options <span class="token operator">=</span> s<span class="token punctuation">.</span>_add_ids_to_menu_options<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>menu_options<span class="token punctuation">)</span><span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>menu_actions_by_id <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>menu_actions_by_id<span class="token punctuation">)</span>
        <span class="token keyword">del</span> s<span class="token punctuation">.</span>_next_action_id

        s<span class="token punctuation">.</span>default_menu_index <span class="token operator">=</span> <span class="token punctuation">(</span>default_menu_index <span class="token keyword">or</span> <span class="token number">0</span><span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>window_class_name <span class="token operator">=</span> window_class_name <span class="token keyword">or</span> <span class="token string">&quot;SysTrayIconPy&quot;</span>

        message_map <span class="token operator">=</span> <span class="token punctuation">{</span>win32gui<span class="token punctuation">.</span>RegisterWindowMessage<span class="token punctuation">(</span><span class="token string">&quot;TaskbarCreated&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span> s<span class="token punctuation">.</span>refresh_icon<span class="token punctuation">,</span>
                       win32con<span class="token punctuation">.</span>WM_DESTROY<span class="token punctuation">:</span> s<span class="token punctuation">.</span>destroy<span class="token punctuation">,</span>
                       win32con<span class="token punctuation">.</span>WM_COMMAND<span class="token punctuation">:</span> s<span class="token punctuation">.</span>command<span class="token punctuation">,</span>
                       win32con<span class="token punctuation">.</span>WM_USER <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">:</span> s<span class="token punctuation">.</span>notify<span class="token punctuation">,</span> <span class="token punctuation">}</span>
        <span class="token comment"># 注册窗口类。</span>
        window_class <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>WNDCLASS<span class="token punctuation">(</span><span class="token punctuation">)</span>
        window_class<span class="token punctuation">.</span>hInstance <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>GetModuleHandle<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span>
        window_class<span class="token punctuation">.</span>lpszClassName <span class="token operator">=</span> s<span class="token punctuation">.</span>window_class_name
        window_class<span class="token punctuation">.</span>style <span class="token operator">=</span> win32con<span class="token punctuation">.</span>CS_VREDRAW <span class="token operator">|</span> win32con<span class="token punctuation">.</span>CS_HREDRAW<span class="token punctuation">;</span>
        window_class<span class="token punctuation">.</span>hCursor <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>LoadCursor<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> win32con<span class="token punctuation">.</span>IDC_ARROW<span class="token punctuation">)</span>
        window_class<span class="token punctuation">.</span>hbrBackground <span class="token operator">=</span> win32con<span class="token punctuation">.</span>COLOR_WINDOW
        window_class<span class="token punctuation">.</span>lpfnWndProc <span class="token operator">=</span> message_map  <span class="token comment"># 也可以指定wndproc.</span>
        s<span class="token punctuation">.</span>classAtom <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>RegisterClass<span class="token punctuation">(</span>window_class<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">show_icon</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 创建窗口。</span>
        hinst <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>GetModuleHandle<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span>
        style <span class="token operator">=</span> win32con<span class="token punctuation">.</span>WS_OVERLAPPED <span class="token operator">|</span> win32con<span class="token punctuation">.</span>WS_SYSMENU
        s<span class="token punctuation">.</span>hwnd <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>CreateWindow<span class="token punctuation">(</span>s<span class="token punctuation">.</span>classAtom<span class="token punctuation">,</span>
                                       s<span class="token punctuation">.</span>window_class_name<span class="token punctuation">,</span>
                                       style<span class="token punctuation">,</span>
                                       <span class="token number">0</span><span class="token punctuation">,</span>
                                       <span class="token number">0</span><span class="token punctuation">,</span>
                                       win32con<span class="token punctuation">.</span>CW_USEDEFAULT<span class="token punctuation">,</span>
                                       win32con<span class="token punctuation">.</span>CW_USEDEFAULT<span class="token punctuation">,</span>
                                       <span class="token number">0</span><span class="token punctuation">,</span>
                                       <span class="token number">0</span><span class="token punctuation">,</span>
                                       hinst<span class="token punctuation">,</span>
                                       <span class="token boolean">None</span><span class="token punctuation">)</span>
        win32gui<span class="token punctuation">.</span>UpdateWindow<span class="token punctuation">(</span>s<span class="token punctuation">.</span>hwnd<span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>notify_id <span class="token operator">=</span> <span class="token boolean">None</span>
        s<span class="token punctuation">.</span>refresh_icon<span class="token punctuation">(</span><span class="token punctuation">)</span>

        win32gui<span class="token punctuation">.</span>PumpMessages<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">show_menu</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
        menu <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>CreatePopupMenu<span class="token punctuation">(</span><span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>create_menu<span class="token punctuation">(</span>menu<span class="token punctuation">,</span> s<span class="token punctuation">.</span>menu_options<span class="token punctuation">)</span>
        <span class="token comment"># win32gui.SetMenuDefaultItem(menu, 1000, 0)</span>

        pos <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>GetCursorPos<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># See http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/menus_0hdi.asp</span>
        win32gui<span class="token punctuation">.</span>SetForegroundWindow<span class="token punctuation">(</span>s<span class="token punctuation">.</span>hwnd<span class="token punctuation">)</span>
        win32gui<span class="token punctuation">.</span>TrackPopupMenu<span class="token punctuation">(</span>menu<span class="token punctuation">,</span>
                                win32con<span class="token punctuation">.</span>TPM_LEFTALIGN<span class="token punctuation">,</span>
                                pos<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                pos<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                <span class="token number">0</span><span class="token punctuation">,</span>
                                s<span class="token punctuation">.</span>hwnd<span class="token punctuation">,</span>
                                <span class="token boolean">None</span><span class="token punctuation">)</span>
        win32gui<span class="token punctuation">.</span>PostMessage<span class="token punctuation">(</span>s<span class="token punctuation">.</span>hwnd<span class="token punctuation">,</span> win32con<span class="token punctuation">.</span>WM_NULL<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">destroy</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> hwnd<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> wparam<span class="token punctuation">,</span> lparam<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> s<span class="token punctuation">.</span>on_quit<span class="token punctuation">:</span> s<span class="token punctuation">.</span>on_quit<span class="token punctuation">(</span>s<span class="token punctuation">)</span>  <span class="token comment"># 运行传递的on_quit</span>
        nid <span class="token operator">=</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span>hwnd<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        win32gui<span class="token punctuation">.</span>Shell_NotifyIcon<span class="token punctuation">(</span>win32gui<span class="token punctuation">.</span>NIM_DELETE<span class="token punctuation">,</span> nid<span class="token punctuation">)</span>
        win32gui<span class="token punctuation">.</span>PostQuitMessage<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># 退出托盘图标</span>

    <span class="token keyword">def</span> <span class="token function">notify</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> hwnd<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> wparam<span class="token punctuation">,</span> lparam<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> lparam <span class="token operator">==</span> win32con<span class="token punctuation">.</span>WM_LBUTTONDBLCLK<span class="token punctuation">:</span>  <span class="token comment"># 双击左键</span>
            <span class="token keyword">pass</span>  <span class="token comment"># s.execute_menu_option(s.default_menu_index + s.FIRST_ID)</span>
        <span class="token keyword">elif</span> lparam <span class="token operator">==</span> win32con<span class="token punctuation">.</span>WM_RBUTTONUP<span class="token punctuation">:</span>  <span class="token comment"># 单击右键</span>
            s<span class="token punctuation">.</span>show_menu<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> lparam <span class="token operator">==</span> win32con<span class="token punctuation">.</span>WM_LBUTTONUP<span class="token punctuation">:</span>  <span class="token comment"># 单击左键</span>
            nid <span class="token operator">=</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span>hwnd<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
            win32gui<span class="token punctuation">.</span>Shell_NotifyIcon<span class="token punctuation">(</span>win32gui<span class="token punctuation">.</span>NIM_DELETE<span class="token punctuation">,</span> nid<span class="token punctuation">)</span>
            win32gui<span class="token punctuation">.</span>PostQuitMessage<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># 退出托盘图标</span>
            <span class="token keyword">if</span> Main<span class="token punctuation">:</span> Main<span class="token punctuation">.</span>root<span class="token punctuation">.</span>deiconify<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>

    <span class="token keyword">def</span> <span class="token function">_add_ids_to_menu_options</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> menu_options<span class="token punctuation">)</span><span class="token punctuation">:</span>
        result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> menu_option <span class="token keyword">in</span> menu_options<span class="token punctuation">:</span>
            option_text<span class="token punctuation">,</span> option_icon<span class="token punctuation">,</span> option_action <span class="token operator">=</span> menu_option
            <span class="token keyword">if</span> <span class="token builtin">callable</span><span class="token punctuation">(</span>option_action<span class="token punctuation">)</span> <span class="token keyword">or</span> option_action <span class="token keyword">in</span> s<span class="token punctuation">.</span>SPECIAL_ACTIONS<span class="token punctuation">:</span>
                s<span class="token punctuation">.</span>menu_actions_by_id<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>_next_action_id<span class="token punctuation">,</span> option_action<span class="token punctuation">)</span><span class="token punctuation">)</span>
                result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>menu_option <span class="token operator">+</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span>_next_action_id<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>option_text<span class="token punctuation">,</span>
                               option_icon<span class="token punctuation">,</span>
                               s<span class="token punctuation">.</span>_add_ids_to_menu_options<span class="token punctuation">(</span>option_action<span class="token punctuation">)</span><span class="token punctuation">,</span>
                               s<span class="token punctuation">.</span>_next_action_id<span class="token punctuation">)</span><span class="token punctuation">)</span>
            s<span class="token punctuation">.</span>_next_action_id <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">return</span> result

    <span class="token keyword">def</span> <span class="token function">refresh_icon</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token operator">**</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        hinst <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>GetModuleHandle<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>s<span class="token punctuation">.</span>icon<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 尝试找到自定义图标</span>
            icon_flags <span class="token operator">=</span> win32con<span class="token punctuation">.</span>LR_LOADFROMFILE <span class="token operator">|</span> win32con<span class="token punctuation">.</span>LR_DEFAULTSIZE
            hicon <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>LoadImage<span class="token punctuation">(</span>hinst<span class="token punctuation">,</span>
                                       s<span class="token punctuation">.</span>icon<span class="token punctuation">,</span>
                                       win32con<span class="token punctuation">.</span>IMAGE_ICON<span class="token punctuation">,</span>
                                       <span class="token number">0</span><span class="token punctuation">,</span>
                                       <span class="token number">0</span><span class="token punctuation">,</span>
                                       icon_flags<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># 找不到图标文件 - 使用默认值</span>
            hicon <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>LoadIcon<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> win32con<span class="token punctuation">.</span>IDI_APPLICATION<span class="token punctuation">)</span>

        <span class="token keyword">if</span> s<span class="token punctuation">.</span>notify_id<span class="token punctuation">:</span>
            message <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>NIM_MODIFY
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            message <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>NIM_ADD
        s<span class="token punctuation">.</span>notify_id <span class="token operator">=</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span>hwnd<span class="token punctuation">,</span>
                       <span class="token number">0</span><span class="token punctuation">,</span>
                       win32gui<span class="token punctuation">.</span>NIF_ICON <span class="token operator">|</span> win32gui<span class="token punctuation">.</span>NIF_MESSAGE <span class="token operator">|</span> win32gui<span class="token punctuation">.</span>NIF_TIP<span class="token punctuation">,</span>
                       win32con<span class="token punctuation">.</span>WM_USER <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">,</span>
                       hicon<span class="token punctuation">,</span>
                       s<span class="token punctuation">.</span>hover_text<span class="token punctuation">)</span>
        win32gui<span class="token punctuation">.</span>Shell_NotifyIcon<span class="token punctuation">(</span>message<span class="token punctuation">,</span> s<span class="token punctuation">.</span>notify_id<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">create_menu</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> menu<span class="token punctuation">,</span> menu_options<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> option_text<span class="token punctuation">,</span> option_icon<span class="token punctuation">,</span> option_action<span class="token punctuation">,</span> option_id <span class="token keyword">in</span> menu_options<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> option_icon<span class="token punctuation">:</span>
                option_icon <span class="token operator">=</span> s<span class="token punctuation">.</span>prep_menu_icon<span class="token punctuation">(</span>option_icon<span class="token punctuation">)</span>

            <span class="token keyword">if</span> option_id <span class="token keyword">in</span> s<span class="token punctuation">.</span>menu_actions_by_id<span class="token punctuation">:</span>
                item<span class="token punctuation">,</span> extras <span class="token operator">=</span> win32gui_struct<span class="token punctuation">.</span>PackMENUITEMINFO<span class="token punctuation">(</span>text<span class="token operator">=</span>option_text<span class="token punctuation">,</span>
                                                                hbmpItem<span class="token operator">=</span>option_icon<span class="token punctuation">,</span>
                                                                wID<span class="token operator">=</span>option_id<span class="token punctuation">)</span>
                win32gui<span class="token punctuation">.</span>InsertMenuItem<span class="token punctuation">(</span>menu<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                submenu <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>CreatePopupMenu<span class="token punctuation">(</span><span class="token punctuation">)</span>
                s<span class="token punctuation">.</span>create_menu<span class="token punctuation">(</span>submenu<span class="token punctuation">,</span> option_action<span class="token punctuation">)</span>
                item<span class="token punctuation">,</span> extras <span class="token operator">=</span> win32gui_struct<span class="token punctuation">.</span>PackMENUITEMINFO<span class="token punctuation">(</span>text<span class="token operator">=</span>option_text<span class="token punctuation">,</span>
                                                                hbmpItem<span class="token operator">=</span>option_icon<span class="token punctuation">,</span>
                                                                hSubMenu<span class="token operator">=</span>submenu<span class="token punctuation">)</span>
                win32gui<span class="token punctuation">.</span>InsertMenuItem<span class="token punctuation">(</span>menu<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">prep_menu_icon</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> icon<span class="token punctuation">)</span><span class="token punctuation">:</span>
        ico_x <span class="token operator">=</span> win32api<span class="token punctuation">.</span>GetSystemMetrics<span class="token punctuation">(</span>win32con<span class="token punctuation">.</span>SM_CXSMICON<span class="token punctuation">)</span>
        ico_y <span class="token operator">=</span> win32api<span class="token punctuation">.</span>GetSystemMetrics<span class="token punctuation">(</span>win32con<span class="token punctuation">.</span>SM_CYSMICON<span class="token punctuation">)</span>
        hicon <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>LoadImage<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> icon<span class="token punctuation">,</span> win32con<span class="token punctuation">.</span>IMAGE_ICON<span class="token punctuation">,</span> ico_x<span class="token punctuation">,</span> ico_y<span class="token punctuation">,</span> win32con<span class="token punctuation">.</span>LR_LOADFROMFILE<span class="token punctuation">)</span>

        hdcBitmap <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>CreateCompatibleDC<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        hdcScreen <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>GetDC<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        hbm <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>CreateCompatibleBitmap<span class="token punctuation">(</span>hdcScreen<span class="token punctuation">,</span> ico_x<span class="token punctuation">,</span> ico_y<span class="token punctuation">)</span>
        hbmOld <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>SelectObject<span class="token punctuation">(</span>hdcBitmap<span class="token punctuation">,</span> hbm<span class="token punctuation">)</span>
        brush <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>GetSysColorBrush<span class="token punctuation">(</span>win32con<span class="token punctuation">.</span>COLOR_MENU<span class="token punctuation">)</span>
        win32gui<span class="token punctuation">.</span>FillRect<span class="token punctuation">(</span>hdcBitmap<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> brush<span class="token punctuation">)</span>
        win32gui<span class="token punctuation">.</span>DrawIconEx<span class="token punctuation">(</span>hdcBitmap<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> hicon<span class="token punctuation">,</span> ico_x<span class="token punctuation">,</span> ico_y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> win32con<span class="token punctuation">.</span>DI_NORMAL<span class="token punctuation">)</span>
        win32gui<span class="token punctuation">.</span>SelectObject<span class="token punctuation">(</span>hdcBitmap<span class="token punctuation">,</span> hbmOld<span class="token punctuation">)</span>
        win32gui<span class="token punctuation">.</span>DeleteDC<span class="token punctuation">(</span>hdcBitmap<span class="token punctuation">)</span>
        <span class="token keyword">return</span> hbm

    <span class="token keyword">def</span> <span class="token function">command</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> hwnd<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> wparam<span class="token punctuation">,</span> lparam<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> win32gui<span class="token punctuation">.</span>LOWORD<span class="token punctuation">(</span>wparam<span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>execute_menu_option<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">execute_menu_option</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        menu_action <span class="token operator">=</span> s<span class="token punctuation">.</span>menu_actions_by_id<span class="token punctuation">[</span><span class="token builtin">id</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> menu_action <span class="token operator">==</span> s<span class="token punctuation">.</span>QUIT<span class="token punctuation">:</span>
            win32gui<span class="token punctuation">.</span>DestroyWindow<span class="token punctuation">(</span>s<span class="token punctuation">.</span>hwnd<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            menu_action<span class="token punctuation">(</span>s<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">_Main</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#########################      tkinter界面设定      #####################################</span>
        <span class="token keyword">import</span> win32gui
        <span class="token keyword">import</span> win32con

        app <span class="token operator">=</span> Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
        app<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">&quot;600x600&quot;</span><span class="token punctuation">)</span>
        app<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&quot;隐藏窗口&quot;</span><span class="token punctuation">)</span>
        scrollbar <span class="token operator">=</span> Scrollbar<span class="token punctuation">(</span>app<span class="token punctuation">)</span>
        scrollbar<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>RIGHT<span class="token punctuation">,</span> fill<span class="token operator">=</span>Y<span class="token punctuation">)</span>
        label <span class="token operator">=</span> Label<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">&quot;请选择需隐藏的&quot;</span><span class="token punctuation">,</span>
                      justify<span class="token operator">=</span>LEFT<span class="token punctuation">,</span>
                      font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">&quot;楷书&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">&#39;bold&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                      anchor<span class="token operator">=</span><span class="token string">&#39;w&#39;</span><span class="token punctuation">,</span>
                      bg<span class="token operator">=</span><span class="token string">&quot;#A2CD5A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pack<span class="token punctuation">(</span>fill <span class="token operator">=</span> BOTH<span class="token punctuation">)</span>
        listb <span class="token operator">=</span> Listbox<span class="token punctuation">(</span>yscrollcommand<span class="token operator">=</span>scrollbar<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">,</span> bg<span class="token operator">=</span><span class="token string">&quot;#A2CD5A&quot;</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">&quot;宋体&quot;</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        listb<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>fill<span class="token operator">=</span>BOTH<span class="token punctuation">,</span> expand<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        scrollbar<span class="token punctuation">.</span>config<span class="token punctuation">(</span>command<span class="token operator">=</span>listb<span class="token punctuation">.</span>yview<span class="token punctuation">)</span>
        Button<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">&quot;隐藏&quot;</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">600</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
               command<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> tray_it<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>listb<span class="token punctuation">.</span>get<span class="token punctuation">(</span>listb<span class="token punctuation">.</span>curselection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token punctuation">)</span>
        Button<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">&quot;显示&quot;</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">600</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
               command<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> show_it<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>listb<span class="token punctuation">.</span>get<span class="token punctuation">(</span>listb<span class="token punctuation">.</span>curselection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token punctuation">)</span>
        Button<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">&quot;关闭&quot;</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">600</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
               command<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> kill<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>listb<span class="token punctuation">.</span>get<span class="token punctuation">(</span>listb<span class="token punctuation">.</span>curselection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token punctuation">)</span>
        Button<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">&quot;刷新(显式的)&quot;</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">600</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
               command<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> getwin<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token punctuation">)</span>
        Button<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">&quot;刷新(隐藏的)&quot;</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">600</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
               command<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> getwin<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token punctuation">)</span>
        Button<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">&quot;托盘自己&quot;</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">600</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
               command<span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span>hide_self<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#点击隐藏自身,即点击最小化按钮.</span>

        hwnd_title <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">def</span> <span class="token function">getwin</span><span class="token punctuation">(</span>showHidden<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            listb<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>END<span class="token punctuation">)</span>
            win32gui<span class="token punctuation">.</span>EnumWindows<span class="token punctuation">(</span>get_hwnd<span class="token punctuation">,</span> showHidden<span class="token punctuation">)</span>
            <span class="token keyword">for</span> h<span class="token punctuation">,</span> t <span class="token keyword">in</span> hwnd_title<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> t <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">:</span>
                    listb<span class="token punctuation">.</span>insert<span class="token punctuation">(</span>END<span class="token punctuation">,</span> t <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">def</span> <span class="token function">get_hwnd</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> showHidden<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> win32gui<span class="token punctuation">.</span>IsWindow<span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span> <span class="token keyword">and</span> win32gui<span class="token punctuation">.</span>IsWindowEnabled<span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> showHidden<span class="token punctuation">:</span>
                    hwnd_title<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span>hwnd<span class="token punctuation">:</span> win32gui<span class="token punctuation">.</span>GetWindowText<span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token keyword">elif</span> win32gui<span class="token punctuation">.</span>IsWindowVisible<span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    hwnd_title<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span>hwnd<span class="token punctuation">:</span> win32gui<span class="token punctuation">.</span>GetWindowText<span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    <span class="token keyword">pass</span>

        getwin<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">def</span> <span class="token function">hide_self</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            app<span class="token punctuation">.</span>state<span class="token punctuation">(</span><span class="token string">&#39;icon&#39;</span><span class="token punctuation">)</span>

        <span class="token keyword">def</span> <span class="token function">kill</span><span class="token punctuation">(</span>pid<span class="token punctuation">)</span><span class="token punctuation">:</span>
            win32gui<span class="token punctuation">.</span>PostMessage<span class="token punctuation">(</span>pid<span class="token punctuation">,</span> win32con<span class="token punctuation">.</span>WM_CLOSE<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                listb<span class="token punctuation">.</span>delete<span class="token punctuation">(</span>listb<span class="token punctuation">.</span>curselection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                <span class="token keyword">pass</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">pass</span>

        <span class="token keyword">def</span> <span class="token function">tray_it</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
            win32gui<span class="token punctuation">.</span>ShowWindow<span class="token punctuation">(</span>win32gui<span class="token punctuation">.</span>FindWindow<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">,</span> win32con<span class="token punctuation">.</span>SW_HIDE<span class="token punctuation">)</span>

        <span class="token keyword">def</span> <span class="token function">show_it</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
            win32gui<span class="token punctuation">.</span>ShowWindow<span class="token punctuation">(</span>win32gui<span class="token punctuation">.</span>FindWindow<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">,</span> win32con<span class="token punctuation">.</span>SW_SHOW<span class="token punctuation">)</span>

        <span class="token comment">#app.mainloop()</span>

        <span class="token comment">###########################     开始托盘程序嵌入     #####################################</span>
        s<span class="token punctuation">.</span>root <span class="token operator">=</span> app
        icons <span class="token operator">=</span> os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">r&#39;\\robot.ico&#39;</span>
         <span class="token comment"># print(icons)</span>
        hover_text <span class="token operator">=</span> <span class="token string">&quot;点击恢复&quot;</span>  <span class="token comment"># 悬浮于图标上方时的提示</span>
        menu_options <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>sysTrayIcon <span class="token operator">=</span> SysTrayIcon<span class="token punctuation">(</span>icons<span class="token punctuation">,</span> hover_text<span class="token punctuation">,</span> menu_options<span class="token punctuation">,</span> on_quit<span class="token operator">=</span>s<span class="token punctuation">.</span>exit<span class="token punctuation">,</span> default_menu_index<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

        s<span class="token punctuation">.</span>root<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token string">&quot;&lt;Unmap&gt;&quot;</span><span class="token punctuation">,</span> <span class="token keyword">lambda</span> event<span class="token punctuation">:</span> s<span class="token punctuation">.</span>Unmap<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> s<span class="token punctuation">.</span>root<span class="token punctuation">.</span>state<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&#39;iconic&#39;</span> <span class="token keyword">else</span> <span class="token boolean">False</span><span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>root<span class="token punctuation">.</span>protocol<span class="token punctuation">(</span><span class="token string">&#39;WM_DELETE_WINDOW&#39;</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>exit<span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>root<span class="token punctuation">.</span>resizable<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>root<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">switch_icon</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> _sysTrayIcon<span class="token punctuation">,</span> icons<span class="token operator">=</span><span class="token string">&#39;D:\\\\2.ico&#39;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        _sysTrayIcon<span class="token punctuation">.</span>icon <span class="token operator">=</span> icons
        _sysTrayIcon<span class="token punctuation">.</span>refresh_icon<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 点击右键菜单项目会传递SysTrayIcon自身给引用的函数，所以这里的_sysTrayIcon = s.sysTrayIcon</span>

    <span class="token keyword">def</span> <span class="token function">Unmap</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
        s<span class="token punctuation">.</span>root<span class="token punctuation">.</span>withdraw<span class="token punctuation">(</span><span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>sysTrayIcon<span class="token punctuation">.</span>show_icon<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">exit</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> _sysTrayIcon<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        s<span class="token punctuation">.</span>root<span class="token punctuation">.</span>destroy<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># print(&#39;exit...&#39;)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    Main <span class="token operator">=</span> _Main<span class="token punctuation">(</span><span class="token punctuation">)</span>
    Main<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>管理员方式运行</p><blockquote><p>有些窗口需要管理员权限</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>@ <span class="token builtin class-name">echo</span> off
%1 %2
ver<span class="token operator">|</span><span class="token function">find</span> <span class="token string">&quot;5.&quot;</span><span class="token operator">&gt;</span>nul<span class="token operator">&amp;&amp;</span>goto :Admin
mshta vbscript:createobject<span class="token punctuation">(</span><span class="token string">&quot;shell.application&quot;</span><span class="token punctuation">)</span>.shellexecute<span class="token punctuation">(</span><span class="token string">&quot;%~s0&quot;</span>,<span class="token string">&quot;goto :Admin&quot;</span>,<span class="token string">&quot;&quot;</span>,<span class="token string">&quot;runas&quot;</span>,1<span class="token punctuation">)</span><span class="token punctuation">(</span>window.close<span class="token punctuation">)</span><span class="token operator">&amp;</span>goto :eof
:Admin
start <span class="token string">&quot;&quot;</span> <span class="token string">&quot;C:\\Users\\xx\\Desktop\\whidden.py&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6),c=[o];function e(i,u){return s(),a("div",null,c)}const r=n(t,[["render",e],["__file","WinHidden.html.vue"]]);export{r as default};
